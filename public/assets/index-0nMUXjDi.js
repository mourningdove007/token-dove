(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();const rl=!1;var Na=Array.isArray,ng=Array.prototype.indexOf,Oa=Array.from,sg=Object.defineProperty,gs=Object.getOwnPropertyDescriptor,ig=Object.getOwnPropertyDescriptors,og=Object.prototype,ag=Array.prototype,Uh=Object.getPrototypeOf,Ou=Object.isExtensible;function eo(t){return typeof t=="function"}const _i=()=>{};function cg(t){return t()}function ha(t){for(var e=0;e<t.length;e++)t[e]()}function Lh(){var t,e,r=new Promise((n,s)=>{t=n,e=s});return{promise:r,resolve:t,reject:e}}const Sr=2,nl=4,_o=8,Fh=1<<24,Jn=16,Zn=32,Ys=64,Kl=128,un=512,_r=1024,$r=2048,Bn=4096,rn=8192,Wn=16384,zl=32768,Vs=65536,Mu=1<<17,$h=1<<18,Ki=1<<19,Kh=1<<20,ds=1<<25,qs=32768,sl=1<<21,Vl=1<<22,ws=1<<23,Os=Symbol("$state"),zh=Symbol("legacy props"),mi=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Ma(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function lg(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function ug(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function fg(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function hg(t){throw new Error("https://svelte.dev/e/effect_orphan")}function dg(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function pg(t){throw new Error("https://svelte.dev/e/lifecycle_legacy_only")}function gg(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function wg(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function mg(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function yg(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function bg(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const vg=1,Eg=2,xg=16,_g=1,Ig=2,Sg=4,Ag=8,Rg=16,Bg=1,Tg=2,br=Symbol();function Pg(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function Vh(t){return t===this.v}function qh(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function Wh(t){return!qh(t,this.v)}let zi=!1,Cg=!1;function Dg(){zi=!0}let Dt=null;function Bi(t){Dt=t}function Io(t,e=!1,r){Dt={p:Dt,i:!1,c:null,e:null,s:t,x:null,l:zi&&!e?{s:null,u:null,$:[]}:null}}function So(t){var e=Dt,r=e.e;if(r!==null){e.e=null;for(var n of r)ld(n)}return e.i=!0,Dt=e.p,{}}function Ao(){return!zi||Dt!==null&&Dt.l===null}let As=[];function jh(){var t=As;As=[],ha(t)}function ql(t){if(As.length===0&&!uo){var e=As;queueMicrotask(()=>{e===As&&jh()})}As.push(t)}function kg(){for(;As.length>0;)jh()}function Hh(t){var e=It;if(e===null)return pt.f|=ws,t;if((e.f&zl)===0){if((e.f&Kl)===0)throw t;e.b.error(t)}else Ti(t,e)}function Ti(t,e){for(;e!==null;){if((e.f&Kl)!==0)try{e.b.error(t);return}catch(r){t=r}e=e.parent}throw t}const Ng=-7169;function dr(t,e){t.f=t.f&Ng|e}function Wl(t){(t.f&un)!==0||t.deps===null?dr(t,_r):dr(t,Bn)}function Gh(t){if(t!==null)for(const e of t)(e.f&Sr)===0||(e.f&qs)===0||(e.f^=qs,Gh(e.deps))}function Jh(t,e,r){(t.f&$r)!==0?e.add(t):(t.f&Bn)!==0&&r.add(t),Gh(t.deps),dr(t,_r)}const zo=new Set;let jt=null,hn=null,cn=[],Ua=null,il=!1,uo=!1;class In{committed=!1;current=new Map;previous=new Map;#e=new Set;#r=new Set;#t=0;#n=0;#o=null;#i=new Set;#s=new Set;skipped_effects=new Set;is_fork=!1;is_deferred(){return this.is_fork||this.#n>0}process(e){cn=[],this.apply();var r=[],n=[];for(const s of e)this.#a(s,r,n);this.is_fork||this.#l(),this.is_deferred()?(this.#c(n),this.#c(r)):(jt=null,Uu(n),Uu(r),this.#o?.resolve()),hn=null}#a(e,r,n){e.f^=_r;for(var s=e.first,i=null;s!==null;){var o=s.f,a=(o&(Zn|Ys))!==0,c=a&&(o&_r)!==0,l=c||(o&rn)!==0||this.skipped_effects.has(s);if(!l&&s.fn!==null){a?s.f^=_r:i!==null&&(o&(nl|_o|Fh))!==0?i.b.defer_effect(s):(o&nl)!==0?r.push(s):Vi(s)&&((o&Jn)!==0&&this.#i.add(s),Ci(s));var g=s.first;if(g!==null){s=g;continue}}var m=s.parent;for(s=s.next;s===null&&m!==null;)m===i&&(i=null),s=m.next,m=m.parent}}#c(e){for(var r=0;r<e.length;r+=1)Jh(e[r],this.#i,this.#s)}capture(e,r){r!==br&&!this.previous.has(e)&&this.previous.set(e,r),(e.f&ws)===0&&(this.current.set(e,e.v),hn?.set(e,e.v))}activate(){jt=this,this.apply()}deactivate(){jt===this&&(jt=null,hn=null)}flush(){if(this.activate(),cn.length>0){if(Zh(),jt!==null&&jt!==this)return}else this.#t===0&&this.process([]);this.deactivate()}discard(){for(const e of this.#r)e(this);this.#r.clear()}#l(){if(this.#n===0){for(const e of this.#e)e();this.#e.clear()}this.#t===0&&this.#h()}#h(){if(zo.size>1){this.previous.clear();var e=hn,r=!0;for(const s of zo){if(s===this){r=!1;continue}const i=[];for(const[a,c]of this.current){if(s.current.has(a))if(r&&c!==s.current.get(a))s.current.set(a,c);else continue;i.push(a)}if(i.length===0)continue;const o=[...s.current.keys()].filter(a=>!this.current.has(a));if(o.length>0){var n=cn;cn=[];const a=new Set,c=new Map;for(const l of i)Yh(l,o,a,c);if(cn.length>0){jt=s,s.apply();for(const l of cn)s.#a(l,[],[]);s.deactivate()}cn=n}}jt=null,hn=e}this.committed=!0,zo.delete(this)}increment(e){this.#t+=1,e&&(this.#n+=1)}decrement(e){this.#t-=1,e&&(this.#n-=1),this.revive()}revive(){for(const e of this.#i)this.#s.delete(e),dr(e,$r),Hn(e);for(const e of this.#s)dr(e,Bn),Hn(e);this.flush()}oncommit(e){this.#e.add(e)}ondiscard(e){this.#r.add(e)}settled(){return(this.#o??=Lh()).promise}static ensure(){if(jt===null){const e=jt=new In;zo.add(jt),uo||In.enqueue(()=>{jt===e&&e.flush()})}return jt}static enqueue(e){ql(e)}apply(){}}function Og(t){var e=uo;uo=!0;try{for(var r;;){if(kg(),cn.length===0&&(jt?.flush(),cn.length===0))return Ua=null,r;Zh()}}finally{uo=e}}function Zh(){var t=Us;il=!0;var e=null;try{var r=0;for(ga(!0);cn.length>0;){var n=In.ensure();if(r++>1e3){var s,i;Mg()}n.process(cn),ms.clear()}}finally{il=!1,ga(t),Ua=null}}function Mg(){try{dg()}catch(t){Ti(t,Ua)}}let Mn=null;function Uu(t){var e=t.length;if(e!==0){for(var r=0;r<e;){var n=t[r++];if((n.f&(Wn|rn))===0&&Vi(n)&&(Mn=new Set,Ci(n),n.deps===null&&n.first===null&&n.nodes===null&&(n.teardown===null&&n.ac===null?hd(n):n.fn=null),Mn?.size>0)){ms.clear();for(const s of Mn){if((s.f&(Wn|rn))!==0)continue;const i=[s];let o=s.parent;for(;o!==null;)Mn.has(o)&&(Mn.delete(o),i.push(o)),o=o.parent;for(let a=i.length-1;a>=0;a--){const c=i[a];(c.f&(Wn|rn))===0&&Ci(c)}}Mn.clear()}}Mn=null}}function Yh(t,e,r,n){if(!r.has(t)&&(r.add(t),t.reactions!==null))for(const s of t.reactions){const i=s.f;(i&Sr)!==0?Yh(s,e,r,n):(i&(Vl|Jn))!==0&&(i&$r)===0&&Xh(s,e,n)&&(dr(s,$r),Hn(s))}}function Xh(t,e,r){const n=r.get(t);if(n!==void 0)return n;if(t.deps!==null)for(const s of t.deps){if(e.includes(s))return!0;if((s.f&Sr)!==0&&Xh(s,e,r))return r.set(s,!0),!0}return r.set(t,!1),!1}function Hn(t){for(var e=Ua=t;e.parent!==null;){e=e.parent;var r=e.f;if(il&&e===It&&(r&Jn)!==0&&(r&$h)===0)return;if((r&(Ys|Zn))!==0){if((r&_r)===0)return;e.f^=_r}}cn.push(e)}function Ug(t){let e=0,r=Ws(0),n;return()=>{Gl()&&(ut(r),Jl(()=>(e===0&&(n=Xs(()=>t(()=>fo(r)))),e+=1,()=>{ql(()=>{e-=1,e===0&&(n?.(),n=void 0,fo(r))})})))}}var Lg=Vs|Ki|Kl;function Fg(t,e,r){new $g(t,e,r)}class $g{parent;is_pending=!1;#e;#r=null;#t;#n;#o;#i=null;#s=null;#a=null;#c=null;#l=null;#h=0;#d=0;#p=!1;#g=new Set;#u=new Set;#f=null;#w=Ug(()=>(this.#f=Ws(this.#h),()=>{this.#f=null}));constructor(e,r,n){this.#e=e,this.#t=r,this.#n=n,this.parent=It.b,this.is_pending=!!this.#t.pending,this.#o=Fa(()=>{It.b=this;{var s=this.#E();try{this.#i=ln(()=>n(s))}catch(i){this.error(i)}this.#d>0?this.#v():this.is_pending=!1}return()=>{this.#l?.remove()}},Lg)}#m(){try{this.#i=ln(()=>this.#n(this.#e))}catch(e){this.error(e)}}#y(){const e=this.#t.pending;e&&(this.#s=ln(()=>e(this.#e)),In.enqueue(()=>{var r=this.#E();this.#i=this.#b(()=>(In.ensure(),ln(()=>this.#n(r)))),this.#d>0?this.#v():(Ms(this.#s,()=>{this.#s=null}),this.is_pending=!1)}))}#E(){var e=this.#e;return this.is_pending&&(this.#l=js(),this.#e.before(this.#l),e=this.#l),e}defer_effect(e){Jh(e,this.#g,this.#u)}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!this.#t.pending}#b(e){var r=It,n=pt,s=Dt;An(this.#o),jr(this.#o),Bi(this.#o.ctx);try{return e()}catch(i){return Hh(i),null}finally{An(r),jr(n),Bi(s)}}#v(){const e=this.#t.pending;this.#i!==null&&(this.#c=document.createDocumentFragment(),this.#c.append(this.#l),gd(this.#i,this.#c)),this.#s===null&&(this.#s=ln(()=>e(this.#e)))}#x(e){if(!this.has_pending_snippet()){this.parent&&this.parent.#x(e);return}if(this.#d+=e,this.#d===0){this.is_pending=!1;for(const r of this.#g)dr(r,$r),Hn(r);for(const r of this.#u)dr(r,Bn),Hn(r);this.#g.clear(),this.#u.clear(),this.#s&&Ms(this.#s,()=>{this.#s=null}),this.#c&&(this.#e.before(this.#c),this.#c=null)}}update_pending_count(e){this.#x(e),this.#h+=e,this.#f&&Pi(this.#f,this.#h)}get_effect_pending(){return this.#w(),ut(this.#f)}error(e){var r=this.#t.onerror;let n=this.#t.failed;if(this.#p||!r&&!n)throw e;this.#i&&(Gr(this.#i),this.#i=null),this.#s&&(Gr(this.#s),this.#s=null),this.#a&&(Gr(this.#a),this.#a=null);var s=!1,i=!1;const o=()=>{if(s){Pg();return}s=!0,i&&bg(),In.ensure(),this.#h=0,this.#a!==null&&Ms(this.#a,()=>{this.#a=null}),this.is_pending=this.has_pending_snippet(),this.#i=this.#b(()=>(this.#p=!1,ln(()=>this.#n(this.#e)))),this.#d>0?this.#v():this.is_pending=!1};var a=pt;try{jr(null),i=!0,r?.(e,o),i=!1}catch(c){Ti(c,this.#o&&this.#o.parent)}finally{jr(a)}n&&ql(()=>{this.#a=this.#b(()=>{In.ensure(),this.#p=!0;try{return ln(()=>{n(this.#e,()=>e,()=>o)})}catch(c){return Ti(c,this.#o.parent),null}finally{this.#p=!1}})})}}function Kg(t,e,r,n){const s=Ao()?La:jl;if(r.length===0&&t.length===0){n(e.map(s));return}var i=jt,o=It,a=zg();function c(){Promise.all(r.map(l=>Vg(l))).then(l=>{a();try{n([...e.map(s),...l])}catch(g){(o.f&Wn)===0&&Ti(g,o)}i?.deactivate(),da()}).catch(l=>{Ti(l,o)})}t.length>0?Promise.all(t).then(()=>{a();try{return c()}finally{i?.deactivate(),da()}}):c()}function zg(){var t=It,e=pt,r=Dt,n=jt;return function(i=!0){An(t),jr(e),Bi(r),i&&n?.activate()}}function da(){An(null),jr(null),Bi(null)}function La(t){var e=Sr|$r,r=pt!==null&&(pt.f&Sr)!==0?pt:null;return It!==null&&(It.f|=Ki),{ctx:Dt,deps:null,effects:null,equals:Vh,f:e,fn:t,reactions:null,rv:0,v:br,wv:0,parent:r??It,ac:null}}function Vg(t,e,r){let n=It;n===null&&lg();var s=n.b,i=void 0,o=Ws(br),a=!pt,c=new Map;return ew(()=>{var l=Lh();i=l.promise;try{Promise.resolve(t()).then(l.resolve,l.reject).then(()=>{g===jt&&g.committed&&g.deactivate(),da()})}catch(_){l.reject(_),da()}var g=jt;if(a){var m=s.is_rendered();s.update_pending_count(1),g.increment(m),c.get(g)?.reject(mi),c.delete(g),c.set(g,l)}const I=(_,b=void 0)=>{if(g.activate(),b)b!==mi&&(o.f|=ws,Pi(o,b));else{(o.f&ws)!==0&&(o.f^=ws),Pi(o,_);for(const[v,S]of c){if(c.delete(v),v===g)break;S.reject(mi)}}a&&(s.update_pending_count(-1),g.decrement(m))};l.promise.then(I,_=>I(null,_||"unknown"))}),Jg(()=>{for(const l of c.values())l.reject(mi)}),new Promise(l=>{function g(m){function I(){m===i?l(o):g(i)}m.then(I,I)}g(i)})}function jl(t){const e=La(t);return e.equals=Wh,e}function Qh(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)Gr(e[r])}}function qg(t){for(var e=t.parent;e!==null;){if((e.f&Sr)===0)return(e.f&Wn)===0?e:null;e=e.parent}return null}function Hl(t){var e,r=It;An(qg(t));try{t.f&=~qs,Qh(t),e=bd(t)}finally{An(r)}return e}function ed(t){var e=Hl(t);if(!t.equals(e)&&(t.wv=md(),(!jt?.is_fork||t.deps===null)&&(t.v=e,t.deps===null))){dr(t,_r);return}Es||(hn!==null?(Gl()||jt?.is_fork)&&hn.set(t,e):Wl(t))}let ol=new Set;const ms=new Map;let td=!1;function Ws(t,e){var r={f:0,v:t,reactions:null,equals:Vh,rv:0,wv:0};return r}function En(t,e){const r=Ws(t);return nw(r),r}function ia(t,e=!1,r=!0){const n=Ws(t);return e||(n.equals=Wh),zi&&r&&Dt!==null&&Dt.l!==null&&(Dt.l.s??=[]).push(n),n}function or(t,e,r=!1){pt!==null&&(!dn||(pt.f&Mu)!==0)&&Ao()&&(pt.f&(Sr|Jn|Vl|Mu))!==0&&!jn?.includes(t)&&yg();let n=r?Rs(e):e;return Pi(t,n)}function Pi(t,e){if(!t.equals(e)){var r=t.v;Es?ms.set(t,e):ms.set(t,r),t.v=e;var n=In.ensure();if(n.capture(t,r),(t.f&Sr)!==0){const s=t;(t.f&$r)!==0&&Hl(s),Wl(s)}t.wv=md(),rd(t,$r),Ao()&&It!==null&&(It.f&_r)!==0&&(It.f&(Zn|Ys))===0&&(on===null?sw([t]):on.push(t)),!n.is_fork&&ol.size>0&&!td&&Wg()}return e}function Wg(){td=!1;var t=Us;ga(!0);const e=Array.from(ol);try{for(const r of e)(r.f&_r)!==0&&dr(r,Bn),Vi(r)&&Ci(r)}finally{ga(t)}ol.clear()}function fo(t){or(t,t.v+1)}function rd(t,e){var r=t.reactions;if(r!==null)for(var n=Ao(),s=r.length,i=0;i<s;i++){var o=r[i],a=o.f;if(!(!n&&o===It)){var c=(a&$r)===0;if(c&&dr(o,e),(a&Sr)!==0){var l=o;hn?.delete(l),(a&qs)===0&&(a&un&&(o.f|=qs),rd(l,Bn))}else c&&((a&Jn)!==0&&Mn!==null&&Mn.add(o),Hn(o))}}}function Rs(t){if(typeof t!="object"||t===null||Os in t)return t;const e=Uh(t);if(e!==og&&e!==ag)return t;var r=new Map,n=Na(t),s=En(0),i=Ls,o=a=>{if(Ls===i)return a();var c=pt,l=Ls;jr(null),Ku(i);var g=a();return jr(c),Ku(l),g};return n&&r.set("length",En(t.length)),new Proxy(t,{defineProperty(a,c,l){(!("value"in l)||l.configurable===!1||l.enumerable===!1||l.writable===!1)&&wg();var g=r.get(c);return g===void 0?g=o(()=>{var m=En(l.value);return r.set(c,m),m}):or(g,l.value,!0),!0},deleteProperty(a,c){var l=r.get(c);if(l===void 0){if(c in a){const g=o(()=>En(br));r.set(c,g),fo(s)}}else or(l,br),fo(s);return!0},get(a,c,l){if(c===Os)return t;var g=r.get(c),m=c in a;if(g===void 0&&(!m||gs(a,c)?.writable)&&(g=o(()=>{var _=Rs(m?a[c]:br),b=En(_);return b}),r.set(c,g)),g!==void 0){var I=ut(g);return I===br?void 0:I}return Reflect.get(a,c,l)},getOwnPropertyDescriptor(a,c){var l=Reflect.getOwnPropertyDescriptor(a,c);if(l&&"value"in l){var g=r.get(c);g&&(l.value=ut(g))}else if(l===void 0){var m=r.get(c),I=m?.v;if(m!==void 0&&I!==br)return{enumerable:!0,configurable:!0,value:I,writable:!0}}return l},has(a,c){if(c===Os)return!0;var l=r.get(c),g=l!==void 0&&l.v!==br||Reflect.has(a,c);if(l!==void 0||It!==null&&(!g||gs(a,c)?.writable)){l===void 0&&(l=o(()=>{var I=g?Rs(a[c]):br,_=En(I);return _}),r.set(c,l));var m=ut(l);if(m===br)return!1}return g},set(a,c,l,g){var m=r.get(c),I=c in a;if(n&&c==="length")for(var _=l;_<m.v;_+=1){var b=r.get(_+"");b!==void 0?or(b,br):_ in a&&(b=o(()=>En(br)),r.set(_+"",b))}if(m===void 0)(!I||gs(a,c)?.writable)&&(m=o(()=>En(void 0)),or(m,Rs(l)),r.set(c,m));else{I=m.v!==br;var v=o(()=>Rs(l));or(m,v)}var S=Reflect.getOwnPropertyDescriptor(a,c);if(S?.set&&S.set.call(g,l),!I){if(n&&typeof c=="string"){var O=r.get("length"),$=Number(c);Number.isInteger($)&&$>=O.v&&or(O,$+1)}fo(s)}return!0},ownKeys(a){ut(s);var c=Reflect.ownKeys(a).filter(m=>{var I=r.get(m);return I===void 0||I.v!==br});for(var[l,g]of r)g.v!==br&&!(l in a)&&c.push(l);return c},setPrototypeOf(){mg()}})}var Lu,nd,sd,id;function jg(){if(Lu===void 0){Lu=window,nd=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;sd=gs(e,"firstChild").get,id=gs(e,"nextSibling").get,Ou(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),Ou(r)&&(r.__t=void 0)}}function js(t=""){return document.createTextNode(t)}function pa(t){return sd.call(t)}function Ro(t){return id.call(t)}function Dn(t,e){return pa(t)}function Ii(t,e=!1){{var r=pa(t);return r instanceof Comment&&r.data===""?Ro(r):r}}function xn(t,e=1,r=!1){let n=t;for(;e--;)n=Ro(n);return n}function Hg(t){t.textContent=""}function od(){return!1}function ad(t){var e=pt,r=It;jr(null),An(null);try{return t()}finally{jr(e),An(r)}}function cd(t){It===null&&(pt===null&&hg(),fg()),Es&&ug()}function Gg(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function Yn(t,e,r){var n=It;n!==null&&(n.f&rn)!==0&&(t|=rn);var s={ctx:Dt,deps:null,nodes:null,f:t|$r|un,first:null,fn:e,last:null,next:null,parent:n,b:n&&n.b,prev:null,teardown:null,wv:0,ac:null};if(r)try{Ci(s),s.f|=zl}catch(a){throw Gr(s),a}else e!==null&&Hn(s);var i=s;if(r&&i.deps===null&&i.teardown===null&&i.nodes===null&&i.first===i.last&&(i.f&Ki)===0&&(i=i.first,(t&Jn)!==0&&(t&Vs)!==0&&i!==null&&(i.f|=Vs)),i!==null&&(i.parent=n,n!==null&&Gg(i,n),pt!==null&&(pt.f&Sr)!==0&&(t&Ys)===0)){var o=pt;(o.effects??=[]).push(i)}return s}function Gl(){return pt!==null&&!dn}function Jg(t){const e=Yn(_o,null,!1);return dr(e,_r),e.teardown=t,e}function al(t){cd();var e=It.f,r=!pt&&(e&Zn)!==0&&(e&zl)===0;if(r){var n=Dt;(n.e??=[]).push(t)}else return ld(t)}function ld(t){return Yn(nl|Kh,t,!1)}function Zg(t){return cd(),Yn(_o|Kh,t,!0)}function Yg(t){In.ensure();const e=Yn(Ys|Ki,t,!0);return(r={})=>new Promise(n=>{r.outro?Ms(e,()=>{Gr(e),n(void 0)}):(Gr(e),n(void 0))})}function Xg(t,e){var r=Dt,n={effect:null,ran:!1,deps:t};r.l.$.push(n),n.effect=Jl(()=>{t(),!n.ran&&(n.ran=!0,Xs(e))})}function Qg(){var t=Dt;Jl(()=>{for(var e of t.l.$){e.deps();var r=e.effect;(r.f&_r)!==0&&r.deps!==null&&dr(r,Bn),Vi(r)&&Ci(r),e.ran=!1}})}function ew(t){return Yn(Vl|Ki,t,!0)}function Jl(t,e=0){return Yn(_o|e,t,!0)}function Fu(t,e=[],r=[],n=[]){Kg(n,e,r,s=>{Yn(_o,()=>t(...s.map(ut)),!0)})}function Fa(t,e=0){var r=Yn(Jn|e,t,!0);return r}function ln(t){return Yn(Zn|Ki,t,!0)}function ud(t){var e=t.teardown;if(e!==null){const r=Es,n=pt;$u(!0),jr(null);try{e.call(null)}finally{$u(r),jr(n)}}}function fd(t,e=!1){var r=t.first;for(t.first=t.last=null;r!==null;){const s=r.ac;s!==null&&ad(()=>{s.abort(mi)});var n=r.next;(r.f&Ys)!==0?r.parent=null:Gr(r,e),r=n}}function tw(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&Zn)===0&&Gr(e),e=r}}function Gr(t,e=!0){var r=!1;(e||(t.f&$h)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(rw(t.nodes.start,t.nodes.end),r=!0),fd(t,e&&!r),wa(t,0),dr(t,Wn);var n=t.nodes&&t.nodes.t;if(n!==null)for(const i of n)i.stop();ud(t);var s=t.parent;s!==null&&s.first!==null&&hd(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function rw(t,e){for(;t!==null;){var r=t===e?null:Ro(t);t.remove(),t=r}}function hd(t){var e=t.parent,r=t.prev,n=t.next;r!==null&&(r.next=n),n!==null&&(n.prev=r),e!==null&&(e.first===t&&(e.first=n),e.last===t&&(e.last=r))}function Ms(t,e,r=!0){var n=[];dd(t,n,!0);var s=()=>{r&&Gr(t),e&&e()},i=n.length;if(i>0){var o=()=>--i||s();for(var a of n)a.out(o)}else s()}function dd(t,e,r){if((t.f&rn)===0){t.f^=rn;var n=t.nodes&&t.nodes.t;if(n!==null)for(const a of n)(a.is_global||r)&&e.push(a);for(var s=t.first;s!==null;){var i=s.next,o=(s.f&Vs)!==0||(s.f&Zn)!==0&&(t.f&Jn)!==0;dd(s,e,o?r:!1),s=i}}}function Zl(t){pd(t,!0)}function pd(t,e){if((t.f&rn)!==0){t.f^=rn,(t.f&_r)===0&&(dr(t,$r),Hn(t));for(var r=t.first;r!==null;){var n=r.next,s=(r.f&Vs)!==0||(r.f&Zn)!==0;pd(r,s?e:!1),r=n}var i=t.nodes&&t.nodes.t;if(i!==null)for(const o of i)(o.is_global||e)&&o.in()}}function gd(t,e){if(t.nodes)for(var r=t.nodes.start,n=t.nodes.end;r!==null;){var s=r===n?null:Ro(r);e.append(r),r=s}}let Us=!1;function ga(t){Us=t}let Es=!1;function $u(t){Es=t}let pt=null,dn=!1;function jr(t){pt=t}let It=null;function An(t){It=t}let jn=null;function nw(t){pt!==null&&(jn===null?jn=[t]:jn.push(t))}let qr=null,Xr=0,on=null;function sw(t){on=t}let wd=1,Bs=0,Ls=Bs;function Ku(t){Ls=t}function md(){return++wd}function Vi(t){var e=t.f;if((e&$r)!==0)return!0;if(e&Sr&&(t.f&=~qs),(e&Bn)!==0){for(var r=t.deps,n=r.length,s=0;s<n;s++){var i=r[s];if(Vi(i)&&ed(i),i.wv>t.wv)return!0}(e&un)!==0&&hn===null&&dr(t,_r)}return!1}function yd(t,e,r=!0){var n=t.reactions;if(n!==null&&!jn?.includes(t))for(var s=0;s<n.length;s++){var i=n[s];(i.f&Sr)!==0?yd(i,e,!1):e===i&&(r?dr(i,$r):(i.f&_r)!==0&&dr(i,Bn),Hn(i))}}function bd(t){var e=qr,r=Xr,n=on,s=pt,i=jn,o=Dt,a=dn,c=Ls,l=t.f;qr=null,Xr=0,on=null,pt=(l&(Zn|Ys))===0?t:null,jn=null,Bi(t.ctx),dn=!1,Ls=++Bs,t.ac!==null&&(ad(()=>{t.ac.abort(mi)}),t.ac=null);try{t.f|=sl;var g=t.fn,m=g(),I=t.deps;if(qr!==null){var _;if(wa(t,Xr),I!==null&&Xr>0)for(I.length=Xr+qr.length,_=0;_<qr.length;_++)I[Xr+_]=qr[_];else t.deps=I=qr;if(Gl()&&(t.f&un)!==0)for(_=Xr;_<I.length;_++)(I[_].reactions??=[]).push(t)}else I!==null&&Xr<I.length&&(wa(t,Xr),I.length=Xr);if(Ao()&&on!==null&&!dn&&I!==null&&(t.f&(Sr|Bn|$r))===0)for(_=0;_<on.length;_++)yd(on[_],t);if(s!==null&&s!==t){if(Bs++,s.deps!==null)for(let b=0;b<r;b+=1)s.deps[b].rv=Bs;if(e!==null)for(const b of e)b.rv=Bs;on!==null&&(n===null?n=on:n.push(...on))}return(t.f&ws)!==0&&(t.f^=ws),m}catch(b){return Hh(b)}finally{t.f^=sl,qr=e,Xr=r,on=n,pt=s,jn=i,Bi(o),dn=a,Ls=c}}function iw(t,e){let r=e.reactions;if(r!==null){var n=ng.call(r,t);if(n!==-1){var s=r.length-1;s===0?r=e.reactions=null:(r[n]=r[s],r.pop())}}if(r===null&&(e.f&Sr)!==0&&(qr===null||!qr.includes(e))){var i=e;(i.f&un)!==0&&(i.f^=un,i.f&=~qs),Wl(i),Qh(i),wa(i,0)}}function wa(t,e){var r=t.deps;if(r!==null)for(var n=e;n<r.length;n++)iw(t,r[n])}function Ci(t){var e=t.f;if((e&Wn)===0){dr(t,_r);var r=It,n=Us;It=t,Us=!0;try{(e&(Jn|Fh))!==0?tw(t):fd(t),ud(t);var s=bd(t);t.teardown=typeof s=="function"?s:null,t.wv=wd;var i;rl&&Cg&&(t.f&$r)!==0&&t.deps}finally{Us=n,It=r}}}async function vd(){await Promise.resolve(),Og()}function ut(t){var e=t.f,r=(e&Sr)!==0;if(pt!==null&&!dn){var n=It!==null&&(It.f&Wn)!==0;if(!n&&!jn?.includes(t)){var s=pt.deps;if((pt.f&sl)!==0)t.rv<Bs&&(t.rv=Bs,qr===null&&s!==null&&s[Xr]===t?Xr++:qr===null?qr=[t]:qr.push(t));else{(pt.deps??=[]).push(t);var i=t.reactions;i===null?t.reactions=[pt]:i.includes(pt)||i.push(pt)}}}if(Es&&ms.has(t))return ms.get(t);if(r){var o=t;if(Es){var a=o.v;return((o.f&_r)===0&&o.reactions!==null||xd(o))&&(a=Hl(o)),ms.set(o,a),a}var c=(o.f&un)===0&&!dn&&pt!==null&&(Us||(pt.f&un)!==0),l=o.deps===null;Vi(o)&&(c&&(o.f|=un),ed(o)),c&&!l&&Ed(o)}if(hn?.has(t))return hn.get(t);if((t.f&ws)!==0)throw t.v;return t.v}function Ed(t){if(t.deps!==null){t.f|=un;for(const e of t.deps)(e.reactions??=[]).push(t),(e.f&Sr)!==0&&(e.f&un)===0&&Ed(e)}}function xd(t){if(t.v===br)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(ms.has(e)||(e.f&Sr)!==0&&xd(e))return!0;return!1}function Xs(t){var e=dn;try{return dn=!0,t()}finally{dn=e}}function _d(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if(Os in t)cl(t);else if(!Array.isArray(t))for(let e in t){const r=t[e];typeof r=="object"&&r&&Os in r&&cl(r)}}}function cl(t,e=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!e.has(t)){e.add(t),t instanceof Date&&t.getTime();for(let n in t)try{cl(t[n],e)}catch{}const r=Uh(t);if(r!==Object.prototype&&r!==Array.prototype&&r!==Map.prototype&&r!==Set.prototype&&r!==Date.prototype){const n=ig(r);for(let s in n){const i=n[s].get;if(i)try{i.call(t)}catch{}}}}}const ow=["touchstart","touchmove"];function aw(t){return ow.includes(t)}const Id=new Set,ll=new Set;function Yl(t){for(var e=0;e<t.length;e++)Id.add(t[e]);for(var r of ll)r(t)}let zu=null;function Vo(t){var e=this,r=e.ownerDocument,n=t.type,s=t.composedPath?.()||[],i=s[0]||t.target;zu=t;var o=0,a=zu===t&&t.__root;if(a){var c=s.indexOf(a);if(c!==-1&&(e===document||e===window)){t.__root=e;return}var l=s.indexOf(e);if(l===-1)return;c<=l&&(o=c)}if(i=s[o]||t.target,i!==e){sg(t,"currentTarget",{configurable:!0,get(){return i||r}});var g=pt,m=It;jr(null),An(null);try{for(var I,_=[];i!==null;){var b=i.assignedSlot||i.parentNode||i.host||null;try{var v=i["__"+n];v!=null&&(!i.disabled||t.target===i)&&v.call(i,t)}catch(S){I?_.push(S):I=S}if(t.cancelBubble||b===e||b===null)break;i=b}if(I){for(let S of _)queueMicrotask(()=>{throw S});throw I}}finally{t.__root=e,delete t.currentTarget,jr(g),An(m)}}}function cw(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function ul(t,e){var r=It;r.nodes===null&&(r.nodes={start:t,end:e,a:null,t:null})}function $a(t,e){var r=(e&Bg)!==0,n=(e&Tg)!==0,s,i=!t.startsWith("<!>");return()=>{s===void 0&&(s=cw(i?t:"<!>"+t),r||(s=pa(s)));var o=n||nd?document.importNode(s,!0):s.cloneNode(!0);if(r){var a=pa(o),c=o.lastChild;ul(a,c)}else ul(o,o);return o}}function lc(){var t=document.createDocumentFragment(),e=document.createComment(""),r=js();return t.append(e,r),ul(e,r),t}function Fs(t,e){t!==null&&t.before(e)}function ai(t,e){var r=e==null?"":typeof e=="object"?e+"":e;r!==(t.__t??=t.nodeValue)&&(t.__t=r,t.nodeValue=r+"")}function lw(t,e){return uw(t,e)}const ci=new Map;function uw(t,{target:e,anchor:r,props:n={},events:s,context:i,intro:o=!0}){jg();var a=new Set,c=m=>{for(var I=0;I<m.length;I++){var _=m[I];if(!a.has(_)){a.add(_);var b=aw(_);e.addEventListener(_,Vo,{passive:b});var v=ci.get(_);v===void 0?(document.addEventListener(_,Vo,{passive:b}),ci.set(_,1)):ci.set(_,v+1)}}};c(Oa(Id)),ll.add(c);var l=void 0,g=Yg(()=>{var m=r??e.appendChild(js());return Fg(m,{pending:()=>{}},I=>{if(i){Io({});var _=Dt;_.c=i}s&&(n.$$events=s),l=t(I,n)||{},i&&So()}),()=>{for(var I of a){e.removeEventListener(I,Vo);var _=ci.get(I);--_===0?(document.removeEventListener(I,Vo),ci.delete(I)):ci.set(I,_)}ll.delete(c),m!==r&&m.parentNode?.removeChild(m)}});return fw.set(l,g),l}let fw=new WeakMap;class Sd{anchor;#e=new Map;#r=new Map;#t=new Map;#n=new Set;#o=!0;constructor(e,r=!0){this.anchor=e,this.#o=r}#i=()=>{var e=jt;if(this.#e.has(e)){var r=this.#e.get(e),n=this.#r.get(r);if(n)Zl(n),this.#n.delete(r);else{var s=this.#t.get(r);s&&(this.#r.set(r,s.effect),this.#t.delete(r),s.fragment.lastChild.remove(),this.anchor.before(s.fragment),n=s.effect)}for(const[i,o]of this.#e){if(this.#e.delete(i),i===e)break;const a=this.#t.get(o);a&&(Gr(a.effect),this.#t.delete(o))}for(const[i,o]of this.#r){if(i===r||this.#n.has(i))continue;const a=()=>{if(Array.from(this.#e.values()).includes(i)){var l=document.createDocumentFragment();gd(o,l),l.append(js()),this.#t.set(i,{effect:o,fragment:l})}else Gr(o);this.#n.delete(i),this.#r.delete(i)};this.#o||!n?(this.#n.add(i),Ms(o,a,!1)):a()}}};#s=e=>{this.#e.delete(e);const r=Array.from(this.#e.values());for(const[n,s]of this.#t)r.includes(n)||(Gr(s.effect),this.#t.delete(n))};ensure(e,r){var n=jt,s=od();if(r&&!this.#r.has(e)&&!this.#t.has(e))if(s){var i=document.createDocumentFragment(),o=js();i.append(o),this.#t.set(e,{effect:ln(()=>r(o)),fragment:i})}else this.#r.set(e,ln(()=>r(this.anchor)));if(this.#e.set(n,e),s){for(const[a,c]of this.#r)a===e?n.skipped_effects.delete(c):n.skipped_effects.add(c);for(const[a,c]of this.#t)a===e?n.skipped_effects.delete(c.effect):n.skipped_effects.add(c.effect);n.oncommit(this.#i),n.ondiscard(this.#s)}else this.#i()}}function hw(t,e,r=!1){var n=new Sd(t),s=r?Vs:0;function i(o,a){n.ensure(o,a)}Fa(()=>{var o=!1;e((a,c=!0)=>{o=!0,i(c,a)}),o||i(!1,null)},s)}function dw(t,e,r){for(var n=[],s=e.length,i,o=e.length,a=0;a<s;a++){let m=e[a];Ms(m,()=>{if(i){if(i.pending.delete(m),i.done.add(m),i.pending.size===0){var I=t.outrogroups;fl(Oa(i.done)),I.delete(i),I.size===0&&(t.outrogroups=null)}}else o-=1},!1)}if(o===0){var c=n.length===0&&r!==null;if(c){var l=r,g=l.parentNode;Hg(g),g.append(l),t.items.clear()}fl(e,!c)}else i={pending:new Set(e),done:new Set},(t.outrogroups??=new Set).add(i)}function fl(t,e=!0){for(var r=0;r<t.length;r++)Gr(t[r],e)}var Vu;function pw(t,e,r,n,s,i=null){var o=t,a=new Map,c=null,l=jl(()=>{var v=r();return Na(v)?v:v==null?[]:Oa(v)}),g,m=!0;function I(){b.fallback=c,gw(b,g,o,e,n),c!==null&&(g.length===0?(c.f&ds)===0?Zl(c):(c.f^=ds,oo(c,null,o)):Ms(c,()=>{c=null}))}var _=Fa(()=>{g=ut(l);for(var v=g.length,S=new Set,O=jt,$=od(),k=0;k<v;k+=1){var Z=g[k],q=n(Z,k),J=m?null:a.get(q);J?(J.v&&Pi(J.v,Z),J.i&&Pi(J.i,k),$&&O.skipped_effects.delete(J.e)):(J=ww(a,m?o:Vu??=js(),Z,q,k,s,e,r),m||(J.e.f|=ds),a.set(q,J)),S.add(q)}if(v===0&&i&&!c&&(m?c=ln(()=>i(o)):(c=ln(()=>i(Vu??=js())),c.f|=ds)),!m)if($){for(const[se,oe]of a)S.has(se)||O.skipped_effects.add(oe.e);O.oncommit(I),O.ondiscard(()=>{})}else I();ut(l)}),b={effect:_,items:a,outrogroups:null,fallback:c};m=!1}function gw(t,e,r,n,s){var i=e.length,o=t.items,a=t.effect.first,c,l=null,g=[],m=[],I,_,b,v;for(v=0;v<i;v+=1){if(I=e[v],_=s(I,v),b=o.get(_).e,t.outrogroups!==null)for(const oe of t.outrogroups)oe.pending.delete(b),oe.done.delete(b);if((b.f&ds)!==0)if(b.f^=ds,b===a)oo(b,null,r);else{var S=l?l.next:a;b===t.effect.last&&(t.effect.last=b.prev),b.prev&&(b.prev.next=b.next),b.next&&(b.next.prev=b.prev),Qn(t,l,b),Qn(t,b,S),oo(b,S,r),l=b,g=[],m=[],a=l.next;continue}if((b.f&rn)!==0&&Zl(b),b!==a){if(c!==void 0&&c.has(b)){if(g.length<m.length){var O=m[0],$;l=O.prev;var k=g[0],Z=g[g.length-1];for($=0;$<g.length;$+=1)oo(g[$],O,r);for($=0;$<m.length;$+=1)c.delete(m[$]);Qn(t,k.prev,Z.next),Qn(t,l,k),Qn(t,Z,O),a=O,l=Z,v-=1,g=[],m=[]}else c.delete(b),oo(b,a,r),Qn(t,b.prev,b.next),Qn(t,b,l===null?t.effect.first:l.next),Qn(t,l,b),l=b;continue}for(g=[],m=[];a!==null&&a!==b;)(c??=new Set).add(a),m.push(a),a=a.next;if(a===null)continue}(b.f&ds)===0&&g.push(b),l=b,a=b.next}if(t.outrogroups!==null){for(const oe of t.outrogroups)oe.pending.size===0&&(fl(Oa(oe.done)),t.outrogroups?.delete(oe));t.outrogroups.size===0&&(t.outrogroups=null)}if(a!==null||c!==void 0){var q=[];if(c!==void 0)for(b of c)(b.f&rn)===0&&q.push(b);for(;a!==null;)(a.f&rn)===0&&a!==t.fallback&&q.push(a),a=a.next;var J=q.length;if(J>0){var se=null;dw(t,q,se)}}}function ww(t,e,r,n,s,i,o,a){var c=(o&vg)!==0?(o&xg)===0?ia(r,!1,!1):Ws(r):null,l=(o&Eg)!==0?Ws(s):null;return{v:c,i:l,e:ln(()=>(i(e,c??r,l??s,a),()=>{t.delete(n)}))}}function oo(t,e,r){if(t.nodes)for(var n=t.nodes.start,s=t.nodes.end,i=e&&(e.f&ds)===0?e.nodes.start:r;n!==null;){var o=Ro(n);if(i.before(n),n===s)return;n=o}}function Qn(t,e,r){e===null?t.effect.first=r:e.next=r,r===null?t.effect.last=e:r.prev=e}function qu(t,e,r){var n=new Sd(t);Fa(()=>{var s=e()??null;n.ensure(s,s&&(i=>r(i,s)))},Vs)}function Xl(t=!1){const e=Dt,r=e.l.u;if(!r)return;let n=()=>_d(e.s);if(t){let s=0,i={};const o=La(()=>{let a=!1;const c=e.s;for(const l in c)c[l]!==i[l]&&(i[l]=c[l],a=!0);return a&&s++,s});n=()=>ut(o)}r.b.length&&Zg(()=>{Wu(e,n),ha(r.b)}),al(()=>{const s=Xs(()=>r.m.map(cg));return()=>{for(const i of s)typeof i=="function"&&i()}}),r.a.length&&al(()=>{Wu(e,n),ha(r.a)})}function Wu(t,e){if(t.l.s)for(const r of t.l.s)ut(r);e()}function ju(t,e){var r=t.$$events?.[e.type],n=Na(r)?r.slice():r==null?[]:[r];for(var s of n)s.call(this,e)}function mw(t,e,r){if(t==null)return e(void 0),r&&r(void 0),_i;const n=Xs(()=>t.subscribe(e,r));return n.unsubscribe?()=>n.unsubscribe():n}const li=[];function Ad(t,e){return{subscribe:Rd(t,e).subscribe}}function Rd(t,e=_i){let r=null;const n=new Set;function s(a){if(qh(t,a)&&(t=a,r)){const c=!li.length;for(const l of n)l[1](),li.push(l,t);if(c){for(let l=0;l<li.length;l+=2)li[l][0](li[l+1]);li.length=0}}}function i(a){s(a(t))}function o(a,c=_i){const l=[a,c];return n.add(l),n.size===1&&(r=e(s,i)||_i),a(t),()=>{n.delete(l),n.size===0&&r&&(r(),r=null)}}return{set:s,update:i,subscribe:o}}function Bd(t,e,r){const n=!Array.isArray(t),s=n?[t]:t;if(!s.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const i=e.length<2;return Ad(r,(o,a)=>{let c=!1;const l=[];let g=0,m=_i;const I=()=>{if(g)return;m();const b=e(n?l[0]:l,o,a);i?o(b):m=typeof b=="function"?b:_i},_=s.map((b,v)=>mw(b,S=>{l[v]=S,g&=~(1<<v),c&&I()},()=>{g|=1<<v}));return c=!0,I(),function(){ha(_),m(),c=!1}})}let qo=!1;function yw(t){var e=qo;try{return qo=!1,[t(),qo]}finally{qo=e}}const bw={get(t,e){let r=t.props.length;for(;r--;){let n=t.props[r];if(eo(n)&&(n=n()),typeof n=="object"&&n!==null&&e in n)return n[e]}},set(t,e,r){let n=t.props.length;for(;n--;){let s=t.props[n];eo(s)&&(s=s());const i=gs(s,e);if(i&&i.set)return i.set(r),!0}return!1},getOwnPropertyDescriptor(t,e){let r=t.props.length;for(;r--;){let n=t.props[r];if(eo(n)&&(n=n()),typeof n=="object"&&n!==null&&e in n){const s=gs(n,e);return s&&!s.configurable&&(s.configurable=!0),s}}},has(t,e){if(e===Os||e===zh)return!1;for(let r of t.props)if(eo(r)&&(r=r()),r!=null&&e in r)return!0;return!1},ownKeys(t){const e=[];for(let r of t.props)if(eo(r)&&(r=r()),!!r){for(const n in r)e.includes(n)||e.push(n);for(const n of Object.getOwnPropertySymbols(r))e.includes(n)||e.push(n)}return e}};function Hu(...t){return new Proxy({props:t},bw)}function uc(t,e,r,n){var s=!zi||(r&Ig)!==0,i=(r&Ag)!==0,o=(r&Rg)!==0,a=n,c=!0,l=()=>(c&&(c=!1,a=o?Xs(n):n),a),g;if(i){var m=Os in t||zh in t;g=gs(t,e)?.set??(m&&e in t?k=>t[e]=k:void 0)}var I,_=!1;i?[I,_]=yw(()=>t[e]):I=t[e],I===void 0&&n!==void 0&&(I=l(),g&&(s&&gg(),g(I)));var b;if(s?b=()=>{var k=t[e];return k===void 0?l():(c=!0,k)}:b=()=>{var k=t[e];return k!==void 0&&(a=void 0),k===void 0?a:k},s&&(r&Sg)===0)return b;if(g){var v=t.$$legacy;return(function(k,Z){return arguments.length>0?((!s||!Z||v||_)&&g(Z?b():k),k):b()})}var S=!1,O=((r&_g)!==0?La:jl)(()=>(S=!1,b()));i&&ut(O);var $=It;return(function(k,Z){if(arguments.length>0){const q=Z?ut(O):s&&i?Rs(k):k;return or(O,q),S=!0,a!==void 0&&(a=q),k}return Es&&S||($.f&Wn)!==0?O.v:ut(O)})}function Td(t){Dt===null&&Ma(),zi&&Dt.l!==null?Pd(Dt).m.push(t):al(()=>{const e=Xs(t);if(typeof e=="function")return e})}function vw(t){Dt===null&&Ma(),Td(()=>()=>Xs(t))}function Ew(t,e,{bubbles:r=!1,cancelable:n=!1}={}){return new CustomEvent(t,{detail:e,bubbles:r,cancelable:n})}function xw(){const t=Dt;return t===null&&Ma(),(e,r,n)=>{const s=t.s.$$events?.[e];if(s){const i=Na(s)?s.slice():[s],o=Ew(e,r,n);for(const a of i)a.call(t.x,o);return!o.defaultPrevented}return!0}}function _w(t){Dt===null&&Ma(),Dt.l===null&&pg(),Pd(Dt).a.push(t)}function Pd(t){var e=t.l;return e.u??={a:[],b:[],m:[]}}const Iw="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(Iw);Dg();function Sw(t,e){if(t instanceof RegExp)return{keys:!1,pattern:t};var r,n,s,i,o=[],a="",c=t.split("/");for(c[0]||c.shift();s=c.shift();)r=s[0],r==="*"?(o.push("wild"),a+="/(.*)"):r===":"?(n=s.indexOf("?",1),i=s.indexOf(".",1),o.push(s.substring(1,~n?n:~i?i:s.length)),a+=~n&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(a+=(~n?"?":"")+"\\"+s.substring(i))):a+="/"+s;return{keys:o,pattern:new RegExp("^"+a+"/?$","i")}}function Gu(){const t=window.location.href.indexOf("#/");let e=t>-1?window.location.href.substr(t+1):"/";const r=e.indexOf("?");let n="";return r>-1&&(n=e.substr(r+1),e=e.substr(0,r)),{location:e,querystring:n}}const Ql=Ad(null,function(e){e(Gu());const r=()=>{e(Gu())};return window.addEventListener("hashchange",r,!1),function(){window.removeEventListener("hashchange",r,!1)}});Bd(Ql,t=>t.location);Bd(Ql,t=>t.querystring);const Ju=Rd(void 0);async function wo(t){if(!t||t.length<1||t.charAt(0)!="/"&&t.indexOf("#/")!==0)throw Error("Invalid parameter location");await vd(),history.replaceState({...history.state,__svelte_spa_router_scrollX:window.scrollX,__svelte_spa_router_scrollY:window.scrollY},void 0),window.location.hash=(t.charAt(0)=="#"?"":"#")+t}function Aw(t){t?window.scrollTo(t.__svelte_spa_router_scrollX,t.__svelte_spa_router_scrollY):window.scrollTo(0,0)}function Rw(t,e){Io(e,!1);let r=uc(e,"routes",24,()=>({})),n=uc(e,"prefix",8,""),s=uc(e,"restoreScrollState",8,!1);class i{constructor(J,se){if(!se||typeof se!="function"&&(typeof se!="object"||se._sveltesparouter!==!0))throw Error("Invalid component object");if(!J||typeof J=="string"&&(J.length<1||J.charAt(0)!="/"&&J.charAt(0)!="*")||typeof J=="object"&&!(J instanceof RegExp))throw Error('Invalid value for "path" argument - strings must start with / or *');const{pattern:oe,keys:V}=Sw(J);this.path=J,typeof se=="object"&&se._sveltesparouter===!0?(this.component=se.component,this.conditions=se.conditions||[],this.userData=se.userData,this.props=se.props||{}):(this.component=()=>Promise.resolve(se),this.conditions=[],this.props={}),this._pattern=oe,this._keys=V}match(J){if(n()){if(typeof n()=="string")if(J.startsWith(n()))J=J.substr(n().length)||"/";else return null;else if(n()instanceof RegExp){const W=J.match(n());if(W&&W[0])J=J.substr(W[0].length)||"/";else return null}}const se=this._pattern.exec(J);if(se===null)return null;if(this._keys===!1)return se;const oe={};let V=0;for(;V<this._keys.length;){try{oe[this._keys[V]]=decodeURIComponent(se[V+1]||"")||null}catch{oe[this._keys[V]]=null}V++}return oe}async checkConditions(J){for(let se=0;se<this.conditions.length;se++)if(!await this.conditions[se](J))return!1;return!0}}const o=[];r()instanceof Map?r().forEach((q,J)=>{o.push(new i(J,q))}):Object.keys(r()).forEach(q=>{o.push(new i(q,r()[q]))});let a=ia(null),c=ia(null),l=ia({});const g=xw();async function m(q,J){await vd(),g(q,J)}let I=null,_=null;s()&&(_=q=>{q.state&&(q.state.__svelte_spa_router_scrollY||q.state.__svelte_spa_router_scrollX)?I=q.state:I=null},window.addEventListener("popstate",_),_w(()=>{Aw(I)}));let b=null,v=null;const S=Ql.subscribe(async q=>{b=q;let J=0;for(;J<o.length;){const se=o[J].match(q.location);if(!se){J++;continue}const oe={route:o[J].path,location:q.location,querystring:q.querystring,userData:o[J].userData,params:se&&typeof se=="object"&&Object.keys(se).length?se:null};if(!await o[J].checkConditions(oe)){or(a,null),v=null,m("conditionsFailed",oe);return}m("routeLoading",Object.assign({},oe));const V=o[J].component;if(v!=V){V.loading?(or(a,V.loading),v=V,or(c,V.loadingParams),or(l,{}),m("routeLoaded",Object.assign({},oe,{component:ut(a),name:ut(a).name,params:ut(c)}))):(or(a,null),v=null);const W=await V();if(q!=b)return;or(a,W&&W.default||W),v=V}se&&typeof se=="object"&&Object.keys(se).length?or(c,se):or(c,null),or(l,o[J].props),m("routeLoaded",Object.assign({},oe,{component:ut(a),name:ut(a).name,params:ut(c)})).then(()=>{Ju.set(ut(c))});return}or(a,null),v=null,Ju.set(void 0)});vw(()=>{S(),_&&window.removeEventListener("popstate",_)}),Xg(()=>_d(s()),()=>{history.scrollRestoration=s()?"manual":"auto"}),Qg(),Xl();var O=lc(),$=Ii(O);{var k=q=>{var J=lc(),se=Ii(J);qu(se,()=>ut(a),(oe,V)=>{V(oe,Hu({get params(){return ut(c)}},()=>ut(l),{$$events:{routeEvent(W){ju.call(this,e,W)}}}))}),Fs(q,J)},Z=q=>{var J=lc(),se=Ii(J);qu(se,()=>ut(a),(oe,V)=>{V(oe,Hu(()=>ut(l),{$$events:{routeEvent(W){ju.call(this,e,W)}}}))}),Fs(q,J)};hw($,q=>{ut(c)?q(k):q(Z,!1)})}Fs(t,O),So()}function Cd(t,e){return function(){return t.apply(e,arguments)}}const{toString:Bw}=Object.prototype,{getPrototypeOf:eu}=Object,{iterator:Ka,toStringTag:Dd}=Symbol,za=(t=>e=>{const r=Bw.call(e);return t[r]||(t[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),mn=t=>(t=t.toLowerCase(),e=>za(e)===t),Va=t=>e=>typeof e===t,{isArray:qi}=Array,Di=Va("undefined");function Bo(t){return t!==null&&!Di(t)&&t.constructor!==null&&!Di(t.constructor)&&Jr(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const kd=mn("ArrayBuffer");function Tw(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&kd(t.buffer),e}const Pw=Va("string"),Jr=Va("function"),Nd=Va("number"),To=t=>t!==null&&typeof t=="object",Cw=t=>t===!0||t===!1,oa=t=>{if(za(t)!=="object")return!1;const e=eu(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Dd in t)&&!(Ka in t)},Dw=t=>{if(!To(t)||Bo(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},kw=mn("Date"),Nw=mn("File"),Ow=mn("Blob"),Mw=mn("FileList"),Uw=t=>To(t)&&Jr(t.pipe),Lw=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||Jr(t.append)&&((e=za(t))==="formdata"||e==="object"&&Jr(t.toString)&&t.toString()==="[object FormData]"))},Fw=mn("URLSearchParams"),[$w,Kw,zw,Vw]=["ReadableStream","Request","Response","Headers"].map(mn),qw=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Po(t,e,{allOwnKeys:r=!1}={}){if(t===null||typeof t>"u")return;let n,s;if(typeof t!="object"&&(t=[t]),qi(t))for(n=0,s=t.length;n<s;n++)e.call(null,t[n],n,t);else{if(Bo(t))return;const i=r?Object.getOwnPropertyNames(t):Object.keys(t),o=i.length;let a;for(n=0;n<o;n++)a=i[n],e.call(null,t[a],a,t)}}function Od(t,e){if(Bo(t))return null;e=e.toLowerCase();const r=Object.keys(t);let n=r.length,s;for(;n-- >0;)if(s=r[n],e===s.toLowerCase())return s;return null}const Ts=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Md=t=>!Di(t)&&t!==Ts;function hl(){const{caseless:t,skipUndefined:e}=Md(this)&&this||{},r={},n=(s,i)=>{const o=t&&Od(r,i)||i;oa(r[o])&&oa(s)?r[o]=hl(r[o],s):oa(s)?r[o]=hl({},s):qi(s)?r[o]=s.slice():(!e||!Di(s))&&(r[o]=s)};for(let s=0,i=arguments.length;s<i;s++)arguments[s]&&Po(arguments[s],n);return r}const Ww=(t,e,r,{allOwnKeys:n}={})=>(Po(e,(s,i)=>{r&&Jr(s)?t[i]=Cd(s,r):t[i]=s},{allOwnKeys:n}),t),jw=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),Hw=(t,e,r,n)=>{t.prototype=Object.create(e.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),r&&Object.assign(t.prototype,r)},Gw=(t,e,r,n)=>{let s,i,o;const a={};if(e=e||{},t==null)return e;do{for(s=Object.getOwnPropertyNames(t),i=s.length;i-- >0;)o=s[i],(!n||n(o,t,e))&&!a[o]&&(e[o]=t[o],a[o]=!0);t=r!==!1&&eu(t)}while(t&&(!r||r(t,e))&&t!==Object.prototype);return e},Jw=(t,e,r)=>{t=String(t),(r===void 0||r>t.length)&&(r=t.length),r-=e.length;const n=t.indexOf(e,r);return n!==-1&&n===r},Zw=t=>{if(!t)return null;if(qi(t))return t;let e=t.length;if(!Nd(e))return null;const r=new Array(e);for(;e-- >0;)r[e]=t[e];return r},Yw=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&eu(Uint8Array)),Xw=(t,e)=>{const n=(t&&t[Ka]).call(t);let s;for(;(s=n.next())&&!s.done;){const i=s.value;e.call(t,i[0],i[1])}},Qw=(t,e)=>{let r;const n=[];for(;(r=t.exec(e))!==null;)n.push(r);return n},em=mn("HTMLFormElement"),tm=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,s){return n.toUpperCase()+s}),Zu=(({hasOwnProperty:t})=>(e,r)=>t.call(e,r))(Object.prototype),rm=mn("RegExp"),Ud=(t,e)=>{const r=Object.getOwnPropertyDescriptors(t),n={};Po(r,(s,i)=>{let o;(o=e(s,i,t))!==!1&&(n[i]=o||s)}),Object.defineProperties(t,n)},nm=t=>{Ud(t,(e,r)=>{if(Jr(t)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=t[r];if(Jr(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},sm=(t,e)=>{const r={},n=s=>{s.forEach(i=>{r[i]=!0})};return qi(t)?n(t):n(String(t).split(e)),r},im=()=>{},om=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function am(t){return!!(t&&Jr(t.append)&&t[Dd]==="FormData"&&t[Ka])}const cm=t=>{const e=new Array(10),r=(n,s)=>{if(To(n)){if(e.indexOf(n)>=0)return;if(Bo(n))return n;if(!("toJSON"in n)){e[s]=n;const i=qi(n)?[]:{};return Po(n,(o,a)=>{const c=r(o,s+1);!Di(c)&&(i[a]=c)}),e[s]=void 0,i}}return n};return r(t,0)},lm=mn("AsyncFunction"),um=t=>t&&(To(t)||Jr(t))&&Jr(t.then)&&Jr(t.catch),Ld=((t,e)=>t?setImmediate:e?((r,n)=>(Ts.addEventListener("message",({source:s,data:i})=>{s===Ts&&i===r&&n.length&&n.shift()()},!1),s=>{n.push(s),Ts.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",Jr(Ts.postMessage)),fm=typeof queueMicrotask<"u"?queueMicrotask.bind(Ts):typeof process<"u"&&process.nextTick||Ld,hm=t=>t!=null&&Jr(t[Ka]),ue={isArray:qi,isArrayBuffer:kd,isBuffer:Bo,isFormData:Lw,isArrayBufferView:Tw,isString:Pw,isNumber:Nd,isBoolean:Cw,isObject:To,isPlainObject:oa,isEmptyObject:Dw,isReadableStream:$w,isRequest:Kw,isResponse:zw,isHeaders:Vw,isUndefined:Di,isDate:kw,isFile:Nw,isBlob:Ow,isRegExp:rm,isFunction:Jr,isStream:Uw,isURLSearchParams:Fw,isTypedArray:Yw,isFileList:Mw,forEach:Po,merge:hl,extend:Ww,trim:qw,stripBOM:jw,inherits:Hw,toFlatObject:Gw,kindOf:za,kindOfTest:mn,endsWith:Jw,toArray:Zw,forEachEntry:Xw,matchAll:Qw,isHTMLForm:em,hasOwnProperty:Zu,hasOwnProp:Zu,reduceDescriptors:Ud,freezeMethods:nm,toObjectSet:sm,toCamelCase:tm,noop:im,toFiniteNumber:om,findKey:Od,global:Ts,isContextDefined:Md,isSpecCompliantForm:am,toJSONObject:cm,isAsyncFn:lm,isThenable:um,setImmediate:Ld,asap:fm,isIterable:hm};function rt(t,e,r,n,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),r&&(this.config=r),n&&(this.request=n),s&&(this.response=s,this.status=s.status?s.status:null)}ue.inherits(rt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ue.toJSONObject(this.config),code:this.code,status:this.status}}});const Fd=rt.prototype,$d={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{$d[t]={value:t}});Object.defineProperties(rt,$d);Object.defineProperty(Fd,"isAxiosError",{value:!0});rt.from=(t,e,r,n,s,i)=>{const o=Object.create(Fd);ue.toFlatObject(t,o,function(g){return g!==Error.prototype},l=>l!=="isAxiosError");const a=t&&t.message?t.message:"Error",c=e==null&&t?t.code:e;return rt.call(o,a,c,r,n,s),t&&o.cause==null&&Object.defineProperty(o,"cause",{value:t,configurable:!0}),o.name=t&&t.name||"Error",i&&Object.assign(o,i),o};const dm=null;function dl(t){return ue.isPlainObject(t)||ue.isArray(t)}function Kd(t){return ue.endsWith(t,"[]")?t.slice(0,-2):t}function Yu(t,e,r){return t?t.concat(e).map(function(s,i){return s=Kd(s),!r&&i?"["+s+"]":s}).join(r?".":""):e}function pm(t){return ue.isArray(t)&&!t.some(dl)}const gm=ue.toFlatObject(ue,{},null,function(e){return/^is[A-Z]/.test(e)});function qa(t,e,r){if(!ue.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,r=ue.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(v,S){return!ue.isUndefined(S[v])});const n=r.metaTokens,s=r.visitor||g,i=r.dots,o=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&ue.isSpecCompliantForm(e);if(!ue.isFunction(s))throw new TypeError("visitor must be a function");function l(b){if(b===null)return"";if(ue.isDate(b))return b.toISOString();if(ue.isBoolean(b))return b.toString();if(!c&&ue.isBlob(b))throw new rt("Blob is not supported. Use a Buffer instead.");return ue.isArrayBuffer(b)||ue.isTypedArray(b)?c&&typeof Blob=="function"?new Blob([b]):Buffer.from(b):b}function g(b,v,S){let O=b;if(b&&!S&&typeof b=="object"){if(ue.endsWith(v,"{}"))v=n?v:v.slice(0,-2),b=JSON.stringify(b);else if(ue.isArray(b)&&pm(b)||(ue.isFileList(b)||ue.endsWith(v,"[]"))&&(O=ue.toArray(b)))return v=Kd(v),O.forEach(function(k,Z){!(ue.isUndefined(k)||k===null)&&e.append(o===!0?Yu([v],Z,i):o===null?v:v+"[]",l(k))}),!1}return dl(b)?!0:(e.append(Yu(S,v,i),l(b)),!1)}const m=[],I=Object.assign(gm,{defaultVisitor:g,convertValue:l,isVisitable:dl});function _(b,v){if(!ue.isUndefined(b)){if(m.indexOf(b)!==-1)throw Error("Circular reference detected in "+v.join("."));m.push(b),ue.forEach(b,function(O,$){(!(ue.isUndefined(O)||O===null)&&s.call(e,O,ue.isString($)?$.trim():$,v,I))===!0&&_(O,v?v.concat($):[$])}),m.pop()}}if(!ue.isObject(t))throw new TypeError("data must be an object");return _(t),e}function Xu(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function tu(t,e){this._pairs=[],t&&qa(t,this,e)}const zd=tu.prototype;zd.append=function(e,r){this._pairs.push([e,r])};zd.toString=function(e){const r=e?function(n){return e.call(this,n,Xu)}:Xu;return this._pairs.map(function(s){return r(s[0])+"="+r(s[1])},"").join("&")};function wm(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Vd(t,e,r){if(!e)return t;const n=r&&r.encode||wm;ue.isFunction(r)&&(r={serialize:r});const s=r&&r.serialize;let i;if(s?i=s(e,r):i=ue.isURLSearchParams(e)?e.toString():new tu(e,r).toString(n),i){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+i}return t}class Qu{constructor(){this.handlers=[]}use(e,r,n){return this.handlers.push({fulfilled:e,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){ue.forEach(this.handlers,function(n){n!==null&&e(n)})}}const qd={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},mm=typeof URLSearchParams<"u"?URLSearchParams:tu,ym=typeof FormData<"u"?FormData:null,bm=typeof Blob<"u"?Blob:null,vm={isBrowser:!0,classes:{URLSearchParams:mm,FormData:ym,Blob:bm},protocols:["http","https","file","blob","url","data"]},ru=typeof window<"u"&&typeof document<"u",pl=typeof navigator=="object"&&navigator||void 0,Em=ru&&(!pl||["ReactNative","NativeScript","NS"].indexOf(pl.product)<0),xm=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",_m=ru&&window.location.href||"http://localhost",Im=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ru,hasStandardBrowserEnv:Em,hasStandardBrowserWebWorkerEnv:xm,navigator:pl,origin:_m},Symbol.toStringTag,{value:"Module"})),Mr={...Im,...vm};function Sm(t,e){return qa(t,new Mr.classes.URLSearchParams,{visitor:function(r,n,s,i){return Mr.isNode&&ue.isBuffer(r)?(this.append(n,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...e})}function Am(t){return ue.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function Rm(t){const e={},r=Object.keys(t);let n;const s=r.length;let i;for(n=0;n<s;n++)i=r[n],e[i]=t[i];return e}function Wd(t){function e(r,n,s,i){let o=r[i++];if(o==="__proto__")return!0;const a=Number.isFinite(+o),c=i>=r.length;return o=!o&&ue.isArray(s)?s.length:o,c?(ue.hasOwnProp(s,o)?s[o]=[s[o],n]:s[o]=n,!a):((!s[o]||!ue.isObject(s[o]))&&(s[o]=[]),e(r,n,s[o],i)&&ue.isArray(s[o])&&(s[o]=Rm(s[o])),!a)}if(ue.isFormData(t)&&ue.isFunction(t.entries)){const r={};return ue.forEachEntry(t,(n,s)=>{e(Am(n),s,r,0)}),r}return null}function Bm(t,e,r){if(ue.isString(t))try{return(e||JSON.parse)(t),ue.trim(t)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(t)}const Co={transitional:qd,adapter:["xhr","http","fetch"],transformRequest:[function(e,r){const n=r.getContentType()||"",s=n.indexOf("application/json")>-1,i=ue.isObject(e);if(i&&ue.isHTMLForm(e)&&(e=new FormData(e)),ue.isFormData(e))return s?JSON.stringify(Wd(e)):e;if(ue.isArrayBuffer(e)||ue.isBuffer(e)||ue.isStream(e)||ue.isFile(e)||ue.isBlob(e)||ue.isReadableStream(e))return e;if(ue.isArrayBufferView(e))return e.buffer;if(ue.isURLSearchParams(e))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return Sm(e,this.formSerializer).toString();if((a=ue.isFileList(e))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return qa(a?{"files[]":e}:e,c&&new c,this.formSerializer)}}return i||s?(r.setContentType("application/json",!1),Bm(e)):e}],transformResponse:[function(e){const r=this.transitional||Co.transitional,n=r&&r.forcedJSONParsing,s=this.responseType==="json";if(ue.isResponse(e)||ue.isReadableStream(e))return e;if(e&&ue.isString(e)&&(n&&!this.responseType||s)){const o=!(r&&r.silentJSONParsing)&&s;try{return JSON.parse(e,this.parseReviver)}catch(a){if(o)throw a.name==="SyntaxError"?rt.from(a,rt.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Mr.classes.FormData,Blob:Mr.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ue.forEach(["delete","get","head","post","put","patch"],t=>{Co.headers[t]={}});const Tm=ue.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Pm=t=>{const e={};let r,n,s;return t&&t.split(`
`).forEach(function(o){s=o.indexOf(":"),r=o.substring(0,s).trim().toLowerCase(),n=o.substring(s+1).trim(),!(!r||e[r]&&Tm[r])&&(r==="set-cookie"?e[r]?e[r].push(n):e[r]=[n]:e[r]=e[r]?e[r]+", "+n:n)}),e},ef=Symbol("internals");function to(t){return t&&String(t).trim().toLowerCase()}function aa(t){return t===!1||t==null?t:ue.isArray(t)?t.map(aa):String(t)}function Cm(t){const e=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(t);)e[n[1]]=n[2];return e}const Dm=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function fc(t,e,r,n,s){if(ue.isFunction(n))return n.call(this,e,r);if(s&&(e=r),!!ue.isString(e)){if(ue.isString(n))return e.indexOf(n)!==-1;if(ue.isRegExp(n))return n.test(e)}}function km(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,r,n)=>r.toUpperCase()+n)}function Nm(t,e){const r=ue.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(t,n+r,{value:function(s,i,o){return this[n].call(this,e,s,i,o)},configurable:!0})})}let Zr=class{constructor(e){e&&this.set(e)}set(e,r,n){const s=this;function i(a,c,l){const g=to(c);if(!g)throw new Error("header name must be a non-empty string");const m=ue.findKey(s,g);(!m||s[m]===void 0||l===!0||l===void 0&&s[m]!==!1)&&(s[m||c]=aa(a))}const o=(a,c)=>ue.forEach(a,(l,g)=>i(l,g,c));if(ue.isPlainObject(e)||e instanceof this.constructor)o(e,r);else if(ue.isString(e)&&(e=e.trim())&&!Dm(e))o(Pm(e),r);else if(ue.isObject(e)&&ue.isIterable(e)){let a={},c,l;for(const g of e){if(!ue.isArray(g))throw TypeError("Object iterator must return a key-value pair");a[l=g[0]]=(c=a[l])?ue.isArray(c)?[...c,g[1]]:[c,g[1]]:g[1]}o(a,r)}else e!=null&&i(r,e,n);return this}get(e,r){if(e=to(e),e){const n=ue.findKey(this,e);if(n){const s=this[n];if(!r)return s;if(r===!0)return Cm(s);if(ue.isFunction(r))return r.call(this,s,n);if(ue.isRegExp(r))return r.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,r){if(e=to(e),e){const n=ue.findKey(this,e);return!!(n&&this[n]!==void 0&&(!r||fc(this,this[n],n,r)))}return!1}delete(e,r){const n=this;let s=!1;function i(o){if(o=to(o),o){const a=ue.findKey(n,o);a&&(!r||fc(n,n[a],a,r))&&(delete n[a],s=!0)}}return ue.isArray(e)?e.forEach(i):i(e),s}clear(e){const r=Object.keys(this);let n=r.length,s=!1;for(;n--;){const i=r[n];(!e||fc(this,this[i],i,e,!0))&&(delete this[i],s=!0)}return s}normalize(e){const r=this,n={};return ue.forEach(this,(s,i)=>{const o=ue.findKey(n,i);if(o){r[o]=aa(s),delete r[i];return}const a=e?km(i):String(i).trim();a!==i&&delete r[i],r[a]=aa(s),n[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const r=Object.create(null);return ue.forEach(this,(n,s)=>{n!=null&&n!==!1&&(r[s]=e&&ue.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,r])=>e+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...r){const n=new this(e);return r.forEach(s=>n.set(s)),n}static accessor(e){const n=(this[ef]=this[ef]={accessors:{}}).accessors,s=this.prototype;function i(o){const a=to(o);n[a]||(Nm(s,o),n[a]=!0)}return ue.isArray(e)?e.forEach(i):i(e),this}};Zr.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ue.reduceDescriptors(Zr.prototype,({value:t},e)=>{let r=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(n){this[r]=n}}});ue.freezeMethods(Zr);function hc(t,e){const r=this||Co,n=e||r,s=Zr.from(n.headers);let i=n.data;return ue.forEach(t,function(a){i=a.call(r,i,s.normalize(),e?e.status:void 0)}),s.normalize(),i}function jd(t){return!!(t&&t.__CANCEL__)}function Wi(t,e,r){rt.call(this,t??"canceled",rt.ERR_CANCELED,e,r),this.name="CanceledError"}ue.inherits(Wi,rt,{__CANCEL__:!0});function Hd(t,e,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?t(r):e(new rt("Request failed with status code "+r.status,[rt.ERR_BAD_REQUEST,rt.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function Om(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function Mm(t,e){t=t||10;const r=new Array(t),n=new Array(t);let s=0,i=0,o;return e=e!==void 0?e:1e3,function(c){const l=Date.now(),g=n[i];o||(o=l),r[s]=c,n[s]=l;let m=i,I=0;for(;m!==s;)I+=r[m++],m=m%t;if(s=(s+1)%t,s===i&&(i=(i+1)%t),l-o<e)return;const _=g&&l-g;return _?Math.round(I*1e3/_):void 0}}function Um(t,e){let r=0,n=1e3/e,s,i;const o=(l,g=Date.now())=>{r=g,s=null,i&&(clearTimeout(i),i=null),t(...l)};return[(...l)=>{const g=Date.now(),m=g-r;m>=n?o(l,g):(s=l,i||(i=setTimeout(()=>{i=null,o(s)},n-m)))},()=>s&&o(s)]}const ma=(t,e,r=3)=>{let n=0;const s=Mm(50,250);return Um(i=>{const o=i.loaded,a=i.lengthComputable?i.total:void 0,c=o-n,l=s(c),g=o<=a;n=o;const m={loaded:o,total:a,progress:a?o/a:void 0,bytes:c,rate:l||void 0,estimated:l&&a&&g?(a-o)/l:void 0,event:i,lengthComputable:a!=null,[e?"download":"upload"]:!0};t(m)},r)},tf=(t,e)=>{const r=t!=null;return[n=>e[0]({lengthComputable:r,total:t,loaded:n}),e[1]]},rf=t=>(...e)=>ue.asap(()=>t(...e)),Lm=Mr.hasStandardBrowserEnv?((t,e)=>r=>(r=new URL(r,Mr.origin),t.protocol===r.protocol&&t.host===r.host&&(e||t.port===r.port)))(new URL(Mr.origin),Mr.navigator&&/(msie|trident)/i.test(Mr.navigator.userAgent)):()=>!0,Fm=Mr.hasStandardBrowserEnv?{write(t,e,r,n,s,i,o){if(typeof document>"u")return;const a=[`${t}=${encodeURIComponent(e)}`];ue.isNumber(r)&&a.push(`expires=${new Date(r).toUTCString()}`),ue.isString(n)&&a.push(`path=${n}`),ue.isString(s)&&a.push(`domain=${s}`),i===!0&&a.push("secure"),ue.isString(o)&&a.push(`SameSite=${o}`),document.cookie=a.join("; ")},read(t){if(typeof document>"u")return null;const e=document.cookie.match(new RegExp("(?:^|; )"+t+"=([^;]*)"));return e?decodeURIComponent(e[1]):null},remove(t){this.write(t,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function $m(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function Km(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function Gd(t,e,r){let n=!$m(e);return t&&(n||r==!1)?Km(t,e):e}const nf=t=>t instanceof Zr?{...t}:t;function Hs(t,e){e=e||{};const r={};function n(l,g,m,I){return ue.isPlainObject(l)&&ue.isPlainObject(g)?ue.merge.call({caseless:I},l,g):ue.isPlainObject(g)?ue.merge({},g):ue.isArray(g)?g.slice():g}function s(l,g,m,I){if(ue.isUndefined(g)){if(!ue.isUndefined(l))return n(void 0,l,m,I)}else return n(l,g,m,I)}function i(l,g){if(!ue.isUndefined(g))return n(void 0,g)}function o(l,g){if(ue.isUndefined(g)){if(!ue.isUndefined(l))return n(void 0,l)}else return n(void 0,g)}function a(l,g,m){if(m in e)return n(l,g);if(m in t)return n(void 0,l)}const c={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(l,g,m)=>s(nf(l),nf(g),m,!0)};return ue.forEach(Object.keys({...t,...e}),function(g){const m=c[g]||s,I=m(t[g],e[g],g);ue.isUndefined(I)&&m!==a||(r[g]=I)}),r}const Jd=t=>{const e=Hs({},t);let{data:r,withXSRFToken:n,xsrfHeaderName:s,xsrfCookieName:i,headers:o,auth:a}=e;if(e.headers=o=Zr.from(o),e.url=Vd(Gd(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),a&&o.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):""))),ue.isFormData(r)){if(Mr.hasStandardBrowserEnv||Mr.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(ue.isFunction(r.getHeaders)){const c=r.getHeaders(),l=["content-type","content-length"];Object.entries(c).forEach(([g,m])=>{l.includes(g.toLowerCase())&&o.set(g,m)})}}if(Mr.hasStandardBrowserEnv&&(n&&ue.isFunction(n)&&(n=n(e)),n||n!==!1&&Lm(e.url))){const c=s&&i&&Fm.read(i);c&&o.set(s,c)}return e},zm=typeof XMLHttpRequest<"u",Vm=zm&&function(t){return new Promise(function(r,n){const s=Jd(t);let i=s.data;const o=Zr.from(s.headers).normalize();let{responseType:a,onUploadProgress:c,onDownloadProgress:l}=s,g,m,I,_,b;function v(){_&&_(),b&&b(),s.cancelToken&&s.cancelToken.unsubscribe(g),s.signal&&s.signal.removeEventListener("abort",g)}let S=new XMLHttpRequest;S.open(s.method.toUpperCase(),s.url,!0),S.timeout=s.timeout;function O(){if(!S)return;const k=Zr.from("getAllResponseHeaders"in S&&S.getAllResponseHeaders()),q={data:!a||a==="text"||a==="json"?S.responseText:S.response,status:S.status,statusText:S.statusText,headers:k,config:t,request:S};Hd(function(se){r(se),v()},function(se){n(se),v()},q),S=null}"onloadend"in S?S.onloadend=O:S.onreadystatechange=function(){!S||S.readyState!==4||S.status===0&&!(S.responseURL&&S.responseURL.indexOf("file:")===0)||setTimeout(O)},S.onabort=function(){S&&(n(new rt("Request aborted",rt.ECONNABORTED,t,S)),S=null)},S.onerror=function(Z){const q=Z&&Z.message?Z.message:"Network Error",J=new rt(q,rt.ERR_NETWORK,t,S);J.event=Z||null,n(J),S=null},S.ontimeout=function(){let Z=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const q=s.transitional||qd;s.timeoutErrorMessage&&(Z=s.timeoutErrorMessage),n(new rt(Z,q.clarifyTimeoutError?rt.ETIMEDOUT:rt.ECONNABORTED,t,S)),S=null},i===void 0&&o.setContentType(null),"setRequestHeader"in S&&ue.forEach(o.toJSON(),function(Z,q){S.setRequestHeader(q,Z)}),ue.isUndefined(s.withCredentials)||(S.withCredentials=!!s.withCredentials),a&&a!=="json"&&(S.responseType=s.responseType),l&&([I,b]=ma(l,!0),S.addEventListener("progress",I)),c&&S.upload&&([m,_]=ma(c),S.upload.addEventListener("progress",m),S.upload.addEventListener("loadend",_)),(s.cancelToken||s.signal)&&(g=k=>{S&&(n(!k||k.type?new Wi(null,t,S):k),S.abort(),S=null)},s.cancelToken&&s.cancelToken.subscribe(g),s.signal&&(s.signal.aborted?g():s.signal.addEventListener("abort",g)));const $=Om(s.url);if($&&Mr.protocols.indexOf($)===-1){n(new rt("Unsupported protocol "+$+":",rt.ERR_BAD_REQUEST,t));return}S.send(i||null)})},qm=(t,e)=>{const{length:r}=t=t?t.filter(Boolean):[];if(e||r){let n=new AbortController,s;const i=function(l){if(!s){s=!0,a();const g=l instanceof Error?l:this.reason;n.abort(g instanceof rt?g:new Wi(g instanceof Error?g.message:g))}};let o=e&&setTimeout(()=>{o=null,i(new rt(`timeout ${e} of ms exceeded`,rt.ETIMEDOUT))},e);const a=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(l=>{l.unsubscribe?l.unsubscribe(i):l.removeEventListener("abort",i)}),t=null)};t.forEach(l=>l.addEventListener("abort",i));const{signal:c}=n;return c.unsubscribe=()=>ue.asap(a),c}},Wm=function*(t,e){let r=t.byteLength;if(r<e){yield t;return}let n=0,s;for(;n<r;)s=n+e,yield t.slice(n,s),n=s},jm=async function*(t,e){for await(const r of Hm(t))yield*Wm(r,e)},Hm=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:r,value:n}=await e.read();if(r)break;yield n}}finally{await e.cancel()}},sf=(t,e,r,n)=>{const s=jm(t,e);let i=0,o,a=c=>{o||(o=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:l,value:g}=await s.next();if(l){a(),c.close();return}let m=g.byteLength;if(r){let I=i+=m;r(I)}c.enqueue(new Uint8Array(g))}catch(l){throw a(l),l}},cancel(c){return a(c),s.return()}},{highWaterMark:2})},of=64*1024,{isFunction:Wo}=ue,Gm=(({Request:t,Response:e})=>({Request:t,Response:e}))(ue.global),{ReadableStream:af,TextEncoder:cf}=ue.global,lf=(t,...e)=>{try{return!!t(...e)}catch{return!1}},Jm=t=>{t=ue.merge.call({skipUndefined:!0},Gm,t);const{fetch:e,Request:r,Response:n}=t,s=e?Wo(e):typeof fetch=="function",i=Wo(r),o=Wo(n);if(!s)return!1;const a=s&&Wo(af),c=s&&(typeof cf=="function"?(b=>v=>b.encode(v))(new cf):async b=>new Uint8Array(await new r(b).arrayBuffer())),l=i&&a&&lf(()=>{let b=!1;const v=new r(Mr.origin,{body:new af,method:"POST",get duplex(){return b=!0,"half"}}).headers.has("Content-Type");return b&&!v}),g=o&&a&&lf(()=>ue.isReadableStream(new n("").body)),m={stream:g&&(b=>b.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(b=>{!m[b]&&(m[b]=(v,S)=>{let O=v&&v[b];if(O)return O.call(v);throw new rt(`Response type '${b}' is not supported`,rt.ERR_NOT_SUPPORT,S)})});const I=async b=>{if(b==null)return 0;if(ue.isBlob(b))return b.size;if(ue.isSpecCompliantForm(b))return(await new r(Mr.origin,{method:"POST",body:b}).arrayBuffer()).byteLength;if(ue.isArrayBufferView(b)||ue.isArrayBuffer(b))return b.byteLength;if(ue.isURLSearchParams(b)&&(b=b+""),ue.isString(b))return(await c(b)).byteLength},_=async(b,v)=>{const S=ue.toFiniteNumber(b.getContentLength());return S??I(v)};return async b=>{let{url:v,method:S,data:O,signal:$,cancelToken:k,timeout:Z,onDownloadProgress:q,onUploadProgress:J,responseType:se,headers:oe,withCredentials:V="same-origin",fetchOptions:W}=Jd(b),Y=e||fetch;se=se?(se+"").toLowerCase():"text";let te=qm([$,k&&k.toAbortSignal()],Z),A=null;const u=te&&te.unsubscribe&&(()=>{te.unsubscribe()});let d;try{if(J&&l&&S!=="get"&&S!=="head"&&(d=await _(oe,O))!==0){let D=new r(v,{method:"POST",body:O,duplex:"half"}),f;if(ue.isFormData(O)&&(f=D.headers.get("content-type"))&&oe.setContentType(f),D.body){const[p,R]=tf(d,ma(rf(J)));O=sf(D.body,of,p,R)}}ue.isString(V)||(V=V?"include":"omit");const x=i&&"credentials"in r.prototype,P={...W,signal:te,method:S.toUpperCase(),headers:oe.normalize().toJSON(),body:O,duplex:"half",credentials:x?V:void 0};A=i&&new r(v,P);let M=await(i?Y(A,W):Y(v,P));const F=g&&(se==="stream"||se==="response");if(g&&(q||F&&u)){const D={};["status","statusText","headers"].forEach(U=>{D[U]=M[U]});const f=ue.toFiniteNumber(M.headers.get("content-length")),[p,R]=q&&tf(f,ma(rf(q),!0))||[];M=new n(sf(M.body,of,p,()=>{R&&R(),u&&u()}),D)}se=se||"text";let j=await m[ue.findKey(m,se)||"text"](M,b);return!F&&u&&u(),await new Promise((D,f)=>{Hd(D,f,{data:j,headers:Zr.from(M.headers),status:M.status,statusText:M.statusText,config:b,request:A})})}catch(x){throw u&&u(),x&&x.name==="TypeError"&&/Load failed|fetch/i.test(x.message)?Object.assign(new rt("Network Error",rt.ERR_NETWORK,b,A),{cause:x.cause||x}):rt.from(x,x&&x.code,b,A)}}},Zm=new Map,Zd=t=>{let e=t&&t.env||{};const{fetch:r,Request:n,Response:s}=e,i=[n,s,r];let o=i.length,a=o,c,l,g=Zm;for(;a--;)c=i[a],l=g.get(c),l===void 0&&g.set(c,l=a?new Map:Jm(e)),g=l;return l};Zd();const nu={http:dm,xhr:Vm,fetch:{get:Zd}};ue.forEach(nu,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const uf=t=>`- ${t}`,Ym=t=>ue.isFunction(t)||t===null||t===!1;function Xm(t,e){t=ue.isArray(t)?t:[t];const{length:r}=t;let n,s;const i={};for(let o=0;o<r;o++){n=t[o];let a;if(s=n,!Ym(n)&&(s=nu[(a=String(n)).toLowerCase()],s===void 0))throw new rt(`Unknown adapter '${a}'`);if(s&&(ue.isFunction(s)||(s=s.get(e))))break;i[a||"#"+o]=s}if(!s){const o=Object.entries(i).map(([c,l])=>`adapter ${c} `+(l===!1?"is not supported by the environment":"is not available in the build"));let a=r?o.length>1?`since :
`+o.map(uf).join(`
`):" "+uf(o[0]):"as no adapter specified";throw new rt("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return s}const Yd={getAdapter:Xm,adapters:nu};function dc(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Wi(null,t)}function ff(t){return dc(t),t.headers=Zr.from(t.headers),t.data=hc.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),Yd.getAdapter(t.adapter||Co.adapter,t)(t).then(function(n){return dc(t),n.data=hc.call(t,t.transformResponse,n),n.headers=Zr.from(n.headers),n},function(n){return jd(n)||(dc(t),n&&n.response&&(n.response.data=hc.call(t,t.transformResponse,n.response),n.response.headers=Zr.from(n.response.headers))),Promise.reject(n)})}const Xd="1.13.2",Wa={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{Wa[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}});const hf={};Wa.transitional=function(e,r,n){function s(i,o){return"[Axios v"+Xd+"] Transitional option '"+i+"'"+o+(n?". "+n:"")}return(i,o,a)=>{if(e===!1)throw new rt(s(o," has been removed"+(r?" in "+r:"")),rt.ERR_DEPRECATED);return r&&!hf[o]&&(hf[o]=!0,console.warn(s(o," has been deprecated since v"+r+" and will be removed in the near future"))),e?e(i,o,a):!0}};Wa.spelling=function(e){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${e}`),!0)};function Qm(t,e,r){if(typeof t!="object")throw new rt("options must be an object",rt.ERR_BAD_OPTION_VALUE);const n=Object.keys(t);let s=n.length;for(;s-- >0;){const i=n[s],o=e[i];if(o){const a=t[i],c=a===void 0||o(a,i,t);if(c!==!0)throw new rt("option "+i+" must be "+c,rt.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new rt("Unknown option "+i,rt.ERR_BAD_OPTION)}}const ca={assertOptions:Qm,validators:Wa},yn=ca.validators;let $s=class{constructor(e){this.defaults=e||{},this.interceptors={request:new Qu,response:new Qu}}async request(e,r){try{return await this._request(e,r)}catch(n){if(n instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";try{n.stack?i&&!String(n.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+i):n.stack=i}catch{}}throw n}}_request(e,r){typeof e=="string"?(r=r||{},r.url=e):r=e||{},r=Hs(this.defaults,r);const{transitional:n,paramsSerializer:s,headers:i}=r;n!==void 0&&ca.assertOptions(n,{silentJSONParsing:yn.transitional(yn.boolean),forcedJSONParsing:yn.transitional(yn.boolean),clarifyTimeoutError:yn.transitional(yn.boolean)},!1),s!=null&&(ue.isFunction(s)?r.paramsSerializer={serialize:s}:ca.assertOptions(s,{encode:yn.function,serialize:yn.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),ca.assertOptions(r,{baseUrl:yn.spelling("baseURL"),withXsrfToken:yn.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=i&&ue.merge(i.common,i[r.method]);i&&ue.forEach(["delete","get","head","post","put","patch","common"],b=>{delete i[b]}),r.headers=Zr.concat(o,i);const a=[];let c=!0;this.interceptors.request.forEach(function(v){typeof v.runWhen=="function"&&v.runWhen(r)===!1||(c=c&&v.synchronous,a.unshift(v.fulfilled,v.rejected))});const l=[];this.interceptors.response.forEach(function(v){l.push(v.fulfilled,v.rejected)});let g,m=0,I;if(!c){const b=[ff.bind(this),void 0];for(b.unshift(...a),b.push(...l),I=b.length,g=Promise.resolve(r);m<I;)g=g.then(b[m++],b[m++]);return g}I=a.length;let _=r;for(;m<I;){const b=a[m++],v=a[m++];try{_=b(_)}catch(S){v.call(this,S);break}}try{g=ff.call(this,_)}catch(b){return Promise.reject(b)}for(m=0,I=l.length;m<I;)g=g.then(l[m++],l[m++]);return g}getUri(e){e=Hs(this.defaults,e);const r=Gd(e.baseURL,e.url,e.allowAbsoluteUrls);return Vd(r,e.params,e.paramsSerializer)}};ue.forEach(["delete","get","head","options"],function(e){$s.prototype[e]=function(r,n){return this.request(Hs(n||{},{method:e,url:r,data:(n||{}).data}))}});ue.forEach(["post","put","patch"],function(e){function r(n){return function(i,o,a){return this.request(Hs(a||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}$s.prototype[e]=r(),$s.prototype[e+"Form"]=r(!0)});let ey=class Qd{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const n=this;this.promise.then(s=>{if(!n._listeners)return;let i=n._listeners.length;for(;i-- >0;)n._listeners[i](s);n._listeners=null}),this.promise.then=s=>{let i;const o=new Promise(a=>{n.subscribe(a),i=a}).then(s);return o.cancel=function(){n.unsubscribe(i)},o},e(function(i,o,a){n.reason||(n.reason=new Wi(i,o,a),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const r=this._listeners.indexOf(e);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const e=new AbortController,r=n=>{e.abort(n)};return this.subscribe(r),e.signal.unsubscribe=()=>this.unsubscribe(r),e.signal}static source(){let e;return{token:new Qd(function(s){e=s}),cancel:e}}};function ty(t){return function(r){return t.apply(null,r)}}function ry(t){return ue.isObject(t)&&t.isAxiosError===!0}const gl={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(gl).forEach(([t,e])=>{gl[e]=t});function e0(t){const e=new $s(t),r=Cd($s.prototype.request,e);return ue.extend(r,$s.prototype,e,{allOwnKeys:!0}),ue.extend(r,e,null,{allOwnKeys:!0}),r.create=function(s){return e0(Hs(t,s))},r}const Gt=e0(Co);Gt.Axios=$s;Gt.CanceledError=Wi;Gt.CancelToken=ey;Gt.isCancel=jd;Gt.VERSION=Xd;Gt.toFormData=qa;Gt.AxiosError=rt;Gt.Cancel=Gt.CanceledError;Gt.all=function(e){return Promise.all(e)};Gt.spread=ty;Gt.isAxiosError=ry;Gt.mergeConfig=Hs;Gt.AxiosHeaders=Zr;Gt.formToJSON=t=>Wd(ue.isHTMLForm(t)?new FormData(t):t);Gt.getAdapter=Yd.getAdapter;Gt.HttpStatusCode=gl;Gt.default=Gt;const{Axios:rS,AxiosError:nS,CanceledError:sS,isCancel:iS,CancelToken:oS,VERSION:aS,all:cS,Cancel:lS,isAxiosError:ny,spread:uS,toFormData:fS,AxiosHeaders:hS,HttpStatusCode:dS,formToJSON:pS,getAdapter:gS,mergeConfig:wS}=Gt,t0="http://localhost:8000".replace(/\/+$/,"");class sy{constructor(e,r=t0,n=Gt){var s;this.basePath=r,this.axios=n,e&&(this.configuration=e,this.basePath=(s=e.basePath)!==null&&s!==void 0?s:r)}}class iy extends Error{constructor(e,r){super(r),this.field=e,this.name="RequiredError"}}const oy={},ay="https://example.com",cy=function(t,e,r){if(r==null)throw new iy(e,`Required parameter ${e} was null or undefined when calling ${t}.`)};function wl(t,e,r=""){e!=null&&(typeof e=="object"?Array.isArray(e)?e.forEach(n=>wl(t,n,r)):Object.keys(e).forEach(n=>wl(t,e[n],`${r}${r!==""?".":""}${n}`)):t.has(r)?t.append(r,e):t.set(r,e))}const ly=function(t,...e){const r=new URLSearchParams(t.search);wl(r,e),t.search=r.toString()},uy=function(t,e,r){const n=typeof t!="string";return(n&&r&&r.isJsonMime?r.isJsonMime(e.headers["Content-Type"]):n)?JSON.stringify(t!==void 0?t:{}):t||""},fy=function(t){return t.pathname+t.search+t.hash},hy=function(t,e,r,n){return(s=e,i=r)=>{var o;const a=Object.assign(Object.assign({},t.options),{url:(s.defaults.baseURL?"":(o=n?.basePath)!==null&&o!==void 0?o:i)+t.url});return s.request(a)}};var r0=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(g){try{l(n.next(g))}catch(m){o(m)}}function c(g){try{l(n.throw(g))}catch(m){o(m)}}function l(g){g.done?i(g.value):s(g.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};const dy=function(t){return{postKmsRpc:(e,...r)=>r0(this,[e,...r],void 0,function*(n,s={}){cy("postKmsRpc","kmsRpcRequest",n);const i="/kms/rpc",o=new URL(i,ay);let a;t&&(a=t.baseOptions);const c=Object.assign(Object.assign({method:"POST"},a),s),l={},g={};l["Content-Type"]="application/json",ly(o,g);let m=a&&a.headers?a.headers:{};return c.headers=Object.assign(Object.assign(Object.assign({},l),m),s.headers),c.data=uy(n,c,t),{url:fy(o),options:c}})}},py=function(t){const e=dy(t);return{postKmsRpc(r,n){return r0(this,void 0,void 0,function*(){var s,i,o;const a=yield e.postKmsRpc(r,n),c=(s=t?.serverIndex)!==null&&s!==void 0?s:0,l=(o=(i=oy["KMSRPCApi.postKmsRpc"])===null||i===void 0?void 0:i[c])===null||o===void 0?void 0:o.url;return(g,m)=>hy(a,Gt,t0,t)(g,l||m)})}}};class gy extends sy{postKmsRpc(e,r){return py(this.configuration).postKmsRpc(e,r).then(n=>n(this.axios,this.basePath))}}class wy{constructor(e={}){var r;this.apiKey=e.apiKey,this.username=e.username,this.password=e.password,this.accessToken=e.accessToken,this.basePath=e.basePath,this.serverIndex=e.serverIndex,this.baseOptions=Object.assign(Object.assign({},e.baseOptions),{headers:Object.assign({},(r=e.baseOptions)===null||r===void 0?void 0:r.headers)}),this.formDataCtor=e.formDataCtor}isJsonMime(e){const r=new RegExp("^(application/json|[^;/ 	]+/[^;/ 	]+[+]json)[ 	]*(;.*)?$","i");return e!==null&&(r.test(e)||e.toLowerCase()==="application/json-patch+json")}}var ml;(function(t){t.addUserToOrganization="addUserToOrganization"})(ml||(ml={}));var Ps;(function(t){t.ed25519="Ed25519",t.secp256r1="Secp256r1",t.secp256k1="Secp256k1",t.secp256k1Keccak256="Secp256k1Keccak256",t.secp256k1Schnorr="Secp256k1Schnorr"})(Ps||(Ps={}));var yl;(function(t){t.createAuthenticator="createAuthenticator"})(yl||(yl={}));var bl;(function(t){t.createOrganization="createOrganization"})(bl||(bl={}));var vl;(function(t){t.createWallet="createWallet"})(vl||(vl={}));var El;(function(t){t.deleteAuthenticator="deleteAuthenticator"})(El||(El={}));var yi;(function(t){t.ed25519="Ed25519",t.secp256k1="Secp256k1"})(yi||(yi={}));var st;(function(t){t.ethereum="Ethereum",t.solana="Solana",t.bitcoinSegwit="BitcoinSegwit",t.sui="Sui"})(st||(st={}));var ya;(function(t){t.getAccounts="getAccounts"})(ya||(ya={}));var xl;(function(t){t.grantOrganizationAccess="grantOrganizationAccess"})(xl||(xl={}));var _l;(function(t){t.signTransaction="signTransaction"})(_l||(_l={}));var Il;(function(t){t.signUtf8Message="signUtf8Message"})(Il||(Il={}));var Sl;(function(t){t.root="ROOT"})(Sl||(Sl={}));function ja(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function su(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var r=function n(){var s=!1;try{s=this instanceof n}catch{}return s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var s=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return t[n]}})}),r}var pc={},ro={},df;function my(){if(df)return ro;df=1,ro.byteLength=a,ro.toByteArray=l,ro.fromByteArray=I;for(var t=[],e=[],r=typeof Uint8Array<"u"?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,i=n.length;s<i;++s)t[s]=n[s],e[n.charCodeAt(s)]=s;e[45]=62,e[95]=63;function o(_){var b=_.length;if(b%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var v=_.indexOf("=");v===-1&&(v=b);var S=v===b?0:4-v%4;return[v,S]}function a(_){var b=o(_),v=b[0],S=b[1];return(v+S)*3/4-S}function c(_,b,v){return(b+v)*3/4-v}function l(_){var b,v=o(_),S=v[0],O=v[1],$=new r(c(_,S,O)),k=0,Z=O>0?S-4:S,q;for(q=0;q<Z;q+=4)b=e[_.charCodeAt(q)]<<18|e[_.charCodeAt(q+1)]<<12|e[_.charCodeAt(q+2)]<<6|e[_.charCodeAt(q+3)],$[k++]=b>>16&255,$[k++]=b>>8&255,$[k++]=b&255;return O===2&&(b=e[_.charCodeAt(q)]<<2|e[_.charCodeAt(q+1)]>>4,$[k++]=b&255),O===1&&(b=e[_.charCodeAt(q)]<<10|e[_.charCodeAt(q+1)]<<4|e[_.charCodeAt(q+2)]>>2,$[k++]=b>>8&255,$[k++]=b&255),$}function g(_){return t[_>>18&63]+t[_>>12&63]+t[_>>6&63]+t[_&63]}function m(_,b,v){for(var S,O=[],$=b;$<v;$+=3)S=(_[$]<<16&16711680)+(_[$+1]<<8&65280)+(_[$+2]&255),O.push(g(S));return O.join("")}function I(_){for(var b,v=_.length,S=v%3,O=[],$=16383,k=0,Z=v-S;k<Z;k+=$)O.push(m(_,k,k+$>Z?Z:k+$));return S===1?(b=_[v-1],O.push(t[b>>2]+t[b<<4&63]+"==")):S===2&&(b=(_[v-2]<<8)+_[v-1],O.push(t[b>>10]+t[b>>4&63]+t[b<<2&63]+"=")),O.join("")}return ro}var jo={};var pf;function yy(){return pf||(pf=1,jo.read=function(t,e,r,n,s){var i,o,a=s*8-n-1,c=(1<<a)-1,l=c>>1,g=-7,m=r?s-1:0,I=r?-1:1,_=t[e+m];for(m+=I,i=_&(1<<-g)-1,_>>=-g,g+=a;g>0;i=i*256+t[e+m],m+=I,g-=8);for(o=i&(1<<-g)-1,i>>=-g,g+=n;g>0;o=o*256+t[e+m],m+=I,g-=8);if(i===0)i=1-l;else{if(i===c)return o?NaN:(_?-1:1)*(1/0);o=o+Math.pow(2,n),i=i-l}return(_?-1:1)*o*Math.pow(2,i-n)},jo.write=function(t,e,r,n,s,i){var o,a,c,l=i*8-s-1,g=(1<<l)-1,m=g>>1,I=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,_=n?0:i-1,b=n?1:-1,v=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=g):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+m>=1?e+=I/c:e+=I*Math.pow(2,1-m),e*c>=2&&(o++,c/=2),o+m>=g?(a=0,o=g):o+m>=1?(a=(e*c-1)*Math.pow(2,s),o=o+m):(a=e*Math.pow(2,m-1)*Math.pow(2,s),o=0));s>=8;t[r+_]=a&255,_+=b,a/=256,s-=8);for(o=o<<s|a,l+=s;l>0;t[r+_]=o&255,_+=b,o/=256,l-=8);t[r+_-b]|=v*128}),jo}var gf;function iu(){return gf||(gf=1,(function(t){const e=my(),r=yy(),n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=$,t.INSPECT_MAX_BYTES=50;const s=2147483647;t.kMaxLength=s,a.TYPED_ARRAY_SUPPORT=i(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function i(){try{const B=new Uint8Array(1),w={foo:function(){return 42}};return Object.setPrototypeOf(w,Uint8Array.prototype),Object.setPrototypeOf(B,w),B.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function o(B){if(B>s)throw new RangeError('The value "'+B+'" is invalid for option "size"');const w=new Uint8Array(B);return Object.setPrototypeOf(w,a.prototype),w}function a(B,w,y){if(typeof B=="number"){if(typeof w=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return m(B)}return c(B,w,y)}a.poolSize=8192;function c(B,w,y){if(typeof B=="string")return I(B,w);if(ArrayBuffer.isView(B))return b(B);if(B==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof B);if(mr(B,ArrayBuffer)||B&&mr(B.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(mr(B,SharedArrayBuffer)||B&&mr(B.buffer,SharedArrayBuffer)))return v(B,w,y);if(typeof B=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const L=B.valueOf&&B.valueOf();if(L!=null&&L!==B)return a.from(L,w,y);const Q=S(B);if(Q)return Q;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof B[Symbol.toPrimitive]=="function")return a.from(B[Symbol.toPrimitive]("string"),w,y);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof B)}a.from=function(B,w,y){return c(B,w,y)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function l(B){if(typeof B!="number")throw new TypeError('"size" argument must be of type number');if(B<0)throw new RangeError('The value "'+B+'" is invalid for option "size"')}function g(B,w,y){return l(B),B<=0?o(B):w!==void 0?typeof y=="string"?o(B).fill(w,y):o(B).fill(w):o(B)}a.alloc=function(B,w,y){return g(B,w,y)};function m(B){return l(B),o(B<0?0:O(B)|0)}a.allocUnsafe=function(B){return m(B)},a.allocUnsafeSlow=function(B){return m(B)};function I(B,w){if((typeof w!="string"||w==="")&&(w="utf8"),!a.isEncoding(w))throw new TypeError("Unknown encoding: "+w);const y=k(B,w)|0;let L=o(y);const Q=L.write(B,w);return Q!==y&&(L=L.slice(0,Q)),L}function _(B){const w=B.length<0?0:O(B.length)|0,y=o(w);for(let L=0;L<w;L+=1)y[L]=B[L]&255;return y}function b(B){if(mr(B,Uint8Array)){const w=new Uint8Array(B);return v(w.buffer,w.byteOffset,w.byteLength)}return _(B)}function v(B,w,y){if(w<0||B.byteLength<w)throw new RangeError('"offset" is outside of buffer bounds');if(B.byteLength<w+(y||0))throw new RangeError('"length" is outside of buffer bounds');let L;return w===void 0&&y===void 0?L=new Uint8Array(B):y===void 0?L=new Uint8Array(B,w):L=new Uint8Array(B,w,y),Object.setPrototypeOf(L,a.prototype),L}function S(B){if(a.isBuffer(B)){const w=O(B.length)|0,y=o(w);return y.length===0||B.copy(y,0,0,w),y}if(B.length!==void 0)return typeof B.length!="number"||Tt(B.length)?o(0):_(B);if(B.type==="Buffer"&&Array.isArray(B.data))return _(B.data)}function O(B){if(B>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return B|0}function $(B){return+B!=B&&(B=0),a.alloc(+B)}a.isBuffer=function(w){return w!=null&&w._isBuffer===!0&&w!==a.prototype},a.compare=function(w,y){if(mr(w,Uint8Array)&&(w=a.from(w,w.offset,w.byteLength)),mr(y,Uint8Array)&&(y=a.from(y,y.offset,y.byteLength)),!a.isBuffer(w)||!a.isBuffer(y))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(w===y)return 0;let L=w.length,Q=y.length;for(let ne=0,he=Math.min(L,Q);ne<he;++ne)if(w[ne]!==y[ne]){L=w[ne],Q=y[ne];break}return L<Q?-1:Q<L?1:0},a.isEncoding=function(w){switch(String(w).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(w,y){if(!Array.isArray(w))throw new TypeError('"list" argument must be an Array of Buffers');if(w.length===0)return a.alloc(0);let L;if(y===void 0)for(y=0,L=0;L<w.length;++L)y+=w[L].length;const Q=a.allocUnsafe(y);let ne=0;for(L=0;L<w.length;++L){let he=w[L];if(mr(he,Uint8Array))ne+he.length>Q.length?(a.isBuffer(he)||(he=a.from(he)),he.copy(Q,ne)):Uint8Array.prototype.set.call(Q,he,ne);else if(a.isBuffer(he))he.copy(Q,ne);else throw new TypeError('"list" argument must be an Array of Buffers');ne+=he.length}return Q};function k(B,w){if(a.isBuffer(B))return B.length;if(ArrayBuffer.isView(B)||mr(B,ArrayBuffer))return B.byteLength;if(typeof B!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof B);const y=B.length,L=arguments.length>2&&arguments[2]===!0;if(!L&&y===0)return 0;let Q=!1;for(;;)switch(w){case"ascii":case"latin1":case"binary":return y;case"utf8":case"utf-8":return Nt(B).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return y*2;case"hex":return y>>>1;case"base64":return Rt(B).length;default:if(Q)return L?-1:Nt(B).length;w=(""+w).toLowerCase(),Q=!0}}a.byteLength=k;function Z(B,w,y){let L=!1;if((w===void 0||w<0)&&(w=0),w>this.length||((y===void 0||y>this.length)&&(y=this.length),y<=0)||(y>>>=0,w>>>=0,y<=w))return"";for(B||(B="utf8");;)switch(B){case"hex":return F(this,w,y);case"utf8":case"utf-8":return u(this,w,y);case"ascii":return P(this,w,y);case"latin1":case"binary":return M(this,w,y);case"base64":return A(this,w,y);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return j(this,w,y);default:if(L)throw new TypeError("Unknown encoding: "+B);B=(B+"").toLowerCase(),L=!0}}a.prototype._isBuffer=!0;function q(B,w,y){const L=B[w];B[w]=B[y],B[y]=L}a.prototype.swap16=function(){const w=this.length;if(w%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let y=0;y<w;y+=2)q(this,y,y+1);return this},a.prototype.swap32=function(){const w=this.length;if(w%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let y=0;y<w;y+=4)q(this,y,y+3),q(this,y+1,y+2);return this},a.prototype.swap64=function(){const w=this.length;if(w%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let y=0;y<w;y+=8)q(this,y,y+7),q(this,y+1,y+6),q(this,y+2,y+5),q(this,y+3,y+4);return this},a.prototype.toString=function(){const w=this.length;return w===0?"":arguments.length===0?u(this,0,w):Z.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(w){if(!a.isBuffer(w))throw new TypeError("Argument must be a Buffer");return this===w?!0:a.compare(this,w)===0},a.prototype.inspect=function(){let w="";const y=t.INSPECT_MAX_BYTES;return w=this.toString("hex",0,y).replace(/(.{2})/g,"$1 ").trim(),this.length>y&&(w+=" ... "),"<Buffer "+w+">"},n&&(a.prototype[n]=a.prototype.inspect),a.prototype.compare=function(w,y,L,Q,ne){if(mr(w,Uint8Array)&&(w=a.from(w,w.offset,w.byteLength)),!a.isBuffer(w))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof w);if(y===void 0&&(y=0),L===void 0&&(L=w?w.length:0),Q===void 0&&(Q=0),ne===void 0&&(ne=this.length),y<0||L>w.length||Q<0||ne>this.length)throw new RangeError("out of range index");if(Q>=ne&&y>=L)return 0;if(Q>=ne)return-1;if(y>=L)return 1;if(y>>>=0,L>>>=0,Q>>>=0,ne>>>=0,this===w)return 0;let he=ne-Q,Ze=L-y;const ze=Math.min(he,Ze),$e=this.slice(Q,ne),xt=w.slice(y,L);for(let Ue=0;Ue<ze;++Ue)if($e[Ue]!==xt[Ue]){he=$e[Ue],Ze=xt[Ue];break}return he<Ze?-1:Ze<he?1:0};function J(B,w,y,L,Q){if(B.length===0)return-1;if(typeof y=="string"?(L=y,y=0):y>2147483647?y=2147483647:y<-2147483648&&(y=-2147483648),y=+y,Tt(y)&&(y=Q?0:B.length-1),y<0&&(y=B.length+y),y>=B.length){if(Q)return-1;y=B.length-1}else if(y<0)if(Q)y=0;else return-1;if(typeof w=="string"&&(w=a.from(w,L)),a.isBuffer(w))return w.length===0?-1:se(B,w,y,L,Q);if(typeof w=="number")return w=w&255,typeof Uint8Array.prototype.indexOf=="function"?Q?Uint8Array.prototype.indexOf.call(B,w,y):Uint8Array.prototype.lastIndexOf.call(B,w,y):se(B,[w],y,L,Q);throw new TypeError("val must be string, number or Buffer")}function se(B,w,y,L,Q){let ne=1,he=B.length,Ze=w.length;if(L!==void 0&&(L=String(L).toLowerCase(),L==="ucs2"||L==="ucs-2"||L==="utf16le"||L==="utf-16le")){if(B.length<2||w.length<2)return-1;ne=2,he/=2,Ze/=2,y/=2}function ze(xt,Ue){return ne===1?xt[Ue]:xt.readUInt16BE(Ue*ne)}let $e;if(Q){let xt=-1;for($e=y;$e<he;$e++)if(ze(B,$e)===ze(w,xt===-1?0:$e-xt)){if(xt===-1&&(xt=$e),$e-xt+1===Ze)return xt*ne}else xt!==-1&&($e-=$e-xt),xt=-1}else for(y+Ze>he&&(y=he-Ze),$e=y;$e>=0;$e--){let xt=!0;for(let Ue=0;Ue<Ze;Ue++)if(ze(B,$e+Ue)!==ze(w,Ue)){xt=!1;break}if(xt)return $e}return-1}a.prototype.includes=function(w,y,L){return this.indexOf(w,y,L)!==-1},a.prototype.indexOf=function(w,y,L){return J(this,w,y,L,!0)},a.prototype.lastIndexOf=function(w,y,L){return J(this,w,y,L,!1)};function oe(B,w,y,L){y=Number(y)||0;const Q=B.length-y;L?(L=Number(L),L>Q&&(L=Q)):L=Q;const ne=w.length;L>ne/2&&(L=ne/2);let he;for(he=0;he<L;++he){const Ze=parseInt(w.substr(he*2,2),16);if(Tt(Ze))return he;B[y+he]=Ze}return he}function V(B,w,y,L){return Bt(Nt(w,B.length-y),B,y,L)}function W(B,w,y,L){return Bt(Kt(w),B,y,L)}function Y(B,w,y,L){return Bt(Rt(w),B,y,L)}function te(B,w,y,L){return Bt(nn(w,B.length-y),B,y,L)}a.prototype.write=function(w,y,L,Q){if(y===void 0)Q="utf8",L=this.length,y=0;else if(L===void 0&&typeof y=="string")Q=y,L=this.length,y=0;else if(isFinite(y))y=y>>>0,isFinite(L)?(L=L>>>0,Q===void 0&&(Q="utf8")):(Q=L,L=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const ne=this.length-y;if((L===void 0||L>ne)&&(L=ne),w.length>0&&(L<0||y<0)||y>this.length)throw new RangeError("Attempt to write outside buffer bounds");Q||(Q="utf8");let he=!1;for(;;)switch(Q){case"hex":return oe(this,w,y,L);case"utf8":case"utf-8":return V(this,w,y,L);case"ascii":case"latin1":case"binary":return W(this,w,y,L);case"base64":return Y(this,w,y,L);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return te(this,w,y,L);default:if(he)throw new TypeError("Unknown encoding: "+Q);Q=(""+Q).toLowerCase(),he=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function A(B,w,y){return w===0&&y===B.length?e.fromByteArray(B):e.fromByteArray(B.slice(w,y))}function u(B,w,y){y=Math.min(B.length,y);const L=[];let Q=w;for(;Q<y;){const ne=B[Q];let he=null,Ze=ne>239?4:ne>223?3:ne>191?2:1;if(Q+Ze<=y){let ze,$e,xt,Ue;switch(Ze){case 1:ne<128&&(he=ne);break;case 2:ze=B[Q+1],(ze&192)===128&&(Ue=(ne&31)<<6|ze&63,Ue>127&&(he=Ue));break;case 3:ze=B[Q+1],$e=B[Q+2],(ze&192)===128&&($e&192)===128&&(Ue=(ne&15)<<12|(ze&63)<<6|$e&63,Ue>2047&&(Ue<55296||Ue>57343)&&(he=Ue));break;case 4:ze=B[Q+1],$e=B[Q+2],xt=B[Q+3],(ze&192)===128&&($e&192)===128&&(xt&192)===128&&(Ue=(ne&15)<<18|(ze&63)<<12|($e&63)<<6|xt&63,Ue>65535&&Ue<1114112&&(he=Ue))}}he===null?(he=65533,Ze=1):he>65535&&(he-=65536,L.push(he>>>10&1023|55296),he=56320|he&1023),L.push(he),Q+=Ze}return x(L)}const d=4096;function x(B){const w=B.length;if(w<=d)return String.fromCharCode.apply(String,B);let y="",L=0;for(;L<w;)y+=String.fromCharCode.apply(String,B.slice(L,L+=d));return y}function P(B,w,y){let L="";y=Math.min(B.length,y);for(let Q=w;Q<y;++Q)L+=String.fromCharCode(B[Q]&127);return L}function M(B,w,y){let L="";y=Math.min(B.length,y);for(let Q=w;Q<y;++Q)L+=String.fromCharCode(B[Q]);return L}function F(B,w,y){const L=B.length;(!w||w<0)&&(w=0),(!y||y<0||y>L)&&(y=L);let Q="";for(let ne=w;ne<y;++ne)Q+=Ot[B[ne]];return Q}function j(B,w,y){const L=B.slice(w,y);let Q="";for(let ne=0;ne<L.length-1;ne+=2)Q+=String.fromCharCode(L[ne]+L[ne+1]*256);return Q}a.prototype.slice=function(w,y){const L=this.length;w=~~w,y=y===void 0?L:~~y,w<0?(w+=L,w<0&&(w=0)):w>L&&(w=L),y<0?(y+=L,y<0&&(y=0)):y>L&&(y=L),y<w&&(y=w);const Q=this.subarray(w,y);return Object.setPrototypeOf(Q,a.prototype),Q};function D(B,w,y){if(B%1!==0||B<0)throw new RangeError("offset is not uint");if(B+w>y)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(w,y,L){w=w>>>0,y=y>>>0,L||D(w,y,this.length);let Q=this[w],ne=1,he=0;for(;++he<y&&(ne*=256);)Q+=this[w+he]*ne;return Q},a.prototype.readUintBE=a.prototype.readUIntBE=function(w,y,L){w=w>>>0,y=y>>>0,L||D(w,y,this.length);let Q=this[w+--y],ne=1;for(;y>0&&(ne*=256);)Q+=this[w+--y]*ne;return Q},a.prototype.readUint8=a.prototype.readUInt8=function(w,y){return w=w>>>0,y||D(w,1,this.length),this[w]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(w,y){return w=w>>>0,y||D(w,2,this.length),this[w]|this[w+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(w,y){return w=w>>>0,y||D(w,2,this.length),this[w]<<8|this[w+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(w,y){return w=w>>>0,y||D(w,4,this.length),(this[w]|this[w+1]<<8|this[w+2]<<16)+this[w+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(w,y){return w=w>>>0,y||D(w,4,this.length),this[w]*16777216+(this[w+1]<<16|this[w+2]<<8|this[w+3])},a.prototype.readBigUInt64LE=Ur(function(w){w=w>>>0,Zt(w,"offset");const y=this[w],L=this[w+7];(y===void 0||L===void 0)&&bt(w,this.length-8);const Q=y+this[++w]*2**8+this[++w]*2**16+this[++w]*2**24,ne=this[++w]+this[++w]*2**8+this[++w]*2**16+L*2**24;return BigInt(Q)+(BigInt(ne)<<BigInt(32))}),a.prototype.readBigUInt64BE=Ur(function(w){w=w>>>0,Zt(w,"offset");const y=this[w],L=this[w+7];(y===void 0||L===void 0)&&bt(w,this.length-8);const Q=y*2**24+this[++w]*2**16+this[++w]*2**8+this[++w],ne=this[++w]*2**24+this[++w]*2**16+this[++w]*2**8+L;return(BigInt(Q)<<BigInt(32))+BigInt(ne)}),a.prototype.readIntLE=function(w,y,L){w=w>>>0,y=y>>>0,L||D(w,y,this.length);let Q=this[w],ne=1,he=0;for(;++he<y&&(ne*=256);)Q+=this[w+he]*ne;return ne*=128,Q>=ne&&(Q-=Math.pow(2,8*y)),Q},a.prototype.readIntBE=function(w,y,L){w=w>>>0,y=y>>>0,L||D(w,y,this.length);let Q=y,ne=1,he=this[w+--Q];for(;Q>0&&(ne*=256);)he+=this[w+--Q]*ne;return ne*=128,he>=ne&&(he-=Math.pow(2,8*y)),he},a.prototype.readInt8=function(w,y){return w=w>>>0,y||D(w,1,this.length),this[w]&128?(255-this[w]+1)*-1:this[w]},a.prototype.readInt16LE=function(w,y){w=w>>>0,y||D(w,2,this.length);const L=this[w]|this[w+1]<<8;return L&32768?L|4294901760:L},a.prototype.readInt16BE=function(w,y){w=w>>>0,y||D(w,2,this.length);const L=this[w+1]|this[w]<<8;return L&32768?L|4294901760:L},a.prototype.readInt32LE=function(w,y){return w=w>>>0,y||D(w,4,this.length),this[w]|this[w+1]<<8|this[w+2]<<16|this[w+3]<<24},a.prototype.readInt32BE=function(w,y){return w=w>>>0,y||D(w,4,this.length),this[w]<<24|this[w+1]<<16|this[w+2]<<8|this[w+3]},a.prototype.readBigInt64LE=Ur(function(w){w=w>>>0,Zt(w,"offset");const y=this[w],L=this[w+7];(y===void 0||L===void 0)&&bt(w,this.length-8);const Q=this[w+4]+this[w+5]*2**8+this[w+6]*2**16+(L<<24);return(BigInt(Q)<<BigInt(32))+BigInt(y+this[++w]*2**8+this[++w]*2**16+this[++w]*2**24)}),a.prototype.readBigInt64BE=Ur(function(w){w=w>>>0,Zt(w,"offset");const y=this[w],L=this[w+7];(y===void 0||L===void 0)&&bt(w,this.length-8);const Q=(y<<24)+this[++w]*2**16+this[++w]*2**8+this[++w];return(BigInt(Q)<<BigInt(32))+BigInt(this[++w]*2**24+this[++w]*2**16+this[++w]*2**8+L)}),a.prototype.readFloatLE=function(w,y){return w=w>>>0,y||D(w,4,this.length),r.read(this,w,!0,23,4)},a.prototype.readFloatBE=function(w,y){return w=w>>>0,y||D(w,4,this.length),r.read(this,w,!1,23,4)},a.prototype.readDoubleLE=function(w,y){return w=w>>>0,y||D(w,8,this.length),r.read(this,w,!0,52,8)},a.prototype.readDoubleBE=function(w,y){return w=w>>>0,y||D(w,8,this.length),r.read(this,w,!1,52,8)};function f(B,w,y,L,Q,ne){if(!a.isBuffer(B))throw new TypeError('"buffer" argument must be a Buffer instance');if(w>Q||w<ne)throw new RangeError('"value" argument is out of bounds');if(y+L>B.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(w,y,L,Q){if(w=+w,y=y>>>0,L=L>>>0,!Q){const Ze=Math.pow(2,8*L)-1;f(this,w,y,L,Ze,0)}let ne=1,he=0;for(this[y]=w&255;++he<L&&(ne*=256);)this[y+he]=w/ne&255;return y+L},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(w,y,L,Q){if(w=+w,y=y>>>0,L=L>>>0,!Q){const Ze=Math.pow(2,8*L)-1;f(this,w,y,L,Ze,0)}let ne=L-1,he=1;for(this[y+ne]=w&255;--ne>=0&&(he*=256);)this[y+ne]=w/he&255;return y+L},a.prototype.writeUint8=a.prototype.writeUInt8=function(w,y,L){return w=+w,y=y>>>0,L||f(this,w,y,1,255,0),this[y]=w&255,y+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(w,y,L){return w=+w,y=y>>>0,L||f(this,w,y,2,65535,0),this[y]=w&255,this[y+1]=w>>>8,y+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(w,y,L){return w=+w,y=y>>>0,L||f(this,w,y,2,65535,0),this[y]=w>>>8,this[y+1]=w&255,y+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(w,y,L){return w=+w,y=y>>>0,L||f(this,w,y,4,4294967295,0),this[y+3]=w>>>24,this[y+2]=w>>>16,this[y+1]=w>>>8,this[y]=w&255,y+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(w,y,L){return w=+w,y=y>>>0,L||f(this,w,y,4,4294967295,0),this[y]=w>>>24,this[y+1]=w>>>16,this[y+2]=w>>>8,this[y+3]=w&255,y+4};function p(B,w,y,L,Q){Qe(w,L,Q,B,y,7);let ne=Number(w&BigInt(4294967295));B[y++]=ne,ne=ne>>8,B[y++]=ne,ne=ne>>8,B[y++]=ne,ne=ne>>8,B[y++]=ne;let he=Number(w>>BigInt(32)&BigInt(4294967295));return B[y++]=he,he=he>>8,B[y++]=he,he=he>>8,B[y++]=he,he=he>>8,B[y++]=he,y}function R(B,w,y,L,Q){Qe(w,L,Q,B,y,7);let ne=Number(w&BigInt(4294967295));B[y+7]=ne,ne=ne>>8,B[y+6]=ne,ne=ne>>8,B[y+5]=ne,ne=ne>>8,B[y+4]=ne;let he=Number(w>>BigInt(32)&BigInt(4294967295));return B[y+3]=he,he=he>>8,B[y+2]=he,he=he>>8,B[y+1]=he,he=he>>8,B[y]=he,y+8}a.prototype.writeBigUInt64LE=Ur(function(w,y=0){return p(this,w,y,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=Ur(function(w,y=0){return R(this,w,y,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(w,y,L,Q){if(w=+w,y=y>>>0,!Q){const ze=Math.pow(2,8*L-1);f(this,w,y,L,ze-1,-ze)}let ne=0,he=1,Ze=0;for(this[y]=w&255;++ne<L&&(he*=256);)w<0&&Ze===0&&this[y+ne-1]!==0&&(Ze=1),this[y+ne]=(w/he>>0)-Ze&255;return y+L},a.prototype.writeIntBE=function(w,y,L,Q){if(w=+w,y=y>>>0,!Q){const ze=Math.pow(2,8*L-1);f(this,w,y,L,ze-1,-ze)}let ne=L-1,he=1,Ze=0;for(this[y+ne]=w&255;--ne>=0&&(he*=256);)w<0&&Ze===0&&this[y+ne+1]!==0&&(Ze=1),this[y+ne]=(w/he>>0)-Ze&255;return y+L},a.prototype.writeInt8=function(w,y,L){return w=+w,y=y>>>0,L||f(this,w,y,1,127,-128),w<0&&(w=255+w+1),this[y]=w&255,y+1},a.prototype.writeInt16LE=function(w,y,L){return w=+w,y=y>>>0,L||f(this,w,y,2,32767,-32768),this[y]=w&255,this[y+1]=w>>>8,y+2},a.prototype.writeInt16BE=function(w,y,L){return w=+w,y=y>>>0,L||f(this,w,y,2,32767,-32768),this[y]=w>>>8,this[y+1]=w&255,y+2},a.prototype.writeInt32LE=function(w,y,L){return w=+w,y=y>>>0,L||f(this,w,y,4,2147483647,-2147483648),this[y]=w&255,this[y+1]=w>>>8,this[y+2]=w>>>16,this[y+3]=w>>>24,y+4},a.prototype.writeInt32BE=function(w,y,L){return w=+w,y=y>>>0,L||f(this,w,y,4,2147483647,-2147483648),w<0&&(w=4294967295+w+1),this[y]=w>>>24,this[y+1]=w>>>16,this[y+2]=w>>>8,this[y+3]=w&255,y+4},a.prototype.writeBigInt64LE=Ur(function(w,y=0){return p(this,w,y,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=Ur(function(w,y=0){return R(this,w,y,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function U(B,w,y,L,Q,ne){if(y+L>B.length)throw new RangeError("Index out of range");if(y<0)throw new RangeError("Index out of range")}function X(B,w,y,L,Q){return w=+w,y=y>>>0,Q||U(B,w,y,4),r.write(B,w,y,L,23,4),y+4}a.prototype.writeFloatLE=function(w,y,L){return X(this,w,y,!0,L)},a.prototype.writeFloatBE=function(w,y,L){return X(this,w,y,!1,L)};function fe(B,w,y,L,Q){return w=+w,y=y>>>0,Q||U(B,w,y,8),r.write(B,w,y,L,52,8),y+8}a.prototype.writeDoubleLE=function(w,y,L){return fe(this,w,y,!0,L)},a.prototype.writeDoubleBE=function(w,y,L){return fe(this,w,y,!1,L)},a.prototype.copy=function(w,y,L,Q){if(!a.isBuffer(w))throw new TypeError("argument should be a Buffer");if(L||(L=0),!Q&&Q!==0&&(Q=this.length),y>=w.length&&(y=w.length),y||(y=0),Q>0&&Q<L&&(Q=L),Q===L||w.length===0||this.length===0)return 0;if(y<0)throw new RangeError("targetStart out of bounds");if(L<0||L>=this.length)throw new RangeError("Index out of range");if(Q<0)throw new RangeError("sourceEnd out of bounds");Q>this.length&&(Q=this.length),w.length-y<Q-L&&(Q=w.length-y+L);const ne=Q-L;return this===w&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(y,L,Q):Uint8Array.prototype.set.call(w,this.subarray(L,Q),y),ne},a.prototype.fill=function(w,y,L,Q){if(typeof w=="string"){if(typeof y=="string"?(Q=y,y=0,L=this.length):typeof L=="string"&&(Q=L,L=this.length),Q!==void 0&&typeof Q!="string")throw new TypeError("encoding must be a string");if(typeof Q=="string"&&!a.isEncoding(Q))throw new TypeError("Unknown encoding: "+Q);if(w.length===1){const he=w.charCodeAt(0);(Q==="utf8"&&he<128||Q==="latin1")&&(w=he)}}else typeof w=="number"?w=w&255:typeof w=="boolean"&&(w=Number(w));if(y<0||this.length<y||this.length<L)throw new RangeError("Out of range index");if(L<=y)return this;y=y>>>0,L=L===void 0?this.length:L>>>0,w||(w=0);let ne;if(typeof w=="number")for(ne=y;ne<L;++ne)this[ne]=w;else{const he=a.isBuffer(w)?w:a.from(w,Q),Ze=he.length;if(Ze===0)throw new TypeError('The value "'+w+'" is invalid for argument "value"');for(ne=0;ne<L-y;++ne)this[ne+y]=he[ne%Ze]}return this};const Ee={};function _e(B,w,y){Ee[B]=class extends y{constructor(){super(),Object.defineProperty(this,"message",{value:w.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${B}]`,this.stack,delete this.name}get code(){return B}set code(Q){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Q,writable:!0})}toString(){return`${this.name} [${B}]: ${this.message}`}}}_e("ERR_BUFFER_OUT_OF_BOUNDS",function(B){return B?`${B} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),_e("ERR_INVALID_ARG_TYPE",function(B,w){return`The "${B}" argument must be of type number. Received type ${typeof w}`},TypeError),_e("ERR_OUT_OF_RANGE",function(B,w,y){let L=`The value of "${B}" is out of range.`,Q=y;return Number.isInteger(y)&&Math.abs(y)>2**32?Q=Xe(String(y)):typeof y=="bigint"&&(Q=String(y),(y>BigInt(2)**BigInt(32)||y<-(BigInt(2)**BigInt(32)))&&(Q=Xe(Q)),Q+="n"),L+=` It must be ${w}. Received ${Q}`,L},RangeError);function Xe(B){let w="",y=B.length;const L=B[0]==="-"?1:0;for(;y>=L+4;y-=3)w=`_${B.slice(y-3,y)}${w}`;return`${B.slice(0,y)}${w}`}function dt(B,w,y){Zt(w,"offset"),(B[w]===void 0||B[w+y]===void 0)&&bt(w,B.length-(y+1))}function Qe(B,w,y,L,Q,ne){if(B>y||B<w){const he=typeof w=="bigint"?"n":"";let Ze;throw w===0||w===BigInt(0)?Ze=`>= 0${he} and < 2${he} ** ${(ne+1)*8}${he}`:Ze=`>= -(2${he} ** ${(ne+1)*8-1}${he}) and < 2 ** ${(ne+1)*8-1}${he}`,new Ee.ERR_OUT_OF_RANGE("value",Ze,B)}dt(L,Q,ne)}function Zt(B,w){if(typeof B!="number")throw new Ee.ERR_INVALID_ARG_TYPE(w,"number",B)}function bt(B,w,y){throw Math.floor(B)!==B?(Zt(B,y),new Ee.ERR_OUT_OF_RANGE("offset","an integer",B)):w<0?new Ee.ERR_BUFFER_OUT_OF_BOUNDS:new Ee.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${w}`,B)}const kt=/[^+/0-9A-Za-z-_]/g;function Pn(B){if(B=B.split("=")[0],B=B.trim().replace(kt,""),B.length<2)return"";for(;B.length%4!==0;)B=B+"=";return B}function Nt(B,w){w=w||1/0;let y;const L=B.length;let Q=null;const ne=[];for(let he=0;he<L;++he){if(y=B.charCodeAt(he),y>55295&&y<57344){if(!Q){if(y>56319){(w-=3)>-1&&ne.push(239,191,189);continue}else if(he+1===L){(w-=3)>-1&&ne.push(239,191,189);continue}Q=y;continue}if(y<56320){(w-=3)>-1&&ne.push(239,191,189),Q=y;continue}y=(Q-55296<<10|y-56320)+65536}else Q&&(w-=3)>-1&&ne.push(239,191,189);if(Q=null,y<128){if((w-=1)<0)break;ne.push(y)}else if(y<2048){if((w-=2)<0)break;ne.push(y>>6|192,y&63|128)}else if(y<65536){if((w-=3)<0)break;ne.push(y>>12|224,y>>6&63|128,y&63|128)}else if(y<1114112){if((w-=4)<0)break;ne.push(y>>18|240,y>>12&63|128,y>>6&63|128,y&63|128)}else throw new Error("Invalid code point")}return ne}function Kt(B){const w=[];for(let y=0;y<B.length;++y)w.push(B.charCodeAt(y)&255);return w}function nn(B,w){let y,L,Q;const ne=[];for(let he=0;he<B.length&&!((w-=2)<0);++he)y=B.charCodeAt(he),L=y>>8,Q=y%256,ne.push(Q),ne.push(L);return ne}function Rt(B){return e.toByteArray(Pn(B))}function Bt(B,w,y,L){let Q;for(Q=0;Q<L&&!(Q+y>=w.length||Q>=B.length);++Q)w[Q+y]=B[Q];return Q}function mr(B,w){return B instanceof w||B!=null&&B.constructor!=null&&B.constructor.name!=null&&B.constructor.name===w.name}function Tt(B){return B!==B}const Ot=(function(){const B="0123456789abcdef",w=new Array(256);for(let y=0;y<16;++y){const L=y*16;for(let Q=0;Q<16;++Q)w[L+Q]=B[y]+B[Q]}return w})();function Ur(B){return typeof BigInt>"u"?Mt:B}function Mt(){throw new Error("BigInt not supported")}})(pc)),pc}var je=iu(),rr=(t=>(t.SOLANA_MAINNET="solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",t.SOLANA_DEVNET="solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1",t.SOLANA_TESTNET="solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z",t.ETHEREUM_MAINNET="eip155:1",t.ETHEREUM_SEPOLIA="eip155:11155111",t.POLYGON_MAINNET="eip155:137",t.POLYGON_AMOY="eip155:80002",t.BASE_MAINNET="eip155:8453",t.BASE_SEPOLIA="eip155:84532",t.ARBITRUM_ONE="eip155:42161",t.ARBITRUM_SEPOLIA="eip155:421614",t.MONAD_MAINNET="eip155:143",t.MONAD_TESTNET="eip155:10143",t.BITCOIN_MAINNET="bip122:000000000019d6689c085ae165831e93",t.BITCOIN_TESTNET="bip122:000000000933ea01ad0ee984209779ba",t.SUI_MAINNET="sui:35834a8a",t.SUI_TESTNET="sui:4c78adac",t.SUI_DEVNET="sui:devnet",t))(rr||{}),Gs={"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":{name:"Solana Mainnet",chain:"solana",network:"mainnet",internalCaip:"solana:101",slip44:"501",explorer:{name:"Solscan",transactionUrl:"https://solscan.io/tx/{hash}",addressUrl:"https://solscan.io/account/{address}"}},"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1":{name:"Solana Devnet",chain:"solana",network:"devnet",internalCaip:"solana:103",slip44:"501",explorer:{name:"Solscan",transactionUrl:"https://solscan.io/tx/{hash}?cluster=devnet",addressUrl:"https://solscan.io/account/{address}?cluster=devnet"}},"solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":{name:"Solana Testnet",chain:"solana",network:"testnet",internalCaip:"solana:102",slip44:"501",explorer:{name:"Solscan",transactionUrl:"https://solscan.io/tx/{hash}?cluster=testnet",addressUrl:"https://solscan.io/account/{address}?cluster=testnet"}},"eip155:1":{name:"Ethereum Mainnet",chain:"ethereum",network:"mainnet",internalCaip:"eip155:1",chainId:1,slip44:"60",explorer:{name:"Etherscan",transactionUrl:"https://etherscan.io/tx/{hash}",addressUrl:"https://etherscan.io/address/{address}"}},"eip155:11155111":{name:"Ethereum Sepolia",chain:"ethereum",network:"sepolia",internalCaip:"eip155:11155111",chainId:11155111,slip44:"60",explorer:{name:"Etherscan",transactionUrl:"https://sepolia.etherscan.io/tx/{hash}",addressUrl:"https://sepolia.etherscan.io/address/{address}"}},"eip155:137":{name:"Polygon Mainnet",chain:"polygon",network:"mainnet",internalCaip:"eip155:137",chainId:137,slip44:"137",explorer:{name:"Polygonscan",transactionUrl:"https://polygonscan.com/tx/{hash}",addressUrl:"https://polygonscan.com/address/{address}"}},"eip155:80002":{name:"Polygon Amoy",chain:"polygon",network:"amoy",internalCaip:"eip155:80002",chainId:80002,slip44:"137",explorer:{name:"Polygonscan",transactionUrl:"https://amoy.polygonscan.com/tx/{hash}",addressUrl:"https://amoy.polygonscan.com/address/{address}"}},"eip155:8453":{name:"Base Mainnet",chain:"base",network:"mainnet",internalCaip:"eip155:8453",chainId:8453,slip44:"8453",explorer:{name:"Basescan",transactionUrl:"https://basescan.org/tx/{hash}",addressUrl:"https://basescan.org/address/{address}"}},"eip155:84532":{name:"Base Sepolia",chain:"base",network:"sepolia",internalCaip:"eip155:84532",chainId:84532,slip44:"8453",explorer:{name:"Basescan",transactionUrl:"https://sepolia.basescan.org/tx/{hash}",addressUrl:"https://sepolia.basescan.org/address/{address}"}},"eip155:42161":{name:"Arbitrum One",chain:"arbitrum",network:"mainnet",internalCaip:"eip155:42161",chainId:42161,slip44:"42161",explorer:{name:"Arbiscan",transactionUrl:"https://arbiscan.io/tx/{hash}",addressUrl:"https://arbiscan.io/address/{address}"}},"eip155:421614":{name:"Arbitrum Sepolia",chain:"arbitrum",network:"sepolia",internalCaip:"eip155:421614",chainId:421614,slip44:"42161",explorer:{name:"Arbiscan",transactionUrl:"https://sepolia.arbiscan.io/tx/{hash}",addressUrl:"https://sepolia.arbiscan.io/address/{address}"}},"eip155:143":{name:"Monad Mainnet",chain:"monad",network:"mainnet",internalCaip:"eip155:143",chainId:143,slip44:"60",explorer:{name:"Monad Explorer",transactionUrl:"https://monadexplorer.com/tx/{hash}",addressUrl:"https://monadexplorer.com/address/{address}"}},"eip155:10143":{name:"Monad Testnet",chain:"monad",network:"testnet",internalCaip:"eip155:10143",chainId:10143,slip44:"60",explorer:{name:"Monad Testnet Explorer",transactionUrl:"https://testnet.monadexplorer.com/tx/{hash}",addressUrl:"https://testnet.monadexplorer.com/address/{address}"}},"bip122:000000000019d6689c085ae165831e93":{name:"Bitcoin Mainnet",chain:"bitcoin",network:"mainnet",internalCaip:"bip122:000000000019d6689c085ae165831e93",slip44:"0",explorer:{name:"Blockstream",transactionUrl:"https://blockstream.info/tx/{hash}",addressUrl:"https://blockstream.info/address/{address}"}},"bip122:000000000933ea01ad0ee984209779ba":{name:"Bitcoin Testnet",chain:"bitcoin",network:"testnet",internalCaip:"bip122:000000000933ea01ad0ee984209779ba",slip44:"0",explorer:{name:"Blockstream",transactionUrl:"https://blockstream.info/testnet/tx/{hash}",addressUrl:"https://blockstream.info/testnet/address/{address}"}},"sui:35834a8a":{name:"Sui Mainnet",chain:"sui",network:"mainnet",internalCaip:"sui:mainnet",slip44:"784",explorer:{name:"Sui Explorer",transactionUrl:"https://explorer.sui.io/txblock/{hash}?network=mainnet",addressUrl:"https://explorer.sui.io/address/{address}?network=mainnet"}},"sui:4c78adac":{name:"Sui Testnet",chain:"sui",network:"testnet",internalCaip:"sui:testnet",slip44:"784",explorer:{name:"Sui Explorer",transactionUrl:"https://explorer.sui.io/txblock/{hash}?network=testnet",addressUrl:"https://explorer.sui.io/address/{address}?network=testnet"}},"sui:devnet":{name:"Sui Devnet",chain:"sui",network:"devnet",internalCaip:"sui:devnet",slip44:"784",explorer:{name:"Sui Explorer",transactionUrl:"https://explorer.sui.io/txblock/{hash}?network=devnet",addressUrl:"https://explorer.sui.io/address/{address}?network=devnet"}}};function by(t){return Gs[t]}function vy(t,e,r){const n=by(t);return n?.explorer?n.explorer.transactionUrl.replace("{hash}",r):void 0}function Ho(t){return Object.keys(Gs).find(e=>Gs[e].chainId===t)}function gc(t){return Gs[t]?.chainId}function Ey(t){const e=Gs[t];if(!e||!e.internalCaip)throw new Error(`No internal CAIP mapping found for NetworkId: ${t}`);return e.internalCaip}function Ha(t){const e=Object.keys(Gs).find(r=>Gs[r].internalCaip===t);if(!e)throw new Error(`No NetworkId mapping found for internal CAIP: ${t}`);return e}var ui={SDK_TYPE:"x-phantom-sdk-type",SDK_VERSION:"x-phantom-sdk-version",PLATFORM:"x-phantom-platform",WALLET_TYPE:"x-phantom-wallet-type",APP_ID:"x-app-id",PLATFORM_VERSION:"x-phantom-platform-version"},n0="https://connect.phantom.app/login",xy="https://api.phantom.app/v1/wallets",s0="user-wallet";function i0(){return typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}var ao=class{constructor(){this.cache=null,this.CACHE_DURATION=3e4,this.TIME_API_URL="https://time.phantom.app/utc"}static getInstance(){return ao.instance||(ao.instance=new ao),ao.instance}async now(){const t=Date.now();if(this.cache&&t-this.cache.fetchedAt<this.CACHE_DURATION){const e=t-this.cache.fetchedAt;return this.cache.timestamp+e}try{const e=await fetch(this.TIME_API_URL);if(!e.ok)throw new Error(`Time API responded with status: ${e.status}`);const r=await e.text(),n=parseInt(r,10);if(isNaN(n))throw new Error(`Invalid timestamp received: ${r}`);return this.cache={timestamp:n,fetchedAt:t},n}catch{return Date.now()}}nowSync(){if(this.cache){const t=Date.now()-this.cache.fetchedAt;if(t<this.CACHE_DURATION)return this.cache.timestamp+t}return Date.now()}clearCache(){this.cache=null}},_y=ao.getInstance(),zr=()=>_y.now();function o0(t){return t.split(":")[0].toLowerCase()}function Al(t){return o0(t)==="eip155"}function Iy(t){return o0(t)==="solana"}function Sy(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var wc={exports:{}};const Ay={},Ry=Object.freeze(Object.defineProperty({__proto__:null,default:Ay},Symbol.toStringTag,{value:"Module"})),a0=su(Ry);var wf;function By(){return wf||(wf=1,(function(t){(function(e){var r=function(E){var T,C=new Float64Array(16);if(E)for(T=0;T<E.length;T++)C[T]=E[T];return C},n=function(){throw new Error("no PRNG")},s=new Uint8Array(16),i=new Uint8Array(32);i[0]=9;var o=r(),a=r([1]),c=r([56129,1]),l=r([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),g=r([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),m=r([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),I=r([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),_=r([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function b(E,T,C,h){E[T]=C>>24&255,E[T+1]=C>>16&255,E[T+2]=C>>8&255,E[T+3]=C&255,E[T+4]=h>>24&255,E[T+5]=h>>16&255,E[T+6]=h>>8&255,E[T+7]=h&255}function v(E,T,C,h,N){var re,ee=0;for(re=0;re<N;re++)ee|=E[T+re]^C[h+re];return(1&ee-1>>>8)-1}function S(E,T,C,h){return v(E,T,C,h,16)}function O(E,T,C,h){return v(E,T,C,h,32)}function $(E,T,C,h){for(var N=h[0]&255|(h[1]&255)<<8|(h[2]&255)<<16|(h[3]&255)<<24,re=C[0]&255|(C[1]&255)<<8|(C[2]&255)<<16|(C[3]&255)<<24,ee=C[4]&255|(C[5]&255)<<8|(C[6]&255)<<16|(C[7]&255)<<24,de=C[8]&255|(C[9]&255)<<8|(C[10]&255)<<16|(C[11]&255)<<24,be=C[12]&255|(C[13]&255)<<8|(C[14]&255)<<16|(C[15]&255)<<24,Ie=h[4]&255|(h[5]&255)<<8|(h[6]&255)<<16|(h[7]&255)<<24,ve=T[0]&255|(T[1]&255)<<8|(T[2]&255)<<16|(T[3]&255)<<24,ft=T[4]&255|(T[5]&255)<<8|(T[6]&255)<<16|(T[7]&255)<<24,Pe=T[8]&255|(T[9]&255)<<8|(T[10]&255)<<16|(T[11]&255)<<24,Ke=T[12]&255|(T[13]&255)<<8|(T[14]&255)<<16|(T[15]&255)<<24,Ve=h[8]&255|(h[9]&255)<<8|(h[10]&255)<<16|(h[11]&255)<<24,Ye=C[16]&255|(C[17]&255)<<8|(C[18]&255)<<16|(C[19]&255)<<24,Je=C[20]&255|(C[21]&255)<<8|(C[22]&255)<<16|(C[23]&255)<<24,qe=C[24]&255|(C[25]&255)<<8|(C[26]&255)<<16|(C[27]&255)<<24,He=C[28]&255|(C[29]&255)<<8|(C[30]&255)<<16|(C[31]&255)<<24,We=h[12]&255|(h[13]&255)<<8|(h[14]&255)<<16|(h[15]&255)<<24,De=N,Oe=re,Be=ee,ke=de,Ne=be,Ae=Ie,ce=ve,le=ft,we=Pe,pe=Ke,ge=Ve,ye=Ye,Fe=Je,et=qe,nt=He,tt=We,H,lt=0;lt<20;lt+=2)H=De+Fe|0,Ne^=H<<7|H>>>25,H=Ne+De|0,we^=H<<9|H>>>23,H=we+Ne|0,Fe^=H<<13|H>>>19,H=Fe+we|0,De^=H<<18|H>>>14,H=Ae+Oe|0,pe^=H<<7|H>>>25,H=pe+Ae|0,et^=H<<9|H>>>23,H=et+pe|0,Oe^=H<<13|H>>>19,H=Oe+et|0,Ae^=H<<18|H>>>14,H=ge+ce|0,nt^=H<<7|H>>>25,H=nt+ge|0,Be^=H<<9|H>>>23,H=Be+nt|0,ce^=H<<13|H>>>19,H=ce+Be|0,ge^=H<<18|H>>>14,H=tt+ye|0,ke^=H<<7|H>>>25,H=ke+tt|0,le^=H<<9|H>>>23,H=le+ke|0,ye^=H<<13|H>>>19,H=ye+le|0,tt^=H<<18|H>>>14,H=De+ke|0,Oe^=H<<7|H>>>25,H=Oe+De|0,Be^=H<<9|H>>>23,H=Be+Oe|0,ke^=H<<13|H>>>19,H=ke+Be|0,De^=H<<18|H>>>14,H=Ae+Ne|0,ce^=H<<7|H>>>25,H=ce+Ae|0,le^=H<<9|H>>>23,H=le+ce|0,Ne^=H<<13|H>>>19,H=Ne+le|0,Ae^=H<<18|H>>>14,H=ge+pe|0,ye^=H<<7|H>>>25,H=ye+ge|0,we^=H<<9|H>>>23,H=we+ye|0,pe^=H<<13|H>>>19,H=pe+we|0,ge^=H<<18|H>>>14,H=tt+nt|0,Fe^=H<<7|H>>>25,H=Fe+tt|0,et^=H<<9|H>>>23,H=et+Fe|0,nt^=H<<13|H>>>19,H=nt+et|0,tt^=H<<18|H>>>14;De=De+N|0,Oe=Oe+re|0,Be=Be+ee|0,ke=ke+de|0,Ne=Ne+be|0,Ae=Ae+Ie|0,ce=ce+ve|0,le=le+ft|0,we=we+Pe|0,pe=pe+Ke|0,ge=ge+Ve|0,ye=ye+Ye|0,Fe=Fe+Je|0,et=et+qe|0,nt=nt+He|0,tt=tt+We|0,E[0]=De>>>0&255,E[1]=De>>>8&255,E[2]=De>>>16&255,E[3]=De>>>24&255,E[4]=Oe>>>0&255,E[5]=Oe>>>8&255,E[6]=Oe>>>16&255,E[7]=Oe>>>24&255,E[8]=Be>>>0&255,E[9]=Be>>>8&255,E[10]=Be>>>16&255,E[11]=Be>>>24&255,E[12]=ke>>>0&255,E[13]=ke>>>8&255,E[14]=ke>>>16&255,E[15]=ke>>>24&255,E[16]=Ne>>>0&255,E[17]=Ne>>>8&255,E[18]=Ne>>>16&255,E[19]=Ne>>>24&255,E[20]=Ae>>>0&255,E[21]=Ae>>>8&255,E[22]=Ae>>>16&255,E[23]=Ae>>>24&255,E[24]=ce>>>0&255,E[25]=ce>>>8&255,E[26]=ce>>>16&255,E[27]=ce>>>24&255,E[28]=le>>>0&255,E[29]=le>>>8&255,E[30]=le>>>16&255,E[31]=le>>>24&255,E[32]=we>>>0&255,E[33]=we>>>8&255,E[34]=we>>>16&255,E[35]=we>>>24&255,E[36]=pe>>>0&255,E[37]=pe>>>8&255,E[38]=pe>>>16&255,E[39]=pe>>>24&255,E[40]=ge>>>0&255,E[41]=ge>>>8&255,E[42]=ge>>>16&255,E[43]=ge>>>24&255,E[44]=ye>>>0&255,E[45]=ye>>>8&255,E[46]=ye>>>16&255,E[47]=ye>>>24&255,E[48]=Fe>>>0&255,E[49]=Fe>>>8&255,E[50]=Fe>>>16&255,E[51]=Fe>>>24&255,E[52]=et>>>0&255,E[53]=et>>>8&255,E[54]=et>>>16&255,E[55]=et>>>24&255,E[56]=nt>>>0&255,E[57]=nt>>>8&255,E[58]=nt>>>16&255,E[59]=nt>>>24&255,E[60]=tt>>>0&255,E[61]=tt>>>8&255,E[62]=tt>>>16&255,E[63]=tt>>>24&255}function k(E,T,C,h){for(var N=h[0]&255|(h[1]&255)<<8|(h[2]&255)<<16|(h[3]&255)<<24,re=C[0]&255|(C[1]&255)<<8|(C[2]&255)<<16|(C[3]&255)<<24,ee=C[4]&255|(C[5]&255)<<8|(C[6]&255)<<16|(C[7]&255)<<24,de=C[8]&255|(C[9]&255)<<8|(C[10]&255)<<16|(C[11]&255)<<24,be=C[12]&255|(C[13]&255)<<8|(C[14]&255)<<16|(C[15]&255)<<24,Ie=h[4]&255|(h[5]&255)<<8|(h[6]&255)<<16|(h[7]&255)<<24,ve=T[0]&255|(T[1]&255)<<8|(T[2]&255)<<16|(T[3]&255)<<24,ft=T[4]&255|(T[5]&255)<<8|(T[6]&255)<<16|(T[7]&255)<<24,Pe=T[8]&255|(T[9]&255)<<8|(T[10]&255)<<16|(T[11]&255)<<24,Ke=T[12]&255|(T[13]&255)<<8|(T[14]&255)<<16|(T[15]&255)<<24,Ve=h[8]&255|(h[9]&255)<<8|(h[10]&255)<<16|(h[11]&255)<<24,Ye=C[16]&255|(C[17]&255)<<8|(C[18]&255)<<16|(C[19]&255)<<24,Je=C[20]&255|(C[21]&255)<<8|(C[22]&255)<<16|(C[23]&255)<<24,qe=C[24]&255|(C[25]&255)<<8|(C[26]&255)<<16|(C[27]&255)<<24,He=C[28]&255|(C[29]&255)<<8|(C[30]&255)<<16|(C[31]&255)<<24,We=h[12]&255|(h[13]&255)<<8|(h[14]&255)<<16|(h[15]&255)<<24,De=N,Oe=re,Be=ee,ke=de,Ne=be,Ae=Ie,ce=ve,le=ft,we=Pe,pe=Ke,ge=Ve,ye=Ye,Fe=Je,et=qe,nt=He,tt=We,H,lt=0;lt<20;lt+=2)H=De+Fe|0,Ne^=H<<7|H>>>25,H=Ne+De|0,we^=H<<9|H>>>23,H=we+Ne|0,Fe^=H<<13|H>>>19,H=Fe+we|0,De^=H<<18|H>>>14,H=Ae+Oe|0,pe^=H<<7|H>>>25,H=pe+Ae|0,et^=H<<9|H>>>23,H=et+pe|0,Oe^=H<<13|H>>>19,H=Oe+et|0,Ae^=H<<18|H>>>14,H=ge+ce|0,nt^=H<<7|H>>>25,H=nt+ge|0,Be^=H<<9|H>>>23,H=Be+nt|0,ce^=H<<13|H>>>19,H=ce+Be|0,ge^=H<<18|H>>>14,H=tt+ye|0,ke^=H<<7|H>>>25,H=ke+tt|0,le^=H<<9|H>>>23,H=le+ke|0,ye^=H<<13|H>>>19,H=ye+le|0,tt^=H<<18|H>>>14,H=De+ke|0,Oe^=H<<7|H>>>25,H=Oe+De|0,Be^=H<<9|H>>>23,H=Be+Oe|0,ke^=H<<13|H>>>19,H=ke+Be|0,De^=H<<18|H>>>14,H=Ae+Ne|0,ce^=H<<7|H>>>25,H=ce+Ae|0,le^=H<<9|H>>>23,H=le+ce|0,Ne^=H<<13|H>>>19,H=Ne+le|0,Ae^=H<<18|H>>>14,H=ge+pe|0,ye^=H<<7|H>>>25,H=ye+ge|0,we^=H<<9|H>>>23,H=we+ye|0,pe^=H<<13|H>>>19,H=pe+we|0,ge^=H<<18|H>>>14,H=tt+nt|0,Fe^=H<<7|H>>>25,H=Fe+tt|0,et^=H<<9|H>>>23,H=et+Fe|0,nt^=H<<13|H>>>19,H=nt+et|0,tt^=H<<18|H>>>14;E[0]=De>>>0&255,E[1]=De>>>8&255,E[2]=De>>>16&255,E[3]=De>>>24&255,E[4]=Ae>>>0&255,E[5]=Ae>>>8&255,E[6]=Ae>>>16&255,E[7]=Ae>>>24&255,E[8]=ge>>>0&255,E[9]=ge>>>8&255,E[10]=ge>>>16&255,E[11]=ge>>>24&255,E[12]=tt>>>0&255,E[13]=tt>>>8&255,E[14]=tt>>>16&255,E[15]=tt>>>24&255,E[16]=ce>>>0&255,E[17]=ce>>>8&255,E[18]=ce>>>16&255,E[19]=ce>>>24&255,E[20]=le>>>0&255,E[21]=le>>>8&255,E[22]=le>>>16&255,E[23]=le>>>24&255,E[24]=we>>>0&255,E[25]=we>>>8&255,E[26]=we>>>16&255,E[27]=we>>>24&255,E[28]=pe>>>0&255,E[29]=pe>>>8&255,E[30]=pe>>>16&255,E[31]=pe>>>24&255}function Z(E,T,C,h){$(E,T,C,h)}function q(E,T,C,h){k(E,T,C,h)}var J=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function se(E,T,C,h,N,re,ee){var de=new Uint8Array(16),be=new Uint8Array(64),Ie,ve;for(ve=0;ve<16;ve++)de[ve]=0;for(ve=0;ve<8;ve++)de[ve]=re[ve];for(;N>=64;){for(Z(be,de,ee,J),ve=0;ve<64;ve++)E[T+ve]=C[h+ve]^be[ve];for(Ie=1,ve=8;ve<16;ve++)Ie=Ie+(de[ve]&255)|0,de[ve]=Ie&255,Ie>>>=8;N-=64,T+=64,h+=64}if(N>0)for(Z(be,de,ee,J),ve=0;ve<N;ve++)E[T+ve]=C[h+ve]^be[ve];return 0}function oe(E,T,C,h,N){var re=new Uint8Array(16),ee=new Uint8Array(64),de,be;for(be=0;be<16;be++)re[be]=0;for(be=0;be<8;be++)re[be]=h[be];for(;C>=64;){for(Z(ee,re,N,J),be=0;be<64;be++)E[T+be]=ee[be];for(de=1,be=8;be<16;be++)de=de+(re[be]&255)|0,re[be]=de&255,de>>>=8;C-=64,T+=64}if(C>0)for(Z(ee,re,N,J),be=0;be<C;be++)E[T+be]=ee[be];return 0}function V(E,T,C,h,N){var re=new Uint8Array(32);q(re,h,N,J);for(var ee=new Uint8Array(8),de=0;de<8;de++)ee[de]=h[de+16];return oe(E,T,C,ee,re)}function W(E,T,C,h,N,re,ee){var de=new Uint8Array(32);q(de,re,ee,J);for(var be=new Uint8Array(8),Ie=0;Ie<8;Ie++)be[Ie]=re[Ie+16];return se(E,T,C,h,N,be,de)}var Y=function(E){this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0;var T,C,h,N,re,ee,de,be;T=E[0]&255|(E[1]&255)<<8,this.r[0]=T&8191,C=E[2]&255|(E[3]&255)<<8,this.r[1]=(T>>>13|C<<3)&8191,h=E[4]&255|(E[5]&255)<<8,this.r[2]=(C>>>10|h<<6)&7939,N=E[6]&255|(E[7]&255)<<8,this.r[3]=(h>>>7|N<<9)&8191,re=E[8]&255|(E[9]&255)<<8,this.r[4]=(N>>>4|re<<12)&255,this.r[5]=re>>>1&8190,ee=E[10]&255|(E[11]&255)<<8,this.r[6]=(re>>>14|ee<<2)&8191,de=E[12]&255|(E[13]&255)<<8,this.r[7]=(ee>>>11|de<<5)&8065,be=E[14]&255|(E[15]&255)<<8,this.r[8]=(de>>>8|be<<8)&8191,this.r[9]=be>>>5&127,this.pad[0]=E[16]&255|(E[17]&255)<<8,this.pad[1]=E[18]&255|(E[19]&255)<<8,this.pad[2]=E[20]&255|(E[21]&255)<<8,this.pad[3]=E[22]&255|(E[23]&255)<<8,this.pad[4]=E[24]&255|(E[25]&255)<<8,this.pad[5]=E[26]&255|(E[27]&255)<<8,this.pad[6]=E[28]&255|(E[29]&255)<<8,this.pad[7]=E[30]&255|(E[31]&255)<<8};Y.prototype.blocks=function(E,T,C){for(var h=this.fin?0:2048,N,re,ee,de,be,Ie,ve,ft,Pe,Ke,Ve,Ye,Je,qe,He,We,De,Oe,Be,ke=this.h[0],Ne=this.h[1],Ae=this.h[2],ce=this.h[3],le=this.h[4],we=this.h[5],pe=this.h[6],ge=this.h[7],ye=this.h[8],Fe=this.h[9],et=this.r[0],nt=this.r[1],tt=this.r[2],H=this.r[3],lt=this.r[4],vt=this.r[5],Et=this.r[6],it=this.r[7],mt=this.r[8],yt=this.r[9];C>=16;)N=E[T+0]&255|(E[T+1]&255)<<8,ke+=N&8191,re=E[T+2]&255|(E[T+3]&255)<<8,Ne+=(N>>>13|re<<3)&8191,ee=E[T+4]&255|(E[T+5]&255)<<8,Ae+=(re>>>10|ee<<6)&8191,de=E[T+6]&255|(E[T+7]&255)<<8,ce+=(ee>>>7|de<<9)&8191,be=E[T+8]&255|(E[T+9]&255)<<8,le+=(de>>>4|be<<12)&8191,we+=be>>>1&8191,Ie=E[T+10]&255|(E[T+11]&255)<<8,pe+=(be>>>14|Ie<<2)&8191,ve=E[T+12]&255|(E[T+13]&255)<<8,ge+=(Ie>>>11|ve<<5)&8191,ft=E[T+14]&255|(E[T+15]&255)<<8,ye+=(ve>>>8|ft<<8)&8191,Fe+=ft>>>5|h,Pe=0,Ke=Pe,Ke+=ke*et,Ke+=Ne*(5*yt),Ke+=Ae*(5*mt),Ke+=ce*(5*it),Ke+=le*(5*Et),Pe=Ke>>>13,Ke&=8191,Ke+=we*(5*vt),Ke+=pe*(5*lt),Ke+=ge*(5*H),Ke+=ye*(5*tt),Ke+=Fe*(5*nt),Pe+=Ke>>>13,Ke&=8191,Ve=Pe,Ve+=ke*nt,Ve+=Ne*et,Ve+=Ae*(5*yt),Ve+=ce*(5*mt),Ve+=le*(5*it),Pe=Ve>>>13,Ve&=8191,Ve+=we*(5*Et),Ve+=pe*(5*vt),Ve+=ge*(5*lt),Ve+=ye*(5*H),Ve+=Fe*(5*tt),Pe+=Ve>>>13,Ve&=8191,Ye=Pe,Ye+=ke*tt,Ye+=Ne*nt,Ye+=Ae*et,Ye+=ce*(5*yt),Ye+=le*(5*mt),Pe=Ye>>>13,Ye&=8191,Ye+=we*(5*it),Ye+=pe*(5*Et),Ye+=ge*(5*vt),Ye+=ye*(5*lt),Ye+=Fe*(5*H),Pe+=Ye>>>13,Ye&=8191,Je=Pe,Je+=ke*H,Je+=Ne*tt,Je+=Ae*nt,Je+=ce*et,Je+=le*(5*yt),Pe=Je>>>13,Je&=8191,Je+=we*(5*mt),Je+=pe*(5*it),Je+=ge*(5*Et),Je+=ye*(5*vt),Je+=Fe*(5*lt),Pe+=Je>>>13,Je&=8191,qe=Pe,qe+=ke*lt,qe+=Ne*H,qe+=Ae*tt,qe+=ce*nt,qe+=le*et,Pe=qe>>>13,qe&=8191,qe+=we*(5*yt),qe+=pe*(5*mt),qe+=ge*(5*it),qe+=ye*(5*Et),qe+=Fe*(5*vt),Pe+=qe>>>13,qe&=8191,He=Pe,He+=ke*vt,He+=Ne*lt,He+=Ae*H,He+=ce*tt,He+=le*nt,Pe=He>>>13,He&=8191,He+=we*et,He+=pe*(5*yt),He+=ge*(5*mt),He+=ye*(5*it),He+=Fe*(5*Et),Pe+=He>>>13,He&=8191,We=Pe,We+=ke*Et,We+=Ne*vt,We+=Ae*lt,We+=ce*H,We+=le*tt,Pe=We>>>13,We&=8191,We+=we*nt,We+=pe*et,We+=ge*(5*yt),We+=ye*(5*mt),We+=Fe*(5*it),Pe+=We>>>13,We&=8191,De=Pe,De+=ke*it,De+=Ne*Et,De+=Ae*vt,De+=ce*lt,De+=le*H,Pe=De>>>13,De&=8191,De+=we*tt,De+=pe*nt,De+=ge*et,De+=ye*(5*yt),De+=Fe*(5*mt),Pe+=De>>>13,De&=8191,Oe=Pe,Oe+=ke*mt,Oe+=Ne*it,Oe+=Ae*Et,Oe+=ce*vt,Oe+=le*lt,Pe=Oe>>>13,Oe&=8191,Oe+=we*H,Oe+=pe*tt,Oe+=ge*nt,Oe+=ye*et,Oe+=Fe*(5*yt),Pe+=Oe>>>13,Oe&=8191,Be=Pe,Be+=ke*yt,Be+=Ne*mt,Be+=Ae*it,Be+=ce*Et,Be+=le*vt,Pe=Be>>>13,Be&=8191,Be+=we*lt,Be+=pe*H,Be+=ge*tt,Be+=ye*nt,Be+=Fe*et,Pe+=Be>>>13,Be&=8191,Pe=(Pe<<2)+Pe|0,Pe=Pe+Ke|0,Ke=Pe&8191,Pe=Pe>>>13,Ve+=Pe,ke=Ke,Ne=Ve,Ae=Ye,ce=Je,le=qe,we=He,pe=We,ge=De,ye=Oe,Fe=Be,T+=16,C-=16;this.h[0]=ke,this.h[1]=Ne,this.h[2]=Ae,this.h[3]=ce,this.h[4]=le,this.h[5]=we,this.h[6]=pe,this.h[7]=ge,this.h[8]=ye,this.h[9]=Fe},Y.prototype.finish=function(E,T){var C=new Uint16Array(10),h,N,re,ee;if(this.leftover){for(ee=this.leftover,this.buffer[ee++]=1;ee<16;ee++)this.buffer[ee]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(h=this.h[1]>>>13,this.h[1]&=8191,ee=2;ee<10;ee++)this.h[ee]+=h,h=this.h[ee]>>>13,this.h[ee]&=8191;for(this.h[0]+=h*5,h=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=h,h=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=h,C[0]=this.h[0]+5,h=C[0]>>>13,C[0]&=8191,ee=1;ee<10;ee++)C[ee]=this.h[ee]+h,h=C[ee]>>>13,C[ee]&=8191;for(C[9]-=8192,N=(h^1)-1,ee=0;ee<10;ee++)C[ee]&=N;for(N=~N,ee=0;ee<10;ee++)this.h[ee]=this.h[ee]&N|C[ee];for(this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,re=this.h[0]+this.pad[0],this.h[0]=re&65535,ee=1;ee<8;ee++)re=(this.h[ee]+this.pad[ee]|0)+(re>>>16)|0,this.h[ee]=re&65535;E[T+0]=this.h[0]>>>0&255,E[T+1]=this.h[0]>>>8&255,E[T+2]=this.h[1]>>>0&255,E[T+3]=this.h[1]>>>8&255,E[T+4]=this.h[2]>>>0&255,E[T+5]=this.h[2]>>>8&255,E[T+6]=this.h[3]>>>0&255,E[T+7]=this.h[3]>>>8&255,E[T+8]=this.h[4]>>>0&255,E[T+9]=this.h[4]>>>8&255,E[T+10]=this.h[5]>>>0&255,E[T+11]=this.h[5]>>>8&255,E[T+12]=this.h[6]>>>0&255,E[T+13]=this.h[6]>>>8&255,E[T+14]=this.h[7]>>>0&255,E[T+15]=this.h[7]>>>8&255},Y.prototype.update=function(E,T,C){var h,N;if(this.leftover){for(N=16-this.leftover,N>C&&(N=C),h=0;h<N;h++)this.buffer[this.leftover+h]=E[T+h];if(C-=N,T+=N,this.leftover+=N,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(C>=16&&(N=C-C%16,this.blocks(E,T,N),T+=N,C-=N),C){for(h=0;h<C;h++)this.buffer[this.leftover+h]=E[T+h];this.leftover+=C}};function te(E,T,C,h,N,re){var ee=new Y(re);return ee.update(C,h,N),ee.finish(E,T),0}function A(E,T,C,h,N,re){var ee=new Uint8Array(16);return te(ee,0,C,h,N,re),S(E,T,ee,0)}function u(E,T,C,h,N){var re;if(C<32)return-1;for(W(E,0,T,0,C,h,N),te(E,16,E,32,C-32,E),re=0;re<16;re++)E[re]=0;return 0}function d(E,T,C,h,N){var re,ee=new Uint8Array(32);if(C<32||(V(ee,0,32,h,N),A(T,16,T,32,C-32,ee)!==0))return-1;for(W(E,0,T,0,C,h,N),re=0;re<32;re++)E[re]=0;return 0}function x(E,T){var C;for(C=0;C<16;C++)E[C]=T[C]|0}function P(E){var T,C,h=1;for(T=0;T<16;T++)C=E[T]+h+65535,h=Math.floor(C/65536),E[T]=C-h*65536;E[0]+=h-1+37*(h-1)}function M(E,T,C){for(var h,N=~(C-1),re=0;re<16;re++)h=N&(E[re]^T[re]),E[re]^=h,T[re]^=h}function F(E,T){var C,h,N,re=r(),ee=r();for(C=0;C<16;C++)ee[C]=T[C];for(P(ee),P(ee),P(ee),h=0;h<2;h++){for(re[0]=ee[0]-65517,C=1;C<15;C++)re[C]=ee[C]-65535-(re[C-1]>>16&1),re[C-1]&=65535;re[15]=ee[15]-32767-(re[14]>>16&1),N=re[15]>>16&1,re[14]&=65535,M(ee,re,1-N)}for(C=0;C<16;C++)E[2*C]=ee[C]&255,E[2*C+1]=ee[C]>>8}function j(E,T){var C=new Uint8Array(32),h=new Uint8Array(32);return F(C,E),F(h,T),O(C,0,h,0)}function D(E){var T=new Uint8Array(32);return F(T,E),T[0]&1}function f(E,T){var C;for(C=0;C<16;C++)E[C]=T[2*C]+(T[2*C+1]<<8);E[15]&=32767}function p(E,T,C){for(var h=0;h<16;h++)E[h]=T[h]+C[h]}function R(E,T,C){for(var h=0;h<16;h++)E[h]=T[h]-C[h]}function U(E,T,C){var h,N,re=0,ee=0,de=0,be=0,Ie=0,ve=0,ft=0,Pe=0,Ke=0,Ve=0,Ye=0,Je=0,qe=0,He=0,We=0,De=0,Oe=0,Be=0,ke=0,Ne=0,Ae=0,ce=0,le=0,we=0,pe=0,ge=0,ye=0,Fe=0,et=0,nt=0,tt=0,H=C[0],lt=C[1],vt=C[2],Et=C[3],it=C[4],mt=C[5],yt=C[6],ir=C[7],St=C[8],Qt=C[9],er=C[10],tr=C[11],fr=C[12],Ar=C[13],Rr=C[14],Br=C[15];h=T[0],re+=h*H,ee+=h*lt,de+=h*vt,be+=h*Et,Ie+=h*it,ve+=h*mt,ft+=h*yt,Pe+=h*ir,Ke+=h*St,Ve+=h*Qt,Ye+=h*er,Je+=h*tr,qe+=h*fr,He+=h*Ar,We+=h*Rr,De+=h*Br,h=T[1],ee+=h*H,de+=h*lt,be+=h*vt,Ie+=h*Et,ve+=h*it,ft+=h*mt,Pe+=h*yt,Ke+=h*ir,Ve+=h*St,Ye+=h*Qt,Je+=h*er,qe+=h*tr,He+=h*fr,We+=h*Ar,De+=h*Rr,Oe+=h*Br,h=T[2],de+=h*H,be+=h*lt,Ie+=h*vt,ve+=h*Et,ft+=h*it,Pe+=h*mt,Ke+=h*yt,Ve+=h*ir,Ye+=h*St,Je+=h*Qt,qe+=h*er,He+=h*tr,We+=h*fr,De+=h*Ar,Oe+=h*Rr,Be+=h*Br,h=T[3],be+=h*H,Ie+=h*lt,ve+=h*vt,ft+=h*Et,Pe+=h*it,Ke+=h*mt,Ve+=h*yt,Ye+=h*ir,Je+=h*St,qe+=h*Qt,He+=h*er,We+=h*tr,De+=h*fr,Oe+=h*Ar,Be+=h*Rr,ke+=h*Br,h=T[4],Ie+=h*H,ve+=h*lt,ft+=h*vt,Pe+=h*Et,Ke+=h*it,Ve+=h*mt,Ye+=h*yt,Je+=h*ir,qe+=h*St,He+=h*Qt,We+=h*er,De+=h*tr,Oe+=h*fr,Be+=h*Ar,ke+=h*Rr,Ne+=h*Br,h=T[5],ve+=h*H,ft+=h*lt,Pe+=h*vt,Ke+=h*Et,Ve+=h*it,Ye+=h*mt,Je+=h*yt,qe+=h*ir,He+=h*St,We+=h*Qt,De+=h*er,Oe+=h*tr,Be+=h*fr,ke+=h*Ar,Ne+=h*Rr,Ae+=h*Br,h=T[6],ft+=h*H,Pe+=h*lt,Ke+=h*vt,Ve+=h*Et,Ye+=h*it,Je+=h*mt,qe+=h*yt,He+=h*ir,We+=h*St,De+=h*Qt,Oe+=h*er,Be+=h*tr,ke+=h*fr,Ne+=h*Ar,Ae+=h*Rr,ce+=h*Br,h=T[7],Pe+=h*H,Ke+=h*lt,Ve+=h*vt,Ye+=h*Et,Je+=h*it,qe+=h*mt,He+=h*yt,We+=h*ir,De+=h*St,Oe+=h*Qt,Be+=h*er,ke+=h*tr,Ne+=h*fr,Ae+=h*Ar,ce+=h*Rr,le+=h*Br,h=T[8],Ke+=h*H,Ve+=h*lt,Ye+=h*vt,Je+=h*Et,qe+=h*it,He+=h*mt,We+=h*yt,De+=h*ir,Oe+=h*St,Be+=h*Qt,ke+=h*er,Ne+=h*tr,Ae+=h*fr,ce+=h*Ar,le+=h*Rr,we+=h*Br,h=T[9],Ve+=h*H,Ye+=h*lt,Je+=h*vt,qe+=h*Et,He+=h*it,We+=h*mt,De+=h*yt,Oe+=h*ir,Be+=h*St,ke+=h*Qt,Ne+=h*er,Ae+=h*tr,ce+=h*fr,le+=h*Ar,we+=h*Rr,pe+=h*Br,h=T[10],Ye+=h*H,Je+=h*lt,qe+=h*vt,He+=h*Et,We+=h*it,De+=h*mt,Oe+=h*yt,Be+=h*ir,ke+=h*St,Ne+=h*Qt,Ae+=h*er,ce+=h*tr,le+=h*fr,we+=h*Ar,pe+=h*Rr,ge+=h*Br,h=T[11],Je+=h*H,qe+=h*lt,He+=h*vt,We+=h*Et,De+=h*it,Oe+=h*mt,Be+=h*yt,ke+=h*ir,Ne+=h*St,Ae+=h*Qt,ce+=h*er,le+=h*tr,we+=h*fr,pe+=h*Ar,ge+=h*Rr,ye+=h*Br,h=T[12],qe+=h*H,He+=h*lt,We+=h*vt,De+=h*Et,Oe+=h*it,Be+=h*mt,ke+=h*yt,Ne+=h*ir,Ae+=h*St,ce+=h*Qt,le+=h*er,we+=h*tr,pe+=h*fr,ge+=h*Ar,ye+=h*Rr,Fe+=h*Br,h=T[13],He+=h*H,We+=h*lt,De+=h*vt,Oe+=h*Et,Be+=h*it,ke+=h*mt,Ne+=h*yt,Ae+=h*ir,ce+=h*St,le+=h*Qt,we+=h*er,pe+=h*tr,ge+=h*fr,ye+=h*Ar,Fe+=h*Rr,et+=h*Br,h=T[14],We+=h*H,De+=h*lt,Oe+=h*vt,Be+=h*Et,ke+=h*it,Ne+=h*mt,Ae+=h*yt,ce+=h*ir,le+=h*St,we+=h*Qt,pe+=h*er,ge+=h*tr,ye+=h*fr,Fe+=h*Ar,et+=h*Rr,nt+=h*Br,h=T[15],De+=h*H,Oe+=h*lt,Be+=h*vt,ke+=h*Et,Ne+=h*it,Ae+=h*mt,ce+=h*yt,le+=h*ir,we+=h*St,pe+=h*Qt,ge+=h*er,ye+=h*tr,Fe+=h*fr,et+=h*Ar,nt+=h*Rr,tt+=h*Br,re+=38*Oe,ee+=38*Be,de+=38*ke,be+=38*Ne,Ie+=38*Ae,ve+=38*ce,ft+=38*le,Pe+=38*we,Ke+=38*pe,Ve+=38*ge,Ye+=38*ye,Je+=38*Fe,qe+=38*et,He+=38*nt,We+=38*tt,N=1,h=re+N+65535,N=Math.floor(h/65536),re=h-N*65536,h=ee+N+65535,N=Math.floor(h/65536),ee=h-N*65536,h=de+N+65535,N=Math.floor(h/65536),de=h-N*65536,h=be+N+65535,N=Math.floor(h/65536),be=h-N*65536,h=Ie+N+65535,N=Math.floor(h/65536),Ie=h-N*65536,h=ve+N+65535,N=Math.floor(h/65536),ve=h-N*65536,h=ft+N+65535,N=Math.floor(h/65536),ft=h-N*65536,h=Pe+N+65535,N=Math.floor(h/65536),Pe=h-N*65536,h=Ke+N+65535,N=Math.floor(h/65536),Ke=h-N*65536,h=Ve+N+65535,N=Math.floor(h/65536),Ve=h-N*65536,h=Ye+N+65535,N=Math.floor(h/65536),Ye=h-N*65536,h=Je+N+65535,N=Math.floor(h/65536),Je=h-N*65536,h=qe+N+65535,N=Math.floor(h/65536),qe=h-N*65536,h=He+N+65535,N=Math.floor(h/65536),He=h-N*65536,h=We+N+65535,N=Math.floor(h/65536),We=h-N*65536,h=De+N+65535,N=Math.floor(h/65536),De=h-N*65536,re+=N-1+37*(N-1),N=1,h=re+N+65535,N=Math.floor(h/65536),re=h-N*65536,h=ee+N+65535,N=Math.floor(h/65536),ee=h-N*65536,h=de+N+65535,N=Math.floor(h/65536),de=h-N*65536,h=be+N+65535,N=Math.floor(h/65536),be=h-N*65536,h=Ie+N+65535,N=Math.floor(h/65536),Ie=h-N*65536,h=ve+N+65535,N=Math.floor(h/65536),ve=h-N*65536,h=ft+N+65535,N=Math.floor(h/65536),ft=h-N*65536,h=Pe+N+65535,N=Math.floor(h/65536),Pe=h-N*65536,h=Ke+N+65535,N=Math.floor(h/65536),Ke=h-N*65536,h=Ve+N+65535,N=Math.floor(h/65536),Ve=h-N*65536,h=Ye+N+65535,N=Math.floor(h/65536),Ye=h-N*65536,h=Je+N+65535,N=Math.floor(h/65536),Je=h-N*65536,h=qe+N+65535,N=Math.floor(h/65536),qe=h-N*65536,h=He+N+65535,N=Math.floor(h/65536),He=h-N*65536,h=We+N+65535,N=Math.floor(h/65536),We=h-N*65536,h=De+N+65535,N=Math.floor(h/65536),De=h-N*65536,re+=N-1+37*(N-1),E[0]=re,E[1]=ee,E[2]=de,E[3]=be,E[4]=Ie,E[5]=ve,E[6]=ft,E[7]=Pe,E[8]=Ke,E[9]=Ve,E[10]=Ye,E[11]=Je,E[12]=qe,E[13]=He,E[14]=We,E[15]=De}function X(E,T){U(E,T,T)}function fe(E,T){var C=r(),h;for(h=0;h<16;h++)C[h]=T[h];for(h=253;h>=0;h--)X(C,C),h!==2&&h!==4&&U(C,C,T);for(h=0;h<16;h++)E[h]=C[h]}function Ee(E,T){var C=r(),h;for(h=0;h<16;h++)C[h]=T[h];for(h=250;h>=0;h--)X(C,C),h!==1&&U(C,C,T);for(h=0;h<16;h++)E[h]=C[h]}function _e(E,T,C){var h=new Uint8Array(32),N=new Float64Array(80),re,ee,de=r(),be=r(),Ie=r(),ve=r(),ft=r(),Pe=r();for(ee=0;ee<31;ee++)h[ee]=T[ee];for(h[31]=T[31]&127|64,h[0]&=248,f(N,C),ee=0;ee<16;ee++)be[ee]=N[ee],ve[ee]=de[ee]=Ie[ee]=0;for(de[0]=ve[0]=1,ee=254;ee>=0;--ee)re=h[ee>>>3]>>>(ee&7)&1,M(de,be,re),M(Ie,ve,re),p(ft,de,Ie),R(de,de,Ie),p(Ie,be,ve),R(be,be,ve),X(ve,ft),X(Pe,de),U(de,Ie,de),U(Ie,be,ft),p(ft,de,Ie),R(de,de,Ie),X(be,de),R(Ie,ve,Pe),U(de,Ie,c),p(de,de,ve),U(Ie,Ie,de),U(de,ve,Pe),U(ve,be,N),X(be,ft),M(de,be,re),M(Ie,ve,re);for(ee=0;ee<16;ee++)N[ee+16]=de[ee],N[ee+32]=Ie[ee],N[ee+48]=be[ee],N[ee+64]=ve[ee];var Ke=N.subarray(32),Ve=N.subarray(16);return fe(Ke,Ke),U(Ve,Ve,Ke),F(E,Ve),0}function Xe(E,T){return _e(E,T,i)}function dt(E,T){return n(T,32),Xe(E,T)}function Qe(E,T,C){var h=new Uint8Array(32);return _e(h,C,T),q(E,s,h,J)}var Zt=u,bt=d;function kt(E,T,C,h,N,re){var ee=new Uint8Array(32);return Qe(ee,N,re),Zt(E,T,C,h,ee)}function Pn(E,T,C,h,N,re){var ee=new Uint8Array(32);return Qe(ee,N,re),bt(E,T,C,h,ee)}var Nt=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Kt(E,T,C,h){for(var N=new Int32Array(16),re=new Int32Array(16),ee,de,be,Ie,ve,ft,Pe,Ke,Ve,Ye,Je,qe,He,We,De,Oe,Be,ke,Ne,Ae,ce,le,we,pe,ge,ye,Fe=E[0],et=E[1],nt=E[2],tt=E[3],H=E[4],lt=E[5],vt=E[6],Et=E[7],it=T[0],mt=T[1],yt=T[2],ir=T[3],St=T[4],Qt=T[5],er=T[6],tr=T[7],fr=0;h>=128;){for(Ne=0;Ne<16;Ne++)Ae=8*Ne+fr,N[Ne]=C[Ae+0]<<24|C[Ae+1]<<16|C[Ae+2]<<8|C[Ae+3],re[Ne]=C[Ae+4]<<24|C[Ae+5]<<16|C[Ae+6]<<8|C[Ae+7];for(Ne=0;Ne<80;Ne++)if(ee=Fe,de=et,be=nt,Ie=tt,ve=H,ft=lt,Pe=vt,Ke=Et,Ve=it,Ye=mt,Je=yt,qe=ir,He=St,We=Qt,De=er,Oe=tr,ce=Et,le=tr,we=le&65535,pe=le>>>16,ge=ce&65535,ye=ce>>>16,ce=(H>>>14|St<<18)^(H>>>18|St<<14)^(St>>>9|H<<23),le=(St>>>14|H<<18)^(St>>>18|H<<14)^(H>>>9|St<<23),we+=le&65535,pe+=le>>>16,ge+=ce&65535,ye+=ce>>>16,ce=H&lt^~H&vt,le=St&Qt^~St&er,we+=le&65535,pe+=le>>>16,ge+=ce&65535,ye+=ce>>>16,ce=Nt[Ne*2],le=Nt[Ne*2+1],we+=le&65535,pe+=le>>>16,ge+=ce&65535,ye+=ce>>>16,ce=N[Ne%16],le=re[Ne%16],we+=le&65535,pe+=le>>>16,ge+=ce&65535,ye+=ce>>>16,pe+=we>>>16,ge+=pe>>>16,ye+=ge>>>16,Be=ge&65535|ye<<16,ke=we&65535|pe<<16,ce=Be,le=ke,we=le&65535,pe=le>>>16,ge=ce&65535,ye=ce>>>16,ce=(Fe>>>28|it<<4)^(it>>>2|Fe<<30)^(it>>>7|Fe<<25),le=(it>>>28|Fe<<4)^(Fe>>>2|it<<30)^(Fe>>>7|it<<25),we+=le&65535,pe+=le>>>16,ge+=ce&65535,ye+=ce>>>16,ce=Fe&et^Fe&nt^et&nt,le=it&mt^it&yt^mt&yt,we+=le&65535,pe+=le>>>16,ge+=ce&65535,ye+=ce>>>16,pe+=we>>>16,ge+=pe>>>16,ye+=ge>>>16,Ke=ge&65535|ye<<16,Oe=we&65535|pe<<16,ce=Ie,le=qe,we=le&65535,pe=le>>>16,ge=ce&65535,ye=ce>>>16,ce=Be,le=ke,we+=le&65535,pe+=le>>>16,ge+=ce&65535,ye+=ce>>>16,pe+=we>>>16,ge+=pe>>>16,ye+=ge>>>16,Ie=ge&65535|ye<<16,qe=we&65535|pe<<16,et=ee,nt=de,tt=be,H=Ie,lt=ve,vt=ft,Et=Pe,Fe=Ke,mt=Ve,yt=Ye,ir=Je,St=qe,Qt=He,er=We,tr=De,it=Oe,Ne%16===15)for(Ae=0;Ae<16;Ae++)ce=N[Ae],le=re[Ae],we=le&65535,pe=le>>>16,ge=ce&65535,ye=ce>>>16,ce=N[(Ae+9)%16],le=re[(Ae+9)%16],we+=le&65535,pe+=le>>>16,ge+=ce&65535,ye+=ce>>>16,Be=N[(Ae+1)%16],ke=re[(Ae+1)%16],ce=(Be>>>1|ke<<31)^(Be>>>8|ke<<24)^Be>>>7,le=(ke>>>1|Be<<31)^(ke>>>8|Be<<24)^(ke>>>7|Be<<25),we+=le&65535,pe+=le>>>16,ge+=ce&65535,ye+=ce>>>16,Be=N[(Ae+14)%16],ke=re[(Ae+14)%16],ce=(Be>>>19|ke<<13)^(ke>>>29|Be<<3)^Be>>>6,le=(ke>>>19|Be<<13)^(Be>>>29|ke<<3)^(ke>>>6|Be<<26),we+=le&65535,pe+=le>>>16,ge+=ce&65535,ye+=ce>>>16,pe+=we>>>16,ge+=pe>>>16,ye+=ge>>>16,N[Ae]=ge&65535|ye<<16,re[Ae]=we&65535|pe<<16;ce=Fe,le=it,we=le&65535,pe=le>>>16,ge=ce&65535,ye=ce>>>16,ce=E[0],le=T[0],we+=le&65535,pe+=le>>>16,ge+=ce&65535,ye+=ce>>>16,pe+=we>>>16,ge+=pe>>>16,ye+=ge>>>16,E[0]=Fe=ge&65535|ye<<16,T[0]=it=we&65535|pe<<16,ce=et,le=mt,we=le&65535,pe=le>>>16,ge=ce&65535,ye=ce>>>16,ce=E[1],le=T[1],we+=le&65535,pe+=le>>>16,ge+=ce&65535,ye+=ce>>>16,pe+=we>>>16,ge+=pe>>>16,ye+=ge>>>16,E[1]=et=ge&65535|ye<<16,T[1]=mt=we&65535|pe<<16,ce=nt,le=yt,we=le&65535,pe=le>>>16,ge=ce&65535,ye=ce>>>16,ce=E[2],le=T[2],we+=le&65535,pe+=le>>>16,ge+=ce&65535,ye+=ce>>>16,pe+=we>>>16,ge+=pe>>>16,ye+=ge>>>16,E[2]=nt=ge&65535|ye<<16,T[2]=yt=we&65535|pe<<16,ce=tt,le=ir,we=le&65535,pe=le>>>16,ge=ce&65535,ye=ce>>>16,ce=E[3],le=T[3],we+=le&65535,pe+=le>>>16,ge+=ce&65535,ye+=ce>>>16,pe+=we>>>16,ge+=pe>>>16,ye+=ge>>>16,E[3]=tt=ge&65535|ye<<16,T[3]=ir=we&65535|pe<<16,ce=H,le=St,we=le&65535,pe=le>>>16,ge=ce&65535,ye=ce>>>16,ce=E[4],le=T[4],we+=le&65535,pe+=le>>>16,ge+=ce&65535,ye+=ce>>>16,pe+=we>>>16,ge+=pe>>>16,ye+=ge>>>16,E[4]=H=ge&65535|ye<<16,T[4]=St=we&65535|pe<<16,ce=lt,le=Qt,we=le&65535,pe=le>>>16,ge=ce&65535,ye=ce>>>16,ce=E[5],le=T[5],we+=le&65535,pe+=le>>>16,ge+=ce&65535,ye+=ce>>>16,pe+=we>>>16,ge+=pe>>>16,ye+=ge>>>16,E[5]=lt=ge&65535|ye<<16,T[5]=Qt=we&65535|pe<<16,ce=vt,le=er,we=le&65535,pe=le>>>16,ge=ce&65535,ye=ce>>>16,ce=E[6],le=T[6],we+=le&65535,pe+=le>>>16,ge+=ce&65535,ye+=ce>>>16,pe+=we>>>16,ge+=pe>>>16,ye+=ge>>>16,E[6]=vt=ge&65535|ye<<16,T[6]=er=we&65535|pe<<16,ce=Et,le=tr,we=le&65535,pe=le>>>16,ge=ce&65535,ye=ce>>>16,ce=E[7],le=T[7],we+=le&65535,pe+=le>>>16,ge+=ce&65535,ye+=ce>>>16,pe+=we>>>16,ge+=pe>>>16,ye+=ge>>>16,E[7]=Et=ge&65535|ye<<16,T[7]=tr=we&65535|pe<<16,fr+=128,h-=128}return h}function nn(E,T,C){var h=new Int32Array(8),N=new Int32Array(8),re=new Uint8Array(256),ee,de=C;for(h[0]=1779033703,h[1]=3144134277,h[2]=1013904242,h[3]=2773480762,h[4]=1359893119,h[5]=2600822924,h[6]=528734635,h[7]=1541459225,N[0]=4089235720,N[1]=2227873595,N[2]=4271175723,N[3]=1595750129,N[4]=2917565137,N[5]=725511199,N[6]=4215389547,N[7]=327033209,Kt(h,N,T,C),C%=128,ee=0;ee<C;ee++)re[ee]=T[de-C+ee];for(re[C]=128,C=256-128*(C<112?1:0),re[C-9]=0,b(re,C-8,de/536870912|0,de<<3),Kt(h,N,re,C),ee=0;ee<8;ee++)b(E,8*ee,h[ee],N[ee]);return 0}function Rt(E,T){var C=r(),h=r(),N=r(),re=r(),ee=r(),de=r(),be=r(),Ie=r(),ve=r();R(C,E[1],E[0]),R(ve,T[1],T[0]),U(C,C,ve),p(h,E[0],E[1]),p(ve,T[0],T[1]),U(h,h,ve),U(N,E[3],T[3]),U(N,N,g),U(re,E[2],T[2]),p(re,re,re),R(ee,h,C),R(de,re,N),p(be,re,N),p(Ie,h,C),U(E[0],ee,de),U(E[1],Ie,be),U(E[2],be,de),U(E[3],ee,Ie)}function Bt(E,T,C){var h;for(h=0;h<4;h++)M(E[h],T[h],C)}function mr(E,T){var C=r(),h=r(),N=r();fe(N,T[2]),U(C,T[0],N),U(h,T[1],N),F(E,h),E[31]^=D(C)<<7}function Tt(E,T,C){var h,N;for(x(E[0],o),x(E[1],a),x(E[2],a),x(E[3],o),N=255;N>=0;--N)h=C[N/8|0]>>(N&7)&1,Bt(E,T,h),Rt(T,E),Rt(E,E),Bt(E,T,h)}function Ot(E,T){var C=[r(),r(),r(),r()];x(C[0],m),x(C[1],I),x(C[2],a),U(C[3],m,I),Tt(E,C,T)}function Ur(E,T,C){var h=new Uint8Array(64),N=[r(),r(),r(),r()],re;for(C||n(T,32),nn(h,T,32),h[0]&=248,h[31]&=127,h[31]|=64,Ot(N,h),mr(E,N),re=0;re<32;re++)T[re+32]=E[re];return 0}var Mt=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function B(E,T){var C,h,N,re;for(h=63;h>=32;--h){for(C=0,N=h-32,re=h-12;N<re;++N)T[N]+=C-16*T[h]*Mt[N-(h-32)],C=Math.floor((T[N]+128)/256),T[N]-=C*256;T[N]+=C,T[h]=0}for(C=0,N=0;N<32;N++)T[N]+=C-(T[31]>>4)*Mt[N],C=T[N]>>8,T[N]&=255;for(N=0;N<32;N++)T[N]-=C*Mt[N];for(h=0;h<32;h++)T[h+1]+=T[h]>>8,E[h]=T[h]&255}function w(E){var T=new Float64Array(64),C;for(C=0;C<64;C++)T[C]=E[C];for(C=0;C<64;C++)E[C]=0;B(E,T)}function y(E,T,C,h){var N=new Uint8Array(64),re=new Uint8Array(64),ee=new Uint8Array(64),de,be,Ie=new Float64Array(64),ve=[r(),r(),r(),r()];nn(N,h,32),N[0]&=248,N[31]&=127,N[31]|=64;var ft=C+64;for(de=0;de<C;de++)E[64+de]=T[de];for(de=0;de<32;de++)E[32+de]=N[32+de];for(nn(ee,E.subarray(32),C+32),w(ee),Ot(ve,ee),mr(E,ve),de=32;de<64;de++)E[de]=h[de];for(nn(re,E,C+64),w(re),de=0;de<64;de++)Ie[de]=0;for(de=0;de<32;de++)Ie[de]=ee[de];for(de=0;de<32;de++)for(be=0;be<32;be++)Ie[de+be]+=re[de]*N[be];return B(E.subarray(32),Ie),ft}function L(E,T){var C=r(),h=r(),N=r(),re=r(),ee=r(),de=r(),be=r();return x(E[2],a),f(E[1],T),X(N,E[1]),U(re,N,l),R(N,N,E[2]),p(re,E[2],re),X(ee,re),X(de,ee),U(be,de,ee),U(C,be,N),U(C,C,re),Ee(C,C),U(C,C,N),U(C,C,re),U(C,C,re),U(E[0],C,re),X(h,E[0]),U(h,h,re),j(h,N)&&U(E[0],E[0],_),X(h,E[0]),U(h,h,re),j(h,N)?-1:(D(E[0])===T[31]>>7&&R(E[0],o,E[0]),U(E[3],E[0],E[1]),0)}function Q(E,T,C,h){var N,re=new Uint8Array(32),ee=new Uint8Array(64),de=[r(),r(),r(),r()],be=[r(),r(),r(),r()];if(C<64||L(be,h))return-1;for(N=0;N<C;N++)E[N]=T[N];for(N=0;N<32;N++)E[N+32]=h[N];if(nn(ee,E,C),w(ee),Tt(de,be,ee),Ot(be,T.subarray(32)),Rt(de,be),mr(re,de),C-=64,O(T,0,re,0)){for(N=0;N<C;N++)E[N]=0;return-1}for(N=0;N<C;N++)E[N]=T[N+64];return C}var ne=32,he=24,Ze=32,ze=16,$e=32,xt=32,Ue=32,Ut=32,oi=32,Wt=he,Yt=Ze,Ko=ze,_t=64,Pt=32,Cn=64,zt=32,Vt=64;e.lowlevel={crypto_core_hsalsa20:q,crypto_stream_xor:W,crypto_stream:V,crypto_stream_salsa20_xor:se,crypto_stream_salsa20:oe,crypto_onetimeauth:te,crypto_onetimeauth_verify:A,crypto_verify_16:S,crypto_verify_32:O,crypto_secretbox:u,crypto_secretbox_open:d,crypto_scalarmult:_e,crypto_scalarmult_base:Xe,crypto_box_beforenm:Qe,crypto_box_afternm:Zt,crypto_box:kt,crypto_box_open:Pn,crypto_box_keypair:dt,crypto_hash:nn,crypto_sign:y,crypto_sign_keypair:Ur,crypto_sign_open:Q,crypto_secretbox_KEYBYTES:ne,crypto_secretbox_NONCEBYTES:he,crypto_secretbox_ZEROBYTES:Ze,crypto_secretbox_BOXZEROBYTES:ze,crypto_scalarmult_BYTES:$e,crypto_scalarmult_SCALARBYTES:xt,crypto_box_PUBLICKEYBYTES:Ue,crypto_box_SECRETKEYBYTES:Ut,crypto_box_BEFORENMBYTES:oi,crypto_box_NONCEBYTES:Wt,crypto_box_ZEROBYTES:Yt,crypto_box_BOXZEROBYTES:Ko,crypto_sign_BYTES:_t,crypto_sign_PUBLICKEYBYTES:Pt,crypto_sign_SECRETKEYBYTES:Cn,crypto_sign_SEEDBYTES:zt,crypto_hash_BYTES:Vt,gf:r,D:l,L:Mt,pack25519:F,unpack25519:f,M:U,A:p,S:X,Z:R,pow2523:Ee,add:Rt,set25519:x,modL:B,scalarmult:Tt,scalarbase:Ot};function Xi(E,T){if(E.length!==ne)throw new Error("bad key size");if(T.length!==he)throw new Error("bad nonce size")}function Xt(E,T){if(E.length!==Ue)throw new Error("bad public key size");if(T.length!==Ut)throw new Error("bad secret key size")}function wt(){for(var E=0;E<arguments.length;E++)if(!(arguments[E]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function Qi(E){for(var T=0;T<E.length;T++)E[T]=0}e.randomBytes=function(E){var T=new Uint8Array(E);return n(T,E),T},e.secretbox=function(E,T,C){wt(E,T,C),Xi(C,T);for(var h=new Uint8Array(Ze+E.length),N=new Uint8Array(h.length),re=0;re<E.length;re++)h[re+Ze]=E[re];return u(N,h,h.length,T,C),N.subarray(ze)},e.secretbox.open=function(E,T,C){wt(E,T,C),Xi(C,T);for(var h=new Uint8Array(ze+E.length),N=new Uint8Array(h.length),re=0;re<E.length;re++)h[re+ze]=E[re];return h.length<32||d(N,h,h.length,T,C)!==0?null:N.subarray(Ze)},e.secretbox.keyLength=ne,e.secretbox.nonceLength=he,e.secretbox.overheadLength=ze,e.scalarMult=function(E,T){if(wt(E,T),E.length!==xt)throw new Error("bad n size");if(T.length!==$e)throw new Error("bad p size");var C=new Uint8Array($e);return _e(C,E,T),C},e.scalarMult.base=function(E){if(wt(E),E.length!==xt)throw new Error("bad n size");var T=new Uint8Array($e);return Xe(T,E),T},e.scalarMult.scalarLength=xt,e.scalarMult.groupElementLength=$e,e.box=function(E,T,C,h){var N=e.box.before(C,h);return e.secretbox(E,T,N)},e.box.before=function(E,T){wt(E,T),Xt(E,T);var C=new Uint8Array(oi);return Qe(C,E,T),C},e.box.after=e.secretbox,e.box.open=function(E,T,C,h){var N=e.box.before(C,h);return e.secretbox.open(E,T,N)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var E=new Uint8Array(Ue),T=new Uint8Array(Ut);return dt(E,T),{publicKey:E,secretKey:T}},e.box.keyPair.fromSecretKey=function(E){if(wt(E),E.length!==Ut)throw new Error("bad secret key size");var T=new Uint8Array(Ue);return Xe(T,E),{publicKey:T,secretKey:new Uint8Array(E)}},e.box.publicKeyLength=Ue,e.box.secretKeyLength=Ut,e.box.sharedKeyLength=oi,e.box.nonceLength=Wt,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(E,T){if(wt(E,T),T.length!==Cn)throw new Error("bad secret key size");var C=new Uint8Array(_t+E.length);return y(C,E,E.length,T),C},e.sign.open=function(E,T){if(wt(E,T),T.length!==Pt)throw new Error("bad public key size");var C=new Uint8Array(E.length),h=Q(C,E,E.length,T);if(h<0)return null;for(var N=new Uint8Array(h),re=0;re<N.length;re++)N[re]=C[re];return N},e.sign.detached=function(E,T){for(var C=e.sign(E,T),h=new Uint8Array(_t),N=0;N<h.length;N++)h[N]=C[N];return h},e.sign.detached.verify=function(E,T,C){if(wt(E,T,C),T.length!==_t)throw new Error("bad signature size");if(C.length!==Pt)throw new Error("bad public key size");var h=new Uint8Array(_t+E.length),N=new Uint8Array(_t+E.length),re;for(re=0;re<_t;re++)h[re]=T[re];for(re=0;re<E.length;re++)h[re+_t]=E[re];return Q(N,h,h.length,C)>=0},e.sign.keyPair=function(){var E=new Uint8Array(Pt),T=new Uint8Array(Cn);return Ur(E,T),{publicKey:E,secretKey:T}},e.sign.keyPair.fromSecretKey=function(E){if(wt(E),E.length!==Cn)throw new Error("bad secret key size");for(var T=new Uint8Array(Pt),C=0;C<T.length;C++)T[C]=E[32+C];return{publicKey:T,secretKey:new Uint8Array(E)}},e.sign.keyPair.fromSeed=function(E){if(wt(E),E.length!==zt)throw new Error("bad seed size");for(var T=new Uint8Array(Pt),C=new Uint8Array(Cn),h=0;h<32;h++)C[h]=E[h];return Ur(T,C,!0),{publicKey:T,secretKey:C}},e.sign.publicKeyLength=Pt,e.sign.secretKeyLength=Cn,e.sign.seedLength=zt,e.sign.signatureLength=_t,e.hash=function(E){wt(E);var T=new Uint8Array(Vt);return nn(T,E,E.length),T},e.hash.hashLength=Vt,e.verify=function(E,T){return wt(E,T),E.length===0||T.length===0||E.length!==T.length?!1:v(E,0,T,0,E.length)===0},e.setPRNG=function(E){n=E},(function(){var E=typeof self<"u"?self.crypto||self.msCrypto:null;if(E&&E.getRandomValues){var T=65536;e.setPRNG(function(C,h){var N,re=new Uint8Array(h);for(N=0;N<h;N+=T)E.getRandomValues(re.subarray(N,N+Math.min(h-N,T)));for(N=0;N<h;N++)C[N]=re[N];Qi(re)})}else typeof Sy<"u"&&(E=a0,E&&E.randomBytes&&e.setPRNG(function(C,h){var N,re=E.randomBytes(h);for(N=0;N<h;N++)C[N]=re[N];Qi(re)}))})()})(t.exports?t.exports:self.nacl=self.nacl||{})})(wc)),wc.exports}By();var mc,mf;function Ty(){if(mf)return mc;mf=1;function t(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),g=Math.log(256)/Math.log(a);function m(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(b.length===0)return"";for(var v=0,S=0,O=0,$=b.length;O!==$&&b[O]===0;)O++,v++;for(var k=($-O)*g+1>>>0,Z=new Uint8Array(k);O!==$;){for(var q=b[O],J=0,se=k-1;(q!==0||J<S)&&se!==-1;se--,J++)q+=256*Z[se]>>>0,Z[se]=q%a>>>0,q=q/a>>>0;if(q!==0)throw new Error("Non-zero carry");S=J,O++}for(var oe=k-S;oe!==k&&Z[oe]===0;)oe++;for(var V=c.repeat(v);oe<k;++oe)V+=e.charAt(Z[oe]);return V}function I(b){if(typeof b!="string")throw new TypeError("Expected String");if(b.length===0)return new Uint8Array;for(var v=0,S=0,O=0;b[v]===c;)S++,v++;for(var $=(b.length-v)*l+1>>>0,k=new Uint8Array($);b[v];){var Z=b.charCodeAt(v);if(Z>255)return;var q=r[Z];if(q===255)return;for(var J=0,se=$-1;(q!==0||J<O)&&se!==-1;se--,J++)q+=a*k[se]>>>0,k[se]=q%256>>>0,q=q/256>>>0;if(q!==0)throw new Error("Non-zero carry");O=J,v++}for(var oe=$-O;oe!==$&&k[oe]===0;)oe++;for(var V=new Uint8Array(S+($-oe)),W=S;oe!==$;)V[W++]=k[oe++];return V}function _(b){var v=I(b);if(v)return v;throw new Error("Non-base"+a+" character")}return{encode:m,decodeUnsafe:I,decode:_}}return mc=t,mc}var yc,yf;function Py(){return yf||(yf=1,yc=Ty()("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")),yc}Py();var Cy={[rr.SOLANA_MAINNET]:{chain:"solana",network:"mainnet",description:"Solana Mainnet-Beta"},[rr.SOLANA_DEVNET]:{chain:"solana",network:"devnet",description:"Solana Devnet"},[rr.SOLANA_TESTNET]:{chain:"solana",network:"testnet",description:"Solana Testnet"},[rr.ETHEREUM_MAINNET]:{chain:"ethereum",network:"mainnet",description:"Ethereum Mainnet"},[rr.ETHEREUM_SEPOLIA]:{chain:"ethereum",network:"sepolia",description:"Sepolia Testnet"},[rr.POLYGON_MAINNET]:{chain:"polygon",network:"mainnet",description:"Polygon Mainnet"},[rr.POLYGON_AMOY]:{chain:"polygon",network:"amoy",description:"Polygon Amoy Testnet"},[rr.BASE_MAINNET]:{chain:"base",network:"mainnet",description:"Base Mainnet"},[rr.BASE_SEPOLIA]:{chain:"base",network:"sepolia",description:"Base Sepolia Testnet"},[rr.ARBITRUM_ONE]:{chain:"arbitrum",network:"mainnet",description:"Arbitrum One"},[rr.ARBITRUM_SEPOLIA]:{chain:"arbitrum",network:"sepolia",description:"Arbitrum Sepolia Testnet"},[rr.MONAD_MAINNET]:{chain:"monad",network:"mainnet",description:"Monad Mainnet"},[rr.MONAD_TESTNET]:{chain:"monad",network:"testnet",description:"Monad Testnet"},[rr.BITCOIN_MAINNET]:{chain:"bitcoin",network:"mainnet",description:"Bitcoin Mainnet"},[rr.BITCOIN_TESTNET]:{chain:"bitcoin",network:"testnet",description:"Bitcoin Testnet"},[rr.SUI_MAINNET]:{chain:"sui",network:"mainnet",description:"Sui Mainnet"},[rr.SUI_TESTNET]:{chain:"sui",network:"testnet",description:"Sui Testnet"}};function Dy(t){const e=Cy[t];if(e)return{chain:e.chain,network:e.network}}var Or={Solana:(t=0)=>`m/44'/501'/${t}'/0'`,Ethereum:(t=0)=>`m/44'/60'/0'/0/${t}`,Bitcoin:(t=0)=>`m/84'/0'/${t}'/0`,Sui:(t=0)=>`m/44'/784'/${t}'/0'/0'`};function Go(t,e=0){switch(t.split(":")[0].toLowerCase()){case"solana":return{derivationPath:Or.Solana(e),curve:yi.ed25519,algorithm:Ps.ed25519,addressFormat:st.solana};case"sui":return{derivationPath:Or.Sui(e),curve:yi.ed25519,algorithm:Ps.ed25519,addressFormat:st.sui};case"bitcoin":case"btc":return{derivationPath:Or.Bitcoin(e),curve:yi.secp256k1,algorithm:Ps.secp256k1,addressFormat:st.bitcoinSegwit};case"eip155":return{derivationPath:Or.Ethereum(e),curve:yi.secp256k1,algorithm:Ps.secp256k1,addressFormat:st.ethereum};default:return null}}var mo=class extends Error{constructor(t,e){super(t.detail),this.name=e,this.type=t.type,this.title=t.title,this.detail=t.detail,this.requestId=t.requestId}};function c0(t){if(ny(t))return t.response?.data}function bf(t,e="An error occurred"){if(t instanceof mo)return t.detail||t.title||t.message||e;const r=c0(t);return r?r.message||r.detail||r.title||e:t instanceof Error?t.message:e}function ky(t){if(!t||!t.type)return null;switch(t.type){case"spending-limit-exceeded":return new l0(t);case"transaction-blocked":return new Ny(t);default:return null}}var l0=class extends mo{constructor(t){super(t,"SpendingLimitError"),this.previousSpendCents=t.previousSpendCents,this.transactionSpendCents=t.transactionSpendCents,this.totalSpendCents=t.totalSpendCents,this.limitCents=t.limitCents}},Ny=class extends mo{constructor(t){super(t,"TransactionBlockedError"),this.scannerResult=t.scannerResult}},bc=class{constructor(t,e){this.config={...t,walletType:t.walletType||"user-wallet"},this.axiosInstance=Gt.create();const r={};t.headers&&Object.assign(r,t.headers),Object.keys(r).length>0&&this.axiosInstance.interceptors.request.use(s=>(Object.assign(s.headers,r),s)),e&&(this.axiosInstance.interceptors.request.use(async s=>await this.stampRequest(s,e)),this.stamper=e);const n=new wy({basePath:t.apiBaseUrl});this.kmsApi=new gy(n,t.apiBaseUrl,this.axiosInstance)}setOrganizationId(t){if(!t)throw new Error("organizationId is required");this.config.organizationId=t}async createWallet(t){try{if(!this.config.organizationId)throw new Error("organizationId is required to create a wallet");const e=await zr(),r={organizationId:this.config.organizationId,walletName:t||`Wallet ${e}`,accounts:[Or.Solana(),Or.Ethereum(),Or.Bitcoin(),Or.Sui()]},n={method:vl.createWallet,params:r,timestampMs:e},i=(await this.kmsApi.postKmsRpc(n)).data.result,o={method:ya.getAccounts,params:{accounts:[Or.Solana(),Or.Ethereum(),Or.Bitcoin(),Or.Sui()],organizationId:this.config.organizationId,walletId:i.walletId},timestampMs:e},c=(await this.kmsApi.postKmsRpc(o)).data.result;return{walletId:i.walletId,addresses:c.map(l=>({addressType:l.addressFormat,address:l.address}))}}catch(e){throw console.error("Failed to create wallet:",e.response?.data||e.message),new Error(`Failed to create wallet: ${e.response?.data?.message||e.message}`)}}async prepare(t,e,r,n,s){try{const i={transaction:t,organizationId:e,submissionConfig:r,simulationConfig:{account:n}};return(await this.axiosInstance.post(`${this.config.apiBaseUrl}/prepare`,i,{headers:{"Content-Type":"application/json","X-Rpc-Method":s}})).data}catch(i){const o=c0(i),a=ky(o);if(a)throw a;const c=o?.detail||bf(i,"Failed to submit transaction");throw new Error(c)}}async getTransactionForSigning(t){const{encodedTransaction:e,networkId:r,submissionConfig:n,account:s}=t,i=Al(r),o=Iy(r);if(i)return{kind:"RLP_ENCODED",bytes:e};if(o&&this.config.walletType==="user-wallet"){if(!s)throw new Error("Account is required to simulate Solana transactions with spending limits");try{return(await this.prepare(e,this.config.organizationId,n,s,t.methodName)).transaction}catch(a){if(a instanceof mo)throw a;const c=a instanceof Error?a.message:String(a);throw new Error(c)}}return e}getRpcMethodName(t,e){return Al(t)?e?"eth_sendTransaction":"eth_signTransaction":e?"signAndSendTransaction":"signTransaction"}async performTransactionSigning(t,e){const r=t.walletId,n=t.transaction,s=t.networkId,i=t.derivationIndex??0,o=this.getRpcMethodName(s,e);try{if(!this.config.organizationId)throw new Error("organizationId is required to sign a transaction");const a=Dy(s);if(!a)throw new Error(`SubmissionConfig could not be derived for network ID: ${s}`);const c=Go(s,i);if(!c)throw new Error(`Unsupported network ID: ${s}`);const l={derivationPath:c.derivationPath,curve:c.curve,addressFormat:c.addressFormat},g=await this.getTransactionForSigning({encodedTransaction:n,networkId:s,submissionConfig:a,account:t.account,methodName:o}),m={organizationId:this.config.organizationId,walletId:r,transaction:g,derivationInfo:l};e&&(m.submissionConfig=a),e&&t.account&&(m.simulationConfig={account:t.account});const I={method:_l.signTransaction,params:m,timestampMs:await zr()},_=await this.kmsApi.postKmsRpc(I,{headers:{"X-Rpc-Method":o}}),b=_.data.result,v=_.data.rpc_submission_result,S=e&&v?v.result:null;return{signedTransaction:b.transaction,hash:S}}catch(a){const c=e?"sign and send":"sign";throw a instanceof mo?a:new Error(bf(a,`Failed to ${c} transaction`))}}async signTransaction(t){return{rawTransaction:(await this.performTransactionSigning(t,!1)).signedTransaction}}async signAndSendTransaction(t){const e=await this.performTransactionSigning(t,!0);return{rawTransaction:e.signedTransaction,hash:e.hash}}async getWalletAddresses(t,e,r){try{const n=r??0,s=e||[Or.Solana(n),Or.Ethereum(n),Or.Bitcoin(n),Or.Sui(n)],i={method:ya.getAccounts,params:{accounts:s,organizationId:this.config.organizationId,walletId:t},timestampMs:await zr()};return(await this.kmsApi.postKmsRpc(i)).data.result.map(l=>({addressType:l.addressFormat,address:l.address}))}catch(n){throw console.error("Failed to get wallet addresses:",n.response?.data||n.message),new Error(`Failed to get wallet addresses: ${n.response?.data?.message||n.message}`)}}async ethereumSignMessage(t){const e=t.walletId,r=t.message,n=t.networkId,s=t.derivationIndex??0;try{if(!this.config.organizationId)throw new Error("organizationId is required to sign a message");const i=Go(n,s);if(!i)throw new Error(`Unsupported network ID: ${n}`);const o={derivationPath:i.derivationPath,curve:i.curve,addressFormat:i.addressFormat},c={method:"ethereumSignMessage",params:{message:r,organizationId:this.config.organizationId,walletId:e,derivationInfo:o},timestampMs:await zr()};return(await this.kmsApi.postKmsRpc(c)).data.result.signature}catch(i){throw console.error("Failed to sign Ethereum message:",i.response?.data||i.message),new Error(`Failed to sign Ethereum message: ${i.response?.data?.message||i.message}`)}}async signUtf8Message(t){const e=t.walletId,r=t.message,n=t.networkId,s=t.derivationIndex??0;try{if(!this.config.organizationId)throw new Error("organizationId is required to sign a message");const i=Go(n,s);if(!i)throw new Error(`Unsupported network ID: ${n}`);const o={derivationPath:i.derivationPath,curve:i.curve,addressFormat:i.addressFormat},a={organizationId:this.config.organizationId,walletId:e,message:r,algorithm:i.algorithm,derivationInfo:o},c={method:Il.signUtf8Message,params:a,timestampMs:await zr()};return(await this.kmsApi.postKmsRpc(c)).data.result.signature}catch(i){throw console.error("Failed to sign raw payload:",i.response?.data||i.message),new Error(`Failed to sign raw payload: ${i.response?.data?.message||i.message}`)}}async ethereumSignTypedData(t){const e=t.walletId,r=t.typedData,n=t.networkId,s=t.derivationIndex??0;try{if(!this.config.organizationId)throw new Error("organizationId is required to sign typed data");const i=Go(n,s);if(!i)throw new Error(`Unsupported network ID: ${n}`);const o={derivationPath:i.derivationPath,curve:i.curve,addressFormat:i.addressFormat},a={method:"ethereumSignTypedData",params:{typedData:r,organizationId:this.config.organizationId,walletId:e,derivationInfo:o},timestampMs:await zr()};return(await this.kmsApi.postKmsRpc(a)).data.result.signature}catch(i){throw console.error("Failed to sign typed data:",i.response?.data||i.message),new Error(`Failed to sign typed data: ${i.response?.data?.message||i.message}`)}}async getWallets(t,e){try{const r={method:"getOrganizationWallets",params:{organizationId:this.config.organizationId,limit:t||20,offset:e||0},timestampMs:await zr()},s=(await this.kmsApi.postKmsRpc(r)).data.result;return{wallets:s.wallets.map(i=>({walletId:i.walletId,walletName:i.walletName})),totalCount:s.totalCount,limit:s.limit,offset:s.offset}}catch(r){throw console.error("Failed to get wallets:",r.response?.data||r.message),new Error(`Failed to get wallets: ${r.response?.data?.message||r.message}`)}}async getOrganization(t){try{const e={method:"getOrganization",params:{organizationId:t},timestampMs:await zr()};return(await this.kmsApi.postKmsRpc(e)).data.result}catch(e){throw console.error("Failed to get organization:",e.response?.data||e.message),new Error(`Failed to get organization: ${e.response?.data?.message||e.message}`)}}validateNameLength(t,e){if(t.length>64)throw new Error(`${e} name cannot exceed 64 characters. Current length: ${t.length}`)}async createOrganization(t,e,r){try{if(!t)throw new Error("Organization name is required");if(this.validateNameLength(t,"Organization"),!e||e.length===0)throw new Error("At least one user is required");for(const a of e){a.username&&this.validateNameLength(a.username,"Username");for(const c of a.authenticators)c.authenticatorName&&this.validateNameLength(c.authenticatorName,"Authenticator")}const n={organizationName:t,users:e.map(a=>({username:a.username||`user-${i0()}`,authenticators:a.authenticators,policy:a.role==="ADMIN"?{type:Sl.root}:{type:"CEL",preset:"LEGACY_USER_ROLE"}})),tags:r},s={method:bl.createOrganization,params:n,timestampMs:await zr()};return(await this.kmsApi.postKmsRpc(s)).data.result}catch(n){throw console.error("Failed to create organization:",n.response?.data||n.message),new Error(`Failed to create organization: ${n.response?.data?.message||n.message}`)}}async createAuthenticator(t){try{t.username&&this.validateNameLength(t.username,"Username"),t.authenticatorName&&this.validateNameLength(t.authenticatorName,"Authenticator"),t.authenticator?.authenticatorName&&this.validateNameLength(t.authenticator.authenticatorName,"Authenticator");const e={organizationId:t.organizationId,username:t.username,authenticatorName:t.authenticatorName,authenticator:t.authenticator,replaceExpirable:t.replaceExpirable},r={method:yl.createAuthenticator,params:e,timestampMs:await zr()};return(await this.kmsApi.postKmsRpc(r)).data.result}catch(e){throw console.error("Failed to create authenticator:",e.response?.data||e.message),new Error(`Failed to create authenticator: ${e.response?.data?.message||e.message}`)}}async deleteAuthenticator(t){try{const e={organizationId:t.organizationId,username:t.username,authenticatorId:t.authenticatorId},r={method:El.deleteAuthenticator,params:e,timestampMs:await zr()};return(await this.kmsApi.postKmsRpc(r)).data.result}catch(e){throw console.error("Failed to delete authenticator:",e.response?.data||e.message),new Error(`Failed to delete authenticator: ${e.response?.data?.message||e.message}`)}}async grantOrganizationAccess(t){try{const e={method:xl.grantOrganizationAccess,params:t,timestampMs:await zr()};return(await this.kmsApi.postKmsRpc(e)).data.result}catch(e){throw console.error("Failed to grant organization access:",e.response?.data||e.message),new Error(`Failed to grant organization access: ${e.response?.data?.message||e.message}`)}}async addUserToOrganization(t){try{const e={method:ml.addUserToOrganization,params:t,timestampMs:await zr()};await this.kmsApi.postKmsRpc(e)}catch(e){throw console.error("Failed to add user to organization:",e.response?.data||e.message),new Error(`Failed to add user to organization: ${e.response?.data?.message||e.message}`)}}async getWalletWithTag(t){try{const e={method:"getWalletWithTag",params:{organizationId:t.organizationId,tag:t.tag,derivationPaths:t.derivationPaths},timestampMs:await zr()};return(await this.kmsApi.postKmsRpc(e)).data.result}catch(e){throw console.error("Failed to get wallet with tag:",e.response?.data||e.message),new Error(`Failed to get wallet with tag: ${e.response?.data?.message||e.message}`)}}async stampRequest(t,e){const r=typeof t.data=="string"?t.data:t.data===void 0?"":JSON.stringify(t.data),n=je.Buffer.from(r,"utf8"),s=await e.stamp({data:n});return t.headers=t.headers||{},t.headers["X-Phantom-Stamp"]=s,t}},Oy=(t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)},u0=(t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},Ft=(t,e,r)=>(Oy(t,e,"access private method"),r),My=/^0x[a-fA-F0-9]{40}$/,Uy=/^([a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}(:[0-9]{1,5})?$/,Ly=/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(:[0-9]{1,5})?$/,Fy=/^localhost(:[0-9]{1,5})?$/,$y=/^[a-zA-Z0-9]{8,}$/,Ky=/^([a-zA-Z][a-zA-Z0-9+-.]*)$/;function zy({address:t,chainId:e,domain:r,nonce:n,uri:s,version:i,scheme:o,statement:a,requestId:c,resources:l,issuedAt:g=new Date,expirationTime:m,notBefore:I}){if(!My.test(t))throw new Error("address must be a hex value of 20 bytes (40 hex characters).");if(e!==Math.floor(e))throw new Error("chainId must be a EIP-155 chain ID.");if(!(Uy.test(r)||Ly.test(r)||Fy.test(r)))throw new Error("domain must be an RFC 3986 authority.");if(!$y.test(n))throw new Error("nonce must be at least 8 characters.");if(!vf(s))throw new Error("uri must be a RFC 3986 URI referring to the resource that is the subject of the signing.");if(i!=="1")throw new Error("version must be '1'.");if(o&&!Ky.test(o))throw new Error("scheme must be an RFC 3986 URI scheme.");if(a?.includes(`
`))throw new Error("statement must not include '\\n'.");const _=o?`${o}://${r}`:r,b=a?`${a}
`:"",v=`${_} wants you to sign in with your Ethereum account:
${t}

${b}`;let S=`URI: ${s}
Version: ${i}
Chain ID: ${e}
Nonce: ${n}
Issued At: ${g.toISOString()}`;if(m&&(S+=`
Expiration Time: ${m.toISOString()}`),I&&(S+=`
Not Before: ${I.toISOString()}`),c&&(S+=`
Request ID: ${c}`),l){let O=`
Resources:`;for(const $ of l){if(!vf($))throw new Error("resources must be RFC 3986 URIs.");O+=`
- ${$}`}S+=O}return`${v}
${S}`}function vf(t){if(/[^a-z0-9:/?#[\]@!$&'()*+,;=.\-_~%]/i.test(t)||/%[^0-9a-f]/i.test(t)||/%[0-9a-f](:?[^0-9a-f]|$)/i.test(t))return!1;const e=Vy(t),r=e[1],n=e[2],s=e[3],i=e[4],o=e[5];if(!(r?.length&&s.length>=0))return!1;if(n?.length){if(!(s.length===0||/^\//.test(s)))return!1}else if(/^\/\//.test(s))return!1;if(!/^[a-z][a-z0-9+\-.]*$/.test(r.toLowerCase()))return!1;let a="";return a+=`${r}:`,n?.length&&(a+=`//${n}`),a+=s,i?.length&&(a+=`?${i}`),o?.length&&(a+=`#${o}`),a}function Vy(t){return t.match(/(?:([^:/?#]+):)?(?:\/\/([^/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/)}var qy=4,Wy=100,Nr,Lr,jy=class{constructor(){u0(this,Nr),this.type="injected"}load(){let t=0;const e=(r,n)=>{const s=Wy*Math.pow(2,Math.min(t,5));setTimeout(()=>{if(Ft(this,Nr,Lr).call(this)){r();return}t++,t>=qy?n():e(r,n)},s)};return new Promise((r,n)=>{e(()=>r(this),n)})}getProvider(){return Ft(this,Nr,Lr).call(this)||null}get isConnected(){const t=Ft(this,Nr,Lr).call(this);return!!(t?.isConnected&&t.selectedAddress)}async connect({onlyIfTrusted:t}){const e=Ft(this,Nr,Lr).call(this);if(!e)throw new Error("Provider not found.");if(e.isConnected&&e.selectedAddress)return this.getAccounts();try{return await e.request({method:t?"eth_accounts":"eth_requestAccounts"})}catch{return}}async disconnect(){return Promise.resolve()}async getAccounts(){const t=Ft(this,Nr,Lr).call(this);if(!t)return[];try{return await t.request({method:"eth_accounts"})||[]}catch{return[]}}async signMessage(t,e){const r=Ft(this,Nr,Lr).call(this);if(!r)throw new Error("Provider not found.");if(!r.isConnected)throw new Error("Provider is not connected.");return await r.request({method:"eth_sign",params:[e,t]})}async signPersonalMessage(t,e){const r=Ft(this,Nr,Lr).call(this);if(!r)throw new Error("Provider not found.");if(!r.isConnected)throw new Error("Provider is not connected.");return await r.request({method:"personal_sign",params:[t,e]})}async signTypedData(t,e){const r=Ft(this,Nr,Lr).call(this);if(!r)throw new Error("Provider not found.");if(!r.isConnected)throw new Error("Provider is not connected.");return await r.request({method:"eth_signTypedData_v4",params:[e,JSON.stringify(t)]})}async signIn(t){const e=Ft(this,Nr,Lr).call(this);if(!e)throw new Error("Provider not found.");const r=zy(t),n=e.selectedAddress;if(!n)throw new Error("No address available.");const s=await this.signPersonalMessage(r,n);return{address:n,signature:s,signedMessage:r}}async sendTransaction(t){const e=Ft(this,Nr,Lr).call(this);if(!e)throw new Error("Provider not found.");if(!e.isConnected)throw new Error("Provider is not connected.");return await e.request({method:"eth_sendTransaction",params:[t]})}async signTransaction(t){const e=Ft(this,Nr,Lr).call(this);if(!e)throw new Error("Provider not found.");if(!e.isConnected)throw new Error("Provider is not connected.");return await e.request({method:"eth_signTransaction",params:[t]})}async getChainId(){const t=Ft(this,Nr,Lr).call(this);if(!t)throw new Error("Provider not found.");return await t.request({method:"eth_chainId"})}async switchChain(t){const e=Ft(this,Nr,Lr).call(this);if(!e)throw new Error("Provider not found.");await e.request({method:"wallet_switchEthereumChain",params:[{chainId:t}]})}async request(t){const e=Ft(this,Nr,Lr).call(this);if(!e)throw new Error("Provider not found.");return await e.request(t)}};Nr=new WeakSet;Lr=function(){if(!(typeof window>"u"))return window?.phantom?.ethereum};async function gn(t="injected"){if(t==="injected"){const e=new jy;try{return await e.load(),e}catch{throw new Error("Provider not found.")}}else throw new Error("Invalid provider type.")}var ho=new Map;function Hy(t,e){return ho.has(t)||ho.set(t,new Set),ho.get(t)?.add(e),()=>f0(t,e)}function f0(t,e){const r=ho.get(t);r&&r.delete(e)}function fs(t,e){const r=ho.get(t);r&&r.forEach(n=>{try{n(e)}catch(s){console.error(`Error in ${t} event listener:`,s)}})}async function Gy({onlyIfTrusted:t=!1}={}){const e=await gn();if(!e)throw new Error("Provider not found.");if(e.isConnected)return await e.getAccounts();try{const r=await e.connect({onlyIfTrusted:!0});if(r&&r.length>0)return fs("connect",r),r}catch{}if(t)throw new Error("No trusted connection available.");try{const r=await e.connect({onlyIfTrusted:!1});if(r&&r.length>0)return fs("connect",r),r}catch{}throw new Error("Failed to connect to Phantom.")}async function Jy(){const t=await gn();if(!t)throw new Error("Provider not found.");await t.disconnect(),fs("disconnect",[])}async function Zy(){const t=await gn();if(!t)throw new Error("Provider not found.");return t.getAccounts()}async function Yy(t,e){const r=await gn();if(!r)throw new Error("Provider not found.");return r.isConnected||await r.connect({onlyIfTrusted:!1}),r.signPersonalMessage(t,e)}async function Xy(t,e){const r=await gn();if(!r)throw new Error("Provider not found.");return r.isConnected||await r.connect({onlyIfTrusted:!1}),r.signTypedData(t,e)}async function Qy(t){const e=await gn();if(!e)throw new Error("Provider not found.");return e.isConnected||await e.connect({onlyIfTrusted:!1}),e.sendTransaction(t)}async function e1(t){const e=await gn();if(!e)throw new Error("Provider not found.");return e.isConnected||await e.connect({onlyIfTrusted:!1}),e.signTransaction(t)}async function t1(){const t=await gn();if(!t)throw new Error("Provider not found.");return t.getChainId()}async function r1(t){const e=await gn();if(!e)throw new Error("Provider not found.");return e.switchChain(t)}var n1=class{constructor(){this._chainId="0x1",this._accounts=[],this.bindProviderEvents()}get connected(){return this._accounts.length>0}get chainId(){return this._chainId}get accounts(){return this._accounts}async request(t){const e=await gn();if(!e)throw new Error("Provider not found.");const r=e.getProvider();if(!r)throw new Error("Provider instance not found.");return r.request(t)}async connect(){const t=await Gy();return this._accounts=t,t}async disconnect(){await Jy(),this._accounts=[]}signPersonalMessage(t,e){return Yy(t,e)}signTypedData(t,e){return Xy(t,e)}signTransaction(t){return e1(t)}sendTransaction(t){return Qy(t)}async switchChain(t){const e=typeof t=="string"?t.toLowerCase().startsWith("0x")?t.toLowerCase():`0x${parseInt(t,10).toString(16)}`:`0x${t.toString(16)}`;await r1(e),this._chainId=e}async getChainId(){const t=await t1(),e=parseInt(t,16);return this._chainId=t,e}async getAccounts(){const t=await Zy();return this._accounts=t,t}isConnected(){return this._accounts.length>0}on(t,e){Hy(t,e)}off(t,e){f0(t,e)}async bindProviderEvents(){try{const e=(await gn()).getProvider();e&&(e.on("connect",async()=>{try{const r=await e.request({method:"eth_accounts"});r?.length>0&&(this._accounts=r,fs("connect",r))}catch{}}),e.on("disconnect",()=>{this._accounts=[],fs("disconnect",{code:4900,message:"Provider disconnected"})}),e.on("accountsChanged",r=>{this._accounts=r,fs("accountsChanged",r),r&&r.length>0&&fs("connect",r)}),e.on("chainChanged",r=>{this._chainId=r,fs("chainChanged",r)}))}catch{}}};function s1(){return{name:"ethereum",create:()=>new n1}}function Ga(){try{return!!window?.phantom}catch{return!1}}var i1={isInstalled:Ga};function o1(){return{name:"extension",create:()=>i1}}function a1({plugins:t=[]}){const e={};for(const r of t)e[r.name]=r.create();return e}var c1=4,l1=100,Vr,Yr,u1=class{constructor(){u0(this,Vr),this.type="injected"}load(){let t=0;const e=(r,n)=>{const s=l1*Math.pow(2,Math.min(t,5));setTimeout(()=>{if(Ft(this,Vr,Yr).call(this)){r();return}t++,t>=c1?n():e(r,n)},s)};return new Promise((r,n)=>{e(()=>r(this),n)})}getProvider(){return Ft(this,Vr,Yr).call(this)||null}get isConnected(){const t=Ft(this,Vr,Yr).call(this);return!!(t?.isConnected&&t.publicKey)}async connect({onlyIfTrusted:t}){const e=Ft(this,Vr,Yr).call(this);if(!e)throw new Error("Provider not found.");if(e.isConnected&&e.publicKey)return this.getAccount()??void 0;try{return(await e.connect({onlyIfTrusted:t})).publicKey.toString()}catch{return}}async disconnect(){const t=Ft(this,Vr,Yr).call(this);if(!t)throw new Error("Provider not found.");await t.disconnect()}async getAccount(){const t=Ft(this,Vr,Yr).call(this);return t&&t.isConnected&&t.publicKey?Promise.resolve(t.publicKey.toString()):Promise.resolve(void 0)}async signMessage(t,e){const r=Ft(this,Vr,Yr).call(this);if(!r)throw new Error("Provider not found.");if(!r.isConnected)throw new Error("Provider is not connected.");const n=await r.signMessage(t,e);return{signature:n.signature,address:n.publicKey.toString()}}async signIn(t){const e=Ft(this,Vr,Yr).call(this);if(!e)throw new Error("Provider not found.");const r=await e.signIn(t);return{address:r.address.toString(),signature:r.signature,signedMessage:r.signedMessage}}async signAndSendTransaction(t){const e=Ft(this,Vr,Yr).call(this);if(!e)throw new Error("Provider not found.");if(!e.isConnected)throw new Error("Provider is not connected.");const r=await e.signAndSendTransaction(t);return{signature:r.signature,address:r.publicKey}}async signAndSendAllTransactions(t){const e=Ft(this,Vr,Yr).call(this);if(!e)throw new Error("Provider not found.");if(!e.isConnected)throw new Error("Provider is not connected.");if(!e.signAndSendAllTransactions)throw new Error("Provider does not support signAndSendAllTransactions.");const r=await e.signAndSendAllTransactions(t);return{signatures:r.signatures,address:r.publicKey}}async signTransaction(t){const e=Ft(this,Vr,Yr).call(this);if(!e)throw new Error("Provider not found.");if(!e.isConnected)throw new Error("Provider is not connected.");return await e.signTransaction(t)}async signAllTransactions(t){const e=Ft(this,Vr,Yr).call(this);if(!e)throw new Error("Provider not found.");if(!e.isConnected)throw new Error("Provider is not connected.");return await e.signAllTransactions(t)}};Vr=new WeakSet;Yr=function(){if(!(typeof window>"u"))return window?.phantom?.solana};async function Xn(t="injected"){if(t==="injected"){const e=new u1;try{return await e.load(),e}catch{throw new Error("Provider not found.")}}else throw new Error("Invalid provider type.")}var Vn=new Map;function f1(t,e){return Vn.has(t)||Vn.set(t,new Set),Vn.get(t)?.add(e),()=>{h0(t,e)}}function h0(t,e){Vn.has(t)&&(Vn.get(t)?.delete(e),Vn.get(t)?.size===0&&Vn.delete(t))}function hs(t,...e){Vn.has(t)&&Vn.get(t)?.forEach(r=>{try{r(...e)}catch(n){console.error(`Error in ${t} event listener:`,n)}})}async function h1({onlyIfTrusted:t=!1}={}){const e=await Xn();if(!e)throw new Error("Provider not found.");if(e.isConnected)return e.getAccount();try{const r=await e.connect({onlyIfTrusted:!0});if(r)return hs("connect",r),r}catch{}if(t)throw new Error("No trusted connection available.");try{const r=await e.connect({onlyIfTrusted:!1});if(r)return hs("connect",r),r}catch{}throw new Error("Failed to connect to Phantom.")}async function d1(){const t=await Xn();if(!t)throw new Error("Provider not found.");await t.disconnect(),hs("disconnect")}async function p1(){return(await Xn()).getAccount()}async function g1(t){const e=await Xn();if(!e)throw new Error("Provider not found.");return e.isConnected||await e.connect({onlyIfTrusted:!1}),e.signAndSendTransaction(t)}async function w1(t){const e=await Xn();if(!e)throw new Error("Provider not found.");return e.isConnected||await e.connect({onlyIfTrusted:!1}),e.signAndSendAllTransactions(t)}async function m1(t){const e=await Xn();if(!e)throw new Error("Provider not found.");return e.isConnected||await e.connect({onlyIfTrusted:!1}),e.signTransaction(t)}async function y1(t){const e=await Xn();if(!e)throw new Error("Provider not found.");return e.isConnected||await e.connect({onlyIfTrusted:!1}),e.signAllTransactions(t)}async function b1(t,e){const r=await Xn();if(!r)throw new Error("Provider not found.");return r.isConnected||await r.connect({onlyIfTrusted:!1}),r.signMessage(t,e)}var v1=class{constructor(){this._publicKey=null,this.bindProviderEvents()}get publicKey(){return this._publicKey}get connected(){return this._publicKey!==null}async connect(t){const e=await h1(t);if(!e)throw new Error("Failed to connect to Solana wallet");return this._publicKey=e,{publicKey:e}}async disconnect(){await d1(),this._publicKey=null}async signMessage(t){const e=typeof t=="string"?new TextEncoder().encode(t):t,r=await b1(e);return{signature:r.signature instanceof Uint8Array?r.signature:new Uint8Array(r.signature),publicKey:r.address||this._publicKey||""}}signTransaction(t){return m1(t)}async signAndSendTransaction(t){return{signature:(await g1(t)).signature}}signAllTransactions(t){return y1(t)}async signAndSendAllTransactions(t){return{signatures:(await w1(t)).signatures}}async switchNetwork(t){return Promise.resolve()}async getPublicKey(){if(this._publicKey)return this._publicKey;try{const t=await p1();return this._publicKey=t||null,this._publicKey}catch{return null}}isConnected(){return this._publicKey!==null}on(t,e){f1(t,e)}off(t,e){h0(t,e)}async bindProviderEvents(){try{const e=(await Xn()).getProvider();e&&(e.on("connect",r=>{if(r){const n=r.toString();this._publicKey=n,hs("connect",n)}}),e.on("disconnect",()=>{this._publicKey=null,hs("disconnect")}),e.on("accountChanged",r=>{if(r){const n=r.toString();this._publicKey=n,hs("accountChanged",n),hs("connect",n)}else this._publicKey=null,hs("accountChanged",null)}))}catch{}}};function E1(){return{name:"solana",create:()=>new v1}}function Ja(){if(typeof window>"u")return null;const t=window?.phantom?.app;return t||null}async function x1(t){const e=await Ja();if(!e)throw new Error("Provider not found.");const r=t?.chains?{chains:t.chains.map(Ey)}:{},n=await e.request({method:"phantom_auto_confirm_enable",params:r});return{...n,chains:n.chains.map(Ha)}}async function _1(){const t=await Ja();if(!t)throw new Error("Provider not found.");const e=await t.request({method:"phantom_auto_confirm_disable",params:{}});return{...e,chains:e.chains.map(Ha)}}async function I1(){const t=await Ja();if(!t)throw new Error("Provider not found.");const e=await t.request({method:"phantom_auto_confirm_status",params:{}});return{...e,chains:e.chains.map(Ha)}}async function S1(){const t=await Ja();if(!t)throw new Error("Provider not found.");return{chains:(await t.request({method:"phantom_auto_confirm_supported_chains",params:{}})).chains.map(Ha)}}var A1={autoConfirmEnable:x1,autoConfirmDisable:_1,autoConfirmStatus:I1,autoConfirmSupportedChains:S1};function R1(){return{name:"autoConfirm",create:()=>A1}}var vc={exports:{}},Ef;function B1(){return Ef||(Ef=1,(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function s(c,l,g){this.fn=c,this.context=l,this.once=g||!1}function i(c,l,g,m,I){if(typeof g!="function")throw new TypeError("The listener must be a function");var _=new s(g,m||c,I),b=r?r+l:l;return c._events[b]?c._events[b].fn?c._events[b]=[c._events[b],_]:c._events[b].push(_):(c._events[b]=_,c._eventsCount++),c}function o(c,l){--c._eventsCount===0?c._events=new n:delete c._events[l]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],g,m;if(this._eventsCount===0)return l;for(m in g=this._events)e.call(g,m)&&l.push(r?m.slice(1):m);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(g)):l},a.prototype.listeners=function(l){var g=r?r+l:l,m=this._events[g];if(!m)return[];if(m.fn)return[m.fn];for(var I=0,_=m.length,b=new Array(_);I<_;I++)b[I]=m[I].fn;return b},a.prototype.listenerCount=function(l){var g=r?r+l:l,m=this._events[g];return m?m.fn?1:m.length:0},a.prototype.emit=function(l,g,m,I,_,b){var v=r?r+l:l;if(!this._events[v])return!1;var S=this._events[v],O=arguments.length,$,k;if(S.fn){switch(S.once&&this.removeListener(l,S.fn,void 0,!0),O){case 1:return S.fn.call(S.context),!0;case 2:return S.fn.call(S.context,g),!0;case 3:return S.fn.call(S.context,g,m),!0;case 4:return S.fn.call(S.context,g,m,I),!0;case 5:return S.fn.call(S.context,g,m,I,_),!0;case 6:return S.fn.call(S.context,g,m,I,_,b),!0}for(k=1,$=new Array(O-1);k<O;k++)$[k-1]=arguments[k];S.fn.apply(S.context,$)}else{var Z=S.length,q;for(k=0;k<Z;k++)switch(S[k].once&&this.removeListener(l,S[k].fn,void 0,!0),O){case 1:S[k].fn.call(S[k].context);break;case 2:S[k].fn.call(S[k].context,g);break;case 3:S[k].fn.call(S[k].context,g,m);break;case 4:S[k].fn.call(S[k].context,g,m,I);break;default:if(!$)for(q=1,$=new Array(O-1);q<O;q++)$[q-1]=arguments[q];S[k].fn.apply(S[k].context,$)}}return!0},a.prototype.on=function(l,g,m){return i(this,l,g,m,!1)},a.prototype.once=function(l,g,m){return i(this,l,g,m,!0)},a.prototype.removeListener=function(l,g,m,I){var _=r?r+l:l;if(!this._events[_])return this;if(!g)return o(this,_),this;var b=this._events[_];if(b.fn)b.fn===g&&(!I||b.once)&&(!m||b.context===m)&&o(this,_);else{for(var v=0,S=[],O=b.length;v<O;v++)(b[v].fn!==g||I&&!b[v].once||m&&b[v].context!==m)&&S.push(b[v]);S.length?this._events[_]=S.length===1?S[0]:S:o(this,_)}return this},a.prototype.removeAllListeners=function(l){var g;return l?(g=r?r+l:l,this._events[g]&&o(this,g)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,t.exports=a})(vc)),vc.exports}var T1=B1();const Qs=ja(T1);var ba=typeof window<"u"&&typeof window.btoa<"u";function hr(t){let e;return ba?typeof t=="string"?e=btoa(t):e=btoa(String.fromCharCode(...Array.from(t))):typeof t=="string"?e=Buffer.from(t,"utf8").toString("base64"):e=Buffer.from(t).toString("base64"),e.replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function ji(t){const e=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"=");if(ba){const r=atob(e),n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}else return new Uint8Array(Buffer.from(e,"base64"))}function P1(t){if(ba&&typeof TextEncoder<"u"){const e=new TextEncoder().encode(t);return hr(e)}else return hr(t)}var C1=8078e3,D1=8078001,k1=8078004,N1=8078005,O1=8078006,M1=8078011;function d0(t){return Array.isArray(t)?"%5B"+t.map(d0).join("%2C%20")+"%5D":typeof t=="bigint"?`${t}n`:encodeURIComponent(String(t!=null&&Object.getPrototypeOf(t)===null?{...t}:t))}function U1([t,e]){return`${t}=${d0(e)}`}function L1(t){const e=Object.entries(t).map(U1).join("&");return btoa(e)}function F1(t,e={}){{let r=`Solana error #${t}; Decode this error by running \`npx @solana/errors decode -- ${t}`;return Object.keys(e).length&&(r+=` '${L1(e)}'`),`${r}\``}}var Si=class extends Error{cause=this.cause;context;constructor(...[t,e]){let r,n;if(e){const{cause:i,...o}=e;i&&(n={cause:i}),Object.keys(o).length>0&&(r=o)}const s=F1(t,r);super(s,n),this.context={__code:t,...r},this.name="SolanaError"}};function $1(t,e){return"fixedSize"in e?e.fixedSize:e.getSizeFromValue(t)}function K1(t){return Object.freeze({...t,encode:e=>{const r=new Uint8Array($1(e,t));return t.write(e,r,0),r}})}function z1(t){return Object.freeze({...t,decode:(e,r=0)=>t.read(e,r)[0]})}function fi(t){return"fixedSize"in t&&typeof t.fixedSize=="number"}function V1(t,e){if(fi(t)!==fi(e))throw new Si(k1);if(fi(t)&&fi(e)&&t.fixedSize!==e.fixedSize)throw new Si(N1,{decoderFixedSize:e.fixedSize,encoderFixedSize:t.fixedSize});if(!fi(t)&&!fi(e)&&t.maxSize!==e.maxSize)throw new Si(O1,{decoderMaxSize:e.maxSize,encoderMaxSize:t.maxSize});return{...e,...t,decode:e.decode,encode:t.encode,read:e.read,write:t.write}}function q1(t,e,r=0){if(e.length-r<=0)throw new Si(C1,{codecDescription:t})}function W1(t,e,r,n=0){const s=r.length-n;if(s<e)throw new Si(D1,{bytesLength:s,codecDescription:t,expected:e})}function j1(t,e,r,n){if(n<e||n>r)throw new Si(M1,{codecDescription:t,max:r,min:e,value:n})}function p0(t){return t?.endian!==1}function H1(t){return K1({fixedSize:t.size,write(e,r,n){t.range&&j1(t.name,t.range[0],t.range[1],e);const s=new ArrayBuffer(t.size);return t.set(new DataView(s),e,p0(t.config)),r.set(new Uint8Array(s),n),n+t.size}})}function G1(t){return z1({fixedSize:t.size,read(e,r=0){q1(t.name,e,r),W1(t.name,t.size,e,r);const n=new DataView(J1(e,r,t.size));return[t.get(n,p0(t.config)),r+t.size]}})}function J1(t,e,r){const n=t.byteOffset+(e??0),s=r??t.byteLength;return t.buffer.slice(n,n+s)}var Z1=(t={})=>H1({config:t,name:"u64",range:[0n,BigInt("0xffffffffffffffff")],set:(e,r,n)=>e.setBigUint64(0,BigInt(r),n),size:8}),Y1=(t={})=>G1({config:t,get:(e,r)=>e.getBigUint64(0,r),name:"u64",size:8}),X1=(t={})=>V1(Z1(t),Y1(t));const Q1="6.16.0";function xf(t,e,r){for(let n in e){let s=e[n];Object.defineProperty(t,n,{enumerable:!0,value:s,writable:!1})}}function bi(t,e){if(t==null)return"null";if(e==null&&(e=new Set),typeof t=="object"){if(e.has(t))return"[Circular]";e.add(t)}if(Array.isArray(t))return"[ "+t.map(r=>bi(r,e)).join(", ")+" ]";if(t instanceof Uint8Array){const r="0123456789abcdef";let n="0x";for(let s=0;s<t.length;s++)n+=r[t[s]>>4],n+=r[t[s]&15];return n}if(typeof t=="object"&&typeof t.toJSON=="function")return bi(t.toJSON(),e);switch(typeof t){case"boolean":case"number":case"symbol":return t.toString();case"bigint":return BigInt(t).toString();case"string":return JSON.stringify(t);case"object":{const r=Object.keys(t);return r.sort(),"{ "+r.map(n=>`${bi(n,e)}: ${bi(t[n],e)}`).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function eb(t,e,r){let n=t;{const i=[];if(r){if("message"in r||"code"in r||"name"in r)throw new Error(`value will overwrite populated values: ${bi(r)}`);for(const o in r){if(o==="shortMessage")continue;const a=r[o];i.push(o+"="+bi(a))}}i.push(`code=${e}`),i.push(`version=${Q1}`),i.length&&(t+=" ("+i.join(", ")+")")}let s;switch(e){case"INVALID_ARGUMENT":s=new TypeError(t);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":s=new RangeError(t);break;default:s=new Error(t)}return xf(s,{code:e}),r&&Object.assign(s,r),s.shortMessage==null&&xf(s,{shortMessage:n}),s}function Fr(t,e,r,n){if(!t)throw eb(e,r,n)}function Ce(t,e,r,n){Fr(t,e,"INVALID_ARGUMENT",{argument:r,value:n})}["NFD","NFC","NFKD","NFKC"].reduce((t,e)=>{try{if("test".normalize(e)!=="test")throw new Error("bad");if(e==="NFD"&&"".normalize("NFD")!=="e")throw new Error("broken");t.push(e)}catch{}return t},[]);function tb(t,e,r){if(t!==e){let n=r,s="new";n+=".",s+=" "+r,Fr(!1,`private constructor; use ${n}from* methods`,"UNSUPPORTED_OPERATION",{operation:s})}}function g0(t,e,r){if(t instanceof Uint8Array)return r?new Uint8Array(t):t;if(typeof t=="string"&&t.length%2===0&&t.match(/^0x[0-9a-f]*$/i)){const n=new Uint8Array((t.length-2)/2);let s=2;for(let i=0;i<n.length;i++)n[i]=parseInt(t.substring(s,s+2),16),s+=2;return n}Ce(!1,"invalid BytesLike value",e||"value",t)}function $t(t,e){return g0(t,e,!1)}function no(t,e){return g0(t,e,!0)}function xs(t,e){return!(typeof t!="string"||!t.match(/^0x[0-9A-Fa-f]*$/)||typeof e=="number"&&t.length!==2+2*e||e===!0&&t.length%2!==0)}function rb(t){return xs(t,!0)||t instanceof Uint8Array}const _f="0123456789abcdef";function ct(t){const e=$t(t);let r="0x";for(let n=0;n<e.length;n++){const s=e[n];r+=_f[(s&240)>>4]+_f[s&15]}return r}function Sn(t){return"0x"+t.map(e=>ct(e).substring(2)).join("")}function po(t){return xs(t,!0)?(t.length-2)/2:$t(t).length}function nb(t,e,r){const n=$t(t);Fr(e>=n.length,"padding exceeds data length","BUFFER_OVERRUN",{buffer:new Uint8Array(n),length:e,offset:e+1});const s=new Uint8Array(e);return s.fill(0),s.set(n,e-n.length),ct(s)}function Js(t,e){return nb(t,e)}const ou=BigInt(0);BigInt(1);const vi=9007199254740991;function vr(t,e){switch(typeof t){case"bigint":return t;case"number":return Ce(Number.isInteger(t),"underflow",e||"value",t),Ce(t>=-vi&&t<=vi,"overflow",e||"value",t),BigInt(t);case"string":try{if(t==="")throw new Error("empty string");return t[0]==="-"&&t[1]!=="-"?-BigInt(t.substring(1)):BigInt(t)}catch(r){Ce(!1,`invalid BigNumberish string: ${r.message}`,e||"value",t)}}Ce(!1,"invalid BigNumberish value",e||"value",t)}function w0(t,e){const r=vr(t,e);return Fr(r>=ou,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:t}),r}function ys(t,e){switch(typeof t){case"bigint":return Ce(t>=-vi&&t<=vi,"overflow",e||"value",t),Number(t);case"number":return Ce(Number.isInteger(t),"underflow",e||"value",t),Ce(t>=-vi&&t<=vi,"overflow",e||"value",t),t;case"string":try{if(t==="")throw new Error("empty string");return ys(BigInt(t),e)}catch(r){Ce(!1,`invalid numeric string: ${r.message}`,e||"value",t)}}Ce(!1,"invalid numeric value",e||"value",t)}function If(t,e){const r=w0(t,"value");let n=r.toString(16);{const s=ys(e,"width");if(s===0&&r===ou)return"0x";for(Fr(s*2>=n.length,`value exceeds width (${s} bytes)`,"NUMERIC_FAULT",{operation:"toBeHex",fault:"overflow",value:t});n.length<s*2;)n="0"+n}return"0x"+n}function xr(t,e){const r=w0(t,"value");if(r===ou)return new Uint8Array(0);let n=r.toString(16);n.length%2&&(n="0"+n);const s=new Uint8Array(n.length/2);for(let i=0;i<s.length;i++){const o=i*2;s[i]=parseInt(n.substring(o,o+2),16)}return s}function sb(t){let e=t.toString(16);for(;e.length<2;)e="0"+e;return"0x"+e}function Sf(t,e,r){let n=0;for(let s=0;s<r;s++)n=n*256+t[e+s];return n}function Af(t,e,r,n){const s=[];for(;r<e+1+n;){const i=m0(t,r);s.push(i.result),r+=i.consumed,Fr(r<=e+1+n,"child data too short","BUFFER_OVERRUN",{buffer:t,length:n,offset:e})}return{consumed:1+n,result:s}}function m0(t,e){Fr(t.length!==0,"data too short","BUFFER_OVERRUN",{buffer:t,length:0,offset:1});const r=n=>{Fr(n<=t.length,"data short segment too short","BUFFER_OVERRUN",{buffer:t,length:t.length,offset:n})};if(t[e]>=248){const n=t[e]-247;r(e+1+n);const s=Sf(t,e+1,n);return r(e+1+n+s),Af(t,e,e+1+n,n+s)}else if(t[e]>=192){const n=t[e]-192;return r(e+1+n),Af(t,e,e+1,n)}else if(t[e]>=184){const n=t[e]-183;r(e+1+n);const s=Sf(t,e+1,n);r(e+1+n+s);const i=ct(t.slice(e+1+n,e+1+n+s));return{consumed:1+n+s,result:i}}else if(t[e]>=128){const n=t[e]-128;r(e+1+n);const s=ct(t.slice(e+1,e+1+n));return{consumed:1+n,result:s}}return{consumed:1,result:sb(t[e])}}function Do(t){const e=$t(t,"data"),r=m0(e,0);return Ce(r.consumed===e.length,"unexpected junk after rlp payload","data",t),r.result}function Rf(t){const e=[];for(;t;)e.unshift(t&255),t>>=8;return e}function y0(t){if(Array.isArray(t)){let n=[];if(t.forEach(function(i){n=n.concat(y0(i))}),n.length<=55)return n.unshift(192+n.length),n;const s=Rf(n.length);return s.unshift(247+s.length),s.concat(n)}const e=Array.prototype.slice.call($t(t,"object"));if(e.length===1&&e[0]<=127)return e;if(e.length<=55)return e.unshift(128+e.length),e;const r=Rf(e.length);return r.unshift(183+r.length),r.concat(e)}const Bf="0123456789abcdef";function bs(t){let e="0x";for(const r of y0(t))e+=Bf[r>>4],e+=Bf[r&15];return e}function va(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function au(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function ib(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");va(t.outputLen),va(t.blockLen)}function ki(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function b0(t,e){au(t);const r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}const Ec=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;const v0=t=>t instanceof Uint8Array,ob=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),xc=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),bn=(t,e)=>t<<32-e|t>>>e,ab=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!ab)throw new Error("Non little-endian hardware is not supported");function cb(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Za(t){if(typeof t=="string"&&(t=cb(t)),!v0(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function lb(...t){const e=new Uint8Array(t.reduce((n,s)=>n+s.length,0));let r=0;return t.forEach(n=>{if(!v0(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}let cu=class{clone(){return this._cloneInto()}};function lu(t){const e=n=>t().update(Za(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function ub(t=32){if(Ec&&typeof Ec.getRandomValues=="function")return Ec.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}let E0=class extends cu{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,ib(e);const n=Za(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(n.length>s?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return ki(this),this.iHash.update(e),this}digestInto(e){ki(this),au(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:n,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const x0=(t,e,r)=>new E0(t,e).update(r).digest();x0.create=(t,e)=>new E0(t,e);function fb(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(r>>s&i),a=Number(r&i),c=n?4:0,l=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+l,a,n)}class _0 extends cu{constructor(e,r,n,s){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=xc(this.buffer)}update(e){ki(this);const{view:r,buffer:n,blockLen:s}=this;e=Za(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=xc(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){ki(this),b0(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let m=o;m<s;m++)r[m]=0;fb(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=xc(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,g=this.get();if(l>g.length)throw new Error("_sha2: outputLen bigger than state");for(let m=0;m<l;m++)a.setUint32(4*m,g[m],i)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%r&&e.buffer.set(n),e}}const hb=(t,e,r)=>t&e^~t&r,db=(t,e,r)=>t&e^t&r^e&r,pb=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),es=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ts=new Uint32Array(64);let gb=class extends _0{constructor(){super(64,32,8,!1),this.A=es[0]|0,this.B=es[1]|0,this.C=es[2]|0,this.D=es[3]|0,this.E=es[4]|0,this.F=es[5]|0,this.G=es[6]|0,this.H=es[7]|0}get(){const{A:e,B:r,C:n,D:s,E:i,F:o,G:a,H:c}=this;return[e,r,n,s,i,o,a,c]}set(e,r,n,s,i,o,a,c){this.A=e|0,this.B=r|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,r){for(let m=0;m<16;m++,r+=4)ts[m]=e.getUint32(r,!1);for(let m=16;m<64;m++){const I=ts[m-15],_=ts[m-2],b=bn(I,7)^bn(I,18)^I>>>3,v=bn(_,17)^bn(_,19)^_>>>10;ts[m]=v+ts[m-7]+b+ts[m-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:c,G:l,H:g}=this;for(let m=0;m<64;m++){const I=bn(a,6)^bn(a,11)^bn(a,25),_=g+I+hb(a,c,l)+pb[m]+ts[m]|0,v=(bn(n,2)^bn(n,13)^bn(n,22))+db(n,s,i)|0;g=l,l=c,c=a,a=o+_|0,o=i,i=s,s=n,n=_+v|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,g=g+this.H|0,this.set(n,s,i,o,a,c,l,g)}roundClean(){ts.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const I0=lu(()=>new gb),Jo=BigInt(2**32-1),Rl=BigInt(32);function S0(t,e=!1){return e?{h:Number(t&Jo),l:Number(t>>Rl&Jo)}:{h:Number(t>>Rl&Jo)|0,l:Number(t&Jo)|0}}function A0(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:i,l:o}=S0(t[s],e);[r[s],n[s]]=[i,o]}return[r,n]}const wb=(t,e)=>BigInt(t>>>0)<<Rl|BigInt(e>>>0),mb=(t,e,r)=>t>>>r,yb=(t,e,r)=>t<<32-r|e>>>r,bb=(t,e,r)=>t>>>r|e<<32-r,vb=(t,e,r)=>t<<32-r|e>>>r,Eb=(t,e,r)=>t<<64-r|e>>>r-32,xb=(t,e,r)=>t>>>r-32|e<<64-r,_b=(t,e)=>e,Ib=(t,e)=>t,R0=(t,e,r)=>t<<r|e>>>32-r,B0=(t,e,r)=>e<<r|t>>>32-r,T0=(t,e,r)=>e<<r-32|t>>>64-r,P0=(t,e,r)=>t<<r-32|e>>>64-r;function Sb(t,e,r,n){const s=(e>>>0)+(n>>>0);return{h:t+r+(s/2**32|0)|0,l:s|0}}const Ab=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),Rb=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,Bb=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),Tb=(t,e,r,n,s)=>e+r+n+s+(t/2**32|0)|0,Pb=(t,e,r,n,s)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(s>>>0),Cb=(t,e,r,n,s,i)=>e+r+n+s+i+(t/2**32|0)|0,ot={fromBig:S0,split:A0,toBig:wb,shrSH:mb,shrSL:yb,rotrSH:bb,rotrSL:vb,rotrBH:Eb,rotrBL:xb,rotr32H:_b,rotr32L:Ib,rotlSH:R0,rotlSL:B0,rotlBH:T0,rotlBL:P0,add:Sb,add3L:Ab,add3H:Rb,add4L:Bb,add4H:Tb,add5H:Cb,add5L:Pb},[Db,kb]=ot.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),rs=new Uint32Array(80),ns=new Uint32Array(80);let Nb=class extends _0{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:r,Bh:n,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:g,Fh:m,Fl:I,Gh:_,Gl:b,Hh:v,Hl:S}=this;return[e,r,n,s,i,o,a,c,l,g,m,I,_,b,v,S]}set(e,r,n,s,i,o,a,c,l,g,m,I,_,b,v,S){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=g|0,this.Fh=m|0,this.Fl=I|0,this.Gh=_|0,this.Gl=b|0,this.Hh=v|0,this.Hl=S|0}process(e,r){for(let k=0;k<16;k++,r+=4)rs[k]=e.getUint32(r),ns[k]=e.getUint32(r+=4);for(let k=16;k<80;k++){const Z=rs[k-15]|0,q=ns[k-15]|0,J=ot.rotrSH(Z,q,1)^ot.rotrSH(Z,q,8)^ot.shrSH(Z,q,7),se=ot.rotrSL(Z,q,1)^ot.rotrSL(Z,q,8)^ot.shrSL(Z,q,7),oe=rs[k-2]|0,V=ns[k-2]|0,W=ot.rotrSH(oe,V,19)^ot.rotrBH(oe,V,61)^ot.shrSH(oe,V,6),Y=ot.rotrSL(oe,V,19)^ot.rotrBL(oe,V,61)^ot.shrSL(oe,V,6),te=ot.add4L(se,Y,ns[k-7],ns[k-16]),A=ot.add4H(te,J,W,rs[k-7],rs[k-16]);rs[k]=A|0,ns[k]=te|0}let{Ah:n,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:g,Eh:m,El:I,Fh:_,Fl:b,Gh:v,Gl:S,Hh:O,Hl:$}=this;for(let k=0;k<80;k++){const Z=ot.rotrSH(m,I,14)^ot.rotrSH(m,I,18)^ot.rotrBH(m,I,41),q=ot.rotrSL(m,I,14)^ot.rotrSL(m,I,18)^ot.rotrBL(m,I,41),J=m&_^~m&v,se=I&b^~I&S,oe=ot.add5L($,q,se,kb[k],ns[k]),V=ot.add5H(oe,O,Z,J,Db[k],rs[k]),W=oe|0,Y=ot.rotrSH(n,s,28)^ot.rotrBH(n,s,34)^ot.rotrBH(n,s,39),te=ot.rotrSL(n,s,28)^ot.rotrBL(n,s,34)^ot.rotrBL(n,s,39),A=n&i^n&a^i&a,u=s&o^s&c^o&c;O=v|0,$=S|0,v=_|0,S=b|0,_=m|0,b=I|0,{h:m,l:I}=ot.add(l|0,g|0,V|0,W|0),l=a|0,g=c|0,a=i|0,c=o|0,i=n|0,o=s|0;const d=ot.add3L(W,te,u);n=ot.add3H(d,V,Y,A),s=d|0}({h:n,l:s}=ot.add(this.Ah|0,this.Al|0,n|0,s|0)),{h:i,l:o}=ot.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=ot.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:g}=ot.add(this.Dh|0,this.Dl|0,l|0,g|0),{h:m,l:I}=ot.add(this.Eh|0,this.El|0,m|0,I|0),{h:_,l:b}=ot.add(this.Fh|0,this.Fl|0,_|0,b|0),{h:v,l:S}=ot.add(this.Gh|0,this.Gl|0,v|0,S|0),{h:O,l:$}=ot.add(this.Hh|0,this.Hl|0,O|0,$|0),this.set(n,s,i,o,a,c,l,g,m,I,_,b,v,S,O,$)}roundClean(){rs.fill(0),ns.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const Ob=lu(()=>new Nb);function Mb(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}const Tf=Mb();Tf.crypto||Tf.msCrypto;function Ub(t){switch(t){case"sha256":return I0.create();case"sha512":return Ob.create()}Ce(!1,"invalid hashing algorithm name","algorithm",t)}const[C0,D0,k0]=[[],[],[]],Lb=BigInt(0),so=BigInt(1),Fb=BigInt(2),$b=BigInt(7),Kb=BigInt(256),zb=BigInt(113);for(let t=0,e=so,r=1,n=0;t<24;t++){[r,n]=[n,(2*r+3*n)%5],C0.push(2*(5*n+r)),D0.push((t+1)*(t+2)/2%64);let s=Lb;for(let i=0;i<7;i++)e=(e<<so^(e>>$b)*zb)%Kb,e&Fb&&(s^=so<<(so<<BigInt(i))-so);k0.push(s)}const[Vb,qb]=A0(k0,!0),Pf=(t,e,r)=>r>32?T0(t,e,r):R0(t,e,r),Cf=(t,e,r)=>r>32?P0(t,e,r):B0(t,e,r);function Wb(t,e=24){const r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)r[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=r[c],g=r[c+1],m=Pf(l,g,1)^r[a],I=Cf(l,g,1)^r[a+1];for(let _=0;_<50;_+=10)t[o+_]^=m,t[o+_+1]^=I}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=D0[o],c=Pf(s,i,a),l=Cf(s,i,a),g=C0[o];s=t[g],i=t[g+1],t[g]=c,t[g+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)r[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~r[(a+2)%10]&r[(a+4)%10]}t[0]^=Vb[n],t[1]^=qb[n]}r.fill(0)}class uu extends cu{constructor(e,r,n,s=!1,i=24){if(super(),this.blockLen=e,this.suffix=r,this.outputLen=n,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,va(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=ob(this.state)}keccak(){Wb(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){ki(this);const{blockLen:r,state:n}=this;e=Za(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(r-this.pos,s-i);for(let a=0;a<o;a++)n[this.pos++]^=e[i++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:r,pos:n,blockLen:s}=this;e[n]^=r,(r&128)!==0&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){ki(this,!1),au(e),this.finish();const r=this.state,{blockLen:n}=this;for(let s=0,i=e.length;s<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-s);e.set(r.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return va(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(b0(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:r,suffix:n,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new uu(r,n,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}}const jb=(t,e,r)=>lu(()=>new uu(e,t,r)),Hb=jb(1,136,256/8);let N0=!1;const O0=function(t){return Hb(t)};let M0=O0;function _s(t){const e=$t(t,"data");return ct(M0(e))}_s._=O0;_s.lock=function(){N0=!0};_s.register=function(t){if(N0)throw new TypeError("keccak256 is locked");M0=t};Object.freeze(_s);const U0=function(t){return Ub("sha256").update(t).digest()};let L0=U0,F0=!1;function Hi(t){const e=$t(t,"data");return ct(L0(e))}Hi._=U0;Hi.lock=function(){F0=!0};Hi.register=function(t){if(F0)throw new Error("sha256 is locked");L0=t};Object.freeze(Hi);Object.freeze(Hi);BigInt(0);const Gb=BigInt(1),Jb=BigInt(2),Ya=t=>t instanceof Uint8Array,Zb=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Ni(t){if(!Ya(t))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=Zb[t[r]];return e}function fu(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}function yo(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(e/2);for(let n=0;n<r.length;n++){const s=n*2,i=t.slice(s,s+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");r[n]=o}return r}function Ks(t){return fu(Ni(t))}function hu(t){if(!Ya(t))throw new Error("Uint8Array expected");return fu(Ni(Uint8Array.from(t).reverse()))}function Oi(t,e){return yo(t.toString(16).padStart(e*2,"0"))}function du(t,e){return Oi(t,e).reverse()}function fn(t,e,r){let n;if(typeof e=="string")try{n=yo(e)}catch(i){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${i}`)}else if(Ya(e))n=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);const s=n.length;if(typeof r=="number"&&s!==r)throw new Error(`${t} expected ${r} bytes, got ${s}`);return n}function bo(...t){const e=new Uint8Array(t.reduce((n,s)=>n+s.length,0));let r=0;return t.forEach(n=>{if(!Ya(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}const pu=t=>(Jb<<BigInt(t-1))-Gb,_c=t=>new Uint8Array(t),Df=t=>Uint8Array.from(t);function $0(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=_c(t),s=_c(t),i=0;const o=()=>{n.fill(1),s.fill(0),i=0},a=(...m)=>r(s,n,...m),c=(m=_c())=>{s=a(Df([0]),m),n=a(),m.length!==0&&(s=a(Df([1]),m),n=a())},l=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let m=0;const I=[];for(;m<e;){n=a();const _=n.slice();I.push(_),m+=n.length}return bo(...I)};return(m,I)=>{o(),c(m);let _;for(;!(_=I(l()));)c();return o(),_}}const Yb={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function ko(t,e,r={}){const n=(s,i,o)=>{const a=Yb[i];if(typeof a!="function")throw new Error(`Invalid validator "${i}", expected function`);const c=t[s];if(!(o&&c===void 0)&&!a(c,t))throw new Error(`Invalid param ${String(s)}=${c} (${typeof c}), expected ${i}`)};for(const[s,i]of Object.entries(e))n(s,i,!1);for(const[s,i]of Object.entries(r))n(s,i,!0);return t}const Xb=Object.freeze(Object.defineProperty({__proto__:null,bitMask:pu,bytesToHex:Ni,bytesToNumberBE:Ks,bytesToNumberLE:hu,concatBytes:bo,createHmacDrbg:$0,ensureBytes:fn,hexToBytes:yo,hexToNumber:fu,numberToBytesBE:Oi,numberToBytesLE:du,validateObject:ko},Symbol.toStringTag,{value:"Module"}));const wr=BigInt(0),cr=BigInt(1),Ss=BigInt(2),Qb=BigInt(3),Bl=BigInt(4),kf=BigInt(5),Nf=BigInt(8);BigInt(9);BigInt(16);function Wr(t,e){const r=t%e;return r>=wr?r:e+r}function ev(t,e,r){if(r<=wr||e<wr)throw new Error("Expected power/modulo > 0");if(r===cr)return wr;let n=cr;for(;e>wr;)e&cr&&(n=n*t%r),t=t*t%r,e>>=cr;return n}function sn(t,e,r){let n=t;for(;e-- >wr;)n*=n,n%=r;return n}function Tl(t,e){if(t===wr||e<=wr)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=Wr(t,e),n=e,s=wr,i=cr;for(;r!==wr;){const a=n/r,c=n%r,l=s-i*a;n=r,r=c,s=i,i=l}if(n!==cr)throw new Error("invert: does not exist");return Wr(s,e)}function tv(t){const e=(t-cr)/Ss;let r,n,s;for(r=t-cr,n=0;r%Ss===wr;r/=Ss,n++);for(s=Ss;s<t&&ev(s,e,t)!==t-cr;s++);if(n===1){const o=(t+cr)/Bl;return function(c,l){const g=c.pow(l,o);if(!c.eql(c.sqr(g),l))throw new Error("Cannot find square root");return g}}const i=(r+cr)/Ss;return function(a,c){if(a.pow(c,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let l=n,g=a.pow(a.mul(a.ONE,s),r),m=a.pow(c,i),I=a.pow(c,r);for(;!a.eql(I,a.ONE);){if(a.eql(I,a.ZERO))return a.ZERO;let _=1;for(let v=a.sqr(I);_<l&&!a.eql(v,a.ONE);_++)v=a.sqr(v);const b=a.pow(g,cr<<BigInt(l-_-1));g=a.sqr(b),m=a.mul(m,b),I=a.mul(I,g),l=_}return m}}function rv(t){if(t%Bl===Qb){const e=(t+cr)/Bl;return function(n,s){const i=n.pow(s,e);if(!n.eql(n.sqr(i),s))throw new Error("Cannot find square root");return i}}if(t%Nf===kf){const e=(t-kf)/Nf;return function(n,s){const i=n.mul(s,Ss),o=n.pow(i,e),a=n.mul(s,o),c=n.mul(n.mul(a,Ss),o),l=n.mul(a,n.sub(c,n.ONE));if(!n.eql(n.sqr(l),s))throw new Error("Cannot find square root");return l}}return tv(t)}const nv=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function sv(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=nv.reduce((n,s)=>(n[s]="function",n),e);return ko(t,r)}function iv(t,e,r){if(r<wr)throw new Error("Expected power > 0");if(r===wr)return t.ONE;if(r===cr)return e;let n=t.ONE,s=e;for(;r>wr;)r&cr&&(n=t.mul(n,s)),s=t.sqr(s),r>>=cr;return n}function ov(t,e){const r=new Array(e.length),n=e.reduce((i,o,a)=>t.is0(o)?i:(r[a]=i,t.mul(i,o)),t.ONE),s=t.inv(n);return e.reduceRight((i,o,a)=>t.is0(o)?i:(r[a]=t.mul(i,r[a]),t.mul(i,o)),s),r}function K0(t,e){const r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function av(t,e,r=!1,n={}){if(t<=wr)throw new Error(`Expected Field ORDER > 0, got ${t}`);const{nBitLength:s,nByteLength:i}=K0(t,e);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const o=rv(t),a=Object.freeze({ORDER:t,BITS:s,BYTES:i,MASK:pu(s),ZERO:wr,ONE:cr,create:c=>Wr(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return wr<=c&&c<t},is0:c=>c===wr,isOdd:c=>(c&cr)===cr,neg:c=>Wr(-c,t),eql:(c,l)=>c===l,sqr:c=>Wr(c*c,t),add:(c,l)=>Wr(c+l,t),sub:(c,l)=>Wr(c-l,t),mul:(c,l)=>Wr(c*l,t),pow:(c,l)=>iv(a,c,l),div:(c,l)=>Wr(c*Tl(l,t),t),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>Tl(c,t),sqrt:n.sqrt||(c=>o(a,c)),invertBatch:c=>ov(a,c),cmov:(c,l,g)=>g?l:c,toBytes:c=>r?du(c,i):Oi(c,i),fromBytes:c=>{if(c.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${c.length}`);return r?hu(c):Ks(c)}});return Object.freeze(a)}function z0(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function V0(t){const e=z0(t);return e+Math.ceil(e/2)}function cv(t,e,r=!1){const n=t.length,s=z0(e),i=V0(e);if(n<16||n<i||n>1024)throw new Error(`expected ${i}-1024 bytes of input, got ${n}`);const o=r?Ks(t):hu(t),a=Wr(o,e-cr)+cr;return r?du(a,s):Oi(a,s)}const lv=BigInt(0),Ic=BigInt(1);function uv(t,e){const r=(s,i)=>{const o=i.negate();return s?o:i},n=s=>{const i=Math.ceil(e/s)+1,o=2**(s-1);return{windows:i,windowSize:o}};return{constTimeNegate:r,unsafeLadder(s,i){let o=t.ZERO,a=s;for(;i>lv;)i&Ic&&(o=o.add(a)),a=a.double(),i>>=Ic;return o},precomputeWindow(s,i){const{windows:o,windowSize:a}=n(i),c=[];let l=s,g=l;for(let m=0;m<o;m++){g=l,c.push(g);for(let I=1;I<a;I++)g=g.add(l),c.push(g);l=g.double()}return c},wNAF(s,i,o){const{windows:a,windowSize:c}=n(s);let l=t.ZERO,g=t.BASE;const m=BigInt(2**s-1),I=2**s,_=BigInt(s);for(let b=0;b<a;b++){const v=b*c;let S=Number(o&m);o>>=_,S>c&&(S-=I,o+=Ic);const O=v,$=v+Math.abs(S)-1,k=b%2!==0,Z=S<0;S===0?g=g.add(r(k,i[O])):l=l.add(r(Z,i[$]))}return{p:l,f:g}},wNAFCached(s,i,o,a){const c=s._WINDOW_SIZE||1;let l=i.get(s);return l||(l=this.precomputeWindow(s,c),c!==1&&i.set(s,a(l))),this.wNAF(c,l,o)}}}function q0(t){return sv(t.Fp),ko(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...K0(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}function fv(t){const e=q0(t);ko(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:r,Fp:n,a:s}=e;if(r){if(!n.eql(s,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:hv,hexToBytes:dv}=Xb,Cs={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){const{Err:e}=Cs;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");const r=t[1],n=t.subarray(2,r+2);if(!r||n.length!==r)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:hv(n),l:t.subarray(r+2)}},toSig(t){const{Err:e}=Cs,r=typeof t=="string"?dv(t):t;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new e("Invalid signature tag");if(r[1]!==n-2)throw new e("Invalid signature: incorrect length");const{d:s,l:i}=Cs._parseInt(r.subarray(2)),{d:o,l:a}=Cs._parseInt(i);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:s,s:o}},hexFromSig(t){const e=l=>Number.parseInt(l[0],16)&8?"00"+l:l,r=l=>{const g=l.toString(16);return g.length&1?`0${g}`:g},n=e(r(t.s)),s=e(r(t.r)),i=n.length/2,o=s.length/2,a=r(i),c=r(o);return`30${r(o+i+4)}02${c}${s}02${a}${n}`}},Ln=BigInt(0),an=BigInt(1);BigInt(2);const Of=BigInt(3);BigInt(4);function pv(t){const e=fv(t),{Fp:r}=e,n=e.toBytes||((b,v,S)=>{const O=v.toAffine();return bo(Uint8Array.from([4]),r.toBytes(O.x),r.toBytes(O.y))}),s=e.fromBytes||(b=>{const v=b.subarray(1),S=r.fromBytes(v.subarray(0,r.BYTES)),O=r.fromBytes(v.subarray(r.BYTES,2*r.BYTES));return{x:S,y:O}});function i(b){const{a:v,b:S}=e,O=r.sqr(b),$=r.mul(O,b);return r.add(r.add($,r.mul(b,v)),S)}if(!r.eql(r.sqr(e.Gy),i(e.Gx)))throw new Error("bad generator point: equation left != right");function o(b){return typeof b=="bigint"&&Ln<b&&b<e.n}function a(b){if(!o(b))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(b){const{allowedPrivateKeyLengths:v,nByteLength:S,wrapPrivateKey:O,n:$}=e;if(v&&typeof b!="bigint"){if(b instanceof Uint8Array&&(b=Ni(b)),typeof b!="string"||!v.includes(b.length))throw new Error("Invalid key");b=b.padStart(S*2,"0")}let k;try{k=typeof b=="bigint"?b:Ks(fn("private key",b,S))}catch{throw new Error(`private key must be ${S} bytes, hex or bigint, not ${typeof b}`)}return O&&(k=Wr(k,$)),a(k),k}const l=new Map;function g(b){if(!(b instanceof m))throw new Error("ProjectivePoint expected")}class m{constructor(v,S,O){if(this.px=v,this.py=S,this.pz=O,v==null||!r.isValid(v))throw new Error("x required");if(S==null||!r.isValid(S))throw new Error("y required");if(O==null||!r.isValid(O))throw new Error("z required")}static fromAffine(v){const{x:S,y:O}=v||{};if(!v||!r.isValid(S)||!r.isValid(O))throw new Error("invalid affine point");if(v instanceof m)throw new Error("projective point not allowed");const $=k=>r.eql(k,r.ZERO);return $(S)&&$(O)?m.ZERO:new m(S,O,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(v){const S=r.invertBatch(v.map(O=>O.pz));return v.map((O,$)=>O.toAffine(S[$])).map(m.fromAffine)}static fromHex(v){const S=m.fromAffine(s(fn("pointHex",v)));return S.assertValidity(),S}static fromPrivateKey(v){return m.BASE.multiply(c(v))}_setWindowSize(v){this._WINDOW_SIZE=v,l.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:v,y:S}=this.toAffine();if(!r.isValid(v)||!r.isValid(S))throw new Error("bad point: x or y not FE");const O=r.sqr(S),$=i(v);if(!r.eql(O,$))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:v}=this.toAffine();if(r.isOdd)return!r.isOdd(v);throw new Error("Field doesn't support isOdd")}equals(v){g(v);const{px:S,py:O,pz:$}=this,{px:k,py:Z,pz:q}=v,J=r.eql(r.mul(S,q),r.mul(k,$)),se=r.eql(r.mul(O,q),r.mul(Z,$));return J&&se}negate(){return new m(this.px,r.neg(this.py),this.pz)}double(){const{a:v,b:S}=e,O=r.mul(S,Of),{px:$,py:k,pz:Z}=this;let q=r.ZERO,J=r.ZERO,se=r.ZERO,oe=r.mul($,$),V=r.mul(k,k),W=r.mul(Z,Z),Y=r.mul($,k);return Y=r.add(Y,Y),se=r.mul($,Z),se=r.add(se,se),q=r.mul(v,se),J=r.mul(O,W),J=r.add(q,J),q=r.sub(V,J),J=r.add(V,J),J=r.mul(q,J),q=r.mul(Y,q),se=r.mul(O,se),W=r.mul(v,W),Y=r.sub(oe,W),Y=r.mul(v,Y),Y=r.add(Y,se),se=r.add(oe,oe),oe=r.add(se,oe),oe=r.add(oe,W),oe=r.mul(oe,Y),J=r.add(J,oe),W=r.mul(k,Z),W=r.add(W,W),oe=r.mul(W,Y),q=r.sub(q,oe),se=r.mul(W,V),se=r.add(se,se),se=r.add(se,se),new m(q,J,se)}add(v){g(v);const{px:S,py:O,pz:$}=this,{px:k,py:Z,pz:q}=v;let J=r.ZERO,se=r.ZERO,oe=r.ZERO;const V=e.a,W=r.mul(e.b,Of);let Y=r.mul(S,k),te=r.mul(O,Z),A=r.mul($,q),u=r.add(S,O),d=r.add(k,Z);u=r.mul(u,d),d=r.add(Y,te),u=r.sub(u,d),d=r.add(S,$);let x=r.add(k,q);return d=r.mul(d,x),x=r.add(Y,A),d=r.sub(d,x),x=r.add(O,$),J=r.add(Z,q),x=r.mul(x,J),J=r.add(te,A),x=r.sub(x,J),oe=r.mul(V,d),J=r.mul(W,A),oe=r.add(J,oe),J=r.sub(te,oe),oe=r.add(te,oe),se=r.mul(J,oe),te=r.add(Y,Y),te=r.add(te,Y),A=r.mul(V,A),d=r.mul(W,d),te=r.add(te,A),A=r.sub(Y,A),A=r.mul(V,A),d=r.add(d,A),Y=r.mul(te,d),se=r.add(se,Y),Y=r.mul(x,d),J=r.mul(u,J),J=r.sub(J,Y),Y=r.mul(u,te),oe=r.mul(x,oe),oe=r.add(oe,Y),new m(J,se,oe)}subtract(v){return this.add(v.negate())}is0(){return this.equals(m.ZERO)}wNAF(v){return _.wNAFCached(this,l,v,S=>{const O=r.invertBatch(S.map($=>$.pz));return S.map(($,k)=>$.toAffine(O[k])).map(m.fromAffine)})}multiplyUnsafe(v){const S=m.ZERO;if(v===Ln)return S;if(a(v),v===an)return this;const{endo:O}=e;if(!O)return _.unsafeLadder(this,v);let{k1neg:$,k1:k,k2neg:Z,k2:q}=O.splitScalar(v),J=S,se=S,oe=this;for(;k>Ln||q>Ln;)k&an&&(J=J.add(oe)),q&an&&(se=se.add(oe)),oe=oe.double(),k>>=an,q>>=an;return $&&(J=J.negate()),Z&&(se=se.negate()),se=new m(r.mul(se.px,O.beta),se.py,se.pz),J.add(se)}multiply(v){a(v);let S=v,O,$;const{endo:k}=e;if(k){const{k1neg:Z,k1:q,k2neg:J,k2:se}=k.splitScalar(S);let{p:oe,f:V}=this.wNAF(q),{p:W,f:Y}=this.wNAF(se);oe=_.constTimeNegate(Z,oe),W=_.constTimeNegate(J,W),W=new m(r.mul(W.px,k.beta),W.py,W.pz),O=oe.add(W),$=V.add(Y)}else{const{p:Z,f:q}=this.wNAF(S);O=Z,$=q}return m.normalizeZ([O,$])[0]}multiplyAndAddUnsafe(v,S,O){const $=m.BASE,k=(q,J)=>J===Ln||J===an||!q.equals($)?q.multiplyUnsafe(J):q.multiply(J),Z=k(this,S).add(k(v,O));return Z.is0()?void 0:Z}toAffine(v){const{px:S,py:O,pz:$}=this,k=this.is0();v==null&&(v=k?r.ONE:r.inv($));const Z=r.mul(S,v),q=r.mul(O,v),J=r.mul($,v);if(k)return{x:r.ZERO,y:r.ZERO};if(!r.eql(J,r.ONE))throw new Error("invZ was invalid");return{x:Z,y:q}}isTorsionFree(){const{h:v,isTorsionFree:S}=e;if(v===an)return!0;if(S)return S(m,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:v,clearCofactor:S}=e;return v===an?this:S?S(m,this):this.multiplyUnsafe(e.h)}toRawBytes(v=!0){return this.assertValidity(),n(m,this,v)}toHex(v=!0){return Ni(this.toRawBytes(v))}}m.BASE=new m(e.Gx,e.Gy,r.ONE),m.ZERO=new m(r.ZERO,r.ONE,r.ZERO);const I=e.nBitLength,_=uv(m,e.endo?Math.ceil(I/2):I);return{CURVE:e,ProjectivePoint:m,normPrivateKeyToScalar:c,weierstrassEquation:i,isWithinCurveOrder:o}}function gv(t){const e=q0(t);return ko(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function wv(t){const e=gv(t),{Fp:r,n}=e,s=r.BYTES+1,i=2*r.BYTES+1;function o(d){return Ln<d&&d<r.ORDER}function a(d){return Wr(d,n)}function c(d){return Tl(d,n)}const{ProjectivePoint:l,normPrivateKeyToScalar:g,weierstrassEquation:m,isWithinCurveOrder:I}=pv({...e,toBytes(d,x,P){const M=x.toAffine(),F=r.toBytes(M.x),j=bo;return P?j(Uint8Array.from([x.hasEvenY()?2:3]),F):j(Uint8Array.from([4]),F,r.toBytes(M.y))},fromBytes(d){const x=d.length,P=d[0],M=d.subarray(1);if(x===s&&(P===2||P===3)){const F=Ks(M);if(!o(F))throw new Error("Point is not on curve");const j=m(F);let D=r.sqrt(j);const f=(D&an)===an;return(P&1)===1!==f&&(D=r.neg(D)),{x:F,y:D}}else if(x===i&&P===4){const F=r.fromBytes(M.subarray(0,r.BYTES)),j=r.fromBytes(M.subarray(r.BYTES,2*r.BYTES));return{x:F,y:j}}else throw new Error(`Point of length ${x} was invalid. Expected ${s} compressed bytes or ${i} uncompressed bytes`)}}),_=d=>Ni(Oi(d,e.nByteLength));function b(d){const x=n>>an;return d>x}function v(d){return b(d)?a(-d):d}const S=(d,x,P)=>Ks(d.slice(x,P));class O{constructor(x,P,M){this.r=x,this.s=P,this.recovery=M,this.assertValidity()}static fromCompact(x){const P=e.nByteLength;return x=fn("compactSignature",x,P*2),new O(S(x,0,P),S(x,P,2*P))}static fromDER(x){const{r:P,s:M}=Cs.toSig(fn("DER",x));return new O(P,M)}assertValidity(){if(!I(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!I(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(x){return new O(this.r,this.s,x)}recoverPublicKey(x){const{r:P,s:M,recovery:F}=this,j=se(fn("msgHash",x));if(F==null||![0,1,2,3].includes(F))throw new Error("recovery id invalid");const D=F===2||F===3?P+e.n:P;if(D>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const f=(F&1)===0?"02":"03",p=l.fromHex(f+_(D)),R=c(D),U=a(-j*R),X=a(M*R),fe=l.BASE.multiplyAndAddUnsafe(p,U,X);if(!fe)throw new Error("point at infinify");return fe.assertValidity(),fe}hasHighS(){return b(this.s)}normalizeS(){return this.hasHighS()?new O(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return yo(this.toDERHex())}toDERHex(){return Cs.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return yo(this.toCompactHex())}toCompactHex(){return _(this.r)+_(this.s)}}const $={isValidPrivateKey(d){try{return g(d),!0}catch{return!1}},normPrivateKeyToScalar:g,randomPrivateKey:()=>{const d=V0(e.n);return cv(e.randomBytes(d),e.n)},precompute(d=8,x=l.BASE){return x._setWindowSize(d),x.multiply(BigInt(3)),x}};function k(d,x=!0){return l.fromPrivateKey(d).toRawBytes(x)}function Z(d){const x=d instanceof Uint8Array,P=typeof d=="string",M=(x||P)&&d.length;return x?M===s||M===i:P?M===2*s||M===2*i:d instanceof l}function q(d,x,P=!0){if(Z(d))throw new Error("first arg must be private key");if(!Z(x))throw new Error("second arg must be public key");return l.fromHex(x).multiply(g(d)).toRawBytes(P)}const J=e.bits2int||function(d){const x=Ks(d),P=d.length*8-e.nBitLength;return P>0?x>>BigInt(P):x},se=e.bits2int_modN||function(d){return a(J(d))},oe=pu(e.nBitLength);function V(d){if(typeof d!="bigint")throw new Error("bigint expected");if(!(Ln<=d&&d<oe))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Oi(d,e.nByteLength)}function W(d,x,P=Y){if(["recovered","canonical"].some(_e=>_e in P))throw new Error("sign() legacy options not supported");const{hash:M,randomBytes:F}=e;let{lowS:j,prehash:D,extraEntropy:f}=P;j==null&&(j=!0),d=fn("msgHash",d),D&&(d=fn("prehashed msgHash",M(d)));const p=se(d),R=g(x),U=[V(R),V(p)];if(f!=null){const _e=f===!0?F(r.BYTES):f;U.push(fn("extraEntropy",_e))}const X=bo(...U),fe=p;function Ee(_e){const Xe=J(_e);if(!I(Xe))return;const dt=c(Xe),Qe=l.BASE.multiply(Xe).toAffine(),Zt=a(Qe.x);if(Zt===Ln)return;const bt=a(dt*a(fe+Zt*R));if(bt===Ln)return;let kt=(Qe.x===Zt?0:2)|Number(Qe.y&an),Pn=bt;return j&&b(bt)&&(Pn=v(bt),kt^=1),new O(Zt,Pn,kt)}return{seed:X,k2sig:Ee}}const Y={lowS:e.lowS,prehash:!1},te={lowS:e.lowS,prehash:!1};function A(d,x,P=Y){const{seed:M,k2sig:F}=W(d,x,P),j=e;return $0(j.hash.outputLen,j.nByteLength,j.hmac)(M,F)}l.BASE._setWindowSize(8);function u(d,x,P,M=te){const F=d;if(x=fn("msgHash",x),P=fn("publicKey",P),"strict"in M)throw new Error("options.strict was renamed to lowS");const{lowS:j,prehash:D}=M;let f,p;try{if(typeof F=="string"||F instanceof Uint8Array)try{f=O.fromDER(F)}catch(Qe){if(!(Qe instanceof Cs.Err))throw Qe;f=O.fromCompact(F)}else if(typeof F=="object"&&typeof F.r=="bigint"&&typeof F.s=="bigint"){const{r:Qe,s:Zt}=F;f=new O(Qe,Zt)}else throw new Error("PARSE");p=l.fromHex(P)}catch(Qe){if(Qe.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(j&&f.hasHighS())return!1;D&&(x=e.hash(x));const{r:R,s:U}=f,X=se(x),fe=c(U),Ee=a(X*fe),_e=a(R*fe),Xe=l.BASE.multiplyAndAddUnsafe(p,Ee,_e)?.toAffine();return Xe?a(Xe.x)===R:!1}return{CURVE:e,getPublicKey:k,getSharedSecret:q,sign:A,verify:u,ProjectivePoint:l,Signature:O,utils:$}}function mv(t){return{hash:t,hmac:(e,...r)=>x0(t,e,lb(...r)),randomBytes:ub}}function yv(t,e){const r=n=>wv({...t,...mv(n)});return Object.freeze({...r(e),create:r})}const W0=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Mf=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),bv=BigInt(1),Pl=BigInt(2),Uf=(t,e)=>(t+e/Pl)/e;function vv(t){const e=W0,r=BigInt(3),n=BigInt(6),s=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),l=t*t*t%e,g=l*l*t%e,m=sn(g,r,e)*g%e,I=sn(m,r,e)*g%e,_=sn(I,Pl,e)*l%e,b=sn(_,s,e)*_%e,v=sn(b,i,e)*b%e,S=sn(v,a,e)*v%e,O=sn(S,c,e)*S%e,$=sn(O,a,e)*v%e,k=sn($,r,e)*g%e,Z=sn(k,o,e)*b%e,q=sn(Z,n,e)*l%e,J=sn(q,Pl,e);if(!Cl.eql(Cl.sqr(J),t))throw new Error("Cannot find square root");return J}const Cl=av(W0,void 0,void 0,{sqrt:vv}),us=yv({a:BigInt(0),b:BigInt(7),Fp:Cl,n:Mf,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=Mf,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-bv*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=r,o=BigInt("0x100000000000000000000000000000000"),a=Uf(i*t,e),c=Uf(-n*t,e);let l=Wr(t-a*r-c*s,e),g=Wr(-a*n-c*i,e);const m=l>o,I=g>o;if(m&&(l=e-l),I&&(g=e-g),l>o||g>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:m,k1:l,k2neg:I,k2:g}}}},I0);BigInt(0);us.ProjectivePoint;const j0="0x0000000000000000000000000000000000000000",Lf="0x0000000000000000000000000000000000000000000000000000000000000000",Ff=BigInt(0),$f=BigInt(1),Dl=BigInt(2),Kf=BigInt(27),zf=BigInt(28),Zo=BigInt(35),H0=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Ev=H0/Dl,xv=Symbol.for("nodejs.util.inspect.custom"),Is={};function Sc(t){return Js(xr(t),32)}class lr{#e;#r;#t;#n;get r(){return this.#e}set r(e){Ce(po(e)===32,"invalid r","value",e),this.#e=ct(e)}get s(){return Ce(parseInt(this.#r.substring(0,3))<8,"non-canonical s; use ._s","s",this.#r),this.#r}set s(e){Ce(po(e)===32,"invalid s","value",e),this.#r=ct(e)}get _s(){return this.#r}isValid(){return BigInt(this.#r)<=Ev}get v(){return this.#t}set v(e){const r=ys(e,"value");Ce(r===27||r===28,"invalid v","v",e),this.#t=r}get networkV(){return this.#n}get legacyChainId(){const e=this.networkV;return e==null?null:lr.getChainId(e)}get yParity(){return this.v===27?0:1}get yParityAndS(){const e=$t(this.s);return this.yParity&&(e[0]|=128),ct(e)}get compactSerialized(){return Sn([this.r,this.yParityAndS])}get serialized(){return Sn([this.r,this.s,this.yParity?"0x1c":"0x1b"])}constructor(e,r,n,s){tb(e,Is,"Signature"),this.#e=r,this.#r=n,this.#t=s,this.#n=null}getCanonical(){if(this.isValid())return this;const e=H0-BigInt(this._s),r=55-this.v,n=new lr(Is,this.r,Sc(e),r);return this.networkV&&(n.#n=this.networkV),n}clone(){const e=new lr(Is,this.r,this._s,this.v);return this.networkV&&(e.#n=this.networkV),e}toJSON(){const e=this.networkV;return{_type:"signature",networkV:e!=null?e.toString():null,r:this.r,s:this._s,v:this.v}}[xv](){return this.toString()}toString(){return this.isValid()?`Signature { r: ${this.r}, s: ${this._s}, v: ${this.v} }`:`Signature { r: ${this.r}, s: ${this._s}, v: ${this.v}, valid: false }`}static getChainId(e){const r=vr(e,"v");return r==Kf||r==zf?Ff:(Ce(r>=Zo,"invalid EIP-155 v","v",e),(r-Zo)/Dl)}static getChainIdV(e,r){return vr(e)*Dl+BigInt(35+r-27)}static getNormalizedV(e){const r=vr(e);return r===Ff||r===Kf?27:r===$f||r===zf?28:(Ce(r>=Zo,"invalid v","v",e),r&$f?27:28)}static from(e){function r(l,g){Ce(l,g,"signature",e)}if(e==null)return new lr(Is,Lf,Lf,27);if(typeof e=="string"){const l=$t(e,"signature");if(l.length===64){const g=ct(l.slice(0,32)),m=l.slice(32,64),I=m[0]&128?28:27;return m[0]&=127,new lr(Is,g,ct(m),I)}if(l.length===65){const g=ct(l.slice(0,32)),m=ct(l.slice(32,64)),I=lr.getNormalizedV(l[64]);return new lr(Is,g,m,I)}r(!1,"invalid raw signature length")}if(e instanceof lr)return e.clone();const n=e.r;r(n!=null,"missing r");const s=Sc(n),i=(function(l,g){if(l!=null)return Sc(l);if(g!=null){r(xs(g,32),"invalid yParityAndS");const m=$t(g);return m[0]&=127,ct(m)}r(!1,"missing s")})(e.s,e.yParityAndS),{networkV:o,v:a}=(function(l,g,m){if(l!=null){const I=vr(l);return{networkV:I>=Zo?I:void 0,v:lr.getNormalizedV(I)}}if(g!=null)return r(xs(g,32),"invalid yParityAndS"),{v:$t(g)[0]&128?28:27};if(m!=null){switch(ys(m,"sig.yParity")){case 0:return{v:27};case 1:return{v:28}}r(!1,"invalid yParity")}r(!1,"missing v")})(e.v,e.yParityAndS,e.yParity),c=new lr(Is,s,i,a);return o&&(c.#n=o),r(e.yParity==null||ys(e.yParity,"sig.yParity")===c.yParity,"yParity mismatch"),r(e.yParityAndS==null||e.yParityAndS===c.yParityAndS,"yParityAndS mismatch"),c}}class Fn{#e;constructor(e){Ce(po(e)===32,"invalid private key","privateKey","[REDACTED]"),this.#e=ct(e)}get privateKey(){return this.#e}get publicKey(){return Fn.computePublicKey(this.#e)}get compressedPublicKey(){return Fn.computePublicKey(this.#e,!0)}sign(e){Ce(po(e)===32,"invalid digest length","digest",e);const r=us.sign(no(e),no(this.#e),{lowS:!0});return lr.from({r:If(r.r,32),s:If(r.s,32),v:r.recovery?28:27})}computeSharedSecret(e){const r=Fn.computePublicKey(e);return ct(us.getSharedSecret(no(this.#e),$t(r),!1))}static computePublicKey(e,r){let n=$t(e,"key");if(n.length===32){const i=us.getPublicKey(n,!!r);return ct(i)}if(n.length===64){const i=new Uint8Array(65);i[0]=4,i.set(n,1),n=i}const s=us.ProjectivePoint.fromHex(n);return ct(s.toRawBytes(r))}static recoverPublicKey(e,r){Ce(po(e)===32,"invalid digest length","digest",e);const n=lr.from(r);let s=us.Signature.fromCompact(no(Sn([n.r,n.s])));s=s.addRecoveryBit(n.yParity);const i=s.recoverPublicKey(no(e));return Ce(i!=null,"invalid signature for digest","signature",r),"0x"+i.toHex(!1)}static addPoints(e,r,n){const s=us.ProjectivePoint.fromHex(Fn.computePublicKey(e).substring(2)),i=us.ProjectivePoint.fromHex(Fn.computePublicKey(r).substring(2));return"0x"+s.add(i).toHex(!!n)}}const _v=BigInt(0),Iv=BigInt(36);function Vf(t){t=t.toLowerCase();const e=t.substring(2).split(""),r=new Uint8Array(40);for(let s=0;s<40;s++)r[s]=e[s].charCodeAt(0);const n=$t(_s(r));for(let s=0;s<40;s+=2)n[s>>1]>>4>=8&&(e[s]=e[s].toUpperCase()),(n[s>>1]&15)>=8&&(e[s+1]=e[s+1].toUpperCase());return"0x"+e.join("")}const gu={};for(let t=0;t<10;t++)gu[String(t)]=String(t);for(let t=0;t<26;t++)gu[String.fromCharCode(65+t)]=String(10+t);const qf=15;function Sv(t){t=t.toUpperCase(),t=t.substring(4)+t.substring(0,2)+"00";let e=t.split("").map(n=>gu[n]).join("");for(;e.length>=qf;){let n=e.substring(0,qf);e=parseInt(n,10)%97+e.substring(n.length)}let r=String(98-parseInt(e,10)%97);for(;r.length<2;)r="0"+r;return r}const Av=(function(){const t={};for(let e=0;e<36;e++){const r="0123456789abcdefghijklmnopqrstuvwxyz"[e];t[r]=BigInt(e)}return t})();function Rv(t){t=t.toLowerCase();let e=_v;for(let r=0;r<t.length;r++)e=e*Iv+Av[t[r]];return e}function Gi(t){if(Ce(typeof t=="string","invalid address","address",t),t.match(/^(0x)?[0-9a-fA-F]{40}$/)){t.startsWith("0x")||(t="0x"+t);const e=Vf(t);return Ce(!t.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||e===t,"bad address checksum","address",t),e}if(t.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){Ce(t.substring(2,4)===Sv(t),"bad icap checksum","address",t);let e=Rv(t.substring(4)).toString(16);for(;e.length<40;)e="0"+e;return Vf("0x"+e)}Ce(!1,"invalid address","address",t)}function Ac(t,e){return{address:Gi(t),storageKeys:e.map((r,n)=>(Ce(xs(r,32),"invalid slot",`storageKeys[${n}]`,r),r.toLowerCase()))}}function wu(t){if(Array.isArray(t))return t.map((r,n)=>Array.isArray(r)?(Ce(r.length===2,"invalid slot set",`value[${n}]`,r),Ac(r[0],r[1])):(Ce(r!=null&&typeof r=="object","invalid address-slot set","value",t),Ac(r.address,r.storageKeys)));Ce(t!=null&&typeof t=="object","invalid access list","value",t);const e=Object.keys(t).map(r=>{const n=t[r].reduce((s,i)=>(s[i]=!0,s),{});return Ac(r,Object.keys(n).sort())});return e.sort((r,n)=>r.address.localeCompare(n.address)),e}function Bv(t){return{address:Gi(t.address),nonce:vr(t.nonce!=null?t.nonce:0),chainId:vr(t.chainId!=null?t.chainId:0),signature:lr.from(t.signature)}}function Tv(t){let e;return typeof t=="string"?e=Fn.computePublicKey(t,!1):e=t.publicKey,Gi(_s("0x"+e.substring(4)).substring(26))}function Pv(t,e){return Tv(Fn.recoverPublicKey(t,e))}const gr=BigInt(0),Cv=BigInt(2),Dv=BigInt(27),kv=BigInt(28),Nv=BigInt(35),Ov=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),Mv=Symbol.for("nodejs.util.inspect.custom"),Rc=4096*32,la=128;function Uv(t){return{blobToKzgCommitment:n=>{if("computeBlobProof"in t){if("blobToKzgCommitment"in t&&typeof t.blobToKzgCommitment=="function")return $t(t.blobToKzgCommitment(ct(n)))}else if("blobToKzgCommitment"in t&&typeof t.blobToKzgCommitment=="function")return $t(t.blobToKzgCommitment(n));if("blobToKZGCommitment"in t&&typeof t.blobToKZGCommitment=="function")return $t(t.blobToKZGCommitment(ct(n)));Ce(!1,"unsupported KZG library","kzg",t)},computeBlobKzgProof:(n,s)=>{if("computeBlobProof"in t&&typeof t.computeBlobProof=="function")return $t(t.computeBlobProof(ct(n),ct(s)));if("computeBlobKzgProof"in t&&typeof t.computeBlobKzgProof=="function")return t.computeBlobKzgProof(n,s);if("computeBlobKZGProof"in t&&typeof t.computeBlobKZGProof=="function")return $t(t.computeBlobKZGProof(ct(n),ct(s)));Ce(!1,"unsupported KZG library","kzg",t)}}}function Wf(t,e){let r=t.toString(16);for(;r.length<2;)r="0"+r;return r+=Hi(e).substring(4),"0x"+r}function Ji(t){return t==="0x"?null:Gi(t)}function Xa(t,e){try{return wu(t)}catch(r){Ce(!1,r.message,e,t)}}function Lv(t,e){try{if(!Array.isArray(t))throw new Error("authorizationList: invalid array");const r=[];for(let n=0;n<t.length;n++){const s=t[n];if(!Array.isArray(s))throw new Error(`authorization[${n}]: invalid array`);if(s.length!==6)throw new Error(`authorization[${n}]: wrong length`);if(!s[1])throw new Error(`authorization[${n}]: null address`);r.push({address:Ji(s[1]),nonce:Ct(s[2],"nonce"),chainId:Ct(s[0],"chainId"),signature:lr.from({yParity:ei(s[3],"yParity"),r:Js(s[4],32),s:Js(s[5],32)})})}return r}catch(r){Ce(!1,r.message,e,t)}}function ei(t,e){return t==="0x"?0:ys(t,e)}function Ct(t,e){if(t==="0x")return gr;const r=vr(t,e);return Ce(r<=Ov,"value exceeds uint size",e,r),r}function gt(t,e){const r=vr(t,"value"),n=xr(r);return Ce(n.length<=32,"value too large",`tx.${e}`,r),n}function Qa(t){return wu(t).map(e=>[e.address,e.storageKeys])}function Fv(t){return t.map(e=>[gt(e.chainId,"chainId"),e.address,gt(e.nonce,"nonce"),gt(e.signature.yParity,"yParity"),xr(e.signature.r),xr(e.signature._s)])}function $v(t,e){Ce(Array.isArray(t),`invalid ${e}`,"value",t);for(let r=0;r<t.length;r++)Ce(xs(t[r],32),"invalid ${ param } hash",`value[${r}]`,t[r]);return t}function Kv(t){const e=Do(t);Ce(Array.isArray(e)&&(e.length===9||e.length===6),"invalid field count for legacy transaction","data",t);const r={type:0,nonce:ei(e[0],"nonce"),gasPrice:Ct(e[1],"gasPrice"),gasLimit:Ct(e[2],"gasLimit"),to:Ji(e[3]),value:Ct(e[4],"value"),data:ct(e[5]),chainId:gr};if(e.length===6)return r;const n=Ct(e[6],"v"),s=Ct(e[7],"r"),i=Ct(e[8],"s");if(s===gr&&i===gr)r.chainId=n;else{let o=(n-Nv)/Cv;o<gr&&(o=gr),r.chainId=o,Ce(o!==gr||n===Dv||n===kv,"non-canonical legacy v","v",e[6]),r.signature=lr.from({r:Js(e[7],32),s:Js(e[8],32),v:n})}return r}function zv(t,e){const r=[gt(t.nonce,"nonce"),gt(t.gasPrice||0,"gasPrice"),gt(t.gasLimit,"gasLimit"),t.to||"0x",gt(t.value,"value"),t.data];let n=gr;if(t.chainId!=gr)n=vr(t.chainId,"tx.chainId"),Ce(!e||e.networkV==null||e.legacyChainId===n,"tx.chainId/sig.v mismatch","sig",e);else if(t.signature){const i=t.signature.legacyChainId;i!=null&&(n=i)}if(!e)return n!==gr&&(r.push(xr(n)),r.push("0x"),r.push("0x")),bs(r);let s=BigInt(27+e.yParity);return n!==gr?s=lr.getChainIdV(n,e.v):BigInt(e.v)!==s&&Ce(!1,"tx.chainId/sig.v mismatch","sig",e),r.push(xr(s)),r.push(xr(e.r)),r.push(xr(e._s)),bs(r)}function ec(t,e){let r;try{if(r=ei(e[0],"yParity"),r!==0&&r!==1)throw new Error("bad yParity")}catch{Ce(!1,"invalid yParity","yParity",e[0])}const n=Js(e[1],32),s=Js(e[2],32),i=lr.from({r:n,s,yParity:r});t.signature=i}function Vv(t){const e=Do($t(t).slice(1));Ce(Array.isArray(e)&&(e.length===9||e.length===12),"invalid field count for transaction type: 2","data",ct(t));const r={type:2,chainId:Ct(e[0],"chainId"),nonce:ei(e[1],"nonce"),maxPriorityFeePerGas:Ct(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Ct(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Ct(e[4],"gasLimit"),to:Ji(e[5]),value:Ct(e[6],"value"),data:ct(e[7]),accessList:Xa(e[8],"accessList")};return e.length===9||ec(r,e.slice(9)),r}function qv(t,e){const r=[gt(t.chainId,"chainId"),gt(t.nonce,"nonce"),gt(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),gt(t.maxFeePerGas||0,"maxFeePerGas"),gt(t.gasLimit,"gasLimit"),t.to||"0x",gt(t.value,"value"),t.data,Qa(t.accessList||[])];return e&&(r.push(gt(e.yParity,"yParity")),r.push(xr(e.r)),r.push(xr(e.s))),Sn(["0x02",bs(r)])}function Wv(t){const e=Do($t(t).slice(1));Ce(Array.isArray(e)&&(e.length===8||e.length===11),"invalid field count for transaction type: 1","data",ct(t));const r={type:1,chainId:Ct(e[0],"chainId"),nonce:ei(e[1],"nonce"),gasPrice:Ct(e[2],"gasPrice"),gasLimit:Ct(e[3],"gasLimit"),to:Ji(e[4]),value:Ct(e[5],"value"),data:ct(e[6]),accessList:Xa(e[7],"accessList")};return e.length===8||ec(r,e.slice(8)),r}function jv(t,e){const r=[gt(t.chainId,"chainId"),gt(t.nonce,"nonce"),gt(t.gasPrice||0,"gasPrice"),gt(t.gasLimit,"gasLimit"),t.to||"0x",gt(t.value,"value"),t.data,Qa(t.accessList||[])];return e&&(r.push(gt(e.yParity,"recoveryParam")),r.push(xr(e.r)),r.push(xr(e.s))),Sn(["0x01",bs(r)])}function Hv(t){let e=Do($t(t).slice(1)),r="3",n=null,s=null;if(e.length===4&&Array.isArray(e[0])){r="3 (network format)";const o=e[1],a=e[2],c=e[3];Ce(Array.isArray(o),"invalid network format: blobs not an array","fields[1]",o),Ce(Array.isArray(a),"invalid network format: commitments not an array","fields[2]",a),Ce(Array.isArray(c),"invalid network format: proofs not an array","fields[3]",c),Ce(o.length===a.length,"invalid network format: blobs/commitments length mismatch","fields",e),Ce(o.length===c.length,"invalid network format: blobs/proofs length mismatch","fields",e),s=[];for(let l=0;l<e[1].length;l++)s.push({data:o[l],commitment:a[l],proof:c[l]});e=e[0]}else if(e.length===5&&Array.isArray(e[0])){r="3 (EIP-7594 network format)",n=ys(e[1]);const o=e[2],a=e[3],c=e[4];Ce(n===1,`unsupported EIP-7594 network format version: ${n}`,"fields[1]",n),Ce(Array.isArray(o),"invalid EIP-7594 network format: blobs not an array","fields[2]",o),Ce(Array.isArray(a),"invalid EIP-7594 network format: commitments not an array","fields[3]",a),Ce(Array.isArray(c),"invalid EIP-7594 network format: proofs not an array","fields[4]",c),Ce(o.length===a.length,"invalid network format: blobs/commitments length mismatch","fields",e),Ce(o.length*la===c.length,"invalid network format: blobs/proofs length mismatch","fields",e),s=[];for(let l=0;l<o.length;l++){const g=[];for(let m=0;m<la;m++)g.push(c[l*la+m]);s.push({data:o[l],commitment:a[l],proof:Sn(g)})}e=e[0]}Ce(Array.isArray(e)&&(e.length===11||e.length===14),`invalid field count for transaction type: ${r}`,"data",ct(t));const i={type:3,chainId:Ct(e[0],"chainId"),nonce:ei(e[1],"nonce"),maxPriorityFeePerGas:Ct(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Ct(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Ct(e[4],"gasLimit"),to:Ji(e[5]),value:Ct(e[6],"value"),data:ct(e[7]),accessList:Xa(e[8],"accessList"),maxFeePerBlobGas:Ct(e[9],"maxFeePerBlobGas"),blobVersionedHashes:e[10],blobWrapperVersion:n};s&&(i.blobs=s),Ce(i.to!=null,`invalid address for transaction type: ${r}`,"data",t),Ce(Array.isArray(i.blobVersionedHashes),"invalid blobVersionedHashes: must be an array","data",t);for(let o=0;o<i.blobVersionedHashes.length;o++)Ce(xs(i.blobVersionedHashes[o],32),`invalid blobVersionedHash at index ${o}: must be length 32`,"data",t);return e.length===11||ec(i,e.slice(11)),i}function Gv(t,e,r){const n=[gt(t.chainId,"chainId"),gt(t.nonce,"nonce"),gt(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),gt(t.maxFeePerGas||0,"maxFeePerGas"),gt(t.gasLimit,"gasLimit"),t.to||j0,gt(t.value,"value"),t.data,Qa(t.accessList||[]),gt(t.maxFeePerBlobGas||0,"maxFeePerBlobGas"),$v(t.blobVersionedHashes||[],"blobVersionedHashes")];if(e&&(n.push(gt(e.yParity,"yParity")),n.push(xr(e.r)),n.push(xr(e.s)),r)){if(t.blobWrapperVersion!=null){const s=xr(t.blobWrapperVersion),i=[];for(const{proof:o}of r){const a=$t(o),c=a.length/la;for(let l=0;l<a.length;l+=c)i.push(a.subarray(l,l+c))}return Sn(["0x03",bs([n,s,r.map(o=>o.data),r.map(o=>o.commitment),i])])}return Sn(["0x03",bs([n,r.map(s=>s.data),r.map(s=>s.commitment),r.map(s=>s.proof)])])}return Sn(["0x03",bs(n)])}function Jv(t){const e=Do($t(t).slice(1));Ce(Array.isArray(e)&&(e.length===10||e.length===13),"invalid field count for transaction type: 4","data",ct(t));const r={type:4,chainId:Ct(e[0],"chainId"),nonce:ei(e[1],"nonce"),maxPriorityFeePerGas:Ct(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Ct(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Ct(e[4],"gasLimit"),to:Ji(e[5]),value:Ct(e[6],"value"),data:ct(e[7]),accessList:Xa(e[8],"accessList"),authorizationList:Lv(e[9],"authorizationList")};return e.length===10||ec(r,e.slice(10)),r}function Zv(t,e){const r=[gt(t.chainId,"chainId"),gt(t.nonce,"nonce"),gt(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),gt(t.maxFeePerGas||0,"maxFeePerGas"),gt(t.gasLimit,"gasLimit"),t.to||"0x",gt(t.value,"value"),t.data,Qa(t.accessList||[]),Fv(t.authorizationList||[])];return e&&(r.push(gt(e.yParity,"yParity")),r.push(xr(e.r)),r.push(xr(e.s))),Sn(["0x04",bs(r)])}let Yv=class On{#e;#r;#t;#n;#o;#i;#s;#a;#c;#l;#h;#d;#p;#g;#u;#f;#w;#m;get type(){return this.#e}set type(e){switch(e){case null:this.#e=null;break;case 0:case"legacy":this.#e=0;break;case 1:case"berlin":case"eip-2930":this.#e=1;break;case 2:case"london":case"eip-1559":this.#e=2;break;case 3:case"cancun":case"eip-4844":this.#e=3;break;case 4:case"pectra":case"eip-7702":this.#e=4;break;default:Ce(!1,"unsupported transaction type","type",e)}}get typeName(){switch(this.type){case 0:return"legacy";case 1:return"eip-2930";case 2:return"eip-1559";case 3:return"eip-4844";case 4:return"eip-7702"}return null}get to(){const e=this.#r;return e==null&&this.type===3?j0:e}set to(e){this.#r=e==null?null:Gi(e)}get nonce(){return this.#n}set nonce(e){this.#n=ys(e,"value")}get gasLimit(){return this.#o}set gasLimit(e){this.#o=vr(e)}get gasPrice(){const e=this.#i;return e==null&&(this.type===0||this.type===1)?gr:e}set gasPrice(e){this.#i=e==null?null:vr(e,"gasPrice")}get maxPriorityFeePerGas(){const e=this.#s;return e??(this.type===2||this.type===3?gr:null)}set maxPriorityFeePerGas(e){this.#s=e==null?null:vr(e,"maxPriorityFeePerGas")}get maxFeePerGas(){const e=this.#a;return e??(this.type===2||this.type===3?gr:null)}set maxFeePerGas(e){this.#a=e==null?null:vr(e,"maxFeePerGas")}get data(){return this.#t}set data(e){this.#t=ct(e)}get value(){return this.#c}set value(e){this.#c=vr(e,"value")}get chainId(){return this.#l}set chainId(e){this.#l=vr(e)}get signature(){return this.#h||null}set signature(e){this.#h=e==null?null:lr.from(e)}isValid(){const e=this.signature;if(e&&!e.isValid())return!1;const r=this.authorizationList;if(r){for(const n of r)if(!n.signature.isValid())return!1}return!0}get accessList(){const e=this.#d||null;return e??(this.type===1||this.type===2||this.type===3?[]:null)}set accessList(e){this.#d=e==null?null:wu(e)}get authorizationList(){const e=this.#w||null;return e==null&&this.type===4?[]:e}set authorizationList(e){this.#w=e==null?null:e.map(r=>Bv(r))}get maxFeePerBlobGas(){const e=this.#p;return e==null&&this.type===3?gr:e}set maxFeePerBlobGas(e){this.#p=e==null?null:vr(e,"maxFeePerBlobGas")}get blobVersionedHashes(){let e=this.#g;return e==null&&this.type===3?[]:e}set blobVersionedHashes(e){if(e!=null){Ce(Array.isArray(e),"blobVersionedHashes must be an Array","value",e),e=e.slice();for(let r=0;r<e.length;r++)Ce(xs(e[r],32),"invalid blobVersionedHash",`value[${r}]`,e[r])}this.#g=e}get blobs(){return this.#f==null?null:this.#f.map(e=>Object.assign({},e))}set blobs(e){if(e==null){this.#f=null;return}const r=[],n=[];for(let s=0;s<e.length;s++){const i=e[s];if(rb(i)){Fr(this.#u,"adding a raw blob requires a KZG library","UNSUPPORTED_OPERATION",{operation:"set blobs()"});let o=$t(i);if(Ce(o.length<=Rc,"blob is too large",`blobs[${s}]`,i),o.length!==Rc){const l=new Uint8Array(Rc);l.set(o),o=l}const a=this.#u.blobToKzgCommitment(o),c=ct(this.#u.computeBlobKzgProof(o,a));r.push({data:ct(o),commitment:ct(a),proof:c}),n.push(Wf(1,a))}else{const o=ct(i.data),a=ct(i.commitment),c=ct(i.proof);r.push({data:o,commitment:a,proof:c}),n.push(Wf(1,a))}}this.#f=r,this.#g=n}get kzg(){return this.#u}set kzg(e){e==null?this.#u=null:this.#u=Uv(e)}get blobWrapperVersion(){return this.#m}set blobWrapperVersion(e){this.#m=e}constructor(){this.#e=null,this.#r=null,this.#n=0,this.#o=gr,this.#i=null,this.#s=null,this.#a=null,this.#t="0x",this.#c=gr,this.#l=gr,this.#h=null,this.#d=null,this.#p=null,this.#g=null,this.#u=null,this.#f=null,this.#w=null,this.#m=null}get hash(){return this.signature==null?null:_s(this.#y(!0,!1))}get unsignedHash(){return _s(this.unsignedSerialized)}get from(){return this.signature==null?null:Pv(this.unsignedHash,this.signature.getCanonical())}get fromPublicKey(){return this.signature==null?null:Fn.recoverPublicKey(this.unsignedHash,this.signature.getCanonical())}isSigned(){return this.signature!=null}#y(e,r){Fr(!e||this.signature!=null,"cannot serialize unsigned transaction; maybe you meant .unsignedSerialized","UNSUPPORTED_OPERATION",{operation:".serialized"});const n=e?this.signature:null;switch(this.inferType()){case 0:return zv(this,n);case 1:return jv(this,n);case 2:return qv(this,n);case 3:return Gv(this,n,r?this.blobs:null);case 4:return Zv(this,n)}Fr(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:".serialized"})}get serialized(){return this.#y(!0,!0)}get unsignedSerialized(){return this.#y(!1,!1)}inferType(){const e=this.inferTypes();return e.indexOf(2)>=0?2:e.pop()}inferTypes(){const e=this.gasPrice!=null,r=this.maxFeePerGas!=null||this.maxPriorityFeePerGas!=null,n=this.accessList!=null,s=this.#p!=null||this.#g;this.maxFeePerGas!=null&&this.maxPriorityFeePerGas!=null&&Fr(this.maxFeePerGas>=this.maxPriorityFeePerGas,"priorityFee cannot be more than maxFee","BAD_DATA",{value:this}),Fr(!r||this.type!==0&&this.type!==1,"transaction type cannot have maxFeePerGas or maxPriorityFeePerGas","BAD_DATA",{value:this}),Fr(this.type!==0||!n,"legacy transaction cannot have accessList","BAD_DATA",{value:this});const i=[];return this.type!=null?i.push(this.type):this.authorizationList&&this.authorizationList.length?i.push(4):r?i.push(2):e?(i.push(1),n||i.push(0)):n?(i.push(1),i.push(2)):(s&&this.to||(i.push(0),i.push(1),i.push(2)),i.push(3)),i.sort(),i}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}clone(){return On.from(this)}toJSON(){const e=r=>r==null?null:r.toString();return{type:this.type,to:this.to,data:this.data,nonce:this.nonce,gasLimit:e(this.gasLimit),gasPrice:e(this.gasPrice),maxPriorityFeePerGas:e(this.maxPriorityFeePerGas),maxFeePerGas:e(this.maxFeePerGas),value:e(this.value),chainId:e(this.chainId),sig:this.signature?this.signature.toJSON():null,accessList:this.accessList}}[Mv](){return this.toString()}toString(){const e=[],r=s=>{let i=this[s];typeof i=="string"&&(i=JSON.stringify(i)),e.push(`${s}: ${i}`)};this.type&&r("type"),r("to"),r("data"),r("nonce"),r("gasLimit"),r("value"),this.chainId!=null&&r("chainId"),this.signature&&(r("from"),e.push(`signature: ${this.signature.toString()}`));const n=this.authorizationList;if(n){const s=[];for(const i of n){const o=[];o.push(`address: ${JSON.stringify(i.address)}`),i.nonce!=null&&o.push(`nonce: ${i.nonce}`),i.chainId!=null&&o.push(`chainId: ${i.chainId}`),i.signature&&o.push(`signature: ${i.signature.toString()}`),s.push(`Authorization { ${o.join(", ")} }`)}e.push(`authorizations: [ ${s.join(", ")} ]`)}return`Transaction { ${e.join(", ")} }`}static from(e){if(e==null)return new On;if(typeof e=="string"){const n=$t(e);if(n[0]>=127)return On.from(Kv(n));switch(n[0]){case 1:return On.from(Wv(n));case 2:return On.from(Vv(n));case 3:return On.from(Hv(n));case 4:return On.from(Jv(n))}Fr(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:"from"})}const r=new On;return e.type!=null&&(r.type=e.type),e.to!=null&&(r.to=e.to),e.nonce!=null&&(r.nonce=e.nonce),e.gasLimit!=null&&(r.gasLimit=e.gasLimit),e.gasPrice!=null&&(r.gasPrice=e.gasPrice),e.maxPriorityFeePerGas!=null&&(r.maxPriorityFeePerGas=e.maxPriorityFeePerGas),e.maxFeePerGas!=null&&(r.maxFeePerGas=e.maxFeePerGas),e.maxFeePerBlobGas!=null&&(r.maxFeePerBlobGas=e.maxFeePerBlobGas),e.data!=null&&(r.data=e.data),e.value!=null&&(r.value=e.value),e.chainId!=null&&(r.chainId=e.chainId),e.signature!=null&&(r.signature=lr.from(e.signature)),e.accessList!=null&&(r.accessList=e.accessList),e.authorizationList!=null&&(r.authorizationList=e.authorizationList),e.blobVersionedHashes!=null&&(r.blobVersionedHashes=e.blobVersionedHashes),e.kzg!=null&&(r.kzg=e.kzg),e.blobWrapperVersion!=null&&(r.blobWrapperVersion=e.blobWrapperVersion),e.blobs!=null&&(r.blobs=e.blobs),e.hash!=null&&(Ce(r.isSigned(),"unsigned transaction cannot define '.hash'","tx",e),Ce(r.hash===e.hash,"hash mismatch","tx",e)),e.from!=null&&(Ce(r.isSigned(),"unsigned transaction cannot define '.from'","tx",e),Ce(r.from.toLowerCase()===(e.from||"").toLowerCase(),"from mismatch","tx",e)),r}};const hi=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function No(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function kl(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function ti(t,...e){if(!No(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function G0(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");kl(t.outputLen),kl(t.blockLen)}function Ea(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Xv(t,e){ti(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function Mi(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function Bc(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function vn(t,e){return t<<32-e|t>>>e}const J0=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Qv=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function zs(t){if(ti(t),J0)return t.toHex();let e="";for(let r=0;r<t.length;r++)e+=Qv[t[r]];return e}const kn={_0:48,_9:57,A:65,F:70,a:97,f:102};function jf(t){if(t>=kn._0&&t<=kn._9)return t-kn._0;if(t>=kn.A&&t<=kn.F)return t-(kn.A-10);if(t>=kn.a&&t<=kn.f)return t-(kn.a-10)}function xa(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(J0)return Uint8Array.fromHex(t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let s=0,i=0;s<r;s++,i+=2){const o=jf(t.charCodeAt(i)),a=jf(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}n[s]=o*16+a}return n}function eE(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function mu(t){return typeof t=="string"&&(t=eE(t)),ti(t),t}function _n(...t){let e=0;for(let n=0;n<t.length;n++){const s=t[n];ti(s),e+=s.length}const r=new Uint8Array(e);for(let n=0,s=0;n<t.length;n++){const i=t[n];r.set(i,s),s+=i.length}return r}class Z0{}function Y0(t){const e=n=>t().update(mu(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function yu(t=32){if(hi&&typeof hi.getRandomValues=="function")return hi.getRandomValues(new Uint8Array(t));if(hi&&typeof hi.randomBytes=="function")return Uint8Array.from(hi.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}function tE(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(r>>s&i),a=Number(r&i),c=n?4:0,l=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+l,a,n)}function rE(t,e,r){return t&e^~t&r}function nE(t,e,r){return t&e^t&r^e&r}class X0 extends Z0{constructor(e,r,n,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=s,this.buffer=new Uint8Array(e),this.view=Bc(this.buffer)}update(e){Ea(this),e=mu(e),ti(e);const{view:r,buffer:n,blockLen:s}=this,i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Bc(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Ea(this),Xv(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;r[o++]=128,Mi(this.buffer.subarray(o)),this.padOffset>s-o&&(this.process(n,0),o=0);for(let m=o;m<s;m++)r[m]=0;tE(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=Bc(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,g=this.get();if(l>g.length)throw new Error("_sha2: outputLen bigger than state");for(let m=0;m<l;m++)a.setUint32(4*m,g[m],i)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=i,e.length=s,e.pos=a,s%r&&e.buffer.set(n),e}clone(){return this._cloneInto()}}const ss=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Tr=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),Yo=BigInt(2**32-1),Hf=BigInt(32);function sE(t,e=!1){return e?{h:Number(t&Yo),l:Number(t>>Hf&Yo)}:{h:Number(t>>Hf&Yo)|0,l:Number(t&Yo)|0}}function iE(t,e=!1){const r=t.length;let n=new Uint32Array(r),s=new Uint32Array(r);for(let i=0;i<r;i++){const{h:o,l:a}=sE(t[i],e);[n[i],s[i]]=[o,a]}return[n,s]}const Gf=(t,e,r)=>t>>>r,Jf=(t,e,r)=>t<<32-r|e>>>r,di=(t,e,r)=>t>>>r|e<<32-r,pi=(t,e,r)=>t<<32-r|e>>>r,Xo=(t,e,r)=>t<<64-r|e>>>r-32,Qo=(t,e,r)=>t>>>r-32|e<<64-r;function Nn(t,e,r,n){const s=(e>>>0)+(n>>>0);return{h:t+r+(s/2**32|0)|0,l:s|0}}const oE=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),aE=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,cE=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),lE=(t,e,r,n,s)=>e+r+n+s+(t/2**32|0)|0,uE=(t,e,r,n,s)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(s>>>0),fE=(t,e,r,n,s,i)=>e+r+n+s+i+(t/2**32|0)|0,hE=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),is=new Uint32Array(64);class dE extends X0{constructor(e=32){super(64,e,8,!1),this.A=ss[0]|0,this.B=ss[1]|0,this.C=ss[2]|0,this.D=ss[3]|0,this.E=ss[4]|0,this.F=ss[5]|0,this.G=ss[6]|0,this.H=ss[7]|0}get(){const{A:e,B:r,C:n,D:s,E:i,F:o,G:a,H:c}=this;return[e,r,n,s,i,o,a,c]}set(e,r,n,s,i,o,a,c){this.A=e|0,this.B=r|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,r){for(let m=0;m<16;m++,r+=4)is[m]=e.getUint32(r,!1);for(let m=16;m<64;m++){const I=is[m-15],_=is[m-2],b=vn(I,7)^vn(I,18)^I>>>3,v=vn(_,17)^vn(_,19)^_>>>10;is[m]=v+is[m-7]+b+is[m-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:c,G:l,H:g}=this;for(let m=0;m<64;m++){const I=vn(a,6)^vn(a,11)^vn(a,25),_=g+I+rE(a,c,l)+hE[m]+is[m]|0,v=(vn(n,2)^vn(n,13)^vn(n,22))+nE(n,s,i)|0;g=l,l=c,c=a,a=o+_|0,o=i,i=s,s=n,n=_+v|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,g=g+this.H|0,this.set(n,s,i,o,a,c,l,g)}roundClean(){Mi(is)}destroy(){this.set(0,0,0,0,0,0,0,0),Mi(this.buffer)}}const Q0=iE(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),pE=Q0[0],gE=Q0[1],os=new Uint32Array(80),as=new Uint32Array(80);class wE extends X0{constructor(e=64){super(128,e,16,!1),this.Ah=Tr[0]|0,this.Al=Tr[1]|0,this.Bh=Tr[2]|0,this.Bl=Tr[3]|0,this.Ch=Tr[4]|0,this.Cl=Tr[5]|0,this.Dh=Tr[6]|0,this.Dl=Tr[7]|0,this.Eh=Tr[8]|0,this.El=Tr[9]|0,this.Fh=Tr[10]|0,this.Fl=Tr[11]|0,this.Gh=Tr[12]|0,this.Gl=Tr[13]|0,this.Hh=Tr[14]|0,this.Hl=Tr[15]|0}get(){const{Ah:e,Al:r,Bh:n,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:g,Fh:m,Fl:I,Gh:_,Gl:b,Hh:v,Hl:S}=this;return[e,r,n,s,i,o,a,c,l,g,m,I,_,b,v,S]}set(e,r,n,s,i,o,a,c,l,g,m,I,_,b,v,S){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=g|0,this.Fh=m|0,this.Fl=I|0,this.Gh=_|0,this.Gl=b|0,this.Hh=v|0,this.Hl=S|0}process(e,r){for(let k=0;k<16;k++,r+=4)os[k]=e.getUint32(r),as[k]=e.getUint32(r+=4);for(let k=16;k<80;k++){const Z=os[k-15]|0,q=as[k-15]|0,J=di(Z,q,1)^di(Z,q,8)^Gf(Z,q,7),se=pi(Z,q,1)^pi(Z,q,8)^Jf(Z,q,7),oe=os[k-2]|0,V=as[k-2]|0,W=di(oe,V,19)^Xo(oe,V,61)^Gf(oe,V,6),Y=pi(oe,V,19)^Qo(oe,V,61)^Jf(oe,V,6),te=cE(se,Y,as[k-7],as[k-16]),A=lE(te,J,W,os[k-7],os[k-16]);os[k]=A|0,as[k]=te|0}let{Ah:n,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:g,Eh:m,El:I,Fh:_,Fl:b,Gh:v,Gl:S,Hh:O,Hl:$}=this;for(let k=0;k<80;k++){const Z=di(m,I,14)^di(m,I,18)^Xo(m,I,41),q=pi(m,I,14)^pi(m,I,18)^Qo(m,I,41),J=m&_^~m&v,se=I&b^~I&S,oe=uE($,q,se,gE[k],as[k]),V=fE(oe,O,Z,J,pE[k],os[k]),W=oe|0,Y=di(n,s,28)^Xo(n,s,34)^Xo(n,s,39),te=pi(n,s,28)^Qo(n,s,34)^Qo(n,s,39),A=n&i^n&a^i&a,u=s&o^s&c^o&c;O=v|0,$=S|0,v=_|0,S=b|0,_=m|0,b=I|0,{h:m,l:I}=Nn(l|0,g|0,V|0,W|0),l=a|0,g=c|0,a=i|0,c=o|0,i=n|0,o=s|0;const d=oE(W,te,u);n=aE(d,V,Y,A),s=d|0}({h:n,l:s}=Nn(this.Ah|0,this.Al|0,n|0,s|0)),{h:i,l:o}=Nn(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=Nn(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:g}=Nn(this.Dh|0,this.Dl|0,l|0,g|0),{h:m,l:I}=Nn(this.Eh|0,this.El|0,m|0,I|0),{h:_,l:b}=Nn(this.Fh|0,this.Fl|0,_|0,b|0),{h:v,l:S}=Nn(this.Gh|0,this.Gl|0,v|0,S|0),{h:O,l:$}=Nn(this.Hh|0,this.Hl|0,O|0,$|0),this.set(n,s,i,o,a,c,l,g,m,I,_,b,v,S,O,$)}roundClean(){Mi(os,as)}destroy(){Mi(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const ep=Y0(()=>new dE),mE=Y0(()=>new wE);const bu=BigInt(0),Nl=BigInt(1);function Zs(t,e=""){if(typeof t!="boolean"){const r=e&&`"${e}"`;throw new Error(r+"expected boolean, got type="+typeof t)}return t}function pn(t,e,r=""){const n=No(t),s=t?.length,i=e!==void 0;if(!n||i&&s!==e){const o=r&&`"${r}" `,a=i?` of length ${e}`:"",c=n?`length=${s}`:`type=${typeof t}`;throw new Error(o+"expected Uint8Array"+a+", got "+c)}return t}function ea(t){const e=t.toString(16);return e.length&1?"0"+e:e}function tp(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?bu:BigInt("0x"+t)}function tc(t){return tp(zs(t))}function vo(t){return ti(t),tp(zs(Uint8Array.from(t).reverse()))}function vu(t,e){return xa(t.toString(16).padStart(e*2,"0"))}function rp(t,e){return vu(t,e).reverse()}function sr(t,e,r){let n;if(typeof e=="string")try{n=xa(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(No(e))n=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=n.length;if(typeof r=="number"&&s!==r)throw new Error(t+" of length "+r+" expected, got "+s);return n}function Zf(t){return Uint8Array.from(t)}const Tc=t=>typeof t=="bigint"&&bu<=t;function yE(t,e,r){return Tc(t)&&Tc(e)&&Tc(r)&&e<=t&&t<r}function Ol(t,e,r,n){if(!yE(e,r,n))throw new Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function np(t){let e;for(e=0;t>bu;t>>=Nl,e+=1);return e}const Oo=t=>(Nl<<BigInt(t))-Nl;function bE(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");const n=_=>new Uint8Array(_),s=_=>Uint8Array.of(_);let i=n(t),o=n(t),a=0;const c=()=>{i.fill(1),o.fill(0),a=0},l=(..._)=>r(o,i,..._),g=(_=n(0))=>{o=l(s(0),_),i=l(),_.length!==0&&(o=l(s(1),_),i=l())},m=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let _=0;const b=[];for(;_<e;){i=l();const v=i.slice();b.push(v),_+=i.length}return _n(...b)};return(_,b)=>{c(),g(_);let v;for(;!(v=b(m()));)g();return c(),v}}function Mo(t,e,r={}){if(!t||typeof t!="object")throw new Error("expected valid options object");function n(s,i,o){const a=t[s];if(o&&a===void 0)return;const c=typeof a;if(c!==i||a===null)throw new Error(`param "${s}" is invalid: expected ${i}, got ${c}`)}Object.entries(e).forEach(([s,i])=>n(s,i,!1)),Object.entries(r).forEach(([s,i])=>n(s,i,!0))}function _a(t){const e=new WeakMap;return(r,...n)=>{const s=e.get(r);if(s!==void 0)return s;const i=t(r,...n);return e.set(r,i),i}}const Hr=BigInt(0),Ir=BigInt(1),Ds=BigInt(2),sp=BigInt(3),ip=BigInt(4),op=BigInt(5),vE=BigInt(7),ap=BigInt(8),EE=BigInt(9),cp=BigInt(16);function ur(t,e){const r=t%e;return r>=Hr?r:e+r}function nr(t,e,r){let n=t;for(;e-- >Hr;)n*=n,n%=r;return n}function Yf(t,e){if(t===Hr)throw new Error("invert: expected non-zero number");if(e<=Hr)throw new Error("invert: expected positive modulus, got "+e);let r=ur(t,e),n=e,s=Hr,i=Ir;for(;r!==Hr;){const a=n/r,c=n%r,l=s-i*a;n=r,r=c,s=i,i=l}if(n!==Ir)throw new Error("invert: does not exist");return ur(s,e)}function Eu(t,e,r){if(!t.eql(t.sqr(e),r))throw new Error("Cannot find square root")}function lp(t,e){const r=(t.ORDER+Ir)/ip,n=t.pow(e,r);return Eu(t,n,e),n}function xE(t,e){const r=(t.ORDER-op)/ap,n=t.mul(e,Ds),s=t.pow(n,r),i=t.mul(e,s),o=t.mul(t.mul(i,Ds),s),a=t.mul(i,t.sub(o,t.ONE));return Eu(t,a,e),a}function _E(t){const e=ri(t),r=up(t),n=r(e,e.neg(e.ONE)),s=r(e,n),i=r(e,e.neg(n)),o=(t+vE)/cp;return(a,c)=>{let l=a.pow(c,o),g=a.mul(l,n);const m=a.mul(l,s),I=a.mul(l,i),_=a.eql(a.sqr(g),c),b=a.eql(a.sqr(m),c);l=a.cmov(l,g,_),g=a.cmov(I,m,b);const v=a.eql(a.sqr(g),c),S=a.cmov(l,g,v);return Eu(a,S,c),S}}function up(t){if(t<sp)throw new Error("sqrt is not defined for small field");let e=t-Ir,r=0;for(;e%Ds===Hr;)e/=Ds,r++;let n=Ds;const s=ri(t);for(;Xf(s,n)===1;)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(r===1)return lp;let i=s.pow(n,e);const o=(e+Ir)/Ds;return function(c,l){if(c.is0(l))return l;if(Xf(c,l)!==1)throw new Error("Cannot find square root");let g=r,m=c.mul(c.ONE,i),I=c.pow(l,e),_=c.pow(l,o);for(;!c.eql(I,c.ONE);){if(c.is0(I))return c.ZERO;let b=1,v=c.sqr(I);for(;!c.eql(v,c.ONE);)if(b++,v=c.sqr(v),b===g)throw new Error("Cannot find square root");const S=Ir<<BigInt(g-b-1),O=c.pow(m,S);g=b,m=c.sqr(O),I=c.mul(I,m),_=c.mul(_,O)}return _}}function IE(t){return t%ip===sp?lp:t%ap===op?xE:t%cp===EE?_E(t):up(t)}const SE=(t,e)=>(ur(t,e)&Ir)===Ir,AE=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function RE(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},r=AE.reduce((n,s)=>(n[s]="function",n),e);return Mo(t,r),t}function BE(t,e,r){if(r<Hr)throw new Error("invalid exponent, negatives unsupported");if(r===Hr)return t.ONE;if(r===Ir)return e;let n=t.ONE,s=e;for(;r>Hr;)r&Ir&&(n=t.mul(n,s)),s=t.sqr(s),r>>=Ir;return n}function fp(t,e,r=!1){const n=new Array(e.length).fill(r?t.ZERO:void 0),s=e.reduce((o,a,c)=>t.is0(a)?o:(n[c]=o,t.mul(o,a)),t.ONE),i=t.inv(s);return e.reduceRight((o,a,c)=>t.is0(a)?o:(n[c]=t.mul(o,n[c]),t.mul(o,a)),i),n}function Xf(t,e){const r=(t.ORDER-Ir)/Ds,n=t.pow(e,r),s=t.eql(n,t.ONE),i=t.eql(n,t.ZERO),o=t.eql(n,t.neg(t.ONE));if(!s&&!i&&!o)throw new Error("invalid Legendre symbol result");return s?1:i?0:-1}function hp(t,e){e!==void 0&&kl(e);const r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function ri(t,e,r=!1,n={}){if(t<=Hr)throw new Error("invalid field: expected ORDER > 0, got "+t);let s,i,o=!1,a;if(typeof e=="object"&&e!=null){if(n.sqrt||r)throw new Error("cannot specify opts in two arguments");const I=e;I.BITS&&(s=I.BITS),I.sqrt&&(i=I.sqrt),typeof I.isLE=="boolean"&&(r=I.isLE),typeof I.modFromBytes=="boolean"&&(o=I.modFromBytes),a=I.allowedLengths}else typeof e=="number"&&(s=e),n.sqrt&&(i=n.sqrt);const{nBitLength:c,nByteLength:l}=hp(t,s);if(l>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let g;const m=Object.freeze({ORDER:t,isLE:r,BITS:c,BYTES:l,MASK:Oo(c),ZERO:Hr,ONE:Ir,allowedLengths:a,create:I=>ur(I,t),isValid:I=>{if(typeof I!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof I);return Hr<=I&&I<t},is0:I=>I===Hr,isValidNot0:I=>!m.is0(I)&&m.isValid(I),isOdd:I=>(I&Ir)===Ir,neg:I=>ur(-I,t),eql:(I,_)=>I===_,sqr:I=>ur(I*I,t),add:(I,_)=>ur(I+_,t),sub:(I,_)=>ur(I-_,t),mul:(I,_)=>ur(I*_,t),pow:(I,_)=>BE(m,I,_),div:(I,_)=>ur(I*Yf(_,t),t),sqrN:I=>I*I,addN:(I,_)=>I+_,subN:(I,_)=>I-_,mulN:(I,_)=>I*_,inv:I=>Yf(I,t),sqrt:i||(I=>(g||(g=IE(t)),g(m,I))),toBytes:I=>r?rp(I,l):vu(I,l),fromBytes:(I,_=!0)=>{if(a){if(!a.includes(I.length)||I.length>l)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+I.length);const v=new Uint8Array(l);v.set(I,r?0:v.length-I.length),I=v}if(I.length!==l)throw new Error("Field.fromBytes: expected "+l+" bytes, got "+I.length);let b=r?vo(I):tc(I);if(o&&(b=ur(b,t)),!_&&!m.isValid(b))throw new Error("invalid field element: outside of range 0..ORDER");return b},invertBatch:I=>fp(m,I),cmov:(I,_,b)=>b?_:I});return Object.freeze(m)}function dp(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function pp(t){const e=dp(t);return e+Math.ceil(e/2)}function TE(t,e,r=!1){const n=t.length,s=dp(e),i=pp(e);if(n<16||n<i||n>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+n);const o=r?vo(t):tc(t),a=ur(o,e-Ir)+Ir;return r?rp(a,s):vu(a,s)}const Ui=BigInt(0),ks=BigInt(1);function Ia(t,e){const r=e.negate();return t?r:e}function Ns(t,e){const r=fp(t.Fp,e.map(n=>n.Z));return e.map((n,s)=>t.fromAffine(n.toAffine(r[s])))}function gp(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Pc(t,e){gp(t,e);const r=Math.ceil(e/t)+1,n=2**(t-1),s=2**t,i=Oo(t),o=BigInt(t);return{windows:r,windowSize:n,mask:i,maxNumber:s,shiftBy:o}}function Qf(t,e,r){const{windowSize:n,mask:s,maxNumber:i,shiftBy:o}=r;let a=Number(t&s),c=t>>o;a>n&&(a-=i,c+=ks);const l=e*n,g=l+Math.abs(a)-1,m=a===0,I=a<0,_=e%2!==0;return{nextN:c,offset:g,isZero:m,isNeg:I,isNegF:_,offsetF:l}}function PE(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,n)=>{if(!(r instanceof e))throw new Error("invalid point at index "+n)})}function CE(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,n)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+n)})}const Cc=new WeakMap,wp=new WeakMap;function Dc(t){return wp.get(t)||1}function eh(t){if(t!==Ui)throw new Error("invalid wNAF")}class mp{constructor(e,r){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=r}_unsafeLadder(e,r,n=this.ZERO){let s=e;for(;r>Ui;)r&ks&&(n=n.add(s)),s=s.double(),r>>=ks;return n}precomputeWindow(e,r){const{windows:n,windowSize:s}=Pc(r,this.bits),i=[];let o=e,a=o;for(let c=0;c<n;c++){a=o,i.push(a);for(let l=1;l<s;l++)a=a.add(o),i.push(a);o=a.double()}return i}wNAF(e,r,n){if(!this.Fn.isValid(n))throw new Error("invalid scalar");let s=this.ZERO,i=this.BASE;const o=Pc(e,this.bits);for(let a=0;a<o.windows;a++){const{nextN:c,offset:l,isZero:g,isNeg:m,isNegF:I,offsetF:_}=Qf(n,a,o);n=c,g?i=i.add(Ia(I,r[_])):s=s.add(Ia(m,r[l]))}return eh(n),{p:s,f:i}}wNAFUnsafe(e,r,n,s=this.ZERO){const i=Pc(e,this.bits);for(let o=0;o<i.windows&&n!==Ui;o++){const{nextN:a,offset:c,isZero:l,isNeg:g}=Qf(n,o,i);if(n=a,!l){const m=r[c];s=s.add(g?m.negate():m)}}return eh(n),s}getPrecomputes(e,r,n){let s=Cc.get(r);return s||(s=this.precomputeWindow(r,e),e!==1&&(typeof n=="function"&&(s=n(s)),Cc.set(r,s))),s}cached(e,r,n){const s=Dc(e);return this.wNAF(s,this.getPrecomputes(s,e,n),r)}unsafe(e,r,n,s){const i=Dc(e);return i===1?this._unsafeLadder(e,r,s):this.wNAFUnsafe(i,this.getPrecomputes(i,e,n),r,s)}createCache(e,r){gp(r,this.bits),wp.set(e,r),Cc.delete(e)}hasCache(e){return Dc(e)!==1}}function DE(t,e,r,n){let s=e,i=t.ZERO,o=t.ZERO;for(;r>Ui||n>Ui;)r&ks&&(i=i.add(s)),n&ks&&(o=o.add(s)),s=s.double(),r>>=ks,n>>=ks;return{p1:i,p2:o}}function yp(t,e,r,n){PE(r,t),CE(n,e);const s=r.length,i=n.length;if(s!==i)throw new Error("arrays of points and scalars must have equal length");const o=t.ZERO,a=np(BigInt(s));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const l=Oo(c),g=new Array(Number(l)+1).fill(o),m=Math.floor((e.BITS-1)/c)*c;let I=o;for(let _=m;_>=0;_-=c){g.fill(o);for(let v=0;v<i;v++){const S=n[v],O=Number(S>>BigInt(_)&l);g[O]=g[O].add(r[v])}let b=o;for(let v=g.length-1,S=o;v>0;v--)S=S.add(g[v]),b=b.add(S);if(I=I.add(b),_!==0)for(let v=0;v<c;v++)I=I.double()}return I}function th(t,e,r){if(e){if(e.ORDER!==t)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return RE(e),e}else return ri(t,{isLE:r})}function bp(t,e,r={},n){if(n===void 0&&(n=t==="edwards"),!e||typeof e!="object")throw new Error(`expected valid ${t} CURVE object`);for(const c of["p","n","h"]){const l=e[c];if(!(typeof l=="bigint"&&l>Ui))throw new Error(`CURVE.${c} must be positive bigint`)}const s=th(e.p,r.Fp,n),i=th(e.n,r.Fn,n),a=["Gx","Gy","a",t==="weierstrass"?"b":"d"];for(const c of a)if(!s.isValid(e[c]))throw new Error(`CURVE.${c} must be valid field element of CURVE.Fp`);return e=Object.freeze(Object.assign({},e)),{CURVE:e,Fp:s,Fn:i}}const cs=BigInt(0),pr=BigInt(1),kc=BigInt(2),kE=BigInt(8);function NE(t,e,r,n){const s=t.sqr(r),i=t.sqr(n),o=t.add(t.mul(e.a,s),i),a=t.add(t.ONE,t.mul(e.d,t.mul(s,i)));return t.eql(o,a)}function OE(t,e={}){const r=bp("edwards",t,e,e.FpFnLE),{Fp:n,Fn:s}=r;let i=r.CURVE;const{h:o}=i;Mo(e,{},{uvRatio:"function"});const a=kc<<BigInt(s.BYTES*8)-pr,c=S=>n.create(S),l=e.uvRatio||((S,O)=>{try{return{isValid:!0,value:n.sqrt(n.div(S,O))}}catch{return{isValid:!1,value:cs}}});if(!NE(n,i,i.Gx,i.Gy))throw new Error("bad curve params: generator point");function g(S,O,$=!1){const k=$?pr:cs;return Ol("coordinate "+S,O,k,a),O}function m(S){if(!(S instanceof b))throw new Error("ExtendedPoint expected")}const I=_a((S,O)=>{const{X:$,Y:k,Z}=S,q=S.is0();O==null&&(O=q?kE:n.inv(Z));const J=c($*O),se=c(k*O),oe=n.mul(Z,O);if(q)return{x:cs,y:pr};if(oe!==pr)throw new Error("invZ was invalid");return{x:J,y:se}}),_=_a(S=>{const{a:O,d:$}=i;if(S.is0())throw new Error("bad point: ZERO");const{X:k,Y:Z,Z:q,T:J}=S,se=c(k*k),oe=c(Z*Z),V=c(q*q),W=c(V*V),Y=c(se*O),te=c(V*c(Y+oe)),A=c(W+c($*c(se*oe)));if(te!==A)throw new Error("bad point: equation left != right (1)");const u=c(k*Z),d=c(q*J);if(u!==d)throw new Error("bad point: equation left != right (2)");return!0});class b{constructor(O,$,k,Z){this.X=g("x",O),this.Y=g("y",$),this.Z=g("z",k,!0),this.T=g("t",Z),Object.freeze(this)}static CURVE(){return i}static fromAffine(O){if(O instanceof b)throw new Error("extended point not allowed");const{x:$,y:k}=O||{};return g("x",$),g("y",k),new b($,k,pr,c($*k))}static fromBytes(O,$=!1){const k=n.BYTES,{a:Z,d:q}=i;O=Zf(pn(O,k,"point")),Zs($,"zip215");const J=Zf(O),se=O[k-1];J[k-1]=se&-129;const oe=vo(J),V=$?a:n.ORDER;Ol("point.y",oe,cs,V);const W=c(oe*oe),Y=c(W-pr),te=c(q*W-Z);let{isValid:A,value:u}=l(Y,te);if(!A)throw new Error("bad point: invalid y coordinate");const d=(u&pr)===pr,x=(se&128)!==0;if(!$&&u===cs&&x)throw new Error("bad point: x=0 and x_0=1");return x!==d&&(u=c(-u)),b.fromAffine({x:u,y:oe})}static fromHex(O,$=!1){return b.fromBytes(sr("point",O),$)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(O=8,$=!0){return v.createCache(this,O),$||this.multiply(kc),this}assertValidity(){_(this)}equals(O){m(O);const{X:$,Y:k,Z}=this,{X:q,Y:J,Z:se}=O,oe=c($*se),V=c(q*Z),W=c(k*se),Y=c(J*Z);return oe===V&&W===Y}is0(){return this.equals(b.ZERO)}negate(){return new b(c(-this.X),this.Y,this.Z,c(-this.T))}double(){const{a:O}=i,{X:$,Y:k,Z}=this,q=c($*$),J=c(k*k),se=c(kc*c(Z*Z)),oe=c(O*q),V=$+k,W=c(c(V*V)-q-J),Y=oe+J,te=Y-se,A=oe-J,u=c(W*te),d=c(Y*A),x=c(W*A),P=c(te*Y);return new b(u,d,P,x)}add(O){m(O);const{a:$,d:k}=i,{X:Z,Y:q,Z:J,T:se}=this,{X:oe,Y:V,Z:W,T:Y}=O,te=c(Z*oe),A=c(q*V),u=c(se*k*Y),d=c(J*W),x=c((Z+q)*(oe+V)-te-A),P=d-u,M=d+u,F=c(A-$*te),j=c(x*P),D=c(M*F),f=c(x*F),p=c(P*M);return new b(j,D,p,f)}subtract(O){return this.add(O.negate())}multiply(O){if(!s.isValidNot0(O))throw new Error("invalid scalar: expected 1 <= sc < curve.n");const{p:$,f:k}=v.cached(this,O,Z=>Ns(b,Z));return Ns(b,[$,k])[0]}multiplyUnsafe(O,$=b.ZERO){if(!s.isValid(O))throw new Error("invalid scalar: expected 0 <= sc < curve.n");return O===cs?b.ZERO:this.is0()||O===pr?this:v.unsafe(this,O,k=>Ns(b,k),$)}isSmallOrder(){return this.multiplyUnsafe(o).is0()}isTorsionFree(){return v.unsafe(this,i.n).is0()}toAffine(O){return I(this,O)}clearCofactor(){return o===pr?this:this.multiplyUnsafe(o)}toBytes(){const{x:O,y:$}=this.toAffine(),k=n.toBytes($);return k[k.length-1]|=O&pr?128:0,k}toHex(){return zs(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get ex(){return this.X}get ey(){return this.Y}get ez(){return this.Z}get et(){return this.T}static normalizeZ(O){return Ns(b,O)}static msm(O,$){return yp(b,s,O,$)}_setWindowSize(O){this.precompute(O)}toRawBytes(){return this.toBytes()}}b.BASE=new b(i.Gx,i.Gy,pr,c(i.Gx*i.Gy)),b.ZERO=new b(cs,pr,pr,cs),b.Fp=n,b.Fn=s;const v=new mp(b,s.BITS);return b.BASE.precompute(8),b}function ME(t,e,r={}){if(typeof e!="function")throw new Error('"hash" function param is required');Mo(r,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});const{prehash:n}=r,{BASE:s,Fp:i,Fn:o}=t,a=r.randomBytes||yu,c=r.adjustScalarBytes||(V=>V),l=r.domain||((V,W,Y)=>{if(Zs(Y,"phflag"),W.length||Y)throw new Error("Contexts/pre-hash are not supported");return V});function g(V){return o.create(vo(V))}function m(V){const W=k.secretKey;V=sr("private key",V,W);const Y=sr("hashed private key",e(V),2*W),te=c(Y.slice(0,W)),A=Y.slice(W,2*W),u=g(te);return{head:te,prefix:A,scalar:u}}function I(V){const{head:W,prefix:Y,scalar:te}=m(V),A=s.multiply(te),u=A.toBytes();return{head:W,prefix:Y,scalar:te,point:A,pointBytes:u}}function _(V){return I(V).pointBytes}function b(V=Uint8Array.of(),...W){const Y=_n(...W);return g(e(l(Y,sr("context",V),!!n)))}function v(V,W,Y={}){V=sr("message",V),n&&(V=n(V));const{prefix:te,scalar:A,pointBytes:u}=I(W),d=b(Y.context,te,V),x=s.multiply(d).toBytes(),P=b(Y.context,x,u,V),M=o.create(d+P*A);if(!o.isValid(M))throw new Error("sign failed: invalid s");const F=_n(x,o.toBytes(M));return pn(F,k.signature,"result")}const S={zip215:!0};function O(V,W,Y,te=S){const{context:A,zip215:u}=te,d=k.signature;V=sr("signature",V,d),W=sr("message",W),Y=sr("publicKey",Y,k.publicKey),u!==void 0&&Zs(u,"zip215"),n&&(W=n(W));const x=d/2,P=V.subarray(0,x),M=vo(V.subarray(x,d));let F,j,D;try{F=t.fromBytes(Y,u),j=t.fromBytes(P,u),D=s.multiplyUnsafe(M)}catch{return!1}if(!u&&F.isSmallOrder())return!1;const f=b(A,j.toBytes(),F.toBytes(),W);return j.add(F.multiplyUnsafe(f)).subtract(D).clearCofactor().is0()}const $=i.BYTES,k={secretKey:$,publicKey:$,signature:2*$,seed:$};function Z(V=a(k.seed)){return pn(V,k.seed,"seed")}function q(V){const W=oe.randomSecretKey(V);return{secretKey:W,publicKey:_(W)}}function J(V){return No(V)&&V.length===o.BYTES}function se(V,W){try{return!!t.fromBytes(V,W)}catch{return!1}}const oe={getExtendedPublicKey:I,randomSecretKey:Z,isValidSecretKey:J,isValidPublicKey:se,toMontgomery(V){const{y:W}=t.fromBytes(V),Y=k.publicKey,te=Y===32;if(!te&&Y!==57)throw new Error("only defined for 25519 and 448");const A=te?i.div(pr+W,pr-W):i.div(W-pr,W+pr);return i.toBytes(A)},toMontgomerySecret(V){const W=k.secretKey;pn(V,W);const Y=e(V.subarray(0,W));return c(Y).subarray(0,W)},randomPrivateKey:Z,precompute(V=8,W=t.BASE){return W.precompute(V,!1)}};return Object.freeze({keygen:q,getPublicKey:_,sign:v,verify:O,utils:oe,Point:t,lengths:k})}function UE(t){const e={a:t.a,d:t.d,p:t.Fp.ORDER,n:t.n,h:t.h,Gx:t.Gx,Gy:t.Gy},r=t.Fp,n=ri(e.n,t.nBitLength,!0),s={Fp:r,Fn:n,uvRatio:t.uvRatio},i={randomBytes:t.randomBytes,adjustScalarBytes:t.adjustScalarBytes,domain:t.domain,prehash:t.prehash,mapToCurve:t.mapToCurve};return{CURVE:e,curveOpts:s,hash:t.hash,eddsaOpts:i}}function LE(t,e){const r=e.Point;return Object.assign({},e,{ExtendedPoint:r,CURVE:t,nBitLength:r.Fn.BITS,nByteLength:r.Fn.BYTES})}function FE(t){const{CURVE:e,curveOpts:r,hash:n,eddsaOpts:s}=UE(t),i=OE(e,r),o=ME(i,n,s);return LE(t,o)}const $E=BigInt(1),rh=BigInt(2);BigInt(3);const KE=BigInt(5),zE=BigInt(8),xu=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),vp={p:xu,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:zE,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function VE(t){const e=BigInt(10),r=BigInt(20),n=BigInt(40),s=BigInt(80),i=xu,a=t*t%i*t%i,c=nr(a,rh,i)*a%i,l=nr(c,$E,i)*t%i,g=nr(l,KE,i)*l%i,m=nr(g,e,i)*g%i,I=nr(m,r,i)*m%i,_=nr(I,n,i)*I%i,b=nr(_,s,i)*_%i,v=nr(b,s,i)*_%i,S=nr(v,e,i)*g%i;return{pow_p_5_8:nr(S,rh,i)*t%i,b2:a}}function qE(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}const nh=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");function WE(t,e){const r=xu,n=ur(e*e*e,r),s=ur(n*n*e,r),i=VE(t*s).pow_p_5_8;let o=ur(t*n*i,r);const a=ur(e*o*o,r),c=o,l=ur(o*nh,r),g=a===t,m=a===ur(-t,r),I=a===ur(-t*nh,r);return g&&(o=c),(m||I)&&(o=l),SE(o,r)&&(o=ur(-o,r)),{isValid:g||m,value:o}}const jE=ri(vp.p,{isLE:!0}),HE={...vp,Fp:jE,hash:mE,adjustScalarBytes:qE,uvRatio:WE},Uo=FE(HE);var ua={exports:{}},GE=ua.exports,sh;function Ep(){return sh||(sh=1,(function(t){(function(e,r){function n(A,u){if(!A)throw new Error(u||"Assertion failed")}function s(A,u){A.super_=u;var d=function(){};d.prototype=u.prototype,A.prototype=new d,A.prototype.constructor=A}function i(A,u,d){if(i.isBN(A))return A;this.negative=0,this.words=null,this.length=0,this.red=null,A!==null&&((u==="le"||u==="be")&&(d=u,u=10),this._init(A||0,u||10,d||"be"))}typeof e=="object"?e.exports=i:r.BN=i,i.BN=i,i.wordSize=26;var o;try{typeof window<"u"&&typeof window.Buffer<"u"?o=window.Buffer:o=a0.Buffer}catch{}i.isBN=function(u){return u instanceof i?!0:u!==null&&typeof u=="object"&&u.constructor.wordSize===i.wordSize&&Array.isArray(u.words)},i.max=function(u,d){return u.cmp(d)>0?u:d},i.min=function(u,d){return u.cmp(d)<0?u:d},i.prototype._init=function(u,d,x){if(typeof u=="number")return this._initNumber(u,d,x);if(typeof u=="object")return this._initArray(u,d,x);d==="hex"&&(d=16),n(d===(d|0)&&d>=2&&d<=36),u=u.toString().replace(/\s+/g,"");var P=0;u[0]==="-"&&(P++,this.negative=1),P<u.length&&(d===16?this._parseHex(u,P,x):(this._parseBase(u,d,P),x==="le"&&this._initArray(this.toArray(),d,x)))},i.prototype._initNumber=function(u,d,x){u<0&&(this.negative=1,u=-u),u<67108864?(this.words=[u&67108863],this.length=1):u<4503599627370496?(this.words=[u&67108863,u/67108864&67108863],this.length=2):(n(u<9007199254740992),this.words=[u&67108863,u/67108864&67108863,1],this.length=3),x==="le"&&this._initArray(this.toArray(),d,x)},i.prototype._initArray=function(u,d,x){if(n(typeof u.length=="number"),u.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(u.length/3),this.words=new Array(this.length);for(var P=0;P<this.length;P++)this.words[P]=0;var M,F,j=0;if(x==="be")for(P=u.length-1,M=0;P>=0;P-=3)F=u[P]|u[P-1]<<8|u[P-2]<<16,this.words[M]|=F<<j&67108863,this.words[M+1]=F>>>26-j&67108863,j+=24,j>=26&&(j-=26,M++);else if(x==="le")for(P=0,M=0;P<u.length;P+=3)F=u[P]|u[P+1]<<8|u[P+2]<<16,this.words[M]|=F<<j&67108863,this.words[M+1]=F>>>26-j&67108863,j+=24,j>=26&&(j-=26,M++);return this._strip()};function a(A,u){var d=A.charCodeAt(u);if(d>=48&&d<=57)return d-48;if(d>=65&&d<=70)return d-55;if(d>=97&&d<=102)return d-87;n(!1,"Invalid character in "+A)}function c(A,u,d){var x=a(A,d);return d-1>=u&&(x|=a(A,d-1)<<4),x}i.prototype._parseHex=function(u,d,x){this.length=Math.ceil((u.length-d)/6),this.words=new Array(this.length);for(var P=0;P<this.length;P++)this.words[P]=0;var M=0,F=0,j;if(x==="be")for(P=u.length-1;P>=d;P-=2)j=c(u,d,P)<<M,this.words[F]|=j&67108863,M>=18?(M-=18,F+=1,this.words[F]|=j>>>26):M+=8;else{var D=u.length-d;for(P=D%2===0?d+1:d;P<u.length;P+=2)j=c(u,d,P)<<M,this.words[F]|=j&67108863,M>=18?(M-=18,F+=1,this.words[F]|=j>>>26):M+=8}this._strip()};function l(A,u,d,x){for(var P=0,M=0,F=Math.min(A.length,d),j=u;j<F;j++){var D=A.charCodeAt(j)-48;P*=x,D>=49?M=D-49+10:D>=17?M=D-17+10:M=D,n(D>=0&&M<x,"Invalid character"),P+=M}return P}i.prototype._parseBase=function(u,d,x){this.words=[0],this.length=1;for(var P=0,M=1;M<=67108863;M*=d)P++;P--,M=M/d|0;for(var F=u.length-x,j=F%P,D=Math.min(F,F-j)+x,f=0,p=x;p<D;p+=P)f=l(u,p,p+P,d),this.imuln(M),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f);if(j!==0){var R=1;for(f=l(u,p,u.length,d),p=0;p<j;p++)R*=d;this.imuln(R),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f)}this._strip()},i.prototype.copy=function(u){u.words=new Array(this.length);for(var d=0;d<this.length;d++)u.words[d]=this.words[d];u.length=this.length,u.negative=this.negative,u.red=this.red};function g(A,u){A.words=u.words,A.length=u.length,A.negative=u.negative,A.red=u.red}if(i.prototype._move=function(u){g(u,this)},i.prototype.clone=function(){var u=new i(null);return this.copy(u),u},i.prototype._expand=function(u){for(;this.length<u;)this.words[this.length++]=0;return this},i.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},i.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{i.prototype[Symbol.for("nodejs.util.inspect.custom")]=m}catch{i.prototype.inspect=m}else i.prototype.inspect=m;function m(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var I=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],_=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],b=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];i.prototype.toString=function(u,d){u=u||10,d=d|0||1;var x;if(u===16||u==="hex"){x="";for(var P=0,M=0,F=0;F<this.length;F++){var j=this.words[F],D=((j<<P|M)&16777215).toString(16);M=j>>>24-P&16777215,P+=2,P>=26&&(P-=26,F--),M!==0||F!==this.length-1?x=I[6-D.length]+D+x:x=D+x}for(M!==0&&(x=M.toString(16)+x);x.length%d!==0;)x="0"+x;return this.negative!==0&&(x="-"+x),x}if(u===(u|0)&&u>=2&&u<=36){var f=_[u],p=b[u];x="";var R=this.clone();for(R.negative=0;!R.isZero();){var U=R.modrn(p).toString(u);R=R.idivn(p),R.isZero()?x=U+x:x=I[f-U.length]+U+x}for(this.isZero()&&(x="0"+x);x.length%d!==0;)x="0"+x;return this.negative!==0&&(x="-"+x),x}n(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var u=this.words[0];return this.length===2?u+=this.words[1]*67108864:this.length===3&&this.words[2]===1?u+=4503599627370496+this.words[1]*67108864:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-u:u},i.prototype.toJSON=function(){return this.toString(16,2)},o&&(i.prototype.toBuffer=function(u,d){return this.toArrayLike(o,u,d)}),i.prototype.toArray=function(u,d){return this.toArrayLike(Array,u,d)};var v=function(u,d){return u.allocUnsafe?u.allocUnsafe(d):new u(d)};i.prototype.toArrayLike=function(u,d,x){this._strip();var P=this.byteLength(),M=x||Math.max(1,P);n(P<=M,"byte array longer than desired length"),n(M>0,"Requested array length <= 0");var F=v(u,M),j=d==="le"?"LE":"BE";return this["_toArrayLike"+j](F,P),F},i.prototype._toArrayLikeLE=function(u,d){for(var x=0,P=0,M=0,F=0;M<this.length;M++){var j=this.words[M]<<F|P;u[x++]=j&255,x<u.length&&(u[x++]=j>>8&255),x<u.length&&(u[x++]=j>>16&255),F===6?(x<u.length&&(u[x++]=j>>24&255),P=0,F=0):(P=j>>>24,F+=2)}if(x<u.length)for(u[x++]=P;x<u.length;)u[x++]=0},i.prototype._toArrayLikeBE=function(u,d){for(var x=u.length-1,P=0,M=0,F=0;M<this.length;M++){var j=this.words[M]<<F|P;u[x--]=j&255,x>=0&&(u[x--]=j>>8&255),x>=0&&(u[x--]=j>>16&255),F===6?(x>=0&&(u[x--]=j>>24&255),P=0,F=0):(P=j>>>24,F+=2)}if(x>=0)for(u[x--]=P;x>=0;)u[x--]=0},Math.clz32?i.prototype._countBits=function(u){return 32-Math.clz32(u)}:i.prototype._countBits=function(u){var d=u,x=0;return d>=4096&&(x+=13,d>>>=13),d>=64&&(x+=7,d>>>=7),d>=8&&(x+=4,d>>>=4),d>=2&&(x+=2,d>>>=2),x+d},i.prototype._zeroBits=function(u){if(u===0)return 26;var d=u,x=0;return(d&8191)===0&&(x+=13,d>>>=13),(d&127)===0&&(x+=7,d>>>=7),(d&15)===0&&(x+=4,d>>>=4),(d&3)===0&&(x+=2,d>>>=2),(d&1)===0&&x++,x},i.prototype.bitLength=function(){var u=this.words[this.length-1],d=this._countBits(u);return(this.length-1)*26+d};function S(A){for(var u=new Array(A.bitLength()),d=0;d<u.length;d++){var x=d/26|0,P=d%26;u[d]=A.words[x]>>>P&1}return u}i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var u=0,d=0;d<this.length;d++){var x=this._zeroBits(this.words[d]);if(u+=x,x!==26)break}return u},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(u){return this.negative!==0?this.abs().inotn(u).iaddn(1):this.clone()},i.prototype.fromTwos=function(u){return this.testn(u-1)?this.notn(u).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return this.negative!==0},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(u){for(;this.length<u.length;)this.words[this.length++]=0;for(var d=0;d<u.length;d++)this.words[d]=this.words[d]|u.words[d];return this._strip()},i.prototype.ior=function(u){return n((this.negative|u.negative)===0),this.iuor(u)},i.prototype.or=function(u){return this.length>u.length?this.clone().ior(u):u.clone().ior(this)},i.prototype.uor=function(u){return this.length>u.length?this.clone().iuor(u):u.clone().iuor(this)},i.prototype.iuand=function(u){var d;this.length>u.length?d=u:d=this;for(var x=0;x<d.length;x++)this.words[x]=this.words[x]&u.words[x];return this.length=d.length,this._strip()},i.prototype.iand=function(u){return n((this.negative|u.negative)===0),this.iuand(u)},i.prototype.and=function(u){return this.length>u.length?this.clone().iand(u):u.clone().iand(this)},i.prototype.uand=function(u){return this.length>u.length?this.clone().iuand(u):u.clone().iuand(this)},i.prototype.iuxor=function(u){var d,x;this.length>u.length?(d=this,x=u):(d=u,x=this);for(var P=0;P<x.length;P++)this.words[P]=d.words[P]^x.words[P];if(this!==d)for(;P<d.length;P++)this.words[P]=d.words[P];return this.length=d.length,this._strip()},i.prototype.ixor=function(u){return n((this.negative|u.negative)===0),this.iuxor(u)},i.prototype.xor=function(u){return this.length>u.length?this.clone().ixor(u):u.clone().ixor(this)},i.prototype.uxor=function(u){return this.length>u.length?this.clone().iuxor(u):u.clone().iuxor(this)},i.prototype.inotn=function(u){n(typeof u=="number"&&u>=0);var d=Math.ceil(u/26)|0,x=u%26;this._expand(d),x>0&&d--;for(var P=0;P<d;P++)this.words[P]=~this.words[P]&67108863;return x>0&&(this.words[P]=~this.words[P]&67108863>>26-x),this._strip()},i.prototype.notn=function(u){return this.clone().inotn(u)},i.prototype.setn=function(u,d){n(typeof u=="number"&&u>=0);var x=u/26|0,P=u%26;return this._expand(x+1),d?this.words[x]=this.words[x]|1<<P:this.words[x]=this.words[x]&~(1<<P),this._strip()},i.prototype.iadd=function(u){var d;if(this.negative!==0&&u.negative===0)return this.negative=0,d=this.isub(u),this.negative^=1,this._normSign();if(this.negative===0&&u.negative!==0)return u.negative=0,d=this.isub(u),u.negative=1,d._normSign();var x,P;this.length>u.length?(x=this,P=u):(x=u,P=this);for(var M=0,F=0;F<P.length;F++)d=(x.words[F]|0)+(P.words[F]|0)+M,this.words[F]=d&67108863,M=d>>>26;for(;M!==0&&F<x.length;F++)d=(x.words[F]|0)+M,this.words[F]=d&67108863,M=d>>>26;if(this.length=x.length,M!==0)this.words[this.length]=M,this.length++;else if(x!==this)for(;F<x.length;F++)this.words[F]=x.words[F];return this},i.prototype.add=function(u){var d;return u.negative!==0&&this.negative===0?(u.negative=0,d=this.sub(u),u.negative^=1,d):u.negative===0&&this.negative!==0?(this.negative=0,d=u.sub(this),this.negative=1,d):this.length>u.length?this.clone().iadd(u):u.clone().iadd(this)},i.prototype.isub=function(u){if(u.negative!==0){u.negative=0;var d=this.iadd(u);return u.negative=1,d._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(u),this.negative=1,this._normSign();var x=this.cmp(u);if(x===0)return this.negative=0,this.length=1,this.words[0]=0,this;var P,M;x>0?(P=this,M=u):(P=u,M=this);for(var F=0,j=0;j<M.length;j++)d=(P.words[j]|0)-(M.words[j]|0)+F,F=d>>26,this.words[j]=d&67108863;for(;F!==0&&j<P.length;j++)d=(P.words[j]|0)+F,F=d>>26,this.words[j]=d&67108863;if(F===0&&j<P.length&&P!==this)for(;j<P.length;j++)this.words[j]=P.words[j];return this.length=Math.max(this.length,j),P!==this&&(this.negative=1),this._strip()},i.prototype.sub=function(u){return this.clone().isub(u)};function O(A,u,d){d.negative=u.negative^A.negative;var x=A.length+u.length|0;d.length=x,x=x-1|0;var P=A.words[0]|0,M=u.words[0]|0,F=P*M,j=F&67108863,D=F/67108864|0;d.words[0]=j;for(var f=1;f<x;f++){for(var p=D>>>26,R=D&67108863,U=Math.min(f,u.length-1),X=Math.max(0,f-A.length+1);X<=U;X++){var fe=f-X|0;P=A.words[fe]|0,M=u.words[X]|0,F=P*M+R,p+=F/67108864|0,R=F&67108863}d.words[f]=R|0,D=p|0}return D!==0?d.words[f]=D|0:d.length--,d._strip()}var $=function(u,d,x){var P=u.words,M=d.words,F=x.words,j=0,D,f,p,R=P[0]|0,U=R&8191,X=R>>>13,fe=P[1]|0,Ee=fe&8191,_e=fe>>>13,Xe=P[2]|0,dt=Xe&8191,Qe=Xe>>>13,Zt=P[3]|0,bt=Zt&8191,kt=Zt>>>13,Pn=P[4]|0,Nt=Pn&8191,Kt=Pn>>>13,nn=P[5]|0,Rt=nn&8191,Bt=nn>>>13,mr=P[6]|0,Tt=mr&8191,Ot=mr>>>13,Ur=P[7]|0,Mt=Ur&8191,B=Ur>>>13,w=P[8]|0,y=w&8191,L=w>>>13,Q=P[9]|0,ne=Q&8191,he=Q>>>13,Ze=M[0]|0,ze=Ze&8191,$e=Ze>>>13,xt=M[1]|0,Ue=xt&8191,Ut=xt>>>13,oi=M[2]|0,Wt=oi&8191,Yt=oi>>>13,Ko=M[3]|0,_t=Ko&8191,Pt=Ko>>>13,Cn=M[4]|0,zt=Cn&8191,Vt=Cn>>>13,Xi=M[5]|0,Xt=Xi&8191,wt=Xi>>>13,Qi=M[6]|0,E=Qi&8191,T=Qi>>>13,C=M[7]|0,h=C&8191,N=C>>>13,re=M[8]|0,ee=re&8191,de=re>>>13,be=M[9]|0,Ie=be&8191,ve=be>>>13;x.negative=u.negative^d.negative,x.length=19,D=Math.imul(U,ze),f=Math.imul(U,$e),f=f+Math.imul(X,ze)|0,p=Math.imul(X,$e);var ft=(j+D|0)+((f&8191)<<13)|0;j=(p+(f>>>13)|0)+(ft>>>26)|0,ft&=67108863,D=Math.imul(Ee,ze),f=Math.imul(Ee,$e),f=f+Math.imul(_e,ze)|0,p=Math.imul(_e,$e),D=D+Math.imul(U,Ue)|0,f=f+Math.imul(U,Ut)|0,f=f+Math.imul(X,Ue)|0,p=p+Math.imul(X,Ut)|0;var Pe=(j+D|0)+((f&8191)<<13)|0;j=(p+(f>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,D=Math.imul(dt,ze),f=Math.imul(dt,$e),f=f+Math.imul(Qe,ze)|0,p=Math.imul(Qe,$e),D=D+Math.imul(Ee,Ue)|0,f=f+Math.imul(Ee,Ut)|0,f=f+Math.imul(_e,Ue)|0,p=p+Math.imul(_e,Ut)|0,D=D+Math.imul(U,Wt)|0,f=f+Math.imul(U,Yt)|0,f=f+Math.imul(X,Wt)|0,p=p+Math.imul(X,Yt)|0;var Ke=(j+D|0)+((f&8191)<<13)|0;j=(p+(f>>>13)|0)+(Ke>>>26)|0,Ke&=67108863,D=Math.imul(bt,ze),f=Math.imul(bt,$e),f=f+Math.imul(kt,ze)|0,p=Math.imul(kt,$e),D=D+Math.imul(dt,Ue)|0,f=f+Math.imul(dt,Ut)|0,f=f+Math.imul(Qe,Ue)|0,p=p+Math.imul(Qe,Ut)|0,D=D+Math.imul(Ee,Wt)|0,f=f+Math.imul(Ee,Yt)|0,f=f+Math.imul(_e,Wt)|0,p=p+Math.imul(_e,Yt)|0,D=D+Math.imul(U,_t)|0,f=f+Math.imul(U,Pt)|0,f=f+Math.imul(X,_t)|0,p=p+Math.imul(X,Pt)|0;var Ve=(j+D|0)+((f&8191)<<13)|0;j=(p+(f>>>13)|0)+(Ve>>>26)|0,Ve&=67108863,D=Math.imul(Nt,ze),f=Math.imul(Nt,$e),f=f+Math.imul(Kt,ze)|0,p=Math.imul(Kt,$e),D=D+Math.imul(bt,Ue)|0,f=f+Math.imul(bt,Ut)|0,f=f+Math.imul(kt,Ue)|0,p=p+Math.imul(kt,Ut)|0,D=D+Math.imul(dt,Wt)|0,f=f+Math.imul(dt,Yt)|0,f=f+Math.imul(Qe,Wt)|0,p=p+Math.imul(Qe,Yt)|0,D=D+Math.imul(Ee,_t)|0,f=f+Math.imul(Ee,Pt)|0,f=f+Math.imul(_e,_t)|0,p=p+Math.imul(_e,Pt)|0,D=D+Math.imul(U,zt)|0,f=f+Math.imul(U,Vt)|0,f=f+Math.imul(X,zt)|0,p=p+Math.imul(X,Vt)|0;var Ye=(j+D|0)+((f&8191)<<13)|0;j=(p+(f>>>13)|0)+(Ye>>>26)|0,Ye&=67108863,D=Math.imul(Rt,ze),f=Math.imul(Rt,$e),f=f+Math.imul(Bt,ze)|0,p=Math.imul(Bt,$e),D=D+Math.imul(Nt,Ue)|0,f=f+Math.imul(Nt,Ut)|0,f=f+Math.imul(Kt,Ue)|0,p=p+Math.imul(Kt,Ut)|0,D=D+Math.imul(bt,Wt)|0,f=f+Math.imul(bt,Yt)|0,f=f+Math.imul(kt,Wt)|0,p=p+Math.imul(kt,Yt)|0,D=D+Math.imul(dt,_t)|0,f=f+Math.imul(dt,Pt)|0,f=f+Math.imul(Qe,_t)|0,p=p+Math.imul(Qe,Pt)|0,D=D+Math.imul(Ee,zt)|0,f=f+Math.imul(Ee,Vt)|0,f=f+Math.imul(_e,zt)|0,p=p+Math.imul(_e,Vt)|0,D=D+Math.imul(U,Xt)|0,f=f+Math.imul(U,wt)|0,f=f+Math.imul(X,Xt)|0,p=p+Math.imul(X,wt)|0;var Je=(j+D|0)+((f&8191)<<13)|0;j=(p+(f>>>13)|0)+(Je>>>26)|0,Je&=67108863,D=Math.imul(Tt,ze),f=Math.imul(Tt,$e),f=f+Math.imul(Ot,ze)|0,p=Math.imul(Ot,$e),D=D+Math.imul(Rt,Ue)|0,f=f+Math.imul(Rt,Ut)|0,f=f+Math.imul(Bt,Ue)|0,p=p+Math.imul(Bt,Ut)|0,D=D+Math.imul(Nt,Wt)|0,f=f+Math.imul(Nt,Yt)|0,f=f+Math.imul(Kt,Wt)|0,p=p+Math.imul(Kt,Yt)|0,D=D+Math.imul(bt,_t)|0,f=f+Math.imul(bt,Pt)|0,f=f+Math.imul(kt,_t)|0,p=p+Math.imul(kt,Pt)|0,D=D+Math.imul(dt,zt)|0,f=f+Math.imul(dt,Vt)|0,f=f+Math.imul(Qe,zt)|0,p=p+Math.imul(Qe,Vt)|0,D=D+Math.imul(Ee,Xt)|0,f=f+Math.imul(Ee,wt)|0,f=f+Math.imul(_e,Xt)|0,p=p+Math.imul(_e,wt)|0,D=D+Math.imul(U,E)|0,f=f+Math.imul(U,T)|0,f=f+Math.imul(X,E)|0,p=p+Math.imul(X,T)|0;var qe=(j+D|0)+((f&8191)<<13)|0;j=(p+(f>>>13)|0)+(qe>>>26)|0,qe&=67108863,D=Math.imul(Mt,ze),f=Math.imul(Mt,$e),f=f+Math.imul(B,ze)|0,p=Math.imul(B,$e),D=D+Math.imul(Tt,Ue)|0,f=f+Math.imul(Tt,Ut)|0,f=f+Math.imul(Ot,Ue)|0,p=p+Math.imul(Ot,Ut)|0,D=D+Math.imul(Rt,Wt)|0,f=f+Math.imul(Rt,Yt)|0,f=f+Math.imul(Bt,Wt)|0,p=p+Math.imul(Bt,Yt)|0,D=D+Math.imul(Nt,_t)|0,f=f+Math.imul(Nt,Pt)|0,f=f+Math.imul(Kt,_t)|0,p=p+Math.imul(Kt,Pt)|0,D=D+Math.imul(bt,zt)|0,f=f+Math.imul(bt,Vt)|0,f=f+Math.imul(kt,zt)|0,p=p+Math.imul(kt,Vt)|0,D=D+Math.imul(dt,Xt)|0,f=f+Math.imul(dt,wt)|0,f=f+Math.imul(Qe,Xt)|0,p=p+Math.imul(Qe,wt)|0,D=D+Math.imul(Ee,E)|0,f=f+Math.imul(Ee,T)|0,f=f+Math.imul(_e,E)|0,p=p+Math.imul(_e,T)|0,D=D+Math.imul(U,h)|0,f=f+Math.imul(U,N)|0,f=f+Math.imul(X,h)|0,p=p+Math.imul(X,N)|0;var He=(j+D|0)+((f&8191)<<13)|0;j=(p+(f>>>13)|0)+(He>>>26)|0,He&=67108863,D=Math.imul(y,ze),f=Math.imul(y,$e),f=f+Math.imul(L,ze)|0,p=Math.imul(L,$e),D=D+Math.imul(Mt,Ue)|0,f=f+Math.imul(Mt,Ut)|0,f=f+Math.imul(B,Ue)|0,p=p+Math.imul(B,Ut)|0,D=D+Math.imul(Tt,Wt)|0,f=f+Math.imul(Tt,Yt)|0,f=f+Math.imul(Ot,Wt)|0,p=p+Math.imul(Ot,Yt)|0,D=D+Math.imul(Rt,_t)|0,f=f+Math.imul(Rt,Pt)|0,f=f+Math.imul(Bt,_t)|0,p=p+Math.imul(Bt,Pt)|0,D=D+Math.imul(Nt,zt)|0,f=f+Math.imul(Nt,Vt)|0,f=f+Math.imul(Kt,zt)|0,p=p+Math.imul(Kt,Vt)|0,D=D+Math.imul(bt,Xt)|0,f=f+Math.imul(bt,wt)|0,f=f+Math.imul(kt,Xt)|0,p=p+Math.imul(kt,wt)|0,D=D+Math.imul(dt,E)|0,f=f+Math.imul(dt,T)|0,f=f+Math.imul(Qe,E)|0,p=p+Math.imul(Qe,T)|0,D=D+Math.imul(Ee,h)|0,f=f+Math.imul(Ee,N)|0,f=f+Math.imul(_e,h)|0,p=p+Math.imul(_e,N)|0,D=D+Math.imul(U,ee)|0,f=f+Math.imul(U,de)|0,f=f+Math.imul(X,ee)|0,p=p+Math.imul(X,de)|0;var We=(j+D|0)+((f&8191)<<13)|0;j=(p+(f>>>13)|0)+(We>>>26)|0,We&=67108863,D=Math.imul(ne,ze),f=Math.imul(ne,$e),f=f+Math.imul(he,ze)|0,p=Math.imul(he,$e),D=D+Math.imul(y,Ue)|0,f=f+Math.imul(y,Ut)|0,f=f+Math.imul(L,Ue)|0,p=p+Math.imul(L,Ut)|0,D=D+Math.imul(Mt,Wt)|0,f=f+Math.imul(Mt,Yt)|0,f=f+Math.imul(B,Wt)|0,p=p+Math.imul(B,Yt)|0,D=D+Math.imul(Tt,_t)|0,f=f+Math.imul(Tt,Pt)|0,f=f+Math.imul(Ot,_t)|0,p=p+Math.imul(Ot,Pt)|0,D=D+Math.imul(Rt,zt)|0,f=f+Math.imul(Rt,Vt)|0,f=f+Math.imul(Bt,zt)|0,p=p+Math.imul(Bt,Vt)|0,D=D+Math.imul(Nt,Xt)|0,f=f+Math.imul(Nt,wt)|0,f=f+Math.imul(Kt,Xt)|0,p=p+Math.imul(Kt,wt)|0,D=D+Math.imul(bt,E)|0,f=f+Math.imul(bt,T)|0,f=f+Math.imul(kt,E)|0,p=p+Math.imul(kt,T)|0,D=D+Math.imul(dt,h)|0,f=f+Math.imul(dt,N)|0,f=f+Math.imul(Qe,h)|0,p=p+Math.imul(Qe,N)|0,D=D+Math.imul(Ee,ee)|0,f=f+Math.imul(Ee,de)|0,f=f+Math.imul(_e,ee)|0,p=p+Math.imul(_e,de)|0,D=D+Math.imul(U,Ie)|0,f=f+Math.imul(U,ve)|0,f=f+Math.imul(X,Ie)|0,p=p+Math.imul(X,ve)|0;var De=(j+D|0)+((f&8191)<<13)|0;j=(p+(f>>>13)|0)+(De>>>26)|0,De&=67108863,D=Math.imul(ne,Ue),f=Math.imul(ne,Ut),f=f+Math.imul(he,Ue)|0,p=Math.imul(he,Ut),D=D+Math.imul(y,Wt)|0,f=f+Math.imul(y,Yt)|0,f=f+Math.imul(L,Wt)|0,p=p+Math.imul(L,Yt)|0,D=D+Math.imul(Mt,_t)|0,f=f+Math.imul(Mt,Pt)|0,f=f+Math.imul(B,_t)|0,p=p+Math.imul(B,Pt)|0,D=D+Math.imul(Tt,zt)|0,f=f+Math.imul(Tt,Vt)|0,f=f+Math.imul(Ot,zt)|0,p=p+Math.imul(Ot,Vt)|0,D=D+Math.imul(Rt,Xt)|0,f=f+Math.imul(Rt,wt)|0,f=f+Math.imul(Bt,Xt)|0,p=p+Math.imul(Bt,wt)|0,D=D+Math.imul(Nt,E)|0,f=f+Math.imul(Nt,T)|0,f=f+Math.imul(Kt,E)|0,p=p+Math.imul(Kt,T)|0,D=D+Math.imul(bt,h)|0,f=f+Math.imul(bt,N)|0,f=f+Math.imul(kt,h)|0,p=p+Math.imul(kt,N)|0,D=D+Math.imul(dt,ee)|0,f=f+Math.imul(dt,de)|0,f=f+Math.imul(Qe,ee)|0,p=p+Math.imul(Qe,de)|0,D=D+Math.imul(Ee,Ie)|0,f=f+Math.imul(Ee,ve)|0,f=f+Math.imul(_e,Ie)|0,p=p+Math.imul(_e,ve)|0;var Oe=(j+D|0)+((f&8191)<<13)|0;j=(p+(f>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,D=Math.imul(ne,Wt),f=Math.imul(ne,Yt),f=f+Math.imul(he,Wt)|0,p=Math.imul(he,Yt),D=D+Math.imul(y,_t)|0,f=f+Math.imul(y,Pt)|0,f=f+Math.imul(L,_t)|0,p=p+Math.imul(L,Pt)|0,D=D+Math.imul(Mt,zt)|0,f=f+Math.imul(Mt,Vt)|0,f=f+Math.imul(B,zt)|0,p=p+Math.imul(B,Vt)|0,D=D+Math.imul(Tt,Xt)|0,f=f+Math.imul(Tt,wt)|0,f=f+Math.imul(Ot,Xt)|0,p=p+Math.imul(Ot,wt)|0,D=D+Math.imul(Rt,E)|0,f=f+Math.imul(Rt,T)|0,f=f+Math.imul(Bt,E)|0,p=p+Math.imul(Bt,T)|0,D=D+Math.imul(Nt,h)|0,f=f+Math.imul(Nt,N)|0,f=f+Math.imul(Kt,h)|0,p=p+Math.imul(Kt,N)|0,D=D+Math.imul(bt,ee)|0,f=f+Math.imul(bt,de)|0,f=f+Math.imul(kt,ee)|0,p=p+Math.imul(kt,de)|0,D=D+Math.imul(dt,Ie)|0,f=f+Math.imul(dt,ve)|0,f=f+Math.imul(Qe,Ie)|0,p=p+Math.imul(Qe,ve)|0;var Be=(j+D|0)+((f&8191)<<13)|0;j=(p+(f>>>13)|0)+(Be>>>26)|0,Be&=67108863,D=Math.imul(ne,_t),f=Math.imul(ne,Pt),f=f+Math.imul(he,_t)|0,p=Math.imul(he,Pt),D=D+Math.imul(y,zt)|0,f=f+Math.imul(y,Vt)|0,f=f+Math.imul(L,zt)|0,p=p+Math.imul(L,Vt)|0,D=D+Math.imul(Mt,Xt)|0,f=f+Math.imul(Mt,wt)|0,f=f+Math.imul(B,Xt)|0,p=p+Math.imul(B,wt)|0,D=D+Math.imul(Tt,E)|0,f=f+Math.imul(Tt,T)|0,f=f+Math.imul(Ot,E)|0,p=p+Math.imul(Ot,T)|0,D=D+Math.imul(Rt,h)|0,f=f+Math.imul(Rt,N)|0,f=f+Math.imul(Bt,h)|0,p=p+Math.imul(Bt,N)|0,D=D+Math.imul(Nt,ee)|0,f=f+Math.imul(Nt,de)|0,f=f+Math.imul(Kt,ee)|0,p=p+Math.imul(Kt,de)|0,D=D+Math.imul(bt,Ie)|0,f=f+Math.imul(bt,ve)|0,f=f+Math.imul(kt,Ie)|0,p=p+Math.imul(kt,ve)|0;var ke=(j+D|0)+((f&8191)<<13)|0;j=(p+(f>>>13)|0)+(ke>>>26)|0,ke&=67108863,D=Math.imul(ne,zt),f=Math.imul(ne,Vt),f=f+Math.imul(he,zt)|0,p=Math.imul(he,Vt),D=D+Math.imul(y,Xt)|0,f=f+Math.imul(y,wt)|0,f=f+Math.imul(L,Xt)|0,p=p+Math.imul(L,wt)|0,D=D+Math.imul(Mt,E)|0,f=f+Math.imul(Mt,T)|0,f=f+Math.imul(B,E)|0,p=p+Math.imul(B,T)|0,D=D+Math.imul(Tt,h)|0,f=f+Math.imul(Tt,N)|0,f=f+Math.imul(Ot,h)|0,p=p+Math.imul(Ot,N)|0,D=D+Math.imul(Rt,ee)|0,f=f+Math.imul(Rt,de)|0,f=f+Math.imul(Bt,ee)|0,p=p+Math.imul(Bt,de)|0,D=D+Math.imul(Nt,Ie)|0,f=f+Math.imul(Nt,ve)|0,f=f+Math.imul(Kt,Ie)|0,p=p+Math.imul(Kt,ve)|0;var Ne=(j+D|0)+((f&8191)<<13)|0;j=(p+(f>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,D=Math.imul(ne,Xt),f=Math.imul(ne,wt),f=f+Math.imul(he,Xt)|0,p=Math.imul(he,wt),D=D+Math.imul(y,E)|0,f=f+Math.imul(y,T)|0,f=f+Math.imul(L,E)|0,p=p+Math.imul(L,T)|0,D=D+Math.imul(Mt,h)|0,f=f+Math.imul(Mt,N)|0,f=f+Math.imul(B,h)|0,p=p+Math.imul(B,N)|0,D=D+Math.imul(Tt,ee)|0,f=f+Math.imul(Tt,de)|0,f=f+Math.imul(Ot,ee)|0,p=p+Math.imul(Ot,de)|0,D=D+Math.imul(Rt,Ie)|0,f=f+Math.imul(Rt,ve)|0,f=f+Math.imul(Bt,Ie)|0,p=p+Math.imul(Bt,ve)|0;var Ae=(j+D|0)+((f&8191)<<13)|0;j=(p+(f>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,D=Math.imul(ne,E),f=Math.imul(ne,T),f=f+Math.imul(he,E)|0,p=Math.imul(he,T),D=D+Math.imul(y,h)|0,f=f+Math.imul(y,N)|0,f=f+Math.imul(L,h)|0,p=p+Math.imul(L,N)|0,D=D+Math.imul(Mt,ee)|0,f=f+Math.imul(Mt,de)|0,f=f+Math.imul(B,ee)|0,p=p+Math.imul(B,de)|0,D=D+Math.imul(Tt,Ie)|0,f=f+Math.imul(Tt,ve)|0,f=f+Math.imul(Ot,Ie)|0,p=p+Math.imul(Ot,ve)|0;var ce=(j+D|0)+((f&8191)<<13)|0;j=(p+(f>>>13)|0)+(ce>>>26)|0,ce&=67108863,D=Math.imul(ne,h),f=Math.imul(ne,N),f=f+Math.imul(he,h)|0,p=Math.imul(he,N),D=D+Math.imul(y,ee)|0,f=f+Math.imul(y,de)|0,f=f+Math.imul(L,ee)|0,p=p+Math.imul(L,de)|0,D=D+Math.imul(Mt,Ie)|0,f=f+Math.imul(Mt,ve)|0,f=f+Math.imul(B,Ie)|0,p=p+Math.imul(B,ve)|0;var le=(j+D|0)+((f&8191)<<13)|0;j=(p+(f>>>13)|0)+(le>>>26)|0,le&=67108863,D=Math.imul(ne,ee),f=Math.imul(ne,de),f=f+Math.imul(he,ee)|0,p=Math.imul(he,de),D=D+Math.imul(y,Ie)|0,f=f+Math.imul(y,ve)|0,f=f+Math.imul(L,Ie)|0,p=p+Math.imul(L,ve)|0;var we=(j+D|0)+((f&8191)<<13)|0;j=(p+(f>>>13)|0)+(we>>>26)|0,we&=67108863,D=Math.imul(ne,Ie),f=Math.imul(ne,ve),f=f+Math.imul(he,Ie)|0,p=Math.imul(he,ve);var pe=(j+D|0)+((f&8191)<<13)|0;return j=(p+(f>>>13)|0)+(pe>>>26)|0,pe&=67108863,F[0]=ft,F[1]=Pe,F[2]=Ke,F[3]=Ve,F[4]=Ye,F[5]=Je,F[6]=qe,F[7]=He,F[8]=We,F[9]=De,F[10]=Oe,F[11]=Be,F[12]=ke,F[13]=Ne,F[14]=Ae,F[15]=ce,F[16]=le,F[17]=we,F[18]=pe,j!==0&&(F[19]=j,x.length++),x};Math.imul||($=O);function k(A,u,d){d.negative=u.negative^A.negative,d.length=A.length+u.length;for(var x=0,P=0,M=0;M<d.length-1;M++){var F=P;P=0;for(var j=x&67108863,D=Math.min(M,u.length-1),f=Math.max(0,M-A.length+1);f<=D;f++){var p=M-f,R=A.words[p]|0,U=u.words[f]|0,X=R*U,fe=X&67108863;F=F+(X/67108864|0)|0,fe=fe+j|0,j=fe&67108863,F=F+(fe>>>26)|0,P+=F>>>26,F&=67108863}d.words[M]=j,x=F,F=P}return x!==0?d.words[M]=x:d.length--,d._strip()}function Z(A,u,d){return k(A,u,d)}i.prototype.mulTo=function(u,d){var x,P=this.length+u.length;return this.length===10&&u.length===10?x=$(this,u,d):P<63?x=O(this,u,d):P<1024?x=k(this,u,d):x=Z(this,u,d),x},i.prototype.mul=function(u){var d=new i(null);return d.words=new Array(this.length+u.length),this.mulTo(u,d)},i.prototype.mulf=function(u){var d=new i(null);return d.words=new Array(this.length+u.length),Z(this,u,d)},i.prototype.imul=function(u){return this.clone().mulTo(u,this)},i.prototype.imuln=function(u){var d=u<0;d&&(u=-u),n(typeof u=="number"),n(u<67108864);for(var x=0,P=0;P<this.length;P++){var M=(this.words[P]|0)*u,F=(M&67108863)+(x&67108863);x>>=26,x+=M/67108864|0,x+=F>>>26,this.words[P]=F&67108863}return x!==0&&(this.words[P]=x,this.length++),this.length=u===0?1:this.length,d?this.ineg():this},i.prototype.muln=function(u){return this.clone().imuln(u)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(u){var d=S(u);if(d.length===0)return new i(1);for(var x=this,P=0;P<d.length&&d[P]===0;P++,x=x.sqr());if(++P<d.length)for(var M=x.sqr();P<d.length;P++,M=M.sqr())d[P]!==0&&(x=x.mul(M));return x},i.prototype.iushln=function(u){n(typeof u=="number"&&u>=0);var d=u%26,x=(u-d)/26,P=67108863>>>26-d<<26-d,M;if(d!==0){var F=0;for(M=0;M<this.length;M++){var j=this.words[M]&P,D=(this.words[M]|0)-j<<d;this.words[M]=D|F,F=j>>>26-d}F&&(this.words[M]=F,this.length++)}if(x!==0){for(M=this.length-1;M>=0;M--)this.words[M+x]=this.words[M];for(M=0;M<x;M++)this.words[M]=0;this.length+=x}return this._strip()},i.prototype.ishln=function(u){return n(this.negative===0),this.iushln(u)},i.prototype.iushrn=function(u,d,x){n(typeof u=="number"&&u>=0);var P;d?P=(d-d%26)/26:P=0;var M=u%26,F=Math.min((u-M)/26,this.length),j=67108863^67108863>>>M<<M,D=x;if(P-=F,P=Math.max(0,P),D){for(var f=0;f<F;f++)D.words[f]=this.words[f];D.length=F}if(F!==0)if(this.length>F)for(this.length-=F,f=0;f<this.length;f++)this.words[f]=this.words[f+F];else this.words[0]=0,this.length=1;var p=0;for(f=this.length-1;f>=0&&(p!==0||f>=P);f--){var R=this.words[f]|0;this.words[f]=p<<26-M|R>>>M,p=R&j}return D&&p!==0&&(D.words[D.length++]=p),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},i.prototype.ishrn=function(u,d,x){return n(this.negative===0),this.iushrn(u,d,x)},i.prototype.shln=function(u){return this.clone().ishln(u)},i.prototype.ushln=function(u){return this.clone().iushln(u)},i.prototype.shrn=function(u){return this.clone().ishrn(u)},i.prototype.ushrn=function(u){return this.clone().iushrn(u)},i.prototype.testn=function(u){n(typeof u=="number"&&u>=0);var d=u%26,x=(u-d)/26,P=1<<d;if(this.length<=x)return!1;var M=this.words[x];return!!(M&P)},i.prototype.imaskn=function(u){n(typeof u=="number"&&u>=0);var d=u%26,x=(u-d)/26;if(n(this.negative===0,"imaskn works only with positive numbers"),this.length<=x)return this;if(d!==0&&x++,this.length=Math.min(x,this.length),d!==0){var P=67108863^67108863>>>d<<d;this.words[this.length-1]&=P}return this._strip()},i.prototype.maskn=function(u){return this.clone().imaskn(u)},i.prototype.iaddn=function(u){return n(typeof u=="number"),n(u<67108864),u<0?this.isubn(-u):this.negative!==0?this.length===1&&(this.words[0]|0)<=u?(this.words[0]=u-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(u),this.negative=1,this):this._iaddn(u)},i.prototype._iaddn=function(u){this.words[0]+=u;for(var d=0;d<this.length&&this.words[d]>=67108864;d++)this.words[d]-=67108864,d===this.length-1?this.words[d+1]=1:this.words[d+1]++;return this.length=Math.max(this.length,d+1),this},i.prototype.isubn=function(u){if(n(typeof u=="number"),n(u<67108864),u<0)return this.iaddn(-u);if(this.negative!==0)return this.negative=0,this.iaddn(u),this.negative=1,this;if(this.words[0]-=u,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var d=0;d<this.length&&this.words[d]<0;d++)this.words[d]+=67108864,this.words[d+1]-=1;return this._strip()},i.prototype.addn=function(u){return this.clone().iaddn(u)},i.prototype.subn=function(u){return this.clone().isubn(u)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(u,d,x){var P=u.length+x,M;this._expand(P);var F,j=0;for(M=0;M<u.length;M++){F=(this.words[M+x]|0)+j;var D=(u.words[M]|0)*d;F-=D&67108863,j=(F>>26)-(D/67108864|0),this.words[M+x]=F&67108863}for(;M<this.length-x;M++)F=(this.words[M+x]|0)+j,j=F>>26,this.words[M+x]=F&67108863;if(j===0)return this._strip();for(n(j===-1),j=0,M=0;M<this.length;M++)F=-(this.words[M]|0)+j,j=F>>26,this.words[M]=F&67108863;return this.negative=1,this._strip()},i.prototype._wordDiv=function(u,d){var x=this.length-u.length,P=this.clone(),M=u,F=M.words[M.length-1]|0,j=this._countBits(F);x=26-j,x!==0&&(M=M.ushln(x),P.iushln(x),F=M.words[M.length-1]|0);var D=P.length-M.length,f;if(d!=="mod"){f=new i(null),f.length=D+1,f.words=new Array(f.length);for(var p=0;p<f.length;p++)f.words[p]=0}var R=P.clone()._ishlnsubmul(M,1,D);R.negative===0&&(P=R,f&&(f.words[D]=1));for(var U=D-1;U>=0;U--){var X=(P.words[M.length+U]|0)*67108864+(P.words[M.length+U-1]|0);for(X=Math.min(X/F|0,67108863),P._ishlnsubmul(M,X,U);P.negative!==0;)X--,P.negative=0,P._ishlnsubmul(M,1,U),P.isZero()||(P.negative^=1);f&&(f.words[U]=X)}return f&&f._strip(),P._strip(),d!=="div"&&x!==0&&P.iushrn(x),{div:f||null,mod:P}},i.prototype.divmod=function(u,d,x){if(n(!u.isZero()),this.isZero())return{div:new i(0),mod:new i(0)};var P,M,F;return this.negative!==0&&u.negative===0?(F=this.neg().divmod(u,d),d!=="mod"&&(P=F.div.neg()),d!=="div"&&(M=F.mod.neg(),x&&M.negative!==0&&M.iadd(u)),{div:P,mod:M}):this.negative===0&&u.negative!==0?(F=this.divmod(u.neg(),d),d!=="mod"&&(P=F.div.neg()),{div:P,mod:F.mod}):(this.negative&u.negative)!==0?(F=this.neg().divmod(u.neg(),d),d!=="div"&&(M=F.mod.neg(),x&&M.negative!==0&&M.isub(u)),{div:F.div,mod:M}):u.length>this.length||this.cmp(u)<0?{div:new i(0),mod:this}:u.length===1?d==="div"?{div:this.divn(u.words[0]),mod:null}:d==="mod"?{div:null,mod:new i(this.modrn(u.words[0]))}:{div:this.divn(u.words[0]),mod:new i(this.modrn(u.words[0]))}:this._wordDiv(u,d)},i.prototype.div=function(u){return this.divmod(u,"div",!1).div},i.prototype.mod=function(u){return this.divmod(u,"mod",!1).mod},i.prototype.umod=function(u){return this.divmod(u,"mod",!0).mod},i.prototype.divRound=function(u){var d=this.divmod(u);if(d.mod.isZero())return d.div;var x=d.div.negative!==0?d.mod.isub(u):d.mod,P=u.ushrn(1),M=u.andln(1),F=x.cmp(P);return F<0||M===1&&F===0?d.div:d.div.negative!==0?d.div.isubn(1):d.div.iaddn(1)},i.prototype.modrn=function(u){var d=u<0;d&&(u=-u),n(u<=67108863);for(var x=(1<<26)%u,P=0,M=this.length-1;M>=0;M--)P=(x*P+(this.words[M]|0))%u;return d?-P:P},i.prototype.modn=function(u){return this.modrn(u)},i.prototype.idivn=function(u){var d=u<0;d&&(u=-u),n(u<=67108863);for(var x=0,P=this.length-1;P>=0;P--){var M=(this.words[P]|0)+x*67108864;this.words[P]=M/u|0,x=M%u}return this._strip(),d?this.ineg():this},i.prototype.divn=function(u){return this.clone().idivn(u)},i.prototype.egcd=function(u){n(u.negative===0),n(!u.isZero());var d=this,x=u.clone();d.negative!==0?d=d.umod(u):d=d.clone();for(var P=new i(1),M=new i(0),F=new i(0),j=new i(1),D=0;d.isEven()&&x.isEven();)d.iushrn(1),x.iushrn(1),++D;for(var f=x.clone(),p=d.clone();!d.isZero();){for(var R=0,U=1;(d.words[0]&U)===0&&R<26;++R,U<<=1);if(R>0)for(d.iushrn(R);R-- >0;)(P.isOdd()||M.isOdd())&&(P.iadd(f),M.isub(p)),P.iushrn(1),M.iushrn(1);for(var X=0,fe=1;(x.words[0]&fe)===0&&X<26;++X,fe<<=1);if(X>0)for(x.iushrn(X);X-- >0;)(F.isOdd()||j.isOdd())&&(F.iadd(f),j.isub(p)),F.iushrn(1),j.iushrn(1);d.cmp(x)>=0?(d.isub(x),P.isub(F),M.isub(j)):(x.isub(d),F.isub(P),j.isub(M))}return{a:F,b:j,gcd:x.iushln(D)}},i.prototype._invmp=function(u){n(u.negative===0),n(!u.isZero());var d=this,x=u.clone();d.negative!==0?d=d.umod(u):d=d.clone();for(var P=new i(1),M=new i(0),F=x.clone();d.cmpn(1)>0&&x.cmpn(1)>0;){for(var j=0,D=1;(d.words[0]&D)===0&&j<26;++j,D<<=1);if(j>0)for(d.iushrn(j);j-- >0;)P.isOdd()&&P.iadd(F),P.iushrn(1);for(var f=0,p=1;(x.words[0]&p)===0&&f<26;++f,p<<=1);if(f>0)for(x.iushrn(f);f-- >0;)M.isOdd()&&M.iadd(F),M.iushrn(1);d.cmp(x)>=0?(d.isub(x),P.isub(M)):(x.isub(d),M.isub(P))}var R;return d.cmpn(1)===0?R=P:R=M,R.cmpn(0)<0&&R.iadd(u),R},i.prototype.gcd=function(u){if(this.isZero())return u.abs();if(u.isZero())return this.abs();var d=this.clone(),x=u.clone();d.negative=0,x.negative=0;for(var P=0;d.isEven()&&x.isEven();P++)d.iushrn(1),x.iushrn(1);do{for(;d.isEven();)d.iushrn(1);for(;x.isEven();)x.iushrn(1);var M=d.cmp(x);if(M<0){var F=d;d=x,x=F}else if(M===0||x.cmpn(1)===0)break;d.isub(x)}while(!0);return x.iushln(P)},i.prototype.invm=function(u){return this.egcd(u).a.umod(u)},i.prototype.isEven=function(){return(this.words[0]&1)===0},i.prototype.isOdd=function(){return(this.words[0]&1)===1},i.prototype.andln=function(u){return this.words[0]&u},i.prototype.bincn=function(u){n(typeof u=="number");var d=u%26,x=(u-d)/26,P=1<<d;if(this.length<=x)return this._expand(x+1),this.words[x]|=P,this;for(var M=P,F=x;M!==0&&F<this.length;F++){var j=this.words[F]|0;j+=M,M=j>>>26,j&=67108863,this.words[F]=j}return M!==0&&(this.words[F]=M,this.length++),this},i.prototype.isZero=function(){return this.length===1&&this.words[0]===0},i.prototype.cmpn=function(u){var d=u<0;if(this.negative!==0&&!d)return-1;if(this.negative===0&&d)return 1;this._strip();var x;if(this.length>1)x=1;else{d&&(u=-u),n(u<=67108863,"Number is too big");var P=this.words[0]|0;x=P===u?0:P<u?-1:1}return this.negative!==0?-x|0:x},i.prototype.cmp=function(u){if(this.negative!==0&&u.negative===0)return-1;if(this.negative===0&&u.negative!==0)return 1;var d=this.ucmp(u);return this.negative!==0?-d|0:d},i.prototype.ucmp=function(u){if(this.length>u.length)return 1;if(this.length<u.length)return-1;for(var d=0,x=this.length-1;x>=0;x--){var P=this.words[x]|0,M=u.words[x]|0;if(P!==M){P<M?d=-1:P>M&&(d=1);break}}return d},i.prototype.gtn=function(u){return this.cmpn(u)===1},i.prototype.gt=function(u){return this.cmp(u)===1},i.prototype.gten=function(u){return this.cmpn(u)>=0},i.prototype.gte=function(u){return this.cmp(u)>=0},i.prototype.ltn=function(u){return this.cmpn(u)===-1},i.prototype.lt=function(u){return this.cmp(u)===-1},i.prototype.lten=function(u){return this.cmpn(u)<=0},i.prototype.lte=function(u){return this.cmp(u)<=0},i.prototype.eqn=function(u){return this.cmpn(u)===0},i.prototype.eq=function(u){return this.cmp(u)===0},i.red=function(u){return new Y(u)},i.prototype.toRed=function(u){return n(!this.red,"Already a number in reduction context"),n(this.negative===0,"red works only with positives"),u.convertTo(this)._forceRed(u)},i.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(u){return this.red=u,this},i.prototype.forceRed=function(u){return n(!this.red,"Already a number in reduction context"),this._forceRed(u)},i.prototype.redAdd=function(u){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,u)},i.prototype.redIAdd=function(u){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,u)},i.prototype.redSub=function(u){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,u)},i.prototype.redISub=function(u){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,u)},i.prototype.redShl=function(u){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,u)},i.prototype.redMul=function(u){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,u),this.red.mul(this,u)},i.prototype.redIMul=function(u){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,u),this.red.imul(this,u)},i.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(u){return n(this.red&&!u.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,u)};var q={k256:null,p224:null,p192:null,p25519:null};function J(A,u){this.name=A,this.p=new i(u,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}J.prototype._tmp=function(){var u=new i(null);return u.words=new Array(Math.ceil(this.n/13)),u},J.prototype.ireduce=function(u){var d=u,x;do this.split(d,this.tmp),d=this.imulK(d),d=d.iadd(this.tmp),x=d.bitLength();while(x>this.n);var P=x<this.n?-1:d.ucmp(this.p);return P===0?(d.words[0]=0,d.length=1):P>0?d.isub(this.p):d.strip!==void 0?d.strip():d._strip(),d},J.prototype.split=function(u,d){u.iushrn(this.n,0,d)},J.prototype.imulK=function(u){return u.imul(this.k)};function se(){J.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}s(se,J),se.prototype.split=function(u,d){for(var x=4194303,P=Math.min(u.length,9),M=0;M<P;M++)d.words[M]=u.words[M];if(d.length=P,u.length<=9){u.words[0]=0,u.length=1;return}var F=u.words[9];for(d.words[d.length++]=F&x,M=10;M<u.length;M++){var j=u.words[M]|0;u.words[M-10]=(j&x)<<4|F>>>22,F=j}F>>>=22,u.words[M-10]=F,F===0&&u.length>10?u.length-=10:u.length-=9},se.prototype.imulK=function(u){u.words[u.length]=0,u.words[u.length+1]=0,u.length+=2;for(var d=0,x=0;x<u.length;x++){var P=u.words[x]|0;d+=P*977,u.words[x]=d&67108863,d=P*64+(d/67108864|0)}return u.words[u.length-1]===0&&(u.length--,u.words[u.length-1]===0&&u.length--),u};function oe(){J.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}s(oe,J);function V(){J.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}s(V,J);function W(){J.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}s(W,J),W.prototype.imulK=function(u){for(var d=0,x=0;x<u.length;x++){var P=(u.words[x]|0)*19+d,M=P&67108863;P>>>=26,u.words[x]=M,d=P}return d!==0&&(u.words[u.length++]=d),u},i._prime=function(u){if(q[u])return q[u];var d;if(u==="k256")d=new se;else if(u==="p224")d=new oe;else if(u==="p192")d=new V;else if(u==="p25519")d=new W;else throw new Error("Unknown prime "+u);return q[u]=d,d};function Y(A){if(typeof A=="string"){var u=i._prime(A);this.m=u.p,this.prime=u}else n(A.gtn(1),"modulus must be greater than 1"),this.m=A,this.prime=null}Y.prototype._verify1=function(u){n(u.negative===0,"red works only with positives"),n(u.red,"red works only with red numbers")},Y.prototype._verify2=function(u,d){n((u.negative|d.negative)===0,"red works only with positives"),n(u.red&&u.red===d.red,"red works only with red numbers")},Y.prototype.imod=function(u){return this.prime?this.prime.ireduce(u)._forceRed(this):(g(u,u.umod(this.m)._forceRed(this)),u)},Y.prototype.neg=function(u){return u.isZero()?u.clone():this.m.sub(u)._forceRed(this)},Y.prototype.add=function(u,d){this._verify2(u,d);var x=u.add(d);return x.cmp(this.m)>=0&&x.isub(this.m),x._forceRed(this)},Y.prototype.iadd=function(u,d){this._verify2(u,d);var x=u.iadd(d);return x.cmp(this.m)>=0&&x.isub(this.m),x},Y.prototype.sub=function(u,d){this._verify2(u,d);var x=u.sub(d);return x.cmpn(0)<0&&x.iadd(this.m),x._forceRed(this)},Y.prototype.isub=function(u,d){this._verify2(u,d);var x=u.isub(d);return x.cmpn(0)<0&&x.iadd(this.m),x},Y.prototype.shl=function(u,d){return this._verify1(u),this.imod(u.ushln(d))},Y.prototype.imul=function(u,d){return this._verify2(u,d),this.imod(u.imul(d))},Y.prototype.mul=function(u,d){return this._verify2(u,d),this.imod(u.mul(d))},Y.prototype.isqr=function(u){return this.imul(u,u.clone())},Y.prototype.sqr=function(u){return this.mul(u,u)},Y.prototype.sqrt=function(u){if(u.isZero())return u.clone();var d=this.m.andln(3);if(n(d%2===1),d===3){var x=this.m.add(new i(1)).iushrn(2);return this.pow(u,x)}for(var P=this.m.subn(1),M=0;!P.isZero()&&P.andln(1)===0;)M++,P.iushrn(1);n(!P.isZero());var F=new i(1).toRed(this),j=F.redNeg(),D=this.m.subn(1).iushrn(1),f=this.m.bitLength();for(f=new i(2*f*f).toRed(this);this.pow(f,D).cmp(j)!==0;)f.redIAdd(j);for(var p=this.pow(f,P),R=this.pow(u,P.addn(1).iushrn(1)),U=this.pow(u,P),X=M;U.cmp(F)!==0;){for(var fe=U,Ee=0;fe.cmp(F)!==0;Ee++)fe=fe.redSqr();n(Ee<X);var _e=this.pow(p,new i(1).iushln(X-Ee-1));R=R.redMul(_e),p=_e.redSqr(),U=U.redMul(p),X=Ee}return R},Y.prototype.invm=function(u){var d=u._invmp(this.m);return d.negative!==0?(d.negative=0,this.imod(d).redNeg()):this.imod(d)},Y.prototype.pow=function(u,d){if(d.isZero())return new i(1).toRed(this);if(d.cmpn(1)===0)return u.clone();var x=4,P=new Array(1<<x);P[0]=new i(1).toRed(this),P[1]=u;for(var M=2;M<P.length;M++)P[M]=this.mul(P[M-1],u);var F=P[0],j=0,D=0,f=d.bitLength()%26;for(f===0&&(f=26),M=d.length-1;M>=0;M--){for(var p=d.words[M],R=f-1;R>=0;R--){var U=p>>R&1;if(F!==P[0]&&(F=this.sqr(F)),U===0&&j===0){D=0;continue}j<<=1,j|=U,D++,!(D!==x&&(M!==0||R!==0))&&(F=this.mul(F,P[j]),D=0,j=0)}f=26}return F},Y.prototype.convertTo=function(u){var d=u.umod(this.m);return d===u?d.clone():d},Y.prototype.convertFrom=function(u){var d=u.clone();return d.red=null,d},i.mont=function(u){return new te(u)};function te(A){Y.call(this,A),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}s(te,Y),te.prototype.convertTo=function(u){return this.imod(u.ushln(this.shift))},te.prototype.convertFrom=function(u){var d=this.imod(u.mul(this.rinv));return d.red=null,d},te.prototype.imul=function(u,d){if(u.isZero()||d.isZero())return u.words[0]=0,u.length=1,u;var x=u.imul(d),P=x.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),M=x.isub(P).iushrn(this.shift),F=M;return M.cmp(this.m)>=0?F=M.isub(this.m):M.cmpn(0)<0&&(F=M.iadd(this.m)),F._forceRed(this)},te.prototype.mul=function(u,d){if(u.isZero()||d.isZero())return new i(0)._forceRed(this);var x=u.mul(d),P=x.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),M=x.isub(P).iushrn(this.shift),F=M;return M.cmp(this.m)>=0?F=M.isub(this.m):M.cmpn(0)<0&&(F=M.iadd(this.m)),F._forceRed(this)},te.prototype.invm=function(u){var d=this.imod(u._invmp(this.m).mul(this.r2));return d._forceRed(this)}})(t,GE)})(ua)),ua.exports}var JE=Ep();const ih=ja(JE);var ta={exports:{}};var oh;function ZE(){return oh||(oh=1,(function(t,e){var r=iu(),n=r.Buffer;function s(o,a){for(var c in o)a[c]=o[c]}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?t.exports=r:(s(r,e),e.Buffer=i);function i(o,a,c){return n(o,a,c)}i.prototype=Object.create(n.prototype),s(n,i),i.from=function(o,a,c){if(typeof o=="number")throw new TypeError("Argument must not be a number");return n(o,a,c)},i.alloc=function(o,a,c){if(typeof o!="number")throw new TypeError("Argument must be a number");var l=n(o);return a!==void 0?typeof c=="string"?l.fill(a,c):l.fill(a):l.fill(0),l},i.allocUnsafe=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return n(o)},i.allocUnsafeSlow=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(o)}})(ta,ta.exports)),ta.exports}var Nc,ah;function YE(){if(ah)return Nc;ah=1;var t=ZE().Buffer;function e(r){if(r.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),s=0;s<n.length;s++)n[s]=255;for(var i=0;i<r.length;i++){var o=r.charAt(i),a=o.charCodeAt(0);if(n[a]!==255)throw new TypeError(o+" is ambiguous");n[a]=i}var c=r.length,l=r.charAt(0),g=Math.log(c)/Math.log(256),m=Math.log(256)/Math.log(c);function I(v){if((Array.isArray(v)||v instanceof Uint8Array)&&(v=t.from(v)),!t.isBuffer(v))throw new TypeError("Expected Buffer");if(v.length===0)return"";for(var S=0,O=0,$=0,k=v.length;$!==k&&v[$]===0;)$++,S++;for(var Z=(k-$)*m+1>>>0,q=new Uint8Array(Z);$!==k;){for(var J=v[$],se=0,oe=Z-1;(J!==0||se<O)&&oe!==-1;oe--,se++)J+=256*q[oe]>>>0,q[oe]=J%c>>>0,J=J/c>>>0;if(J!==0)throw new Error("Non-zero carry");O=se,$++}for(var V=Z-O;V!==Z&&q[V]===0;)V++;for(var W=l.repeat(S);V<Z;++V)W+=r.charAt(q[V]);return W}function _(v){if(typeof v!="string")throw new TypeError("Expected String");if(v.length===0)return t.alloc(0);for(var S=0,O=0,$=0;v[S]===l;)O++,S++;for(var k=(v.length-S)*g+1>>>0,Z=new Uint8Array(k);S<v.length;){var q=v.charCodeAt(S);if(q>255)return;var J=n[q];if(J===255)return;for(var se=0,oe=k-1;(J!==0||se<$)&&oe!==-1;oe--,se++)J+=c*Z[oe]>>>0,Z[oe]=J%256>>>0,J=J/256>>>0;if(J!==0)throw new Error("Non-zero carry");$=se,S++}for(var V=k-$;V!==k&&Z[V]===0;)V++;var W=t.allocUnsafe(O+(k-V));W.fill(0,0,O);for(var Y=O;V!==k;)W[Y++]=Z[V++];return W}function b(v){var S=_(v);if(S)return S;throw new Error("Non-base"+c+" character")}return{encode:I,decodeUnsafe:_,decode:b}}return Nc=e,Nc}var Oc,ch;function xp(){if(ch)return Oc;ch=1;var t=YE(),e="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";return Oc=t(e),Oc}var XE=xp();const Er=ja(XE),lh=ep;var At={};function $n(t,e,r){return e<=t&&t<=r}function rc(t){if(t===void 0)return{};if(t===Object(t))return t;throw TypeError("Could not convert argument to dictionary")}function QE(t){for(var e=String(t),r=e.length,n=0,s=[];n<r;){var i=e.charCodeAt(n);if(i<55296||i>57343)s.push(i);else if(56320<=i&&i<=57343)s.push(65533);else if(55296<=i&&i<=56319)if(n===r-1)s.push(65533);else{var o=t.charCodeAt(n+1);if(56320<=o&&o<=57343){var a=i&1023,c=o&1023;s.push(65536+(a<<10)+c),n+=1}else s.push(65533)}n+=1}return s}function ex(t){for(var e="",r=0;r<t.length;++r){var n=t[r];n<=65535?e+=String.fromCharCode(n):(n-=65536,e+=String.fromCharCode((n>>10)+55296,(n&1023)+56320))}return e}var Sa=-1;function _u(t){this.tokens=[].slice.call(t)}_u.prototype={endOfStream:function(){return!this.tokens.length},read:function(){return this.tokens.length?this.tokens.shift():Sa},prepend:function(t){if(Array.isArray(t))for(var e=t;e.length;)this.tokens.unshift(e.pop());else this.tokens.unshift(t)},push:function(t){if(Array.isArray(t))for(var e=t;e.length;)this.tokens.push(e.shift());else this.tokens.push(t)}};var Li=-1;function Mc(t,e){if(t)throw TypeError("Decoder error");return e||65533}var Aa="utf-8";function Ra(t,e){if(!(this instanceof Ra))return new Ra(t,e);if(t=t!==void 0?String(t).toLowerCase():Aa,t!==Aa)throw new Error("Encoding not supported. Only utf-8 is supported");e=rc(e),this._streaming=!1,this._BOMseen=!1,this._decoder=null,this._fatal=!!e.fatal,this._ignoreBOM=!!e.ignoreBOM,Object.defineProperty(this,"encoding",{value:"utf-8"}),Object.defineProperty(this,"fatal",{value:this._fatal}),Object.defineProperty(this,"ignoreBOM",{value:this._ignoreBOM})}Ra.prototype={decode:function(e,r){var n;typeof e=="object"&&e instanceof ArrayBuffer?n=new Uint8Array(e):typeof e=="object"&&"buffer"in e&&e.buffer instanceof ArrayBuffer?n=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):n=new Uint8Array(0),r=rc(r),this._streaming||(this._decoder=new tx({fatal:this._fatal}),this._BOMseen=!1),this._streaming=!!r.stream;for(var s=new _u(n),i=[],o;!s.endOfStream()&&(o=this._decoder.handler(s,s.read()),o!==Li);)o!==null&&(Array.isArray(o)?i.push.apply(i,o):i.push(o));if(!this._streaming){do{if(o=this._decoder.handler(s,s.read()),o===Li)break;o!==null&&(Array.isArray(o)?i.push.apply(i,o):i.push(o))}while(!s.endOfStream());this._decoder=null}return i.length&&["utf-8"].indexOf(this.encoding)!==-1&&!this._ignoreBOM&&!this._BOMseen&&(i[0]===65279?(this._BOMseen=!0,i.shift()):this._BOMseen=!0),ex(i)}};function Ba(t,e){if(!(this instanceof Ba))return new Ba(t,e);if(t=t!==void 0?String(t).toLowerCase():Aa,t!==Aa)throw new Error("Encoding not supported. Only utf-8 is supported");e=rc(e),this._streaming=!1,this._encoder=null,this._options={fatal:!!e.fatal},Object.defineProperty(this,"encoding",{value:"utf-8"})}Ba.prototype={encode:function(e,r){e=e?String(e):"",r=rc(r),this._streaming||(this._encoder=new rx(this._options)),this._streaming=!!r.stream;for(var n=[],s=new _u(QE(e)),i;!s.endOfStream()&&(i=this._encoder.handler(s,s.read()),i!==Li);)Array.isArray(i)?n.push.apply(n,i):n.push(i);if(!this._streaming){for(;i=this._encoder.handler(s,s.read()),i!==Li;)Array.isArray(i)?n.push.apply(n,i):n.push(i);this._encoder=null}return new Uint8Array(n)}};function tx(t){var e=t.fatal,r=0,n=0,s=0,i=128,o=191;this.handler=function(a,c){if(c===Sa&&s!==0)return s=0,Mc(e);if(c===Sa)return Li;if(s===0){if($n(c,0,127))return c;if($n(c,194,223))s=1,r=c-192;else if($n(c,224,239))c===224&&(i=160),c===237&&(o=159),s=2,r=c-224;else if($n(c,240,244))c===240&&(i=144),c===244&&(o=143),s=3,r=c-240;else return Mc(e);return r=r<<6*s,null}if(!$n(c,i,o))return r=s=n=0,i=128,o=191,a.prepend(c),Mc(e);if(i=128,o=191,n+=1,r+=c-128<<6*(s-n),n!==s)return null;var l=r;return r=s=n=0,l}}function rx(t){t.fatal,this.handler=function(e,r){if(r===Sa)return Li;if($n(r,0,127))return r;var n,s;$n(r,128,2047)?(n=1,s=192):$n(r,2048,65535)?(n=2,s=224):$n(r,65536,1114111)&&(n=3,s=240);for(var i=[(r>>6*n)+s];n>0;){var o=r>>6*(n-1);i.push(128|o&63),n-=1}return i}}const nx=Object.freeze(Object.defineProperty({__proto__:null,TextDecoder:Ra,TextEncoder:Ba},Symbol.toStringTag,{value:"Module"})),sx=su(nx);var uh;function ix(){if(uh)return At;uh=1;var t=At&&At.__createBinding||(Object.create?(function(V,W,Y,te){te===void 0&&(te=Y),Object.defineProperty(V,te,{enumerable:!0,get:function(){return W[Y]}})}):(function(V,W,Y,te){te===void 0&&(te=Y),V[te]=W[Y]})),e=At&&At.__setModuleDefault||(Object.create?(function(V,W){Object.defineProperty(V,"default",{enumerable:!0,value:W})}):function(V,W){V.default=W}),r=At&&At.__decorate||function(V,W,Y,te){var A=arguments.length,u=A<3?W:te===null?te=Object.getOwnPropertyDescriptor(W,Y):te,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(V,W,Y,te);else for(var x=V.length-1;x>=0;x--)(d=V[x])&&(u=(A<3?d(u):A>3?d(W,Y,u):d(W,Y))||u);return A>3&&u&&Object.defineProperty(W,Y,u),u},n=At&&At.__importStar||function(V){if(V&&V.__esModule)return V;var W={};if(V!=null)for(var Y in V)Y!=="default"&&Object.hasOwnProperty.call(V,Y)&&t(W,V,Y);return e(W,V),W},s=At&&At.__importDefault||function(V){return V&&V.__esModule?V:{default:V}};Object.defineProperty(At,"__esModule",{value:!0}),At.deserializeUnchecked=At.deserialize=At.serialize=At.BinaryReader=At.BinaryWriter=At.BorshError=At.baseDecode=At.baseEncode=void 0;const i=s(Ep()),o=s(xp()),a=n(sx),c=typeof TextDecoder!="function"?a.TextDecoder:TextDecoder,l=new c("utf-8",{fatal:!0});function g(V){return typeof V=="string"&&(V=Buffer.from(V,"utf8")),o.default.encode(Buffer.from(V))}At.baseEncode=g;function m(V){return Buffer.from(o.default.decode(V))}At.baseDecode=m;const I=1024;class _ extends Error{constructor(W){super(W),this.fieldPath=[],this.originalMessage=W}addToFieldPath(W){this.fieldPath.splice(0,0,W),this.message=this.originalMessage+": "+this.fieldPath.join(".")}}At.BorshError=_;class b{constructor(){this.buf=Buffer.alloc(I),this.length=0}maybeResize(){this.buf.length<16+this.length&&(this.buf=Buffer.concat([this.buf,Buffer.alloc(I)]))}writeU8(W){this.maybeResize(),this.buf.writeUInt8(W,this.length),this.length+=1}writeU16(W){this.maybeResize(),this.buf.writeUInt16LE(W,this.length),this.length+=2}writeU32(W){this.maybeResize(),this.buf.writeUInt32LE(W,this.length),this.length+=4}writeU64(W){this.maybeResize(),this.writeBuffer(Buffer.from(new i.default(W).toArray("le",8)))}writeU128(W){this.maybeResize(),this.writeBuffer(Buffer.from(new i.default(W).toArray("le",16)))}writeU256(W){this.maybeResize(),this.writeBuffer(Buffer.from(new i.default(W).toArray("le",32)))}writeU512(W){this.maybeResize(),this.writeBuffer(Buffer.from(new i.default(W).toArray("le",64)))}writeBuffer(W){this.buf=Buffer.concat([Buffer.from(this.buf.subarray(0,this.length)),W,Buffer.alloc(I)]),this.length+=W.length}writeString(W){this.maybeResize();const Y=Buffer.from(W,"utf8");this.writeU32(Y.length),this.writeBuffer(Y)}writeFixedArray(W){this.writeBuffer(Buffer.from(W))}writeArray(W,Y){this.maybeResize(),this.writeU32(W.length);for(const te of W)this.maybeResize(),Y(te)}toArray(){return this.buf.subarray(0,this.length)}}At.BinaryWriter=b;function v(V,W,Y){const te=Y.value;Y.value=function(...A){try{return te.apply(this,A)}catch(u){if(u instanceof RangeError){const d=u.code;if(["ERR_BUFFER_OUT_OF_BOUNDS","ERR_OUT_OF_RANGE"].indexOf(d)>=0)throw new _("Reached the end of buffer when deserializing")}throw u}}}class S{constructor(W){this.buf=W,this.offset=0}readU8(){const W=this.buf.readUInt8(this.offset);return this.offset+=1,W}readU16(){const W=this.buf.readUInt16LE(this.offset);return this.offset+=2,W}readU32(){const W=this.buf.readUInt32LE(this.offset);return this.offset+=4,W}readU64(){const W=this.readBuffer(8);return new i.default(W,"le")}readU128(){const W=this.readBuffer(16);return new i.default(W,"le")}readU256(){const W=this.readBuffer(32);return new i.default(W,"le")}readU512(){const W=this.readBuffer(64);return new i.default(W,"le")}readBuffer(W){if(this.offset+W>this.buf.length)throw new _(`Expected buffer length ${W} isn't within bounds`);const Y=this.buf.slice(this.offset,this.offset+W);return this.offset+=W,Y}readString(){const W=this.readU32(),Y=this.readBuffer(W);try{return l.decode(Y)}catch(te){throw new _(`Error decoding UTF-8 string: ${te}`)}}readFixedArray(W){return new Uint8Array(this.readBuffer(W))}readArray(W){const Y=this.readU32(),te=Array();for(let A=0;A<Y;++A)te.push(W());return te}}r([v],S.prototype,"readU8",null),r([v],S.prototype,"readU16",null),r([v],S.prototype,"readU32",null),r([v],S.prototype,"readU64",null),r([v],S.prototype,"readU128",null),r([v],S.prototype,"readU256",null),r([v],S.prototype,"readU512",null),r([v],S.prototype,"readString",null),r([v],S.prototype,"readFixedArray",null),r([v],S.prototype,"readArray",null),At.BinaryReader=S;function O(V){return V.charAt(0).toUpperCase()+V.slice(1)}function $(V,W,Y,te,A){try{if(typeof te=="string")A[`write${O(te)}`](Y);else if(te instanceof Array)if(typeof te[0]=="number"){if(Y.length!==te[0])throw new _(`Expecting byte array of length ${te[0]}, but got ${Y.length} bytes`);A.writeFixedArray(Y)}else if(te.length===2&&typeof te[1]=="number"){if(Y.length!==te[1])throw new _(`Expecting byte array of length ${te[1]}, but got ${Y.length} bytes`);for(let u=0;u<te[1];u++)$(V,null,Y[u],te[0],A)}else A.writeArray(Y,u=>{$(V,W,u,te[0],A)});else if(te.kind!==void 0)switch(te.kind){case"option":{Y==null?A.writeU8(0):(A.writeU8(1),$(V,W,Y,te.type,A));break}case"map":{A.writeU32(Y.size),Y.forEach((u,d)=>{$(V,W,d,te.key,A),$(V,W,u,te.value,A)});break}default:throw new _(`FieldType ${te} unrecognized`)}else k(V,Y,A)}catch(u){throw u instanceof _&&u.addToFieldPath(W),u}}function k(V,W,Y){if(typeof W.borshSerialize=="function"){W.borshSerialize(Y);return}const te=V.get(W.constructor);if(!te)throw new _(`Class ${W.constructor.name} is missing in schema`);if(te.kind==="struct")te.fields.map(([A,u])=>{$(V,A,W[A],u,Y)});else if(te.kind==="enum"){const A=W[te.field];for(let u=0;u<te.values.length;++u){const[d,x]=te.values[u];if(d===A){Y.writeU8(u),$(V,d,W[d],x,Y);break}}}else throw new _(`Unexpected schema kind: ${te.kind} for ${W.constructor.name}`)}function Z(V,W,Y=b){const te=new Y;return k(V,W,te),te.toArray()}At.serialize=Z;function q(V,W,Y,te){try{if(typeof Y=="string")return te[`read${O(Y)}`]();if(Y instanceof Array){if(typeof Y[0]=="number")return te.readFixedArray(Y[0]);if(typeof Y[1]=="number"){const A=[];for(let u=0;u<Y[1];u++)A.push(q(V,null,Y[0],te));return A}else return te.readArray(()=>q(V,W,Y[0],te))}if(Y.kind==="option")return te.readU8()?q(V,W,Y.type,te):void 0;if(Y.kind==="map"){let A=new Map;const u=te.readU32();for(let d=0;d<u;d++){const x=q(V,W,Y.key,te),P=q(V,W,Y.value,te);A.set(x,P)}return A}return J(V,Y,te)}catch(A){throw A instanceof _&&A.addToFieldPath(W),A}}function J(V,W,Y){if(typeof W.borshDeserialize=="function")return W.borshDeserialize(Y);const te=V.get(W);if(!te)throw new _(`Class ${W.name} is missing in schema`);if(te.kind==="struct"){const A={};for(const[u,d]of V.get(W).fields)A[u]=q(V,u,d,Y);return new W(A)}if(te.kind==="enum"){const A=Y.readU8();if(A>=te.values.length)throw new _(`Enum index: ${A} is out of range`);const[u,d]=te.values[A],x=q(V,u,d,Y);return new W({[u]:x})}throw new _(`Unexpected schema kind: ${te.kind} for ${W.constructor.name}`)}function se(V,W,Y,te=S){const A=new te(Y),u=J(V,W,A);if(A.offset<Y.length)throw new _(`Unexpected ${Y.length-A.offset} bytes after deserialized data`);return u}At.deserialize=se;function oe(V,W,Y,te=S){const A=new te(Y);return J(V,W,A)}return At.deserializeUnchecked=oe,At}var Uc=ix(),ae={},fh;function ox(){if(fh)return ae;fh=1,Object.defineProperty(ae,"__esModule",{value:!0}),ae.s16=ae.s8=ae.nu64be=ae.u48be=ae.u40be=ae.u32be=ae.u24be=ae.u16be=ae.nu64=ae.u48=ae.u40=ae.u32=ae.u24=ae.u16=ae.u8=ae.offset=ae.greedy=ae.Constant=ae.UTF8=ae.CString=ae.Blob=ae.Boolean=ae.BitField=ae.BitStructure=ae.VariantLayout=ae.Union=ae.UnionLayoutDiscriminator=ae.UnionDiscriminator=ae.Structure=ae.Sequence=ae.DoubleBE=ae.Double=ae.FloatBE=ae.Float=ae.NearInt64BE=ae.NearInt64=ae.NearUInt64BE=ae.NearUInt64=ae.IntBE=ae.Int=ae.UIntBE=ae.UInt=ae.OffsetLayout=ae.GreedyCount=ae.ExternalLayout=ae.bindConstructorLayout=ae.nameWithProperty=ae.Layout=ae.uint8ArrayToBuffer=ae.checkUint8Array=void 0,ae.constant=ae.utf8=ae.cstr=ae.blob=ae.unionLayoutDiscriminator=ae.union=ae.seq=ae.bits=ae.struct=ae.f64be=ae.f64=ae.f32be=ae.f32=ae.ns64be=ae.s48be=ae.s40be=ae.s32be=ae.s24be=ae.s16be=ae.ns64=ae.s48=ae.s40=ae.s32=ae.s24=void 0;const t=iu();function e(f){if(!(f instanceof Uint8Array))throw new TypeError("b must be a Uint8Array")}ae.checkUint8Array=e;function r(f){return e(f),t.Buffer.from(f.buffer,f.byteOffset,f.length)}ae.uint8ArrayToBuffer=r;let n=class{constructor(p,R){if(!Number.isInteger(p))throw new TypeError("span must be an integer");this.span=p,this.property=R}makeDestinationObject(){return{}}getSpan(p,R){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(p){const R=Object.create(this.constructor.prototype);return Object.assign(R,this),R.property=p,R}fromArray(p){}};ae.Layout=n;function s(f,p){return p.property?f+"["+p.property+"]":f}ae.nameWithProperty=s;function i(f,p){if(typeof f!="function")throw new TypeError("Class must be constructor");if(Object.prototype.hasOwnProperty.call(f,"layout_"))throw new Error("Class is already bound to a layout");if(!(p&&p instanceof n))throw new TypeError("layout must be a Layout");if(Object.prototype.hasOwnProperty.call(p,"boundConstructor_"))throw new Error("layout is already bound to a constructor");f.layout_=p,p.boundConstructor_=f,p.makeDestinationObject=(()=>new f),Object.defineProperty(f.prototype,"encode",{value(R,U){return p.encode(this,R,U)},writable:!0}),Object.defineProperty(f,"decode",{value(R,U){return p.decode(R,U)},writable:!0})}ae.bindConstructorLayout=i;class o extends n{isCount(){throw new Error("ExternalLayout is abstract")}}ae.ExternalLayout=o;class a extends o{constructor(p=1,R){if(!Number.isInteger(p)||0>=p)throw new TypeError("elementSpan must be a (positive) integer");super(-1,R),this.elementSpan=p}isCount(){return!0}decode(p,R=0){e(p);const U=p.length-R;return Math.floor(U/this.elementSpan)}encode(p,R,U){return 0}}ae.GreedyCount=a;class c extends o{constructor(p,R=0,U){if(!(p instanceof n))throw new TypeError("layout must be a Layout");if(!Number.isInteger(R))throw new TypeError("offset must be integer or undefined");super(p.span,U||p.property),this.layout=p,this.offset=R}isCount(){return this.layout instanceof l||this.layout instanceof g}decode(p,R=0){return this.layout.decode(p,R+this.offset)}encode(p,R,U=0){return this.layout.encode(p,R,U+this.offset)}}ae.OffsetLayout=c;class l extends n{constructor(p,R){if(super(p,R),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(p,R=0){return r(p).readUIntLE(R,this.span)}encode(p,R,U=0){return r(R).writeUIntLE(p,U,this.span),this.span}}ae.UInt=l;class g extends n{constructor(p,R){if(super(p,R),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(p,R=0){return r(p).readUIntBE(R,this.span)}encode(p,R,U=0){return r(R).writeUIntBE(p,U,this.span),this.span}}ae.UIntBE=g;class m extends n{constructor(p,R){if(super(p,R),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(p,R=0){return r(p).readIntLE(R,this.span)}encode(p,R,U=0){return r(R).writeIntLE(p,U,this.span),this.span}}ae.Int=m;class I extends n{constructor(p,R){if(super(p,R),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(p,R=0){return r(p).readIntBE(R,this.span)}encode(p,R,U=0){return r(R).writeIntBE(p,U,this.span),this.span}}ae.IntBE=I;const _=Math.pow(2,32);function b(f){const p=Math.floor(f/_),R=f-p*_;return{hi32:p,lo32:R}}function v(f,p){return f*_+p}class S extends n{constructor(p){super(8,p)}decode(p,R=0){const U=r(p),X=U.readUInt32LE(R),fe=U.readUInt32LE(R+4);return v(fe,X)}encode(p,R,U=0){const X=b(p),fe=r(R);return fe.writeUInt32LE(X.lo32,U),fe.writeUInt32LE(X.hi32,U+4),8}}ae.NearUInt64=S;class O extends n{constructor(p){super(8,p)}decode(p,R=0){const U=r(p),X=U.readUInt32BE(R),fe=U.readUInt32BE(R+4);return v(X,fe)}encode(p,R,U=0){const X=b(p),fe=r(R);return fe.writeUInt32BE(X.hi32,U),fe.writeUInt32BE(X.lo32,U+4),8}}ae.NearUInt64BE=O;class $ extends n{constructor(p){super(8,p)}decode(p,R=0){const U=r(p),X=U.readUInt32LE(R),fe=U.readInt32LE(R+4);return v(fe,X)}encode(p,R,U=0){const X=b(p),fe=r(R);return fe.writeUInt32LE(X.lo32,U),fe.writeInt32LE(X.hi32,U+4),8}}ae.NearInt64=$;class k extends n{constructor(p){super(8,p)}decode(p,R=0){const U=r(p),X=U.readInt32BE(R),fe=U.readUInt32BE(R+4);return v(X,fe)}encode(p,R,U=0){const X=b(p),fe=r(R);return fe.writeInt32BE(X.hi32,U),fe.writeUInt32BE(X.lo32,U+4),8}}ae.NearInt64BE=k;class Z extends n{constructor(p){super(4,p)}decode(p,R=0){return r(p).readFloatLE(R)}encode(p,R,U=0){return r(R).writeFloatLE(p,U),4}}ae.Float=Z;class q extends n{constructor(p){super(4,p)}decode(p,R=0){return r(p).readFloatBE(R)}encode(p,R,U=0){return r(R).writeFloatBE(p,U),4}}ae.FloatBE=q;class J extends n{constructor(p){super(8,p)}decode(p,R=0){return r(p).readDoubleLE(R)}encode(p,R,U=0){return r(R).writeDoubleLE(p,U),8}}ae.Double=J;class se extends n{constructor(p){super(8,p)}decode(p,R=0){return r(p).readDoubleBE(R)}encode(p,R,U=0){return r(R).writeDoubleBE(p,U),8}}ae.DoubleBE=se;class oe extends n{constructor(p,R,U){if(!(p instanceof n))throw new TypeError("elementLayout must be a Layout");if(!(R instanceof o&&R.isCount()||Number.isInteger(R)&&0<=R))throw new TypeError("count must be non-negative integer or an unsigned integer ExternalLayout");let X=-1;!(R instanceof o)&&0<p.span&&(X=R*p.span),super(X,U),this.elementLayout=p,this.count=R}getSpan(p,R=0){if(0<=this.span)return this.span;let U=0,X=this.count;if(X instanceof o&&(X=X.decode(p,R)),0<this.elementLayout.span)U=X*this.elementLayout.span;else{let fe=0;for(;fe<X;)U+=this.elementLayout.getSpan(p,R+U),++fe}return U}decode(p,R=0){const U=[];let X=0,fe=this.count;for(fe instanceof o&&(fe=fe.decode(p,R));X<fe;)U.push(this.elementLayout.decode(p,R)),R+=this.elementLayout.getSpan(p,R),X+=1;return U}encode(p,R,U=0){const X=this.elementLayout,fe=p.reduce((Ee,_e)=>Ee+X.encode(_e,R,U+Ee),0);return this.count instanceof o&&this.count.encode(p.length,R,U),fe}}ae.Sequence=oe;class V extends n{constructor(p,R,U){if(!(Array.isArray(p)&&p.reduce((fe,Ee)=>fe&&Ee instanceof n,!0)))throw new TypeError("fields must be array of Layout instances");typeof R=="boolean"&&U===void 0&&(U=R,R=void 0);for(const fe of p)if(0>fe.span&&fe.property===void 0)throw new Error("fields cannot contain unnamed variable-length layout");let X=-1;try{X=p.reduce((fe,Ee)=>fe+Ee.getSpan(),0)}catch{}super(X,R),this.fields=p,this.decodePrefixes=!!U}getSpan(p,R=0){if(0<=this.span)return this.span;let U=0;try{U=this.fields.reduce((X,fe)=>{const Ee=fe.getSpan(p,R);return R+=Ee,X+Ee},0)}catch{throw new RangeError("indeterminate span")}return U}decode(p,R=0){e(p);const U=this.makeDestinationObject();for(const X of this.fields)if(X.property!==void 0&&(U[X.property]=X.decode(p,R)),R+=X.getSpan(p,R),this.decodePrefixes&&p.length===R)break;return U}encode(p,R,U=0){const X=U;let fe=0,Ee=0;for(const _e of this.fields){let Xe=_e.span;if(Ee=0<Xe?Xe:0,_e.property!==void 0){const dt=p[_e.property];dt!==void 0&&(Ee=_e.encode(dt,R,U),0>Xe&&(Xe=_e.getSpan(R,U)))}fe=U,U+=Xe}return fe+Ee-X}fromArray(p){const R=this.makeDestinationObject();for(const U of this.fields)U.property!==void 0&&0<p.length&&(R[U.property]=p.shift());return R}layoutFor(p){if(typeof p!="string")throw new TypeError("property must be string");for(const R of this.fields)if(R.property===p)return R}offsetOf(p){if(typeof p!="string")throw new TypeError("property must be string");let R=0;for(const U of this.fields){if(U.property===p)return R;0>U.span?R=-1:0<=R&&(R+=U.span)}}}ae.Structure=V;class W{constructor(p){this.property=p}decode(p,R){throw new Error("UnionDiscriminator is abstract")}encode(p,R,U){throw new Error("UnionDiscriminator is abstract")}}ae.UnionDiscriminator=W;class Y extends W{constructor(p,R){if(!(p instanceof o&&p.isCount()))throw new TypeError("layout must be an unsigned integer ExternalLayout");super(R||p.property||"variant"),this.layout=p}decode(p,R){return this.layout.decode(p,R)}encode(p,R,U){return this.layout.encode(p,R,U)}}ae.UnionLayoutDiscriminator=Y;class te extends n{constructor(p,R,U){let X;if(p instanceof l||p instanceof g)X=new Y(new c(p));else if(p instanceof o&&p.isCount())X=new Y(p);else if(p instanceof W)X=p;else throw new TypeError("discr must be a UnionDiscriminator or an unsigned integer layout");if(R===void 0&&(R=null),!(R===null||R instanceof n))throw new TypeError("defaultLayout must be null or a Layout");if(R!==null){if(0>R.span)throw new Error("defaultLayout must have constant span");R.property===void 0&&(R=R.replicate("content"))}let fe=-1;R&&(fe=R.span,0<=fe&&(p instanceof l||p instanceof g)&&(fe+=X.layout.span)),super(fe,U),this.discriminator=X,this.usesPrefixDiscriminator=p instanceof l||p instanceof g,this.defaultLayout=R,this.registry={};let Ee=this.defaultGetSourceVariant.bind(this);this.getSourceVariant=function(_e){return Ee(_e)},this.configGetSourceVariant=function(_e){Ee=_e.bind(this)}}getSpan(p,R=0){if(0<=this.span)return this.span;const U=this.getVariant(p,R);if(!U)throw new Error("unable to determine span for unrecognized variant");return U.getSpan(p,R)}defaultGetSourceVariant(p){if(Object.prototype.hasOwnProperty.call(p,this.discriminator.property)){if(this.defaultLayout&&this.defaultLayout.property&&Object.prototype.hasOwnProperty.call(p,this.defaultLayout.property))return;const R=this.registry[p[this.discriminator.property]];if(R&&(!R.layout||R.property&&Object.prototype.hasOwnProperty.call(p,R.property)))return R}else for(const R in this.registry){const U=this.registry[R];if(U.property&&Object.prototype.hasOwnProperty.call(p,U.property))return U}throw new Error("unable to infer src variant")}decode(p,R=0){let U;const X=this.discriminator,fe=X.decode(p,R),Ee=this.registry[fe];if(Ee===void 0){const _e=this.defaultLayout;let Xe=0;this.usesPrefixDiscriminator&&(Xe=X.layout.span),U=this.makeDestinationObject(),U[X.property]=fe,U[_e.property]=_e.decode(p,R+Xe)}else U=Ee.decode(p,R);return U}encode(p,R,U=0){const X=this.getSourceVariant(p);if(X===void 0){const fe=this.discriminator,Ee=this.defaultLayout;let _e=0;return this.usesPrefixDiscriminator&&(_e=fe.layout.span),fe.encode(p[fe.property],R,U),_e+Ee.encode(p[Ee.property],R,U+_e)}return X.encode(p,R,U)}addVariant(p,R,U){const X=new A(this,p,R,U);return this.registry[p]=X,X}getVariant(p,R=0){let U;return p instanceof Uint8Array?U=this.discriminator.decode(p,R):U=p,this.registry[U]}}ae.Union=te;class A extends n{constructor(p,R,U,X){if(!(p instanceof te))throw new TypeError("union must be a Union");if(!Number.isInteger(R)||0>R)throw new TypeError("variant must be a (non-negative) integer");if(typeof U=="string"&&X===void 0&&(X=U,U=null),U){if(!(U instanceof n))throw new TypeError("layout must be a Layout");if(p.defaultLayout!==null&&0<=U.span&&U.span>p.defaultLayout.span)throw new Error("variant span exceeds span of containing union");if(typeof X!="string")throw new TypeError("variant must have a String property")}let fe=p.span;0>p.span&&(fe=U?U.span:0,0<=fe&&p.usesPrefixDiscriminator&&(fe+=p.discriminator.layout.span)),super(fe,X),this.union=p,this.variant=R,this.layout=U||null}getSpan(p,R=0){if(0<=this.span)return this.span;let U=0;this.union.usesPrefixDiscriminator&&(U=this.union.discriminator.layout.span);let X=0;return this.layout&&(X=this.layout.getSpan(p,R+U)),U+X}decode(p,R=0){const U=this.makeDestinationObject();if(this!==this.union.getVariant(p,R))throw new Error("variant mismatch");let X=0;return this.union.usesPrefixDiscriminator&&(X=this.union.discriminator.layout.span),this.layout?U[this.property]=this.layout.decode(p,R+X):this.property?U[this.property]=!0:this.union.usesPrefixDiscriminator&&(U[this.union.discriminator.property]=this.variant),U}encode(p,R,U=0){let X=0;if(this.union.usesPrefixDiscriminator&&(X=this.union.discriminator.layout.span),this.layout&&!Object.prototype.hasOwnProperty.call(p,this.property))throw new TypeError("variant lacks property "+this.property);this.union.discriminator.encode(this.variant,R,U);let fe=X;if(this.layout&&(this.layout.encode(p[this.property],R,U+X),fe+=this.layout.getSpan(R,U+X),0<=this.union.span&&fe>this.union.span))throw new Error("encoded variant overruns containing union");return fe}fromArray(p){if(this.layout)return this.layout.fromArray(p)}}ae.VariantLayout=A;function u(f){return 0>f&&(f+=4294967296),f}class d extends n{constructor(p,R,U){if(!(p instanceof l||p instanceof g))throw new TypeError("word must be a UInt or UIntBE layout");if(typeof R=="string"&&U===void 0&&(U=R,R=!1),4<p.span)throw new RangeError("word cannot exceed 32 bits");super(p.span,U),this.word=p,this.msb=!!R,this.fields=[];let X=0;this._packedSetValue=function(fe){return X=u(fe),this},this._packedGetValue=function(){return X}}decode(p,R=0){const U=this.makeDestinationObject(),X=this.word.decode(p,R);this._packedSetValue(X);for(const fe of this.fields)fe.property!==void 0&&(U[fe.property]=fe.decode(p));return U}encode(p,R,U=0){const X=this.word.decode(R,U);this._packedSetValue(X);for(const fe of this.fields)if(fe.property!==void 0){const Ee=p[fe.property];Ee!==void 0&&fe.encode(Ee)}return this.word.encode(this._packedGetValue(),R,U)}addField(p,R){const U=new x(this,p,R);return this.fields.push(U),U}addBoolean(p){const R=new P(this,p);return this.fields.push(R),R}fieldFor(p){if(typeof p!="string")throw new TypeError("property must be string");for(const R of this.fields)if(R.property===p)return R}}ae.BitStructure=d;class x{constructor(p,R,U){if(!(p instanceof d))throw new TypeError("container must be a BitStructure");if(!Number.isInteger(R)||0>=R)throw new TypeError("bits must be positive integer");const X=8*p.span,fe=p.fields.reduce((Ee,_e)=>Ee+_e.bits,0);if(R+fe>X)throw new Error("bits too long for span remainder ("+(X-fe)+" of "+X+" remain)");this.container=p,this.bits=R,this.valueMask=(1<<R)-1,R===32&&(this.valueMask=4294967295),this.start=fe,this.container.msb&&(this.start=X-fe-R),this.wordMask=u(this.valueMask<<this.start),this.property=U}decode(p,R){const U=this.container._packedGetValue();return u(U&this.wordMask)>>>this.start}encode(p){if(typeof p!="number"||!Number.isInteger(p)||p!==u(p&this.valueMask))throw new TypeError(s("BitField.encode",this)+" value must be integer not exceeding "+this.valueMask);const R=this.container._packedGetValue(),U=u(p<<this.start);this.container._packedSetValue(u(R&~this.wordMask)|U)}}ae.BitField=x;class P extends x{constructor(p,R){super(p,1,R)}decode(p,R){return!!super.decode(p,R)}encode(p){typeof p=="boolean"&&(p=+p),super.encode(p)}}ae.Boolean=P;class M extends n{constructor(p,R){if(!(p instanceof o&&p.isCount()||Number.isInteger(p)&&0<=p))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let U=-1;p instanceof o||(U=p),super(U,R),this.length=p}getSpan(p,R){let U=this.span;return 0>U&&(U=this.length.decode(p,R)),U}decode(p,R=0){let U=this.span;return 0>U&&(U=this.length.decode(p,R)),r(p).slice(R,R+U)}encode(p,R,U){let X=this.length;if(this.length instanceof o&&(X=p.length),!(p instanceof Uint8Array&&X===p.length))throw new TypeError(s("Blob.encode",this)+" requires (length "+X+") Uint8Array as src");if(U+X>R.length)throw new RangeError("encoding overruns Uint8Array");const fe=r(p);return r(R).write(fe.toString("hex"),U,X,"hex"),this.length instanceof o&&this.length.encode(X,R,U),X}}ae.Blob=M;class F extends n{constructor(p){super(-1,p)}getSpan(p,R=0){e(p);let U=R;for(;U<p.length&&p[U]!==0;)U+=1;return 1+U-R}decode(p,R=0){const U=this.getSpan(p,R);return r(p).slice(R,R+U-1).toString("utf-8")}encode(p,R,U=0){typeof p!="string"&&(p=String(p));const X=t.Buffer.from(p,"utf8"),fe=X.length;if(U+fe>R.length)throw new RangeError("encoding overruns Buffer");const Ee=r(R);return X.copy(Ee,U),Ee[U+fe]=0,fe+1}}ae.CString=F;class j extends n{constructor(p,R){if(typeof p=="string"&&R===void 0&&(R=p,p=void 0),p===void 0)p=-1;else if(!Number.isInteger(p))throw new TypeError("maxSpan must be an integer");super(-1,R),this.maxSpan=p}getSpan(p,R=0){return e(p),p.length-R}decode(p,R=0){const U=this.getSpan(p,R);if(0<=this.maxSpan&&this.maxSpan<U)throw new RangeError("text length exceeds maxSpan");return r(p).slice(R,R+U).toString("utf-8")}encode(p,R,U=0){typeof p!="string"&&(p=String(p));const X=t.Buffer.from(p,"utf8"),fe=X.length;if(0<=this.maxSpan&&this.maxSpan<fe)throw new RangeError("text length exceeds maxSpan");if(U+fe>R.length)throw new RangeError("encoding overruns Buffer");return X.copy(r(R),U),fe}}ae.UTF8=j;class D extends n{constructor(p,R){super(0,R),this.value=p}decode(p,R){return this.value}encode(p,R,U){return 0}}return ae.Constant=D,ae.greedy=((f,p)=>new a(f,p)),ae.offset=((f,p,R)=>new c(f,p,R)),ae.u8=(f=>new l(1,f)),ae.u16=(f=>new l(2,f)),ae.u24=(f=>new l(3,f)),ae.u32=(f=>new l(4,f)),ae.u40=(f=>new l(5,f)),ae.u48=(f=>new l(6,f)),ae.nu64=(f=>new S(f)),ae.u16be=(f=>new g(2,f)),ae.u24be=(f=>new g(3,f)),ae.u32be=(f=>new g(4,f)),ae.u40be=(f=>new g(5,f)),ae.u48be=(f=>new g(6,f)),ae.nu64be=(f=>new O(f)),ae.s8=(f=>new m(1,f)),ae.s16=(f=>new m(2,f)),ae.s24=(f=>new m(3,f)),ae.s32=(f=>new m(4,f)),ae.s40=(f=>new m(5,f)),ae.s48=(f=>new m(6,f)),ae.ns64=(f=>new $(f)),ae.s16be=(f=>new I(2,f)),ae.s24be=(f=>new I(3,f)),ae.s32be=(f=>new I(4,f)),ae.s40be=(f=>new I(5,f)),ae.s48be=(f=>new I(6,f)),ae.ns64be=(f=>new k(f)),ae.f32=(f=>new Z(f)),ae.f32be=(f=>new q(f)),ae.f64=(f=>new J(f)),ae.f64be=(f=>new se(f)),ae.struct=((f,p,R)=>new V(f,p,R)),ae.bits=((f,p,R)=>new d(f,p,R)),ae.seq=((f,p,R)=>new oe(f,p,R)),ae.union=((f,p,R)=>new te(f,p,R)),ae.unionLayoutDiscriminator=((f,p)=>new Y(f,p)),ae.blob=((f,p)=>new M(f,p)),ae.cstr=(f=>new F(f)),ae.utf8=((f,p)=>new j(f,p)),ae.constant=((f,p)=>new D(f,p)),ae}var G=ox();class ax extends TypeError{constructor(e,r){let n;const{message:s,explanation:i,...o}=e,{path:a}=e,c=a.length===0?s:`At path: ${a.join(".")} -- ${s}`;super(i??c),i!=null&&(this.cause=c),Object.assign(this,o),this.name=this.constructor.name,this.failures=()=>n??(n=[e,...r()])}}function cx(t){return Lo(t)&&typeof t[Symbol.iterator]=="function"}function Lo(t){return typeof t=="object"&&t!=null}function Ta(t){return Lo(t)&&!Array.isArray(t)}function wn(t){return typeof t=="symbol"?t.toString():typeof t=="string"?JSON.stringify(t):`${t}`}function lx(t){const{done:e,value:r}=t.next();return e?void 0:r}function ux(t,e,r,n){if(t===!0)return;t===!1?t={}:typeof t=="string"&&(t={message:t});const{path:s,branch:i}=e,{type:o}=r,{refinement:a,message:c=`Expected a value of type \`${o}\`${a?` with refinement \`${a}\``:""}, but received: \`${wn(n)}\``}=t;return{value:n,type:o,refinement:a,key:s[s.length-1],path:s,branch:i,...t,message:c}}function*hh(t,e,r,n){cx(t)||(t=[t]);for(const s of t){const i=ux(s,e,r,n);i&&(yield i)}}function*Iu(t,e,r={}){const{path:n=[],branch:s=[t],coerce:i=!1,mask:o=!1}=r,a={path:n,branch:s,mask:o};i&&(t=e.coercer(t,a));let c="valid";for(const l of e.validator(t,a))l.explanation=r.message,c="not_valid",yield[l,void 0];for(let[l,g,m]of e.entries(t,a)){const I=Iu(g,m,{path:l===void 0?n:[...n,l],branch:l===void 0?s:[...s,g],coerce:i,mask:o,message:r.message});for(const _ of I)_[0]?(c=_[0].refinement!=null?"not_refined":"not_valid",yield[_[0],void 0]):i&&(g=_[1],l===void 0?t=g:t instanceof Map?t.set(l,g):t instanceof Set?t.add(g):Lo(t)&&(g!==void 0||l in t)&&(t[l]=g))}if(c!=="not_valid")for(const l of e.refiner(t,a))l.explanation=r.message,c="not_refined",yield[l,void 0];c==="valid"&&(yield[void 0,t])}let Tn=class{constructor(e){const{type:r,schema:n,validator:s,refiner:i,coercer:o=c=>c,entries:a=function*(){}}=e;this.type=r,this.schema=n,this.entries=a,this.coercer=o,s?this.validator=(c,l)=>{const g=s(c,l);return hh(g,l,this,c)}:this.validator=()=>[],i?this.refiner=(c,l)=>{const g=i(c,l);return hh(g,l,this,c)}:this.refiner=()=>[]}assert(e,r){return fx(e,this,r)}create(e,r){return Se(e,this,r)}is(e){return _p(e,this)}mask(e,r){return hx(e,this,r)}validate(e,r={}){return Fo(e,this,r)}};function fx(t,e,r){const n=Fo(t,e,{message:r});if(n[0])throw n[0]}function Se(t,e,r){const n=Fo(t,e,{coerce:!0,message:r});if(n[0])throw n[0];return n[1]}function hx(t,e,r){const n=Fo(t,e,{coerce:!0,mask:!0,message:r});if(n[0])throw n[0];return n[1]}function _p(t,e){return!Fo(t,e)[0]}function Fo(t,e,r={}){const n=Iu(t,e,r),s=lx(n);return s[0]?[new ax(s[0],function*(){for(const o of n)o[0]&&(yield o[0])}),void 0]:[void 0,s[1]]}function ni(t,e){return new Tn({type:t,schema:null,validator:e})}function dx(){return ni("any",()=>!0)}function Re(t){return new Tn({type:"array",schema:t,*entries(e){if(t&&Array.isArray(e))for(const[r,n]of e.entries())yield[r,n,t]},coercer(e){return Array.isArray(e)?e.slice():e},validator(e){return Array.isArray(e)||`Expected an array value, but received: ${wn(e)}`}})}function Rn(){return ni("boolean",t=>typeof t=="boolean")}function Su(t){return ni("instance",e=>e instanceof t||`Expected a \`${t.name}\` instance, but received: ${wn(e)}`)}function Ht(t){const e=wn(t),r=typeof t;return new Tn({type:"literal",schema:r==="string"||r==="number"||r==="boolean"?t:null,validator(n){return n===t||`Expected the literal \`${e}\`, but received: ${wn(n)}`}})}function px(){return ni("never",()=>!1)}function Te(t){return new Tn({...t,validator:(e,r)=>e===null||t.validator(e,r),refiner:(e,r)=>e===null||t.refiner(e,r)})}function ie(){return ni("number",t=>typeof t=="number"&&!isNaN(t)||`Expected a number, but received: ${wn(t)}`)}function Le(t){return new Tn({...t,validator:(e,r)=>e===void 0||t.validator(e,r),refiner:(e,r)=>e===void 0||t.refiner(e,r)})}function Ip(t,e){return new Tn({type:"record",schema:null,*entries(r){if(Lo(r))for(const n in r){const s=r[n];yield[n,n,t],yield[n,s,e]}},validator(r){return Ta(r)||`Expected an object, but received: ${wn(r)}`},coercer(r){return Ta(r)?{...r}:r}})}function xe(){return ni("string",t=>typeof t=="string"||`Expected a string, but received: ${wn(t)}`)}function Au(t){const e=px();return new Tn({type:"tuple",schema:null,*entries(r){if(Array.isArray(r)){const n=Math.max(t.length,r.length);for(let s=0;s<n;s++)yield[s,r[s],t[s]||e]}},validator(r){return Array.isArray(r)||`Expected an array, but received: ${wn(r)}`},coercer(r){return Array.isArray(r)?r.slice():r}})}function me(t){const e=Object.keys(t);return new Tn({type:"type",schema:t,*entries(r){if(Lo(r))for(const n of e)yield[n,r[n],t[n]]},validator(r){return Ta(r)||`Expected an object, but received: ${wn(r)}`},coercer(r){return Ta(r)?{...r}:r}})}function Kr(t){const e=t.map(r=>r.type).join(" | ");return new Tn({type:"union",schema:null,coercer(r,n){for(const s of t){const[i,o]=s.validate(r,{coerce:!0,mask:n.mask});if(!i)return o}return r},validator(r,n){const s=[];for(const i of t){const[...o]=Iu(r,i,n),[a]=o;if(a[0])for(const[c]of o)c&&s.push(c);else return[]}return[`Expected the value to satisfy a union of \`${e}\`, but received: ${wn(r)}`,...s]}})}function Zi(){return ni("unknown",()=>!0)}function $o(t,e,r){return new Tn({...t,coercer:(n,s)=>_p(n,e)?t.coercer(r(n,s),s):t.coercer(n,s)})}var ra,gx=new Uint8Array(16);function Sp(){if(!ra&&(ra=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!ra))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ra(gx)}const wx=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function nc(t){return typeof t=="string"&&wx.test(t)}var yr=[];for(var Lc=0;Lc<256;++Lc)yr.push((Lc+256).toString(16).substr(1));function sc(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=(yr[t[e+0]]+yr[t[e+1]]+yr[t[e+2]]+yr[t[e+3]]+"-"+yr[t[e+4]]+yr[t[e+5]]+"-"+yr[t[e+6]]+yr[t[e+7]]+"-"+yr[t[e+8]]+yr[t[e+9]]+"-"+yr[t[e+10]]+yr[t[e+11]]+yr[t[e+12]]+yr[t[e+13]]+yr[t[e+14]]+yr[t[e+15]]).toLowerCase();if(!nc(r))throw TypeError("Stringified UUID is invalid");return r}var dh,Fc,$c=0,Kc=0;function mx(t,e,r){var n=e&&r||0,s=e||new Array(16);t=t||{};var i=t.node||dh,o=t.clockseq!==void 0?t.clockseq:Fc;if(i==null||o==null){var a=t.random||(t.rng||Sp)();i==null&&(i=dh=[a[0]|1,a[1],a[2],a[3],a[4],a[5]]),o==null&&(o=Fc=(a[6]<<8|a[7])&16383)}var c=t.msecs!==void 0?t.msecs:Date.now(),l=t.nsecs!==void 0?t.nsecs:Kc+1,g=c-$c+(l-Kc)/1e4;if(g<0&&t.clockseq===void 0&&(o=o+1&16383),(g<0||c>$c)&&t.nsecs===void 0&&(l=0),l>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");$c=c,Kc=l,Fc=o,c+=122192928e5;var m=((c&268435455)*1e4+l)%4294967296;s[n++]=m>>>24&255,s[n++]=m>>>16&255,s[n++]=m>>>8&255,s[n++]=m&255;var I=c/4294967296*1e4&268435455;s[n++]=I>>>8&255,s[n++]=I&255,s[n++]=I>>>24&15|16,s[n++]=I>>>16&255,s[n++]=o>>>8|128,s[n++]=o&255;for(var _=0;_<6;++_)s[n+_]=i[_];return e||sc(s)}function Ap(t){if(!nc(t))throw TypeError("Invalid UUID");var e,r=new Uint8Array(16);return r[0]=(e=parseInt(t.slice(0,8),16))>>>24,r[1]=e>>>16&255,r[2]=e>>>8&255,r[3]=e&255,r[4]=(e=parseInt(t.slice(9,13),16))>>>8,r[5]=e&255,r[6]=(e=parseInt(t.slice(14,18),16))>>>8,r[7]=e&255,r[8]=(e=parseInt(t.slice(19,23),16))>>>8,r[9]=e&255,r[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,r[11]=e/4294967296&255,r[12]=e>>>24&255,r[13]=e>>>16&255,r[14]=e>>>8&255,r[15]=e&255,r}function yx(t){t=unescape(encodeURIComponent(t));for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e}var bx="6ba7b810-9dad-11d1-80b4-00c04fd430c8",vx="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function Rp(t,e,r){function n(s,i,o,a){if(typeof s=="string"&&(s=yx(s)),typeof i=="string"&&(i=Ap(i)),i.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var c=new Uint8Array(16+s.length);if(c.set(i),c.set(s,i.length),c=r(c),c[6]=c[6]&15|e,c[8]=c[8]&63|128,o){a=a||0;for(var l=0;l<16;++l)o[a+l]=c[l];return o}return sc(c)}try{n.name=t}catch{}return n.DNS=bx,n.URL=vx,n}function Ex(t){if(typeof t=="string"){var e=unescape(encodeURIComponent(t));t=new Uint8Array(e.length);for(var r=0;r<e.length;++r)t[r]=e.charCodeAt(r)}return xx(_x(Ix(t),t.length*8))}function xx(t){for(var e=[],r=t.length*32,n="0123456789abcdef",s=0;s<r;s+=8){var i=t[s>>5]>>>s%32&255,o=parseInt(n.charAt(i>>>4&15)+n.charAt(i&15),16);e.push(o)}return e}function Bp(t){return(t+64>>>9<<4)+14+1}function _x(t,e){t[e>>5]|=128<<e%32,t[Bp(e)-1]=e;for(var r=1732584193,n=-271733879,s=-1732584194,i=271733878,o=0;o<t.length;o+=16){var a=r,c=n,l=s,g=i;r=Pr(r,n,s,i,t[o],7,-680876936),i=Pr(i,r,n,s,t[o+1],12,-389564586),s=Pr(s,i,r,n,t[o+2],17,606105819),n=Pr(n,s,i,r,t[o+3],22,-1044525330),r=Pr(r,n,s,i,t[o+4],7,-176418897),i=Pr(i,r,n,s,t[o+5],12,1200080426),s=Pr(s,i,r,n,t[o+6],17,-1473231341),n=Pr(n,s,i,r,t[o+7],22,-45705983),r=Pr(r,n,s,i,t[o+8],7,1770035416),i=Pr(i,r,n,s,t[o+9],12,-1958414417),s=Pr(s,i,r,n,t[o+10],17,-42063),n=Pr(n,s,i,r,t[o+11],22,-1990404162),r=Pr(r,n,s,i,t[o+12],7,1804603682),i=Pr(i,r,n,s,t[o+13],12,-40341101),s=Pr(s,i,r,n,t[o+14],17,-1502002290),n=Pr(n,s,i,r,t[o+15],22,1236535329),r=Cr(r,n,s,i,t[o+1],5,-165796510),i=Cr(i,r,n,s,t[o+6],9,-1069501632),s=Cr(s,i,r,n,t[o+11],14,643717713),n=Cr(n,s,i,r,t[o],20,-373897302),r=Cr(r,n,s,i,t[o+5],5,-701558691),i=Cr(i,r,n,s,t[o+10],9,38016083),s=Cr(s,i,r,n,t[o+15],14,-660478335),n=Cr(n,s,i,r,t[o+4],20,-405537848),r=Cr(r,n,s,i,t[o+9],5,568446438),i=Cr(i,r,n,s,t[o+14],9,-1019803690),s=Cr(s,i,r,n,t[o+3],14,-187363961),n=Cr(n,s,i,r,t[o+8],20,1163531501),r=Cr(r,n,s,i,t[o+13],5,-1444681467),i=Cr(i,r,n,s,t[o+2],9,-51403784),s=Cr(s,i,r,n,t[o+7],14,1735328473),n=Cr(n,s,i,r,t[o+12],20,-1926607734),r=Dr(r,n,s,i,t[o+5],4,-378558),i=Dr(i,r,n,s,t[o+8],11,-2022574463),s=Dr(s,i,r,n,t[o+11],16,1839030562),n=Dr(n,s,i,r,t[o+14],23,-35309556),r=Dr(r,n,s,i,t[o+1],4,-1530992060),i=Dr(i,r,n,s,t[o+4],11,1272893353),s=Dr(s,i,r,n,t[o+7],16,-155497632),n=Dr(n,s,i,r,t[o+10],23,-1094730640),r=Dr(r,n,s,i,t[o+13],4,681279174),i=Dr(i,r,n,s,t[o],11,-358537222),s=Dr(s,i,r,n,t[o+3],16,-722521979),n=Dr(n,s,i,r,t[o+6],23,76029189),r=Dr(r,n,s,i,t[o+9],4,-640364487),i=Dr(i,r,n,s,t[o+12],11,-421815835),s=Dr(s,i,r,n,t[o+15],16,530742520),n=Dr(n,s,i,r,t[o+2],23,-995338651),r=kr(r,n,s,i,t[o],6,-198630844),i=kr(i,r,n,s,t[o+7],10,1126891415),s=kr(s,i,r,n,t[o+14],15,-1416354905),n=kr(n,s,i,r,t[o+5],21,-57434055),r=kr(r,n,s,i,t[o+12],6,1700485571),i=kr(i,r,n,s,t[o+3],10,-1894986606),s=kr(s,i,r,n,t[o+10],15,-1051523),n=kr(n,s,i,r,t[o+1],21,-2054922799),r=kr(r,n,s,i,t[o+8],6,1873313359),i=kr(i,r,n,s,t[o+15],10,-30611744),s=kr(s,i,r,n,t[o+6],15,-1560198380),n=kr(n,s,i,r,t[o+13],21,1309151649),r=kr(r,n,s,i,t[o+4],6,-145523070),i=kr(i,r,n,s,t[o+11],10,-1120210379),s=kr(s,i,r,n,t[o+2],15,718787259),n=kr(n,s,i,r,t[o+9],21,-343485551),r=ps(r,a),n=ps(n,c),s=ps(s,l),i=ps(i,g)}return[r,n,s,i]}function Ix(t){if(t.length===0)return[];for(var e=t.length*8,r=new Uint32Array(Bp(e)),n=0;n<e;n+=8)r[n>>5]|=(t[n/8]&255)<<n%32;return r}function ps(t,e){var r=(t&65535)+(e&65535),n=(t>>16)+(e>>16)+(r>>16);return n<<16|r&65535}function Sx(t,e){return t<<e|t>>>32-e}function ic(t,e,r,n,s,i){return ps(Sx(ps(ps(e,t),ps(n,i)),s),r)}function Pr(t,e,r,n,s,i,o){return ic(e&r|~e&n,t,e,s,i,o)}function Cr(t,e,r,n,s,i,o){return ic(e&n|r&~n,t,e,s,i,o)}function Dr(t,e,r,n,s,i,o){return ic(e^r^n,t,e,s,i,o)}function kr(t,e,r,n,s,i,o){return ic(r^(e|~n),t,e,s,i,o)}var Ax=Rp("v3",48,Ex);function Rx(t,e,r){t=t||{};var n=t.random||(t.rng||Sp)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){r=r||0;for(var s=0;s<16;++s)e[r+s]=n[s];return e}return sc(n)}function Bx(t,e,r,n){switch(t){case 0:return e&r^~e&n;case 1:return e^r^n;case 2:return e&r^e&n^r&n;case 3:return e^r^n}}function zc(t,e){return t<<e|t>>>32-e}function Tx(t){var e=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof t=="string"){var n=unescape(encodeURIComponent(t));t=[];for(var s=0;s<n.length;++s)t.push(n.charCodeAt(s))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);for(var i=t.length/4+2,o=Math.ceil(i/16),a=new Array(o),c=0;c<o;++c){for(var l=new Uint32Array(16),g=0;g<16;++g)l[g]=t[c*64+g*4]<<24|t[c*64+g*4+1]<<16|t[c*64+g*4+2]<<8|t[c*64+g*4+3];a[c]=l}a[o-1][14]=(t.length-1)*8/Math.pow(2,32),a[o-1][14]=Math.floor(a[o-1][14]),a[o-1][15]=(t.length-1)*8&4294967295;for(var m=0;m<o;++m){for(var I=new Uint32Array(80),_=0;_<16;++_)I[_]=a[m][_];for(var b=16;b<80;++b)I[b]=zc(I[b-3]^I[b-8]^I[b-14]^I[b-16],1);for(var v=r[0],S=r[1],O=r[2],$=r[3],k=r[4],Z=0;Z<80;++Z){var q=Math.floor(Z/20),J=zc(v,5)+Bx(q,S,O,$)+k+e[q]+I[Z]>>>0;k=$,$=O,O=zc(S,30)>>>0,S=v,v=J}r[0]=r[0]+v>>>0,r[1]=r[1]+S>>>0,r[2]=r[2]+O>>>0,r[3]=r[3]+$>>>0,r[4]=r[4]+k>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,r[0]&255,r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,r[1]&255,r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,r[2]&255,r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,r[3]&255,r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,r[4]&255]}var Px=Rp("v5",80,Tx);const Cx="00000000-0000-0000-0000-000000000000";function Dx(t){if(!nc(t))throw TypeError("Invalid UUID");return parseInt(t.substr(14,1),16)}const kx=Object.freeze(Object.defineProperty({__proto__:null,NIL:Cx,parse:Ap,stringify:sc,v1:mx,v3:Ax,v4:Rx,v5:Px,validate:nc,version:Dx},Symbol.toStringTag,{value:"Module"})),Tp=su(kx);var Vc,ph;function Nx(){if(ph)return Vc;ph=1;const t=Tp.v4;return Vc=function(r,n,s,i){if(typeof r!="string")throw new TypeError(r+" must be a string");i=i||{};const o=typeof i.version=="number"?i.version:2;if(o!==1&&o!==2)throw new TypeError(o+" must be 1 or 2");const a={method:r};if(o===2&&(a.jsonrpc="2.0"),n){if(typeof n!="object"&&!Array.isArray(n))throw new TypeError(n+" must be an object, array or omitted");a.params=n}if(typeof s>"u"){const c=typeof i.generator=="function"?i.generator:function(){return t()};a.id=c(a,i)}else o===2&&s===null?i.notificationIdNull&&(a.id=null):a.id=s;return a},Vc}var qc,gh;function Ox(){if(gh)return qc;gh=1;const t=Tp.v4,e=Nx(),r=function(n,s){if(!(this instanceof r))return new r(n,s);s||(s={}),this.options={reviver:typeof s.reviver<"u"?s.reviver:null,replacer:typeof s.replacer<"u"?s.replacer:null,generator:typeof s.generator<"u"?s.generator:function(){return t()},version:typeof s.version<"u"?s.version:2,notificationIdNull:typeof s.notificationIdNull=="boolean"?s.notificationIdNull:!1},this.callServer=n};return qc=r,r.prototype.request=function(n,s,i,o){const a=this;let c=null;const l=Array.isArray(n)&&typeof s=="function";if(this.options.version===1&&l)throw new TypeError("JSON-RPC 1.0 does not support batching");if(l||!l&&n&&typeof n=="object"&&typeof s=="function")o=s,c=n;else{typeof i=="function"&&(o=i,i=void 0);const I=typeof o=="function";try{c=e(n,s,i,{generator:this.options.generator,version:this.options.version,notificationIdNull:this.options.notificationIdNull})}catch(_){if(I){o(_);return}throw _}if(!I)return c}let m;try{m=JSON.stringify(c,this.options.replacer)}catch(I){o(I);return}return this.callServer(m,function(I,_){a._parseResponse(I,_,o)}),c},r.prototype._parseResponse=function(n,s,i){if(n){i(n);return}if(!s){i();return}let o;try{o=JSON.parse(s,this.options.reviver)}catch(a){i(a);return}if(i.length===3)if(Array.isArray(o)){const a=function(l){return typeof l.error<"u"},c=function(l){return!a(l)};i(null,o.filter(a),o.filter(c));return}else{i(null,o.error,o.result);return}i(null,o)},qc}var Mx=Ox();const Ux=ja(Mx);var Lx=class extends Qs{socket;constructor(t,e){super(),this.socket=new window.WebSocket(t,e.protocols),this.socket.onopen=()=>this.emit("open"),this.socket.onmessage=r=>this.emit("message",r.data),this.socket.onerror=r=>this.emit("error",r),this.socket.onclose=r=>{this.emit("close",r.code,r.reason)}}send(t,e,r){const n=r||e;try{this.socket.send(t),n()}catch(s){n(s)}}close(t,e){this.socket.close(t,e)}addEventListener(t,e,r){this.socket.addEventListener(t,e,r)}};function Fx(t,e){return new Lx(t,e)}var $x=class{encode(t){return JSON.stringify(t)}decode(t){return JSON.parse(t)}},Kx=class extends Qs{address;rpc_id;queue;options;autoconnect;ready;reconnect;reconnect_timer_id;reconnect_interval;max_reconnects;rest_options;current_reconnects;generate_request_id;socket;webSocketFactory;dataPack;constructor(t,e="ws://localhost:8080",{autoconnect:r=!0,reconnect:n=!0,reconnect_interval:s=1e3,max_reconnects:i=5,...o}={},a,c){super(),this.webSocketFactory=t,this.queue={},this.rpc_id=0,this.address=e,this.autoconnect=r,this.ready=!1,this.reconnect=n,this.reconnect_timer_id=void 0,this.reconnect_interval=s,this.max_reconnects=i,this.rest_options=o,this.current_reconnects=0,this.generate_request_id=a||(()=>typeof this.rpc_id=="number"?++this.rpc_id:Number(this.rpc_id)+1),c?this.dataPack=c:this.dataPack=new $x,this.autoconnect&&this._connect(this.address,{autoconnect:this.autoconnect,reconnect:this.reconnect,reconnect_interval:this.reconnect_interval,max_reconnects:this.max_reconnects,...this.rest_options})}connect(){this.socket||this._connect(this.address,{autoconnect:this.autoconnect,reconnect:this.reconnect,reconnect_interval:this.reconnect_interval,max_reconnects:this.max_reconnects,...this.rest_options})}call(t,e,r,n){return!n&&typeof r=="object"&&(n=r,r=null),new Promise((s,i)=>{if(!this.ready)return i(new Error("socket not ready"));const o=this.generate_request_id(t,e),a={jsonrpc:"2.0",method:t,params:e||void 0,id:o};this.socket.send(this.dataPack.encode(a),n,c=>{if(c)return i(c);this.queue[o]={promise:[s,i]},r&&(this.queue[o].timeout=setTimeout(()=>{delete this.queue[o],i(new Error("reply timeout"))},r))})})}async login(t){const e=await this.call("rpc.login",t);if(!e)throw new Error("authentication failed");return e}async listMethods(){return await this.call("__listMethods")}notify(t,e){return new Promise((r,n)=>{if(!this.ready)return n(new Error("socket not ready"));const s={jsonrpc:"2.0",method:t,params:e};this.socket.send(this.dataPack.encode(s),i=>{if(i)return n(i);r()})})}async subscribe(t){typeof t=="string"&&(t=[t]);const e=await this.call("rpc.on",t);if(typeof t=="string"&&e[t]!=="ok")throw new Error("Failed subscribing to an event '"+t+"' with: "+e[t]);return e}async unsubscribe(t){typeof t=="string"&&(t=[t]);const e=await this.call("rpc.off",t);if(typeof t=="string"&&e[t]!=="ok")throw new Error("Failed unsubscribing from an event with: "+e);return e}close(t,e){this.socket&&this.socket.close(t||1e3,e)}setAutoReconnect(t){this.reconnect=t}setReconnectInterval(t){this.reconnect_interval=t}setMaxReconnects(t){this.max_reconnects=t}getCurrentReconnects(){return this.current_reconnects}getMaxReconnects(){return this.max_reconnects}isReconnecting(){return this.reconnect_timer_id!==void 0}willReconnect(){return this.reconnect&&(this.max_reconnects===0||this.current_reconnects<this.max_reconnects)}_connect(t,e){clearTimeout(this.reconnect_timer_id),this.socket=this.webSocketFactory(t,e),this.socket.addEventListener("open",()=>{this.ready=!0,this.emit("open"),this.current_reconnects=0}),this.socket.addEventListener("message",({data:r})=>{r instanceof ArrayBuffer&&(r=je.Buffer.from(r).toString());try{r=this.dataPack.decode(r)}catch{return}if(r.notification&&this.listeners(r.notification).length){if(!Object.keys(r.params).length)return this.emit(r.notification);const n=[r.notification];if(r.params.constructor===Object)n.push(r.params);else for(let s=0;s<r.params.length;s++)n.push(r.params[s]);return Promise.resolve().then(()=>{this.emit.apply(this,n)})}if(!this.queue[r.id])return r.method?Promise.resolve().then(()=>{this.emit(r.method,r?.params)}):void 0;"error"in r=="result"in r&&this.queue[r.id].promise[1](new Error('Server response malformed. Response must include either "result" or "error", but not both.')),this.queue[r.id].timeout&&clearTimeout(this.queue[r.id].timeout),r.error?this.queue[r.id].promise[1](r.error):this.queue[r.id].promise[0](r.result),delete this.queue[r.id]}),this.socket.addEventListener("error",r=>this.emit("error",r)),this.socket.addEventListener("close",({code:r,reason:n})=>{this.ready&&setTimeout(()=>this.emit("close",r,n),0),this.ready=!1,this.socket=void 0,r!==1e3&&(this.current_reconnects++,this.reconnect&&(this.max_reconnects>this.current_reconnects||this.max_reconnects===0)?this.reconnect_timer_id=setTimeout(()=>this._connect(t,e),this.reconnect_interval):this.reconnect&&this.max_reconnects>0&&this.current_reconnects>=this.max_reconnects&&setTimeout(()=>this.emit("max_reconnects_reached",r,n),1))})}};class Pp extends Z0{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,G0(e);const n=mu(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(n.length>s?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),Mi(i)}update(e){return Ea(this),this.iHash.update(e),this}digestInto(e){Ea(this),ti(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:n,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Cp=(t,e,r)=>new Pp(t,e).update(r).digest();Cp.create=(t,e)=>new Pp(t,e);const wh=(t,e)=>(t+(t>=0?e:-e)/Dp)/e;function zx(t,e,r){const[[n,s],[i,o]]=e,a=wh(o*t,r),c=wh(-s*t,r);let l=t-a*n-c*i,g=-a*s-c*o;const m=l<qn,I=g<qn;m&&(l=-l),I&&(g=-g);const _=Oo(Math.ceil(np(r)/2))+Ai;if(l<qn||l>=_||g<qn||g>=_)throw new Error("splitScalar (endomorphism): failed, k="+t);return{k1neg:m,k1:l,k2neg:I,k2:g}}function Ml(t){if(!["compact","recovered","der"].includes(t))throw new Error('Signature format must be "compact", "recovered", or "der"');return t}function Wc(t,e){const r={};for(let n of Object.keys(e))r[n]=t[n]===void 0?e[n]:t[n];return Zs(r.lowS,"lowS"),Zs(r.prehash,"prehash"),r.format!==void 0&&Ml(r.format),r}class Vx extends Error{constructor(e=""){super(e)}}const Un={Err:Vx,_tlv:{encode:(t,e)=>{const{Err:r}=Un;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length&1)throw new r("tlv.encode: unpadded data");const n=e.length/2,s=ea(n);if(s.length/2&128)throw new r("tlv.encode: long form length too big");const i=n>127?ea(s.length/2|128):"";return ea(t)+i+s+e},decode(t,e){const{Err:r}=Un;let n=0;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length<2||e[n++]!==t)throw new r("tlv.decode: wrong tlv");const s=e[n++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new r("tlv.decode(long): indefinite length not supported");if(c>4)throw new r("tlv.decode(long): byte length is too big");const l=e.subarray(n,n+c);if(l.length!==c)throw new r("tlv.decode: length bytes not complete");if(l[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(const g of l)o=o<<8|g;if(n+=c,o<128)throw new r("tlv.decode(long): not minimal encoding")}const a=e.subarray(n,n+o);if(a.length!==o)throw new r("tlv.decode: wrong value length");return{v:a,l:e.subarray(n+o)}}},_int:{encode(t){const{Err:e}=Un;if(t<qn)throw new e("integer: negative integers are not allowed");let r=ea(t);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return r},decode(t){const{Err:e}=Un;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return tc(t)}},toSig(t){const{Err:e,_int:r,_tlv:n}=Un,s=sr("signature",t),{v:i,l:o}=n.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=n.decode(2,i),{v:l,l:g}=n.decode(2,c);if(g.length)throw new e("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(l)}},hexFromSig(t){const{_tlv:e,_int:r}=Un,n=e.encode(2,r.encode(t.r)),s=e.encode(2,r.encode(t.s)),i=n+s;return e.encode(48,i)}},qn=BigInt(0),Ai=BigInt(1),Dp=BigInt(2),na=BigInt(3),qx=BigInt(4);function Ei(t,e){const{BYTES:r}=t;let n;if(typeof e=="bigint")n=e;else{let s=sr("private key",e);try{n=t.fromBytes(s)}catch{throw new Error(`invalid private key: expected ui8a of size ${r}, got ${typeof e}`)}}if(!t.isValidNot0(n))throw new Error("invalid private key: out of range [1..N-1]");return n}function Wx(t,e={}){const r=bp("weierstrass",t,e),{Fp:n,Fn:s}=r;let i=r.CURVE;const{h:o,n:a}=i;Mo(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:c}=e;if(c&&(!n.is0(i.a)||typeof c.beta!="bigint"||!Array.isArray(c.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const l=Np(n,s);function g(){if(!n.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function m(te,A,u){const{x:d,y:x}=A.toAffine(),P=n.toBytes(d);if(Zs(u,"isCompressed"),u){g();const M=!n.isOdd(x);return _n(kp(M),P)}else return _n(Uint8Array.of(4),P,n.toBytes(x))}function I(te){pn(te,void 0,"Point");const{publicKey:A,publicKeyUncompressed:u}=l,d=te.length,x=te[0],P=te.subarray(1);if(d===A&&(x===2||x===3)){const M=n.fromBytes(P);if(!n.isValid(M))throw new Error("bad point: is not on curve, wrong x");const F=v(M);let j;try{j=n.sqrt(F)}catch(p){const R=p instanceof Error?": "+p.message:"";throw new Error("bad point: is not on curve, sqrt error"+R)}g();const D=n.isOdd(j);return(x&1)===1!==D&&(j=n.neg(j)),{x:M,y:j}}else if(d===u&&x===4){const M=n.BYTES,F=n.fromBytes(P.subarray(0,M)),j=n.fromBytes(P.subarray(M,M*2));if(!S(F,j))throw new Error("bad point: is not on curve");return{x:F,y:j}}else throw new Error(`bad point: got length ${d}, expected compressed=${A} or uncompressed=${u}`)}const _=e.toBytes||m,b=e.fromBytes||I;function v(te){const A=n.sqr(te),u=n.mul(A,te);return n.add(n.add(u,n.mul(te,i.a)),i.b)}function S(te,A){const u=n.sqr(A),d=v(te);return n.eql(u,d)}if(!S(i.Gx,i.Gy))throw new Error("bad curve params: generator point");const O=n.mul(n.pow(i.a,na),qx),$=n.mul(n.sqr(i.b),BigInt(27));if(n.is0(n.add(O,$)))throw new Error("bad curve params: a or b");function k(te,A,u=!1){if(!n.isValid(A)||u&&n.is0(A))throw new Error(`bad point coordinate ${te}`);return A}function Z(te){if(!(te instanceof V))throw new Error("ProjectivePoint expected")}function q(te){if(!c||!c.basises)throw new Error("no endo");return zx(te,c.basises,s.ORDER)}const J=_a((te,A)=>{const{X:u,Y:d,Z:x}=te;if(n.eql(x,n.ONE))return{x:u,y:d};const P=te.is0();A==null&&(A=P?n.ONE:n.inv(x));const M=n.mul(u,A),F=n.mul(d,A),j=n.mul(x,A);if(P)return{x:n.ZERO,y:n.ZERO};if(!n.eql(j,n.ONE))throw new Error("invZ was invalid");return{x:M,y:F}}),se=_a(te=>{if(te.is0()){if(e.allowInfinityPoint&&!n.is0(te.Y))return;throw new Error("bad point: ZERO")}const{x:A,y:u}=te.toAffine();if(!n.isValid(A)||!n.isValid(u))throw new Error("bad point: x or y not field elements");if(!S(A,u))throw new Error("bad point: equation left != right");if(!te.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function oe(te,A,u,d,x){return u=new V(n.mul(u.X,te),u.Y,u.Z),A=Ia(d,A),u=Ia(x,u),A.add(u)}class V{constructor(A,u,d){this.X=k("x",A),this.Y=k("y",u,!0),this.Z=k("z",d),Object.freeze(this)}static CURVE(){return i}static fromAffine(A){const{x:u,y:d}=A||{};if(!A||!n.isValid(u)||!n.isValid(d))throw new Error("invalid affine point");if(A instanceof V)throw new Error("projective point not allowed");return n.is0(u)&&n.is0(d)?V.ZERO:new V(u,d,n.ONE)}static fromBytes(A){const u=V.fromAffine(b(pn(A,void 0,"point")));return u.assertValidity(),u}static fromHex(A){return V.fromBytes(sr("pointHex",A))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(A=8,u=!0){return Y.createCache(this,A),u||this.multiply(na),this}assertValidity(){se(this)}hasEvenY(){const{y:A}=this.toAffine();if(!n.isOdd)throw new Error("Field doesn't support isOdd");return!n.isOdd(A)}equals(A){Z(A);const{X:u,Y:d,Z:x}=this,{X:P,Y:M,Z:F}=A,j=n.eql(n.mul(u,F),n.mul(P,x)),D=n.eql(n.mul(d,F),n.mul(M,x));return j&&D}negate(){return new V(this.X,n.neg(this.Y),this.Z)}double(){const{a:A,b:u}=i,d=n.mul(u,na),{X:x,Y:P,Z:M}=this;let F=n.ZERO,j=n.ZERO,D=n.ZERO,f=n.mul(x,x),p=n.mul(P,P),R=n.mul(M,M),U=n.mul(x,P);return U=n.add(U,U),D=n.mul(x,M),D=n.add(D,D),F=n.mul(A,D),j=n.mul(d,R),j=n.add(F,j),F=n.sub(p,j),j=n.add(p,j),j=n.mul(F,j),F=n.mul(U,F),D=n.mul(d,D),R=n.mul(A,R),U=n.sub(f,R),U=n.mul(A,U),U=n.add(U,D),D=n.add(f,f),f=n.add(D,f),f=n.add(f,R),f=n.mul(f,U),j=n.add(j,f),R=n.mul(P,M),R=n.add(R,R),f=n.mul(R,U),F=n.sub(F,f),D=n.mul(R,p),D=n.add(D,D),D=n.add(D,D),new V(F,j,D)}add(A){Z(A);const{X:u,Y:d,Z:x}=this,{X:P,Y:M,Z:F}=A;let j=n.ZERO,D=n.ZERO,f=n.ZERO;const p=i.a,R=n.mul(i.b,na);let U=n.mul(u,P),X=n.mul(d,M),fe=n.mul(x,F),Ee=n.add(u,d),_e=n.add(P,M);Ee=n.mul(Ee,_e),_e=n.add(U,X),Ee=n.sub(Ee,_e),_e=n.add(u,x);let Xe=n.add(P,F);return _e=n.mul(_e,Xe),Xe=n.add(U,fe),_e=n.sub(_e,Xe),Xe=n.add(d,x),j=n.add(M,F),Xe=n.mul(Xe,j),j=n.add(X,fe),Xe=n.sub(Xe,j),f=n.mul(p,_e),j=n.mul(R,fe),f=n.add(j,f),j=n.sub(X,f),f=n.add(X,f),D=n.mul(j,f),X=n.add(U,U),X=n.add(X,U),fe=n.mul(p,fe),_e=n.mul(R,_e),X=n.add(X,fe),fe=n.sub(U,fe),fe=n.mul(p,fe),_e=n.add(_e,fe),U=n.mul(X,_e),D=n.add(D,U),U=n.mul(Xe,_e),j=n.mul(Ee,j),j=n.sub(j,U),U=n.mul(Ee,X),f=n.mul(Xe,f),f=n.add(f,U),new V(j,D,f)}subtract(A){return this.add(A.negate())}is0(){return this.equals(V.ZERO)}multiply(A){const{endo:u}=e;if(!s.isValidNot0(A))throw new Error("invalid scalar: out of range");let d,x;const P=M=>Y.cached(this,M,F=>Ns(V,F));if(u){const{k1neg:M,k1:F,k2neg:j,k2:D}=q(A),{p:f,f:p}=P(F),{p:R,f:U}=P(D);x=p.add(U),d=oe(u.beta,f,R,M,j)}else{const{p:M,f:F}=P(A);d=M,x=F}return Ns(V,[d,x])[0]}multiplyUnsafe(A){const{endo:u}=e,d=this;if(!s.isValid(A))throw new Error("invalid scalar: out of range");if(A===qn||d.is0())return V.ZERO;if(A===Ai)return d;if(Y.hasCache(this))return this.multiply(A);if(u){const{k1neg:x,k1:P,k2neg:M,k2:F}=q(A),{p1:j,p2:D}=DE(V,d,P,F);return oe(u.beta,j,D,x,M)}else return Y.unsafe(d,A)}multiplyAndAddUnsafe(A,u,d){const x=this.multiplyUnsafe(u).add(A.multiplyUnsafe(d));return x.is0()?void 0:x}toAffine(A){return J(this,A)}isTorsionFree(){const{isTorsionFree:A}=e;return o===Ai?!0:A?A(V,this):Y.unsafe(this,a).is0()}clearCofactor(){const{clearCofactor:A}=e;return o===Ai?this:A?A(V,this):this.multiplyUnsafe(o)}isSmallOrder(){return this.multiplyUnsafe(o).is0()}toBytes(A=!0){return Zs(A,"isCompressed"),this.assertValidity(),_(V,this,A)}toHex(A=!0){return zs(this.toBytes(A))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(A=!0){return this.toBytes(A)}_setWindowSize(A){this.precompute(A)}static normalizeZ(A){return Ns(V,A)}static msm(A,u){return yp(V,s,A,u)}static fromPrivateKey(A){return V.BASE.multiply(Ei(s,A))}}V.BASE=new V(i.Gx,i.Gy,n.ONE),V.ZERO=new V(n.ZERO,n.ONE,n.ZERO),V.Fp=n,V.Fn=s;const W=s.BITS,Y=new mp(V,e.endo?Math.ceil(W/2):W);return V.BASE.precompute(8),V}function kp(t){return Uint8Array.of(t?2:3)}function Np(t,e){return{secretKey:e.BYTES,publicKey:1+t.BYTES,publicKeyUncompressed:1+2*t.BYTES,publicKeyHasPrefix:!0,signature:2*e.BYTES}}function jx(t,e={}){const{Fn:r}=t,n=e.randomBytes||yu,s=Object.assign(Np(t.Fp,r),{seed:pp(r.ORDER)});function i(_){try{return!!Ei(r,_)}catch{return!1}}function o(_,b){const{publicKey:v,publicKeyUncompressed:S}=s;try{const O=_.length;return b===!0&&O!==v||b===!1&&O!==S?!1:!!t.fromBytes(_)}catch{return!1}}function a(_=n(s.seed)){return TE(pn(_,s.seed,"seed"),r.ORDER)}function c(_,b=!0){return t.BASE.multiply(Ei(r,_)).toBytes(b)}function l(_){const b=a(_);return{secretKey:b,publicKey:c(b)}}function g(_){if(typeof _=="bigint")return!1;if(_ instanceof t)return!0;const{secretKey:b,publicKey:v,publicKeyUncompressed:S}=s;if(r.allowedLengths||b===v)return;const O=sr("key",_).length;return O===v||O===S}function m(_,b,v=!0){if(g(_)===!0)throw new Error("first arg must be private key");if(g(b)===!1)throw new Error("second arg must be public key");const S=Ei(r,_);return t.fromHex(b).multiply(S).toBytes(v)}return Object.freeze({getPublicKey:c,getSharedSecret:m,keygen:l,Point:t,utils:{isValidSecretKey:i,isValidPublicKey:o,randomSecretKey:a,isValidPrivateKey:i,randomPrivateKey:a,normPrivateKeyToScalar:_=>Ei(r,_),precompute(_=8,b=t.BASE){return b.precompute(_,!1)}},lengths:s})}function Hx(t,e,r={}){G0(e),Mo(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const n=r.randomBytes||yu,s=r.hmac||((u,...d)=>Cp(e,u,_n(...d))),{Fp:i,Fn:o}=t,{ORDER:a,BITS:c}=o,{keygen:l,getPublicKey:g,getSharedSecret:m,utils:I,lengths:_}=jx(t,r),b={prehash:!1,lowS:typeof r.lowS=="boolean"?r.lowS:!1,format:void 0,extraEntropy:!1},v="compact";function S(u){const d=a>>Ai;return u>d}function O(u,d){if(!o.isValidNot0(d))throw new Error(`invalid signature ${u}: out of range 1..Point.Fn.ORDER`);return d}function $(u,d){Ml(d);const x=_.signature,P=d==="compact"?x:d==="recovered"?x+1:void 0;return pn(u,P,`${d} signature`)}class k{constructor(d,x,P){this.r=O("r",d),this.s=O("s",x),P!=null&&(this.recovery=P),Object.freeze(this)}static fromBytes(d,x=v){$(d,x);let P;if(x==="der"){const{r:D,s:f}=Un.toSig(pn(d));return new k(D,f)}x==="recovered"&&(P=d[0],x="compact",d=d.subarray(1));const M=o.BYTES,F=d.subarray(0,M),j=d.subarray(M,M*2);return new k(o.fromBytes(F),o.fromBytes(j),P)}static fromHex(d,x){return this.fromBytes(xa(d),x)}addRecoveryBit(d){return new k(this.r,this.s,d)}recoverPublicKey(d){const x=i.ORDER,{r:P,s:M,recovery:F}=this;if(F==null||![0,1,2,3].includes(F))throw new Error("recovery id invalid");if(a*Dp<x&&F>1)throw new Error("recovery id is ambiguous for h>1 curve");const D=F===2||F===3?P+a:P;if(!i.isValid(D))throw new Error("recovery id 2 or 3 invalid");const f=i.toBytes(D),p=t.fromBytes(_n(kp((F&1)===0),f)),R=o.inv(D),U=q(sr("msgHash",d)),X=o.create(-U*R),fe=o.create(M*R),Ee=t.BASE.multiplyUnsafe(X).add(p.multiplyUnsafe(fe));if(Ee.is0())throw new Error("point at infinify");return Ee.assertValidity(),Ee}hasHighS(){return S(this.s)}toBytes(d=v){if(Ml(d),d==="der")return xa(Un.hexFromSig(this));const x=o.toBytes(this.r),P=o.toBytes(this.s);if(d==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return _n(Uint8Array.of(this.recovery),x,P)}return _n(x,P)}toHex(d){return zs(this.toBytes(d))}assertValidity(){}static fromCompact(d){return k.fromBytes(sr("sig",d),"compact")}static fromDER(d){return k.fromBytes(sr("sig",d),"der")}normalizeS(){return this.hasHighS()?new k(this.r,o.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return zs(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return zs(this.toBytes("compact"))}}const Z=r.bits2int||function(d){if(d.length>8192)throw new Error("input is too large");const x=tc(d),P=d.length*8-c;return P>0?x>>BigInt(P):x},q=r.bits2int_modN||function(d){return o.create(Z(d))},J=Oo(c);function se(u){return Ol("num < 2^"+c,u,qn,J),o.toBytes(u)}function oe(u,d){return pn(u,void 0,"message"),d?pn(e(u),void 0,"prehashed message"):u}function V(u,d,x){if(["recovered","canonical"].some(X=>X in x))throw new Error("sign() legacy options not supported");const{lowS:P,prehash:M,extraEntropy:F}=Wc(x,b);u=oe(u,M);const j=q(u),D=Ei(o,d),f=[se(D),se(j)];if(F!=null&&F!==!1){const X=F===!0?n(_.secretKey):F;f.push(sr("extraEntropy",X))}const p=_n(...f),R=j;function U(X){const fe=Z(X);if(!o.isValidNot0(fe))return;const Ee=o.inv(fe),_e=t.BASE.multiply(fe).toAffine(),Xe=o.create(_e.x);if(Xe===qn)return;const dt=o.create(Ee*o.create(R+Xe*D));if(dt===qn)return;let Qe=(_e.x===Xe?0:2)|Number(_e.y&Ai),Zt=dt;return P&&S(dt)&&(Zt=o.neg(dt),Qe^=1),new k(Xe,Zt,Qe)}return{seed:p,k2sig:U}}function W(u,d,x={}){u=sr("message",u);const{seed:P,k2sig:M}=V(u,d,x);return bE(e.outputLen,o.BYTES,s)(P,M)}function Y(u){let d;const x=typeof u=="string"||No(u),P=!x&&u!==null&&typeof u=="object"&&typeof u.r=="bigint"&&typeof u.s=="bigint";if(!x&&!P)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(P)d=new k(u.r,u.s);else if(x){try{d=k.fromBytes(sr("sig",u),"der")}catch(M){if(!(M instanceof Un.Err))throw M}if(!d)try{d=k.fromBytes(sr("sig",u),"compact")}catch{return!1}}return d||!1}function te(u,d,x,P={}){const{lowS:M,prehash:F,format:j}=Wc(P,b);if(x=sr("publicKey",x),d=oe(sr("message",d),F),"strict"in P)throw new Error("options.strict was renamed to lowS");const D=j===void 0?Y(u):k.fromBytes(sr("sig",u),j);if(D===!1)return!1;try{const f=t.fromBytes(x);if(M&&D.hasHighS())return!1;const{r:p,s:R}=D,U=q(d),X=o.inv(R),fe=o.create(U*X),Ee=o.create(p*X),_e=t.BASE.multiplyUnsafe(fe).add(f.multiplyUnsafe(Ee));return _e.is0()?!1:o.create(_e.x)===p}catch{return!1}}function A(u,d,x={}){const{prehash:P}=Wc(x,b);return d=oe(d,P),k.fromBytes(u,"recovered").recoverPublicKey(d).toBytes()}return Object.freeze({keygen:l,getPublicKey:g,getSharedSecret:m,utils:I,lengths:_,Point:t,sign:W,verify:te,recoverPublicKey:A,Signature:k,hash:e})}function Gx(t){const e={a:t.a,b:t.b,p:t.Fp.ORDER,n:t.n,h:t.h,Gx:t.Gx,Gy:t.Gy},r=t.Fp;let n=t.allowedPrivateKeyLengths?Array.from(new Set(t.allowedPrivateKeyLengths.map(o=>Math.ceil(o/2)))):void 0;const s=ri(e.n,{BITS:t.nBitLength,allowedLengths:n,modFromBytes:t.wrapPrivateKey}),i={Fp:r,Fn:s,allowInfinityPoint:t.allowInfinityPoint,endo:t.endo,isTorsionFree:t.isTorsionFree,clearCofactor:t.clearCofactor,fromBytes:t.fromBytes,toBytes:t.toBytes};return{CURVE:e,curveOpts:i}}function Jx(t){const{CURVE:e,curveOpts:r}=Gx(t),n={hmac:t.hmac,randomBytes:t.randomBytes,lowS:t.lowS,bits2int:t.bits2int,bits2int_modN:t.bits2int_modN};return{CURVE:e,curveOpts:r,hash:t.hash,ecdsaOpts:n}}function Zx(t,e){const r=e.Point;return Object.assign({},e,{ProjectivePoint:r,CURVE:Object.assign({},t,hp(r.Fn.ORDER,r.Fn.BITS))})}function Yx(t){const{CURVE:e,curveOpts:r,hash:n,ecdsaOpts:s}=Jx(t),i=Wx(e,r),o=Hx(i,n,s);return Zx(t,o)}function Xx(t,e){const r=n=>Yx({...t,hash:n});return{...r(e),create:r}}const Ru={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},Qx={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},mh=BigInt(2);function e_(t){const e=Ru.p,r=BigInt(3),n=BigInt(6),s=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),l=t*t*t%e,g=l*l*t%e,m=nr(g,r,e)*g%e,I=nr(m,r,e)*g%e,_=nr(I,mh,e)*l%e,b=nr(_,s,e)*_%e,v=nr(b,i,e)*b%e,S=nr(v,a,e)*v%e,O=nr(S,c,e)*S%e,$=nr(O,a,e)*v%e,k=nr($,r,e)*g%e,Z=nr(k,o,e)*b%e,q=nr(Z,n,e)*l%e,J=nr(q,mh,e);if(!Ul.eql(Ul.sqr(J),t))throw new Error("Cannot find square root");return J}const Ul=ri(Ru.p,{sqrt:e_}),t_=Xx({...Ru,Fp:Ul,lowS:!0,endo:Qx},ep);Uo.utils.randomPrivateKey;Uo.getPublicKey;function yh(t){try{return Uo.ExtendedPoint.fromHex(t),!0}catch{return!1}}const Op=(t,e)=>Uo.sign(t,e.slice(0,32)),r_=Uo.verify,Fi=t=>je.Buffer.isBuffer(t)?t:t instanceof Uint8Array?je.Buffer.from(t.buffer,t.byteOffset,t.byteLength):je.Buffer.from(t);class n_{constructor(e){Object.assign(this,e)}encode(){return je.Buffer.from(Uc.serialize(fa,this))}static decode(e){return Uc.deserialize(fa,this,e)}static decodeUnchecked(e){return Uc.deserializeUnchecked(fa,this,e)}}const fa=new Map;var Mp;const s_=32,vs=32;function i_(t){return t._bn!==void 0}let bh=1;class Ge extends n_{constructor(e){if(super({}),this._bn=void 0,i_(e))this._bn=e._bn;else{if(typeof e=="string"){const r=Er.decode(e);if(r.length!=vs)throw new Error("Invalid public key input");this._bn=new ih(r)}else this._bn=new ih(e);if(this._bn.byteLength()>vs)throw new Error("Invalid public key input")}}static unique(){const e=new Ge(bh);return bh+=1,new Ge(e.toBuffer())}equals(e){return this._bn.eq(e._bn)}toBase58(){return Er.encode(this.toBytes())}toJSON(){return this.toBase58()}toBytes(){const e=this.toBuffer();return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}toBuffer(){const e=this._bn.toArrayLike(je.Buffer);if(e.length===vs)return e;const r=je.Buffer.alloc(32);return e.copy(r,32-e.length),r}get[Symbol.toStringTag](){return`PublicKey(${this.toString()})`}toString(){return this.toBase58()}static async createWithSeed(e,r,n){const s=je.Buffer.concat([e.toBuffer(),je.Buffer.from(r),n.toBuffer()]),i=lh(s);return new Ge(i)}static createProgramAddressSync(e,r){let n=je.Buffer.alloc(0);e.forEach(function(i){if(i.length>s_)throw new TypeError("Max seed length exceeded");n=je.Buffer.concat([n,Fi(i)])}),n=je.Buffer.concat([n,r.toBuffer(),je.Buffer.from("ProgramDerivedAddress")]);const s=lh(n);if(yh(s))throw new Error("Invalid seeds, address must fall off the curve");return new Ge(s)}static async createProgramAddress(e,r){return this.createProgramAddressSync(e,r)}static findProgramAddressSync(e,r){let n=255,s;for(;n!=0;){try{const i=e.concat(je.Buffer.from([n]));s=this.createProgramAddressSync(i,r)}catch(i){if(i instanceof TypeError)throw i;n--;continue}return[s,n]}throw new Error("Unable to find a viable program address nonce")}static async findProgramAddress(e,r){return this.findProgramAddressSync(e,r)}static isOnCurve(e){const r=new Ge(e);return yh(r.toBytes())}}Mp=Ge;Ge.default=new Mp("11111111111111111111111111111111");fa.set(Ge,{kind:"struct",fields:[["_bn","u256"]]});new Ge("BPFLoader1111111111111111111111111111111111");const Ri=1232,Bu=127,Pa=64;class Up extends Error{constructor(e){super(`Signature ${e} has expired: block height exceeded.`),this.signature=void 0,this.signature=e}}Object.defineProperty(Up.prototype,"name",{value:"TransactionExpiredBlockheightExceededError"});class Lp extends Error{constructor(e,r){super(`Transaction was not confirmed in ${r.toFixed(2)} seconds. It is unknown if it succeeded or failed. Check signature ${e} using the Solana Explorer or CLI tools.`),this.signature=void 0,this.signature=e}}Object.defineProperty(Lp.prototype,"name",{value:"TransactionExpiredTimeoutError"});class co extends Error{constructor(e){super(`Signature ${e} has expired: the nonce is no longer valid.`),this.signature=void 0,this.signature=e}}Object.defineProperty(co.prototype,"name",{value:"TransactionExpiredNonceInvalidError"});class Ca{constructor(e,r){this.staticAccountKeys=void 0,this.accountKeysFromLookups=void 0,this.staticAccountKeys=e,this.accountKeysFromLookups=r}keySegments(){const e=[this.staticAccountKeys];return this.accountKeysFromLookups&&(e.push(this.accountKeysFromLookups.writable),e.push(this.accountKeysFromLookups.readonly)),e}get(e){for(const r of this.keySegments()){if(e<r.length)return r[e];e-=r.length}}get length(){return this.keySegments().flat().length}compileInstructions(e){if(this.length>256)throw new Error("Account index overflow encountered during compilation");const n=new Map;this.keySegments().flat().forEach((i,o)=>{n.set(i.toBase58(),o)});const s=i=>{const o=n.get(i.toBase58());if(o===void 0)throw new Error("Encountered an unknown instruction account key during compilation");return o};return e.map(i=>({programIdIndex:s(i.programId),accountKeyIndexes:i.keys.map(o=>s(o.pubkey)),data:i.data}))}}const ht=(t="publicKey")=>G.blob(32,t),o_=(t="signature")=>G.blob(64,t),xi=(t="string")=>{const e=G.struct([G.u32("length"),G.u32("lengthPadding"),G.blob(G.offset(G.u32(),-8),"chars")],t),r=e.decode.bind(e),n=e.encode.bind(e),s=e;return s.decode=(i,o)=>r(i,o).chars.toString(),s.encode=(i,o,a)=>{const c={chars:je.Buffer.from(i,"utf8")};return n(c,o,a)},s.alloc=i=>G.u32().span+G.u32().span+je.Buffer.from(i,"utf8").length,s},a_=(t="authorized")=>G.struct([ht("staker"),ht("withdrawer")],t),c_=(t="lockup")=>G.struct([G.ns64("unixTimestamp"),G.ns64("epoch"),ht("custodian")],t),l_=(t="voteInit")=>G.struct([ht("nodePubkey"),ht("authorizedVoter"),ht("authorizedWithdrawer"),G.u8("commission")],t),u_=(t="voteAuthorizeWithSeedArgs")=>G.struct([G.u32("voteAuthorizationType"),ht("currentAuthorityDerivedKeyOwnerPubkey"),xi("currentAuthorityDerivedKeySeed"),ht("newAuthorized")],t);function Qr(t){let e=0,r=0;for(;;){let n=t.shift();if(e|=(n&127)<<r*7,r+=1,(n&128)===0)break}return e}function en(t,e){let r=e;for(;;){let n=r&127;if(r>>=7,r==0){t.push(n);break}else n|=128,t.push(n)}}function qt(t,e){if(!t)throw new Error(e||"Assertion failed")}class oc{constructor(e,r){this.payer=void 0,this.keyMetaMap=void 0,this.payer=e,this.keyMetaMap=r}static compile(e,r){const n=new Map,s=o=>{const a=o.toBase58();let c=n.get(a);return c===void 0&&(c={isSigner:!1,isWritable:!1,isInvoked:!1},n.set(a,c)),c},i=s(r);i.isSigner=!0,i.isWritable=!0;for(const o of e){s(o.programId).isInvoked=!0;for(const a of o.keys){const c=s(a.pubkey);c.isSigner||=a.isSigner,c.isWritable||=a.isWritable}}return new oc(r,n)}getMessageComponents(){const e=[...this.keyMetaMap.entries()];qt(e.length<=256,"Max static account keys length exceeded");const r=e.filter(([,c])=>c.isSigner&&c.isWritable),n=e.filter(([,c])=>c.isSigner&&!c.isWritable),s=e.filter(([,c])=>!c.isSigner&&c.isWritable),i=e.filter(([,c])=>!c.isSigner&&!c.isWritable),o={numRequiredSignatures:r.length+n.length,numReadonlySignedAccounts:n.length,numReadonlyUnsignedAccounts:i.length};{qt(r.length>0,"Expected at least one writable signer key");const[c]=r[0];qt(c===this.payer.toBase58(),"Expected first writable signer key to be the fee payer")}const a=[...r.map(([c])=>new Ge(c)),...n.map(([c])=>new Ge(c)),...s.map(([c])=>new Ge(c)),...i.map(([c])=>new Ge(c))];return[o,a]}extractTableLookup(e){const[r,n]=this.drainKeysFoundInLookupTable(e.state.addresses,o=>!o.isSigner&&!o.isInvoked&&o.isWritable),[s,i]=this.drainKeysFoundInLookupTable(e.state.addresses,o=>!o.isSigner&&!o.isInvoked&&!o.isWritable);if(!(r.length===0&&s.length===0))return[{accountKey:e.key,writableIndexes:r,readonlyIndexes:s},{writable:n,readonly:i}]}drainKeysFoundInLookupTable(e,r){const n=new Array,s=new Array;for(const[i,o]of this.keyMetaMap.entries())if(r(o)){const a=new Ge(i),c=e.findIndex(l=>l.equals(a));c>=0&&(qt(c<256,"Max lookup table index exceeded"),n.push(c),s.push(a),this.keyMetaMap.delete(i))}return[n,s]}}const Fp="Reached end of buffer unexpectedly";function Kn(t){if(t.length===0)throw new Error(Fp);return t.shift()}function tn(t,...e){const[r]=e;if(e.length===2?r+(e[1]??0)>t.length:r>=t.length)throw new Error(Fp);return t.splice(...e)}class Gn{constructor(e){this.header=void 0,this.accountKeys=void 0,this.recentBlockhash=void 0,this.instructions=void 0,this.indexToProgramIds=new Map,this.header=e.header,this.accountKeys=e.accountKeys.map(r=>new Ge(r)),this.recentBlockhash=e.recentBlockhash,this.instructions=e.instructions,this.instructions.forEach(r=>this.indexToProgramIds.set(r.programIdIndex,this.accountKeys[r.programIdIndex]))}get version(){return"legacy"}get staticAccountKeys(){return this.accountKeys}get compiledInstructions(){return this.instructions.map(e=>({programIdIndex:e.programIdIndex,accountKeyIndexes:e.accounts,data:Er.decode(e.data)}))}get addressTableLookups(){return[]}getAccountKeys(){return new Ca(this.staticAccountKeys)}static compile(e){const r=oc.compile(e.instructions,e.payerKey),[n,s]=r.getMessageComponents(),o=new Ca(s).compileInstructions(e.instructions).map(a=>({programIdIndex:a.programIdIndex,accounts:a.accountKeyIndexes,data:Er.encode(a.data)}));return new Gn({header:n,accountKeys:s,recentBlockhash:e.recentBlockhash,instructions:o})}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const r=this.header.numRequiredSignatures;if(e>=this.header.numRequiredSignatures){const n=e-r,i=this.accountKeys.length-r-this.header.numReadonlyUnsignedAccounts;return n<i}else{const n=r-this.header.numReadonlySignedAccounts;return e<n}}isProgramId(e){return this.indexToProgramIds.has(e)}programIds(){return[...this.indexToProgramIds.values()]}nonProgramIds(){return this.accountKeys.filter((e,r)=>!this.isProgramId(r))}serialize(){const e=this.accountKeys.length;let r=[];en(r,e);const n=this.instructions.map(m=>{const{accounts:I,programIdIndex:_}=m,b=Array.from(Er.decode(m.data));let v=[];en(v,I.length);let S=[];return en(S,b.length),{programIdIndex:_,keyIndicesCount:je.Buffer.from(v),keyIndices:I,dataLength:je.Buffer.from(S),data:b}});let s=[];en(s,n.length);let i=je.Buffer.alloc(Ri);je.Buffer.from(s).copy(i);let o=s.length;n.forEach(m=>{const _=G.struct([G.u8("programIdIndex"),G.blob(m.keyIndicesCount.length,"keyIndicesCount"),G.seq(G.u8("keyIndex"),m.keyIndices.length,"keyIndices"),G.blob(m.dataLength.length,"dataLength"),G.seq(G.u8("userdatum"),m.data.length,"data")]).encode(m,i,o);o+=_}),i=i.slice(0,o);const a=G.struct([G.blob(1,"numRequiredSignatures"),G.blob(1,"numReadonlySignedAccounts"),G.blob(1,"numReadonlyUnsignedAccounts"),G.blob(r.length,"keyCount"),G.seq(ht("key"),e,"keys"),ht("recentBlockhash")]),c={numRequiredSignatures:je.Buffer.from([this.header.numRequiredSignatures]),numReadonlySignedAccounts:je.Buffer.from([this.header.numReadonlySignedAccounts]),numReadonlyUnsignedAccounts:je.Buffer.from([this.header.numReadonlyUnsignedAccounts]),keyCount:je.Buffer.from(r),keys:this.accountKeys.map(m=>Fi(m.toBytes())),recentBlockhash:Er.decode(this.recentBlockhash)};let l=je.Buffer.alloc(2048);const g=a.encode(c,l);return i.copy(l,g),l.slice(0,g+i.length)}static from(e){let r=[...e];const n=Kn(r);if(n!==(n&Bu))throw new Error("Versioned messages must be deserialized with VersionedMessage.deserialize()");const s=Kn(r),i=Kn(r),o=Qr(r);let a=[];for(let I=0;I<o;I++){const _=tn(r,0,vs);a.push(new Ge(je.Buffer.from(_)))}const c=tn(r,0,vs),l=Qr(r);let g=[];for(let I=0;I<l;I++){const _=Kn(r),b=Qr(r),v=tn(r,0,b),S=Qr(r),O=tn(r,0,S),$=Er.encode(je.Buffer.from(O));g.push({programIdIndex:_,accounts:v,data:$})}const m={header:{numRequiredSignatures:n,numReadonlySignedAccounts:s,numReadonlyUnsignedAccounts:i},recentBlockhash:Er.encode(je.Buffer.from(c)),accountKeys:a,instructions:g};return new Gn(m)}}class Eo{constructor(e){this.header=void 0,this.staticAccountKeys=void 0,this.recentBlockhash=void 0,this.compiledInstructions=void 0,this.addressTableLookups=void 0,this.header=e.header,this.staticAccountKeys=e.staticAccountKeys,this.recentBlockhash=e.recentBlockhash,this.compiledInstructions=e.compiledInstructions,this.addressTableLookups=e.addressTableLookups}get version(){return 0}get numAccountKeysFromLookups(){let e=0;for(const r of this.addressTableLookups)e+=r.readonlyIndexes.length+r.writableIndexes.length;return e}getAccountKeys(e){let r;if(e&&"accountKeysFromLookups"in e&&e.accountKeysFromLookups){if(this.numAccountKeysFromLookups!=e.accountKeysFromLookups.writable.length+e.accountKeysFromLookups.readonly.length)throw new Error("Failed to get account keys because of a mismatch in the number of account keys from lookups");r=e.accountKeysFromLookups}else if(e&&"addressLookupTableAccounts"in e&&e.addressLookupTableAccounts)r=this.resolveAddressTableLookups(e.addressLookupTableAccounts);else if(this.addressTableLookups.length>0)throw new Error("Failed to get account keys because address table lookups were not resolved");return new Ca(this.staticAccountKeys,r)}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const r=this.header.numRequiredSignatures,n=this.staticAccountKeys.length;if(e>=n){const s=e-n,i=this.addressTableLookups.reduce((o,a)=>o+a.writableIndexes.length,0);return s<i}else if(e>=this.header.numRequiredSignatures){const s=e-r,o=n-r-this.header.numReadonlyUnsignedAccounts;return s<o}else{const s=r-this.header.numReadonlySignedAccounts;return e<s}}resolveAddressTableLookups(e){const r={writable:[],readonly:[]};for(const n of this.addressTableLookups){const s=e.find(i=>i.key.equals(n.accountKey));if(!s)throw new Error(`Failed to find address lookup table account for table key ${n.accountKey.toBase58()}`);for(const i of n.writableIndexes)if(i<s.state.addresses.length)r.writable.push(s.state.addresses[i]);else throw new Error(`Failed to find address for index ${i} in address lookup table ${n.accountKey.toBase58()}`);for(const i of n.readonlyIndexes)if(i<s.state.addresses.length)r.readonly.push(s.state.addresses[i]);else throw new Error(`Failed to find address for index ${i} in address lookup table ${n.accountKey.toBase58()}`)}return r}static compile(e){const r=oc.compile(e.instructions,e.payerKey),n=new Array,s={writable:new Array,readonly:new Array},i=e.addressLookupTableAccounts||[];for(const g of i){const m=r.extractTableLookup(g);if(m!==void 0){const[I,{writable:_,readonly:b}]=m;n.push(I),s.writable.push(..._),s.readonly.push(...b)}}const[o,a]=r.getMessageComponents(),l=new Ca(a,s).compileInstructions(e.instructions);return new Eo({header:o,staticAccountKeys:a,recentBlockhash:e.recentBlockhash,compiledInstructions:l,addressTableLookups:n})}serialize(){const e=Array();en(e,this.staticAccountKeys.length);const r=this.serializeInstructions(),n=Array();en(n,this.compiledInstructions.length);const s=this.serializeAddressTableLookups(),i=Array();en(i,this.addressTableLookups.length);const o=G.struct([G.u8("prefix"),G.struct([G.u8("numRequiredSignatures"),G.u8("numReadonlySignedAccounts"),G.u8("numReadonlyUnsignedAccounts")],"header"),G.blob(e.length,"staticAccountKeysLength"),G.seq(ht(),this.staticAccountKeys.length,"staticAccountKeys"),ht("recentBlockhash"),G.blob(n.length,"instructionsLength"),G.blob(r.length,"serializedInstructions"),G.blob(i.length,"addressTableLookupsLength"),G.blob(s.length,"serializedAddressTableLookups")]),a=new Uint8Array(Ri),l=o.encode({prefix:128,header:this.header,staticAccountKeysLength:new Uint8Array(e),staticAccountKeys:this.staticAccountKeys.map(g=>g.toBytes()),recentBlockhash:Er.decode(this.recentBlockhash),instructionsLength:new Uint8Array(n),serializedInstructions:r,addressTableLookupsLength:new Uint8Array(i),serializedAddressTableLookups:s},a);return a.slice(0,l)}serializeInstructions(){let e=0;const r=new Uint8Array(Ri);for(const n of this.compiledInstructions){const s=Array();en(s,n.accountKeyIndexes.length);const i=Array();en(i,n.data.length);const o=G.struct([G.u8("programIdIndex"),G.blob(s.length,"encodedAccountKeyIndexesLength"),G.seq(G.u8(),n.accountKeyIndexes.length,"accountKeyIndexes"),G.blob(i.length,"encodedDataLength"),G.blob(n.data.length,"data")]);e+=o.encode({programIdIndex:n.programIdIndex,encodedAccountKeyIndexesLength:new Uint8Array(s),accountKeyIndexes:n.accountKeyIndexes,encodedDataLength:new Uint8Array(i),data:n.data},r,e)}return r.slice(0,e)}serializeAddressTableLookups(){let e=0;const r=new Uint8Array(Ri);for(const n of this.addressTableLookups){const s=Array();en(s,n.writableIndexes.length);const i=Array();en(i,n.readonlyIndexes.length);const o=G.struct([ht("accountKey"),G.blob(s.length,"encodedWritableIndexesLength"),G.seq(G.u8(),n.writableIndexes.length,"writableIndexes"),G.blob(i.length,"encodedReadonlyIndexesLength"),G.seq(G.u8(),n.readonlyIndexes.length,"readonlyIndexes")]);e+=o.encode({accountKey:n.accountKey.toBytes(),encodedWritableIndexesLength:new Uint8Array(s),writableIndexes:n.writableIndexes,encodedReadonlyIndexesLength:new Uint8Array(i),readonlyIndexes:n.readonlyIndexes},r,e)}return r.slice(0,e)}static deserialize(e){let r=[...e];const n=Kn(r),s=n&Bu;qt(n!==s,"Expected versioned message but received legacy message");const i=s;qt(i===0,`Expected versioned message with version 0 but found version ${i}`);const o={numRequiredSignatures:Kn(r),numReadonlySignedAccounts:Kn(r),numReadonlyUnsignedAccounts:Kn(r)},a=[],c=Qr(r);for(let b=0;b<c;b++)a.push(new Ge(tn(r,0,vs)));const l=Er.encode(tn(r,0,vs)),g=Qr(r),m=[];for(let b=0;b<g;b++){const v=Kn(r),S=Qr(r),O=tn(r,0,S),$=Qr(r),k=new Uint8Array(tn(r,0,$));m.push({programIdIndex:v,accountKeyIndexes:O,data:k})}const I=Qr(r),_=[];for(let b=0;b<I;b++){const v=new Ge(tn(r,0,vs)),S=Qr(r),O=tn(r,0,S),$=Qr(r),k=tn(r,0,$);_.push({accountKey:v,writableIndexes:O,readonlyIndexes:k})}return new Eo({header:o,staticAccountKeys:a,recentBlockhash:l,compiledInstructions:m,addressTableLookups:_})}}const $p={deserializeMessageVersion(t){const e=t[0],r=e&Bu;return r===e?"legacy":r},deserialize:t=>{const e=$p.deserializeMessageVersion(t);if(e==="legacy")return Gn.from(t);if(e===0)return Eo.deserialize(t);throw new Error(`Transaction message version ${e} deserialization is not supported`)}};let ls=(function(t){return t[t.BLOCKHEIGHT_EXCEEDED=0]="BLOCKHEIGHT_EXCEEDED",t[t.PROCESSED=1]="PROCESSED",t[t.TIMED_OUT=2]="TIMED_OUT",t[t.NONCE_INVALID=3]="NONCE_INVALID",t})({});const f_=je.Buffer.alloc(Pa).fill(0);class vh{constructor(e){this.keys=void 0,this.programId=void 0,this.data=je.Buffer.alloc(0),this.programId=e.programId,this.keys=e.keys,e.data&&(this.data=e.data)}toJSON(){return{keys:this.keys.map(({pubkey:e,isSigner:r,isWritable:n})=>({pubkey:e.toJSON(),isSigner:r,isWritable:n})),programId:this.programId.toJSON(),data:[...this.data]}}}class zn{get signature(){return this.signatures.length>0?this.signatures[0].signature:null}constructor(e){if(this.signatures=[],this.feePayer=void 0,this.instructions=[],this.recentBlockhash=void 0,this.lastValidBlockHeight=void 0,this.nonceInfo=void 0,this.minNonceContextSlot=void 0,this._message=void 0,this._json=void 0,!!e)if(e.feePayer&&(this.feePayer=e.feePayer),e.signatures&&(this.signatures=e.signatures),Object.prototype.hasOwnProperty.call(e,"nonceInfo")){const{minContextSlot:r,nonceInfo:n}=e;this.minNonceContextSlot=r,this.nonceInfo=n}else if(Object.prototype.hasOwnProperty.call(e,"lastValidBlockHeight")){const{blockhash:r,lastValidBlockHeight:n}=e;this.recentBlockhash=r,this.lastValidBlockHeight=n}else{const{recentBlockhash:r,nonceInfo:n}=e;n&&(this.nonceInfo=n),this.recentBlockhash=r}}toJSON(){return{recentBlockhash:this.recentBlockhash||null,feePayer:this.feePayer?this.feePayer.toJSON():null,nonceInfo:this.nonceInfo?{nonce:this.nonceInfo.nonce,nonceInstruction:this.nonceInfo.nonceInstruction.toJSON()}:null,instructions:this.instructions.map(e=>e.toJSON()),signers:this.signatures.map(({publicKey:e})=>e.toJSON())}}add(...e){if(e.length===0)throw new Error("No instructions");return e.forEach(r=>{"instructions"in r?this.instructions=this.instructions.concat(r.instructions):"data"in r&&"programId"in r&&"keys"in r?this.instructions.push(r):this.instructions.push(new vh(r))}),this}compileMessage(){if(this._message&&JSON.stringify(this.toJSON())===JSON.stringify(this._json))return this._message;let e,r;if(this.nonceInfo?(e=this.nonceInfo.nonce,this.instructions[0]!=this.nonceInfo.nonceInstruction?r=[this.nonceInfo.nonceInstruction,...this.instructions]:r=this.instructions):(e=this.recentBlockhash,r=this.instructions),!e)throw new Error("Transaction recentBlockhash required");r.length<1&&console.warn("No instructions provided");let n;if(this.feePayer)n=this.feePayer;else if(this.signatures.length>0&&this.signatures[0].publicKey)n=this.signatures[0].publicKey;else throw new Error("Transaction fee payer required");for(let v=0;v<r.length;v++)if(r[v].programId===void 0)throw new Error(`Transaction instruction index ${v} has undefined program id`);const s=[],i=[];r.forEach(v=>{v.keys.forEach(O=>{i.push({...O})});const S=v.programId.toString();s.includes(S)||s.push(S)}),s.forEach(v=>{i.push({pubkey:new Ge(v),isSigner:!1,isWritable:!1})});const o=[];i.forEach(v=>{const S=v.pubkey.toString(),O=o.findIndex($=>$.pubkey.toString()===S);O>-1?(o[O].isWritable=o[O].isWritable||v.isWritable,o[O].isSigner=o[O].isSigner||v.isSigner):o.push(v)}),o.sort(function(v,S){if(v.isSigner!==S.isSigner)return v.isSigner?-1:1;if(v.isWritable!==S.isWritable)return v.isWritable?-1:1;const O={localeMatcher:"best fit",usage:"sort",sensitivity:"variant",ignorePunctuation:!1,numeric:!1,caseFirst:"lower"};return v.pubkey.toBase58().localeCompare(S.pubkey.toBase58(),"en",O)});const a=o.findIndex(v=>v.pubkey.equals(n));if(a>-1){const[v]=o.splice(a,1);v.isSigner=!0,v.isWritable=!0,o.unshift(v)}else o.unshift({pubkey:n,isSigner:!0,isWritable:!0});for(const v of this.signatures){const S=o.findIndex(O=>O.pubkey.equals(v.publicKey));if(S>-1)o[S].isSigner||(o[S].isSigner=!0,console.warn("Transaction references a signature that is unnecessary, only the fee payer and instruction signer accounts should sign a transaction. This behavior is deprecated and will throw an error in the next major version release."));else throw new Error(`unknown signer: ${v.publicKey.toString()}`)}let c=0,l=0,g=0;const m=[],I=[];o.forEach(({pubkey:v,isSigner:S,isWritable:O})=>{S?(m.push(v.toString()),c+=1,O||(l+=1)):(I.push(v.toString()),O||(g+=1))});const _=m.concat(I),b=r.map(v=>{const{data:S,programId:O}=v;return{programIdIndex:_.indexOf(O.toString()),accounts:v.keys.map($=>_.indexOf($.pubkey.toString())),data:Er.encode(S)}});return b.forEach(v=>{qt(v.programIdIndex>=0),v.accounts.forEach(S=>qt(S>=0))}),new Gn({header:{numRequiredSignatures:c,numReadonlySignedAccounts:l,numReadonlyUnsignedAccounts:g},accountKeys:_,recentBlockhash:e,instructions:b})}_compile(){const e=this.compileMessage(),r=e.accountKeys.slice(0,e.header.numRequiredSignatures);return this.signatures.length===r.length&&this.signatures.every((s,i)=>r[i].equals(s.publicKey))||(this.signatures=r.map(n=>({signature:null,publicKey:n}))),e}serializeMessage(){return this._compile().serialize()}async getEstimatedFee(e){return(await e.getFeeForMessage(this.compileMessage())).value}setSigners(...e){if(e.length===0)throw new Error("No signers");const r=new Set;this.signatures=e.filter(n=>{const s=n.toString();return r.has(s)?!1:(r.add(s),!0)}).map(n=>({signature:null,publicKey:n}))}sign(...e){if(e.length===0)throw new Error("No signers");const r=new Set,n=[];for(const i of e){const o=i.publicKey.toString();r.has(o)||(r.add(o),n.push(i))}this.signatures=n.map(i=>({signature:null,publicKey:i.publicKey}));const s=this._compile();this._partialSign(s,...n)}partialSign(...e){if(e.length===0)throw new Error("No signers");const r=new Set,n=[];for(const i of e){const o=i.publicKey.toString();r.has(o)||(r.add(o),n.push(i))}const s=this._compile();this._partialSign(s,...n)}_partialSign(e,...r){const n=e.serialize();r.forEach(s=>{const i=Op(n,s.secretKey);this._addSignature(s.publicKey,Fi(i))})}addSignature(e,r){this._compile(),this._addSignature(e,r)}_addSignature(e,r){qt(r.length===64);const n=this.signatures.findIndex(s=>e.equals(s.publicKey));if(n<0)throw new Error(`unknown signer: ${e.toString()}`);this.signatures[n].signature=je.Buffer.from(r)}verifySignatures(e=!0){return!this._getMessageSignednessErrors(this.serializeMessage(),e)}_getMessageSignednessErrors(e,r){const n={};for(const{signature:s,publicKey:i}of this.signatures)s===null?r&&(n.missing||=[]).push(i):r_(s,e,i.toBytes())||(n.invalid||=[]).push(i);return n.invalid||n.missing?n:void 0}serialize(e){const{requireAllSignatures:r,verifySignatures:n}=Object.assign({requireAllSignatures:!0,verifySignatures:!0},e),s=this.serializeMessage();if(n){const i=this._getMessageSignednessErrors(s,r);if(i){let o="Signature verification failed.";throw i.invalid&&(o+=`
Invalid signature for public key${i.invalid.length===1?"":"(s)"} [\`${i.invalid.map(a=>a.toBase58()).join("`, `")}\`].`),i.missing&&(o+=`
Missing signature for public key${i.missing.length===1?"":"(s)"} [\`${i.missing.map(a=>a.toBase58()).join("`, `")}\`].`),new Error(o)}}return this._serialize(s)}_serialize(e){const{signatures:r}=this,n=[];en(n,r.length);const s=n.length+r.length*64+e.length,i=je.Buffer.alloc(s);return qt(r.length<256),je.Buffer.from(n).copy(i,0),r.forEach(({signature:o},a)=>{o!==null&&(qt(o.length===64,"signature has invalid length"),je.Buffer.from(o).copy(i,n.length+a*64))}),e.copy(i,n.length+r.length*64),qt(i.length<=Ri,`Transaction too large: ${i.length} > ${Ri}`),i}get keys(){return qt(this.instructions.length===1),this.instructions[0].keys.map(e=>e.pubkey)}get programId(){return qt(this.instructions.length===1),this.instructions[0].programId}get data(){return qt(this.instructions.length===1),this.instructions[0].data}static from(e){let r=[...e];const n=Qr(r);let s=[];for(let i=0;i<n;i++){const o=tn(r,0,Pa);s.push(Er.encode(je.Buffer.from(o)))}return zn.populate(Gn.from(r),s)}static populate(e,r=[]){const n=new zn;return n.recentBlockhash=e.recentBlockhash,e.header.numRequiredSignatures>0&&(n.feePayer=e.accountKeys[0]),r.forEach((s,i)=>{const o={signature:s==Er.encode(f_)?null:Er.decode(s),publicKey:e.accountKeys[i]};n.signatures.push(o)}),e.instructions.forEach(s=>{const i=s.accounts.map(o=>{const a=e.accountKeys[o];return{pubkey:a,isSigner:n.signatures.some(c=>c.publicKey.toString()===a.toString())||e.isAccountSigner(o),isWritable:e.isAccountWritable(o)}});n.instructions.push(new vh({keys:i,programId:e.accountKeys[s.programIdIndex],data:Er.decode(s.data)}))}),n._message=e,n._json=n.toJSON(),n}}class Tu{get version(){return this.message.version}constructor(e,r){if(this.signatures=void 0,this.message=void 0,r!==void 0)qt(r.length===e.header.numRequiredSignatures,"Expected signatures length to be equal to the number of required signatures"),this.signatures=r;else{const n=[];for(let s=0;s<e.header.numRequiredSignatures;s++)n.push(new Uint8Array(Pa));this.signatures=n}this.message=e}serialize(){const e=this.message.serialize(),r=Array();en(r,this.signatures.length);const n=G.struct([G.blob(r.length,"encodedSignaturesLength"),G.seq(o_(),this.signatures.length,"signatures"),G.blob(e.length,"serializedMessage")]),s=new Uint8Array(2048),i=n.encode({encodedSignaturesLength:new Uint8Array(r),signatures:this.signatures,serializedMessage:e},s);return s.slice(0,i)}static deserialize(e){let r=[...e];const n=[],s=Qr(r);for(let o=0;o<s;o++)n.push(new Uint8Array(tn(r,0,Pa)));const i=$p.deserialize(new Uint8Array(r));return new Tu(i,n)}sign(e){const r=this.message.serialize(),n=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures);for(const s of e){const i=n.findIndex(o=>o.equals(s.publicKey));qt(i>=0,`Cannot sign with non signer key ${s.publicKey.toBase58()}`),this.signatures[i]=Op(r,s.secretKey)}}addSignature(e,r){qt(r.byteLength===64,"Signature must be 64 bytes long");const s=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures).findIndex(i=>i.equals(e));qt(s>=0,`Can not add signature; \`${e.toBase58()}\` is not required to sign this transaction`),this.signatures[s]=r}}const h_=160,d_=64,p_=h_/d_,g_=1e3/p_;new Ge("SysvarC1ock11111111111111111111111111111111");new Ge("SysvarEpochSchedu1e111111111111111111111111");new Ge("Sysvar1nstructions1111111111111111111111111");new Ge("SysvarRecentB1ockHashes11111111111111111111");new Ge("SysvarRent111111111111111111111111111111111");new Ge("SysvarRewards111111111111111111111111111111");new Ge("SysvarS1otHashes111111111111111111111111111");new Ge("SysvarS1otHistory11111111111111111111111111");new Ge("SysvarStakeHistory1111111111111111111111111");class Eh extends Error{constructor({action:e,signature:r,transactionMessage:n,logs:s}){const i=s?`Logs: 
${JSON.stringify(s.slice(-10),null,2)}. `:"",o="\nCatch the `SendTransactionError` and call `getLogs()` on it for full details.";let a;switch(e){case"send":a=`Transaction ${r} resulted in an error. 
${n}. `+i+o;break;case"simulate":a=`Simulation failed. 
Message: ${n}. 
`+i+o;break;default:a=`Unknown action '${(c=>c)(e)}'`}super(a),this.signature=void 0,this.transactionMessage=void 0,this.transactionLogs=void 0,this.signature=r,this.transactionMessage=n,this.transactionLogs=s||void 0}get transactionError(){return{message:this.transactionMessage,logs:Array.isArray(this.transactionLogs)?this.transactionLogs:void 0}}get logs(){const e=this.transactionLogs;if(!(e!=null&&typeof e=="object"&&"then"in e))return e}async getLogs(e){return Array.isArray(this.transactionLogs)||(this.transactionLogs=new Promise((r,n)=>{e.getTransaction(this.signature).then(s=>{if(s&&s.meta&&s.meta.logMessages){const i=s.meta.logMessages;this.transactionLogs=i,r(i)}else n(new Error("Log messages not found"))}).catch(n)})),await this.transactionLogs}}class Me extends Error{constructor({code:e,message:r,data:n},s){super(s!=null?`${s}: ${r}`:r),this.code=void 0,this.data=void 0,this.code=e,this.data=n,this.name="SolanaJSONRPCError"}}function gi(t){return new Promise(e=>setTimeout(e,t))}const w_=G.nu64("lamportsPerSignature"),Kp=G.struct([G.u32("version"),G.u32("state"),ht("authorizedPubkey"),ht("nonce"),G.struct([w_],"feeCalculator")]);Kp.span;class Pu{constructor(e){this.authorizedPubkey=void 0,this.nonce=void 0,this.feeCalculator=void 0,this.authorizedPubkey=e.authorizedPubkey,this.nonce=e.nonce,this.feeCalculator=e.feeCalculator}static fromAccountData(e){const r=Kp.decode(Fi(e),0);return new Pu({authorizedPubkey:new Ge(r.authorizedPubkey),nonce:new Ge(r.nonce).toString(),feeCalculator:r.feeCalculator})}}function $i(t){const e=G.blob(8,t),r=e.decode.bind(e),n=e.encode.bind(e),s=e,i=X1();return s.decode=(o,a)=>{const c=r(o,a);return i.decode(c)},s.encode=(o,a,c)=>{const l=i.encode(o);return n(l,a,c)},s}Object.freeze({Create:{index:0,layout:G.struct([G.u32("instruction"),G.ns64("lamports"),G.ns64("space"),ht("programId")])},Assign:{index:1,layout:G.struct([G.u32("instruction"),ht("programId")])},Transfer:{index:2,layout:G.struct([G.u32("instruction"),$i("lamports")])},CreateWithSeed:{index:3,layout:G.struct([G.u32("instruction"),ht("base"),xi("seed"),G.ns64("lamports"),G.ns64("space"),ht("programId")])},AdvanceNonceAccount:{index:4,layout:G.struct([G.u32("instruction")])},WithdrawNonceAccount:{index:5,layout:G.struct([G.u32("instruction"),G.ns64("lamports")])},InitializeNonceAccount:{index:6,layout:G.struct([G.u32("instruction"),ht("authorized")])},AuthorizeNonceAccount:{index:7,layout:G.struct([G.u32("instruction"),ht("authorized")])},Allocate:{index:8,layout:G.struct([G.u32("instruction"),G.ns64("space")])},AllocateWithSeed:{index:9,layout:G.struct([G.u32("instruction"),ht("base"),xi("seed"),G.ns64("space"),ht("programId")])},AssignWithSeed:{index:10,layout:G.struct([G.u32("instruction"),ht("base"),xi("seed"),ht("programId")])},TransferWithSeed:{index:11,layout:G.struct([G.u32("instruction"),$i("lamports"),xi("seed"),ht("programId")])},UpgradeNonceAccount:{index:12,layout:G.struct([G.u32("instruction")])}});new Ge("11111111111111111111111111111111");new Ge("BPFLoader2111111111111111111111111111111111");function m_(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var jc,xh;function y_(){if(xh)return jc;xh=1;var t=Object.prototype.toString,e=Object.keys||function(n){var s=[];for(var i in n)s.push(i);return s};function r(n,s){var i,o,a,c,l,g,m;if(n===!0)return"true";if(n===!1)return"false";switch(typeof n){case"object":if(n===null)return null;if(n.toJSON&&typeof n.toJSON=="function")return r(n.toJSON(),s);if(m=t.call(n),m==="[object Array]"){for(a="[",o=n.length-1,i=0;i<o;i++)a+=r(n[i],!0)+",";return o>-1&&(a+=r(n[i],!0)),a+"]"}else if(m==="[object Object]"){for(c=e(n).sort(),o=c.length,a="",i=0;i<o;)l=c[i],g=r(n[l],!1),g!==void 0&&(a&&(a+=","),a+=JSON.stringify(l)+":"+g),i++;return"{"+a+"}"}else return JSON.stringify(n);case"function":case"undefined":return s?null:void 0;case"string":return JSON.stringify(n);default:return isFinite(n)?n:null}}return jc=function(n){var s=r(n,!1);if(s!==void 0)return""+s},jc}var b_=y_(),_h=m_(b_);const io=32;function Hc(t){let e=0;for(;t>1;)t/=2,e++;return e}function v_(t){return t===0?1:(t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t|=t>>32,t+1)}class E_{constructor(e,r,n,s,i){this.slotsPerEpoch=void 0,this.leaderScheduleSlotOffset=void 0,this.warmup=void 0,this.firstNormalEpoch=void 0,this.firstNormalSlot=void 0,this.slotsPerEpoch=e,this.leaderScheduleSlotOffset=r,this.warmup=n,this.firstNormalEpoch=s,this.firstNormalSlot=i}getEpoch(e){return this.getEpochAndSlotIndex(e)[0]}getEpochAndSlotIndex(e){if(e<this.firstNormalSlot){const r=Hc(v_(e+io+1))-Hc(io)-1,n=this.getSlotsInEpoch(r),s=e-(n-io);return[r,s]}else{const r=e-this.firstNormalSlot,n=Math.floor(r/this.slotsPerEpoch),s=this.firstNormalEpoch+n,i=r%this.slotsPerEpoch;return[s,i]}}getFirstSlotInEpoch(e){return e<=this.firstNormalEpoch?(Math.pow(2,e)-1)*io:(e-this.firstNormalEpoch)*this.slotsPerEpoch+this.firstNormalSlot}getLastSlotInEpoch(e){return this.getFirstSlotInEpoch(e)+this.getSlotsInEpoch(e)-1}getSlotsInEpoch(e){return e<this.firstNormalEpoch?Math.pow(2,e+Hc(io)):this.slotsPerEpoch}}var x_=globalThis.fetch;class __ extends Kx{constructor(e,r,n){const s=i=>{const o=Fx(i,{autoconnect:!0,max_reconnects:5,reconnect:!0,reconnect_interval:1e3,...r});return"socket"in o?this.underlyingSocket=o.socket:this.underlyingSocket=o,o};super(s,e,r,n),this.underlyingSocket=void 0}call(...e){const r=this.underlyingSocket?.readyState;return r===1?super.call(...e):Promise.reject(new Error("Tried to call a JSON-RPC method `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+r+")"))}notify(...e){const r=this.underlyingSocket?.readyState;return r===1?super.notify(...e):Promise.reject(new Error("Tried to send a JSON-RPC notification `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+r+")"))}}function I_(t,e){let r;try{r=t.layout.decode(e)}catch(n){throw new Error("invalid instruction; "+n)}if(r.typeIndex!==t.index)throw new Error(`invalid account data; account type mismatch ${r.typeIndex} != ${t.index}`);return r}const Ih=56;class Sh{constructor(e){this.key=void 0,this.state=void 0,this.key=e.key,this.state=e.state}isActive(){const e=BigInt("0xffffffffffffffff");return this.state.deactivationSlot===e}static deserialize(e){const r=I_(S_,e),n=e.length-Ih;qt(n>=0,"lookup table is invalid"),qt(n%32===0,"lookup table is invalid");const s=n/32,{addresses:i}=G.struct([G.seq(ht(),s,"addresses")]).decode(e.slice(Ih));return{deactivationSlot:r.deactivationSlot,lastExtendedSlot:r.lastExtendedSlot,lastExtendedSlotStartIndex:r.lastExtendedStartIndex,authority:r.authority.length!==0?new Ge(r.authority[0]):void 0,addresses:i.map(o=>new Ge(o))}}}const S_={index:1,layout:G.struct([G.u32("typeIndex"),$i("deactivationSlot"),G.nu64("lastExtendedSlot"),G.u8("lastExtendedStartIndex"),G.u8(),G.seq(ht(),G.offset(G.u8(),-1),"authority")])},A_=/^[^:]+:\/\/([^:[]+|\[[^\]]+\])(:\d+)?(.*)/i;function R_(t){const e=t.match(A_);if(e==null)throw TypeError(`Failed to validate endpoint URL \`${t}\``);const[r,n,s,i]=e,o=t.startsWith("https:")?"wss:":"ws:",a=s==null?null:parseInt(s.slice(1),10),c=a==null?"":`:${a+1}`;return`${o}//${n}${c}${i}`}const Jt=$o(Su(Ge),xe(),t=>new Ge(t)),zp=Au([xe(),Ht("base64")]),Cu=$o(Su(je.Buffer),zp,t=>je.Buffer.from(t[0],"base64")),B_=30*1e3;function T_(t){if(/^https?:/.test(t)===!1)throw new TypeError("Endpoint URL must start with `http:` or `https:`.");return t}function Lt(t){let e,r;if(typeof t=="string")e=t;else if(t){const{commitment:n,...s}=t;e=n,r=s}return{commitment:e,config:r}}function Ah(t){return t.map(e=>"memcmp"in e?{...e,memcmp:{...e.memcmp,encoding:e.memcmp.encoding??"base58"}}:e)}function Vp(t){return Kr([me({jsonrpc:Ht("2.0"),id:xe(),result:t}),me({jsonrpc:Ht("2.0"),id:xe(),error:me({code:Zi(),message:xe(),data:Le(dx())})})])}const P_=Vp(Zi());function at(t){return $o(Vp(t),P_,e=>"error"in e?e:{...e,result:Se(e.result,t)})}function ar(t){return at(me({context:me({slot:ie()}),value:t}))}function ac(t){return me({context:me({slot:ie()}),value:t})}function Gc(t,e){return t===0?new Eo({header:e.header,staticAccountKeys:e.accountKeys.map(r=>new Ge(r)),recentBlockhash:e.recentBlockhash,compiledInstructions:e.instructions.map(r=>({programIdIndex:r.programIdIndex,accountKeyIndexes:r.accounts,data:Er.decode(r.data)})),addressTableLookups:e.addressTableLookups}):new Gn(e)}const C_=me({foundation:ie(),foundationTerm:ie(),initial:ie(),taper:ie(),terminal:ie()}),D_=at(Re(Te(me({epoch:ie(),effectiveSlot:ie(),amount:ie(),postBalance:ie(),commission:Le(Te(ie()))})))),k_=Re(me({slot:ie(),prioritizationFee:ie()})),N_=me({total:ie(),validator:ie(),foundation:ie(),epoch:ie()}),O_=me({epoch:ie(),slotIndex:ie(),slotsInEpoch:ie(),absoluteSlot:ie(),blockHeight:Le(ie()),transactionCount:Le(ie())}),M_=me({slotsPerEpoch:ie(),leaderScheduleSlotOffset:ie(),warmup:Rn(),firstNormalEpoch:ie(),firstNormalSlot:ie()}),U_=Ip(xe(),Re(ie())),si=Te(Kr([me({}),xe()])),L_=me({err:si}),F_=Ht("receivedSignature"),$_=me({"solana-core":xe(),"feature-set":Le(ie())}),K_=me({program:xe(),programId:Jt,parsed:Zi()}),z_=me({programId:Jt,accounts:Re(Jt),data:xe()}),Rh=ar(me({err:Te(Kr([me({}),xe()])),logs:Te(Re(xe())),accounts:Le(Te(Re(Te(me({executable:Rn(),owner:xe(),lamports:ie(),data:Re(xe()),rentEpoch:Le(ie())}))))),unitsConsumed:Le(ie()),returnData:Le(Te(me({programId:xe(),data:Au([xe(),Ht("base64")])}))),innerInstructions:Le(Te(Re(me({index:ie(),instructions:Re(Kr([K_,z_]))}))))})),V_=ar(me({byIdentity:Ip(xe(),Re(ie())),range:me({firstSlot:ie(),lastSlot:ie()})}));function q_(t,e,r,n,s,i){const o=r||x_;let a;i!=null&&console.warn("You have supplied an `httpAgent` when creating a `Connection` in a browser environment.It has been ignored; `httpAgent` is only used in Node environments.");let c;return n&&(c=async(g,m)=>{const I=await new Promise((_,b)=>{try{n(g,m,(v,S)=>_([v,S]))}catch(v){b(v)}});return await o(...I)}),new Ux(async(g,m)=>{const I={method:"POST",body:g,agent:a,headers:Object.assign({"Content-Type":"application/json"},e||{},q2)};try{let _=5,b,v=500;for(;c?b=await c(t,I):b=await o(t,I),!(b.status!==429||s===!0||(_-=1,_===0));)console.error(`Server responded with ${b.status} ${b.statusText}.  Retrying after ${v}ms delay...`),await gi(v),v*=2;const S=await b.text();b.ok?m(null,S):m(new Error(`${b.status} ${b.statusText}: ${S}`))}catch(_){_ instanceof Error&&m(_)}},{})}function W_(t){return(e,r)=>new Promise((n,s)=>{t.request(e,r,(i,o)=>{if(i){s(i);return}n(o)})})}function j_(t){return e=>new Promise((r,n)=>{e.length===0&&r([]);const s=e.map(i=>t.request(i.methodName,i.args));t.request(s,(i,o)=>{if(i){n(i);return}r(o)})})}const H_=at(C_),G_=at(N_),J_=at(k_),Z_=at(O_),Y_=at(M_),X_=at(U_),Q_=at(ie()),e2=ar(me({total:ie(),circulating:ie(),nonCirculating:ie(),nonCirculatingAccounts:Re(Jt)})),Ll=me({amount:xe(),uiAmount:Te(ie()),decimals:ie(),uiAmountString:Le(xe())}),t2=ar(Re(me({address:Jt,amount:xe(),uiAmount:Te(ie()),decimals:ie(),uiAmountString:Le(xe())}))),r2=ar(Re(me({pubkey:Jt,account:me({executable:Rn(),owner:Jt,lamports:ie(),data:Cu,rentEpoch:ie()})}))),Fl=me({program:xe(),parsed:Zi(),space:ie()}),n2=ar(Re(me({pubkey:Jt,account:me({executable:Rn(),owner:Jt,lamports:ie(),data:Fl,rentEpoch:ie()})}))),s2=ar(Re(me({lamports:ie(),address:Jt}))),xo=me({executable:Rn(),owner:Jt,lamports:ie(),data:Cu,rentEpoch:ie()}),i2=me({pubkey:Jt,account:xo}),o2=$o(Kr([Su(je.Buffer),Fl]),Kr([zp,Fl]),t=>Array.isArray(t)?Se(t,Cu):t),$l=me({executable:Rn(),owner:Jt,lamports:ie(),data:o2,rentEpoch:ie()}),a2=me({pubkey:Jt,account:$l}),c2=me({state:Kr([Ht("active"),Ht("inactive"),Ht("activating"),Ht("deactivating")]),active:ie(),inactive:ie()}),l2=at(Re(me({signature:xe(),slot:ie(),err:si,memo:Te(xe()),blockTime:Le(Te(ie()))}))),u2=at(Re(me({signature:xe(),slot:ie(),err:si,memo:Te(xe()),blockTime:Le(Te(ie()))}))),f2=me({subscription:ie(),result:ac(xo)}),h2=me({pubkey:Jt,account:xo}),d2=me({subscription:ie(),result:ac(h2)}),p2=me({parent:ie(),slot:ie(),root:ie()}),g2=me({subscription:ie(),result:p2}),w2=Kr([me({type:Kr([Ht("firstShredReceived"),Ht("completed"),Ht("optimisticConfirmation"),Ht("root")]),slot:ie(),timestamp:ie()}),me({type:Ht("createdBank"),parent:ie(),slot:ie(),timestamp:ie()}),me({type:Ht("frozen"),slot:ie(),timestamp:ie(),stats:me({numTransactionEntries:ie(),numSuccessfulTransactions:ie(),numFailedTransactions:ie(),maxTransactionsPerEntry:ie()})}),me({type:Ht("dead"),slot:ie(),timestamp:ie(),err:xe()})]),m2=me({subscription:ie(),result:w2}),y2=me({subscription:ie(),result:ac(Kr([L_,F_]))}),b2=me({subscription:ie(),result:ie()}),v2=me({pubkey:xe(),gossip:Te(xe()),tpu:Te(xe()),rpc:Te(xe()),version:Te(xe())}),Bh=me({votePubkey:xe(),nodePubkey:xe(),activatedStake:ie(),epochVoteAccount:Rn(),epochCredits:Re(Au([ie(),ie(),ie()])),commission:ie(),lastVote:ie(),rootSlot:Te(ie())}),E2=at(me({current:Re(Bh),delinquent:Re(Bh)})),x2=Kr([Ht("processed"),Ht("confirmed"),Ht("finalized")]),_2=me({slot:ie(),confirmations:Te(ie()),err:si,confirmationStatus:Le(x2)}),I2=ar(Re(Te(_2))),S2=at(ie()),qp=me({accountKey:Jt,writableIndexes:Re(ie()),readonlyIndexes:Re(ie())}),Du=me({signatures:Re(xe()),message:me({accountKeys:Re(xe()),header:me({numRequiredSignatures:ie(),numReadonlySignedAccounts:ie(),numReadonlyUnsignedAccounts:ie()}),instructions:Re(me({accounts:Re(ie()),data:xe(),programIdIndex:ie()})),recentBlockhash:xe(),addressTableLookups:Le(Re(qp))})}),Wp=me({pubkey:Jt,signer:Rn(),writable:Rn(),source:Le(Kr([Ht("transaction"),Ht("lookupTable")]))}),jp=me({accountKeys:Re(Wp),signatures:Re(xe())}),Hp=me({parsed:Zi(),program:xe(),programId:Jt}),Gp=me({accounts:Re(Jt),data:xe(),programId:Jt}),A2=Kr([Gp,Hp]),R2=Kr([me({parsed:Zi(),program:xe(),programId:xe()}),me({accounts:Re(xe()),data:xe(),programId:xe()})]),Jp=$o(A2,R2,t=>"accounts"in t?Se(t,Gp):Se(t,Hp)),Zp=me({signatures:Re(xe()),message:me({accountKeys:Re(Wp),instructions:Re(Jp),recentBlockhash:xe(),addressTableLookups:Le(Te(Re(qp)))})}),Da=me({accountIndex:ie(),mint:xe(),owner:Le(xe()),programId:Le(xe()),uiTokenAmount:Ll}),Yp=me({writable:Re(Jt),readonly:Re(Jt)}),cc=me({err:si,fee:ie(),innerInstructions:Le(Te(Re(me({index:ie(),instructions:Re(me({accounts:Re(ie()),data:xe(),programIdIndex:ie()}))})))),preBalances:Re(ie()),postBalances:Re(ie()),logMessages:Le(Te(Re(xe()))),preTokenBalances:Le(Te(Re(Da))),postTokenBalances:Le(Te(Re(Da))),loadedAddresses:Le(Yp),computeUnitsConsumed:Le(ie()),costUnits:Le(ie())}),ku=me({err:si,fee:ie(),innerInstructions:Le(Te(Re(me({index:ie(),instructions:Re(Jp)})))),preBalances:Re(ie()),postBalances:Re(ie()),logMessages:Le(Te(Re(xe()))),preTokenBalances:Le(Te(Re(Da))),postTokenBalances:Le(Te(Re(Da))),loadedAddresses:Le(Yp),computeUnitsConsumed:Le(ie()),costUnits:Le(ie())}),Yi=Kr([Ht(0),Ht("legacy")]),ii=me({pubkey:xe(),lamports:ie(),postBalance:Te(ie()),rewardType:Te(xe()),commission:Le(Te(ie()))}),B2=at(Te(me({blockhash:xe(),previousBlockhash:xe(),parentSlot:ie(),transactions:Re(me({transaction:Du,meta:Te(cc),version:Le(Yi)})),rewards:Le(Re(ii)),blockTime:Te(ie()),blockHeight:Te(ie())}))),T2=at(Te(me({blockhash:xe(),previousBlockhash:xe(),parentSlot:ie(),rewards:Le(Re(ii)),blockTime:Te(ie()),blockHeight:Te(ie())}))),P2=at(Te(me({blockhash:xe(),previousBlockhash:xe(),parentSlot:ie(),transactions:Re(me({transaction:jp,meta:Te(cc),version:Le(Yi)})),rewards:Le(Re(ii)),blockTime:Te(ie()),blockHeight:Te(ie())}))),C2=at(Te(me({blockhash:xe(),previousBlockhash:xe(),parentSlot:ie(),transactions:Re(me({transaction:Zp,meta:Te(ku),version:Le(Yi)})),rewards:Le(Re(ii)),blockTime:Te(ie()),blockHeight:Te(ie())}))),D2=at(Te(me({blockhash:xe(),previousBlockhash:xe(),parentSlot:ie(),transactions:Re(me({transaction:jp,meta:Te(ku),version:Le(Yi)})),rewards:Le(Re(ii)),blockTime:Te(ie()),blockHeight:Te(ie())}))),k2=at(Te(me({blockhash:xe(),previousBlockhash:xe(),parentSlot:ie(),rewards:Le(Re(ii)),blockTime:Te(ie()),blockHeight:Te(ie())}))),N2=at(Te(me({blockhash:xe(),previousBlockhash:xe(),parentSlot:ie(),transactions:Re(me({transaction:Du,meta:Te(cc)})),rewards:Le(Re(ii)),blockTime:Te(ie())}))),Th=at(Te(me({blockhash:xe(),previousBlockhash:xe(),parentSlot:ie(),signatures:Re(xe()),blockTime:Te(ie())}))),Jc=at(Te(me({slot:ie(),meta:Te(cc),blockTime:Le(Te(ie())),transaction:Du,version:Le(Yi)}))),sa=at(Te(me({slot:ie(),transaction:Zp,meta:Te(ku),blockTime:Le(Te(ie())),version:Le(Yi)}))),O2=ar(me({blockhash:xe(),lastValidBlockHeight:ie()})),M2=ar(Rn()),U2=me({slot:ie(),numTransactions:ie(),numSlots:ie(),samplePeriodSecs:ie()}),L2=at(Re(U2)),F2=ar(Te(me({feeCalculator:me({lamportsPerSignature:ie()})}))),$2=at(xe()),K2=at(xe()),z2=me({err:si,logs:Re(xe()),signature:xe()}),V2=me({result:ac(z2),subscription:ie()}),q2={"solana-client":"js/1.0.0-maintenance"};class W2{constructor(e,r){this._commitment=void 0,this._confirmTransactionInitialTimeout=void 0,this._rpcEndpoint=void 0,this._rpcWsEndpoint=void 0,this._rpcClient=void 0,this._rpcRequest=void 0,this._rpcBatchRequest=void 0,this._rpcWebSocket=void 0,this._rpcWebSocketConnected=!1,this._rpcWebSocketHeartbeat=null,this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketGeneration=0,this._disableBlockhashCaching=!1,this._pollingBlockhash=!1,this._blockhashInfo={latestBlockhash:null,lastFetch:0,transactionSignatures:[],simulatedSignatures:[]},this._nextClientSubscriptionId=0,this._subscriptionDisposeFunctionsByClientSubscriptionId={},this._subscriptionHashByClientSubscriptionId={},this._subscriptionStateChangeCallbacksByHash={},this._subscriptionCallbacksByServerSubscriptionId={},this._subscriptionsByHash={},this._subscriptionsAutoDisposedByRpc=new Set,this.getBlockHeight=(()=>{const l={};return async g=>{const{commitment:m,config:I}=Lt(g),_=this._buildArgs([],m,void 0,I),b=_h(_);return l[b]=l[b]??(async()=>{try{const v=await this._rpcRequest("getBlockHeight",_),S=Se(v,at(ie()));if("error"in S)throw new Me(S.error,"failed to get block height information");return S.result}finally{delete l[b]}})(),await l[b]}})();let n,s,i,o,a,c;r&&typeof r=="string"?this._commitment=r:r&&(this._commitment=r.commitment,this._confirmTransactionInitialTimeout=r.confirmTransactionInitialTimeout,n=r.wsEndpoint,s=r.httpHeaders,i=r.fetch,o=r.fetchMiddleware,a=r.disableRetryOnRateLimit,c=r.httpAgent),this._rpcEndpoint=T_(e),this._rpcWsEndpoint=n||R_(e),this._rpcClient=q_(e,s,i,o,a,c),this._rpcRequest=W_(this._rpcClient),this._rpcBatchRequest=j_(this._rpcClient),this._rpcWebSocket=new __(this._rpcWsEndpoint,{autoconnect:!1,max_reconnects:1/0}),this._rpcWebSocket.on("open",this._wsOnOpen.bind(this)),this._rpcWebSocket.on("error",this._wsOnError.bind(this)),this._rpcWebSocket.on("close",this._wsOnClose.bind(this)),this._rpcWebSocket.on("accountNotification",this._wsOnAccountNotification.bind(this)),this._rpcWebSocket.on("programNotification",this._wsOnProgramAccountNotification.bind(this)),this._rpcWebSocket.on("slotNotification",this._wsOnSlotNotification.bind(this)),this._rpcWebSocket.on("slotsUpdatesNotification",this._wsOnSlotUpdatesNotification.bind(this)),this._rpcWebSocket.on("signatureNotification",this._wsOnSignatureNotification.bind(this)),this._rpcWebSocket.on("rootNotification",this._wsOnRootNotification.bind(this)),this._rpcWebSocket.on("logsNotification",this._wsOnLogsNotification.bind(this))}get commitment(){return this._commitment}get rpcEndpoint(){return this._rpcEndpoint}async getBalanceAndContext(e,r){const{commitment:n,config:s}=Lt(r),i=this._buildArgs([e.toBase58()],n,void 0,s),o=await this._rpcRequest("getBalance",i),a=Se(o,ar(ie()));if("error"in a)throw new Me(a.error,`failed to get balance for ${e.toBase58()}`);return a.result}async getBalance(e,r){return await this.getBalanceAndContext(e,r).then(n=>n.value).catch(n=>{throw new Error("failed to get balance of account "+e.toBase58()+": "+n)})}async getBlockTime(e){const r=await this._rpcRequest("getBlockTime",[e]),n=Se(r,at(Te(ie())));if("error"in n)throw new Me(n.error,`failed to get block time for slot ${e}`);return n.result}async getMinimumLedgerSlot(){const e=await this._rpcRequest("minimumLedgerSlot",[]),r=Se(e,at(ie()));if("error"in r)throw new Me(r.error,"failed to get minimum ledger slot");return r.result}async getFirstAvailableBlock(){const e=await this._rpcRequest("getFirstAvailableBlock",[]),r=Se(e,Q_);if("error"in r)throw new Me(r.error,"failed to get first available block");return r.result}async getSupply(e){let r={};typeof e=="string"?r={commitment:e}:e?r={...e,commitment:e&&e.commitment||this.commitment}:r={commitment:this.commitment};const n=await this._rpcRequest("getSupply",[r]),s=Se(n,e2);if("error"in s)throw new Me(s.error,"failed to get supply");return s.result}async getTokenSupply(e,r){const n=this._buildArgs([e.toBase58()],r),s=await this._rpcRequest("getTokenSupply",n),i=Se(s,ar(Ll));if("error"in i)throw new Me(i.error,"failed to get token supply");return i.result}async getTokenAccountBalance(e,r){const n=this._buildArgs([e.toBase58()],r),s=await this._rpcRequest("getTokenAccountBalance",n),i=Se(s,ar(Ll));if("error"in i)throw new Me(i.error,"failed to get token account balance");return i.result}async getTokenAccountsByOwner(e,r,n){const{commitment:s,config:i}=Lt(n);let o=[e.toBase58()];"mint"in r?o.push({mint:r.mint.toBase58()}):o.push({programId:r.programId.toBase58()});const a=this._buildArgs(o,s,"base64",i),c=await this._rpcRequest("getTokenAccountsByOwner",a),l=Se(c,r2);if("error"in l)throw new Me(l.error,`failed to get token accounts owned by account ${e.toBase58()}`);return l.result}async getParsedTokenAccountsByOwner(e,r,n){let s=[e.toBase58()];"mint"in r?s.push({mint:r.mint.toBase58()}):s.push({programId:r.programId.toBase58()});const i=this._buildArgs(s,n,"jsonParsed"),o=await this._rpcRequest("getTokenAccountsByOwner",i),a=Se(o,n2);if("error"in a)throw new Me(a.error,`failed to get token accounts owned by account ${e.toBase58()}`);return a.result}async getLargestAccounts(e){const r={...e,commitment:e&&e.commitment||this.commitment},n=r.filter||r.commitment?[r]:[],s=await this._rpcRequest("getLargestAccounts",n),i=Se(s,s2);if("error"in i)throw new Me(i.error,"failed to get largest accounts");return i.result}async getTokenLargestAccounts(e,r){const n=this._buildArgs([e.toBase58()],r),s=await this._rpcRequest("getTokenLargestAccounts",n),i=Se(s,t2);if("error"in i)throw new Me(i.error,"failed to get token largest accounts");return i.result}async getAccountInfoAndContext(e,r){const{commitment:n,config:s}=Lt(r),i=this._buildArgs([e.toBase58()],n,"base64",s),o=await this._rpcRequest("getAccountInfo",i),a=Se(o,ar(Te(xo)));if("error"in a)throw new Me(a.error,`failed to get info about account ${e.toBase58()}`);return a.result}async getParsedAccountInfo(e,r){const{commitment:n,config:s}=Lt(r),i=this._buildArgs([e.toBase58()],n,"jsonParsed",s),o=await this._rpcRequest("getAccountInfo",i),a=Se(o,ar(Te($l)));if("error"in a)throw new Me(a.error,`failed to get info about account ${e.toBase58()}`);return a.result}async getAccountInfo(e,r){try{return(await this.getAccountInfoAndContext(e,r)).value}catch(n){throw new Error("failed to get info about account "+e.toBase58()+": "+n)}}async getMultipleParsedAccounts(e,r){const{commitment:n,config:s}=Lt(r),i=e.map(l=>l.toBase58()),o=this._buildArgs([i],n,"jsonParsed",s),a=await this._rpcRequest("getMultipleAccounts",o),c=Se(a,ar(Re(Te($l))));if("error"in c)throw new Me(c.error,`failed to get info for accounts ${i}`);return c.result}async getMultipleAccountsInfoAndContext(e,r){const{commitment:n,config:s}=Lt(r),i=e.map(l=>l.toBase58()),o=this._buildArgs([i],n,"base64",s),a=await this._rpcRequest("getMultipleAccounts",o),c=Se(a,ar(Re(Te(xo))));if("error"in c)throw new Me(c.error,`failed to get info for accounts ${i}`);return c.result}async getMultipleAccountsInfo(e,r){return(await this.getMultipleAccountsInfoAndContext(e,r)).value}async getStakeActivation(e,r,n){const{commitment:s,config:i}=Lt(r),o=this._buildArgs([e.toBase58()],s,void 0,{...i,epoch:n??i?.epoch}),a=await this._rpcRequest("getStakeActivation",o),c=Se(a,at(c2));if("error"in c)throw new Me(c.error,`failed to get Stake Activation ${e.toBase58()}`);return c.result}async getProgramAccounts(e,r){const{commitment:n,config:s}=Lt(r),{encoding:i,...o}=s||{},a=this._buildArgs([e.toBase58()],n,i||"base64",{...o,...o.filters?{filters:Ah(o.filters)}:null}),c=await this._rpcRequest("getProgramAccounts",a),l=Re(i2),g=o.withContext===!0?Se(c,ar(l)):Se(c,at(l));if("error"in g)throw new Me(g.error,`failed to get accounts owned by program ${e.toBase58()}`);return g.result}async getParsedProgramAccounts(e,r){const{commitment:n,config:s}=Lt(r),i=this._buildArgs([e.toBase58()],n,"jsonParsed",s),o=await this._rpcRequest("getProgramAccounts",i),a=Se(o,at(Re(a2)));if("error"in a)throw new Me(a.error,`failed to get accounts owned by program ${e.toBase58()}`);return a.result}async confirmTransaction(e,r){let n;if(typeof e=="string")n=e;else{const i=e;if(i.abortSignal?.aborted)return Promise.reject(i.abortSignal.reason);n=i.signature}let s;try{s=Er.decode(n)}catch{throw new Error("signature must be base58 encoded: "+n)}return qt(s.length===64,"signature has invalid length"),typeof e=="string"?await this.confirmTransactionUsingLegacyTimeoutStrategy({commitment:r||this.commitment,signature:n}):"lastValidBlockHeight"in e?await this.confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:r||this.commitment,strategy:e}):await this.confirmTransactionUsingDurableNonceStrategy({commitment:r||this.commitment,strategy:e})}getCancellationPromise(e){return new Promise((r,n)=>{e!=null&&(e.aborted?n(e.reason):e.addEventListener("abort",()=>{n(e.reason)}))})}getTransactionConfirmationPromise({commitment:e,signature:r}){let n,s,i=!1;const o=new Promise((c,l)=>{try{n=this.onSignature(r,(m,I)=>{n=void 0;const _={context:I,value:m};c({__type:ls.PROCESSED,response:_})},e);const g=new Promise(m=>{n==null?m():s=this._onSubscriptionStateChange(n,I=>{I==="subscribed"&&m()})});(async()=>{if(await g,i)return;const m=await this.getSignatureStatus(r);if(i||m==null)return;const{context:I,value:_}=m;if(_!=null)if(_?.err)l(_.err);else{switch(e){case"confirmed":case"single":case"singleGossip":{if(_.confirmationStatus==="processed")return;break}case"finalized":case"max":case"root":{if(_.confirmationStatus==="processed"||_.confirmationStatus==="confirmed")return;break}case"processed":case"recent":}i=!0,c({__type:ls.PROCESSED,response:{context:I,value:_}})}})()}catch(g){l(g)}});return{abortConfirmation:()=>{s&&(s(),s=void 0),n!=null&&(this.removeSignatureListener(n),n=void 0)},confirmationPromise:o}}async confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:e,strategy:{abortSignal:r,lastValidBlockHeight:n,signature:s}}){let i=!1;const o=new Promise(m=>{const I=async()=>{try{return await this.getBlockHeight(e)}catch{return-1}};(async()=>{let _=await I();if(!i){for(;_<=n;)if(await gi(1e3),i||(_=await I(),i))return;m({__type:ls.BLOCKHEIGHT_EXCEEDED})}})()}),{abortConfirmation:a,confirmationPromise:c}=this.getTransactionConfirmationPromise({commitment:e,signature:s}),l=this.getCancellationPromise(r);let g;try{const m=await Promise.race([l,c,o]);if(m.__type===ls.PROCESSED)g=m.response;else throw new Up(s)}finally{i=!0,a()}return g}async confirmTransactionUsingDurableNonceStrategy({commitment:e,strategy:{abortSignal:r,minContextSlot:n,nonceAccountPubkey:s,nonceValue:i,signature:o}}){let a=!1;const c=new Promise(_=>{let b=i,v=null;const S=async()=>{try{const{context:O,value:$}=await this.getNonceAndContext(s,{commitment:e,minContextSlot:n});return v=O.slot,$?.nonce}catch{return b}};(async()=>{if(b=await S(),!a)for(;;){if(i!==b){_({__type:ls.NONCE_INVALID,slotInWhichNonceDidAdvance:v});return}if(await gi(2e3),a||(b=await S(),a))return}})()}),{abortConfirmation:l,confirmationPromise:g}=this.getTransactionConfirmationPromise({commitment:e,signature:o}),m=this.getCancellationPromise(r);let I;try{const _=await Promise.race([m,g,c]);if(_.__type===ls.PROCESSED)I=_.response;else{let b;for(;;){const v=await this.getSignatureStatus(o);if(v==null)break;if(v.context.slot<(_.slotInWhichNonceDidAdvance??n)){await gi(400);continue}b=v;break}if(b?.value){const v=e||"finalized",{confirmationStatus:S}=b.value;switch(v){case"processed":case"recent":if(S!=="processed"&&S!=="confirmed"&&S!=="finalized")throw new co(o);break;case"confirmed":case"single":case"singleGossip":if(S!=="confirmed"&&S!=="finalized")throw new co(o);break;case"finalized":case"max":case"root":if(S!=="finalized")throw new co(o);break;default:}I={context:b.context,value:{err:b.value.err}}}else throw new co(o)}}finally{a=!0,l()}return I}async confirmTransactionUsingLegacyTimeoutStrategy({commitment:e,signature:r}){let n;const s=new Promise(c=>{let l=this._confirmTransactionInitialTimeout||6e4;switch(e){case"processed":case"recent":case"single":case"confirmed":case"singleGossip":{l=this._confirmTransactionInitialTimeout||3e4;break}}n=setTimeout(()=>c({__type:ls.TIMED_OUT,timeoutMs:l}),l)}),{abortConfirmation:i,confirmationPromise:o}=this.getTransactionConfirmationPromise({commitment:e,signature:r});let a;try{const c=await Promise.race([o,s]);if(c.__type===ls.PROCESSED)a=c.response;else throw new Lp(r,c.timeoutMs/1e3)}finally{clearTimeout(n),i()}return a}async getClusterNodes(){const e=await this._rpcRequest("getClusterNodes",[]),r=Se(e,at(Re(v2)));if("error"in r)throw new Me(r.error,"failed to get cluster nodes");return r.result}async getVoteAccounts(e){const r=this._buildArgs([],e),n=await this._rpcRequest("getVoteAccounts",r),s=Se(n,E2);if("error"in s)throw new Me(s.error,"failed to get vote accounts");return s.result}async getSlot(e){const{commitment:r,config:n}=Lt(e),s=this._buildArgs([],r,void 0,n),i=await this._rpcRequest("getSlot",s),o=Se(i,at(ie()));if("error"in o)throw new Me(o.error,"failed to get slot");return o.result}async getSlotLeader(e){const{commitment:r,config:n}=Lt(e),s=this._buildArgs([],r,void 0,n),i=await this._rpcRequest("getSlotLeader",s),o=Se(i,at(xe()));if("error"in o)throw new Me(o.error,"failed to get slot leader");return o.result}async getSlotLeaders(e,r){const n=[e,r],s=await this._rpcRequest("getSlotLeaders",n),i=Se(s,at(Re(Jt)));if("error"in i)throw new Me(i.error,"failed to get slot leaders");return i.result}async getSignatureStatus(e,r){const{context:n,value:s}=await this.getSignatureStatuses([e],r);qt(s.length===1);const i=s[0];return{context:n,value:i}}async getSignatureStatuses(e,r){const n=[e];r&&n.push(r);const s=await this._rpcRequest("getSignatureStatuses",n),i=Se(s,I2);if("error"in i)throw new Me(i.error,"failed to get signature status");return i.result}async getTransactionCount(e){const{commitment:r,config:n}=Lt(e),s=this._buildArgs([],r,void 0,n),i=await this._rpcRequest("getTransactionCount",s),o=Se(i,at(ie()));if("error"in o)throw new Me(o.error,"failed to get transaction count");return o.result}async getTotalSupply(e){return(await this.getSupply({commitment:e,excludeNonCirculatingAccountsList:!0})).value.total}async getInflationGovernor(e){const r=this._buildArgs([],e),n=await this._rpcRequest("getInflationGovernor",r),s=Se(n,H_);if("error"in s)throw new Me(s.error,"failed to get inflation");return s.result}async getInflationReward(e,r,n){const{commitment:s,config:i}=Lt(n),o=this._buildArgs([e.map(l=>l.toBase58())],s,void 0,{...i,epoch:r??i?.epoch}),a=await this._rpcRequest("getInflationReward",o),c=Se(a,D_);if("error"in c)throw new Me(c.error,"failed to get inflation reward");return c.result}async getInflationRate(){const e=await this._rpcRequest("getInflationRate",[]),r=Se(e,G_);if("error"in r)throw new Me(r.error,"failed to get inflation rate");return r.result}async getEpochInfo(e){const{commitment:r,config:n}=Lt(e),s=this._buildArgs([],r,void 0,n),i=await this._rpcRequest("getEpochInfo",s),o=Se(i,Z_);if("error"in o)throw new Me(o.error,"failed to get epoch info");return o.result}async getEpochSchedule(){const e=await this._rpcRequest("getEpochSchedule",[]),r=Se(e,Y_);if("error"in r)throw new Me(r.error,"failed to get epoch schedule");const n=r.result;return new E_(n.slotsPerEpoch,n.leaderScheduleSlotOffset,n.warmup,n.firstNormalEpoch,n.firstNormalSlot)}async getLeaderSchedule(){const e=await this._rpcRequest("getLeaderSchedule",[]),r=Se(e,X_);if("error"in r)throw new Me(r.error,"failed to get leader schedule");return r.result}async getMinimumBalanceForRentExemption(e,r){const n=this._buildArgs([e],r),s=await this._rpcRequest("getMinimumBalanceForRentExemption",n),i=Se(s,S2);return"error"in i?(console.warn("Unable to fetch minimum balance for rent exemption"),0):i.result}async getRecentBlockhashAndContext(e){const{context:r,value:{blockhash:n}}=await this.getLatestBlockhashAndContext(e);return{context:r,value:{blockhash:n,feeCalculator:{get lamportsPerSignature(){throw new Error("The capability to fetch `lamportsPerSignature` using the `getRecentBlockhash` API is no longer offered by the network. Use the `getFeeForMessage` API to obtain the fee for a given message.")},toJSON(){return{}}}}}}async getRecentPerformanceSamples(e){const r=await this._rpcRequest("getRecentPerformanceSamples",e?[e]:[]),n=Se(r,L2);if("error"in n)throw new Me(n.error,"failed to get recent performance samples");return n.result}async getFeeCalculatorForBlockhash(e,r){const n=this._buildArgs([e],r),s=await this._rpcRequest("getFeeCalculatorForBlockhash",n),i=Se(s,F2);if("error"in i)throw new Me(i.error,"failed to get fee calculator");const{context:o,value:a}=i.result;return{context:o,value:a!==null?a.feeCalculator:null}}async getFeeForMessage(e,r){const n=Fi(e.serialize()).toString("base64"),s=this._buildArgs([n],r),i=await this._rpcRequest("getFeeForMessage",s),o=Se(i,ar(Te(ie())));if("error"in o)throw new Me(o.error,"failed to get fee for message");if(o.result===null)throw new Error("invalid blockhash");return o.result}async getRecentPrioritizationFees(e){const r=e?.lockedWritableAccounts?.map(o=>o.toBase58()),n=r?.length?[r]:[],s=await this._rpcRequest("getRecentPrioritizationFees",n),i=Se(s,J_);if("error"in i)throw new Me(i.error,"failed to get recent prioritization fees");return i.result}async getRecentBlockhash(e){try{return(await this.getRecentBlockhashAndContext(e)).value}catch(r){throw new Error("failed to get recent blockhash: "+r)}}async getLatestBlockhash(e){try{return(await this.getLatestBlockhashAndContext(e)).value}catch(r){throw new Error("failed to get recent blockhash: "+r)}}async getLatestBlockhashAndContext(e){const{commitment:r,config:n}=Lt(e),s=this._buildArgs([],r,void 0,n),i=await this._rpcRequest("getLatestBlockhash",s),o=Se(i,O2);if("error"in o)throw new Me(o.error,"failed to get latest blockhash");return o.result}async isBlockhashValid(e,r){const{commitment:n,config:s}=Lt(r),i=this._buildArgs([e],n,void 0,s),o=await this._rpcRequest("isBlockhashValid",i),a=Se(o,M2);if("error"in a)throw new Me(a.error,"failed to determine if the blockhash `"+e+"`is valid");return a.result}async getVersion(){const e=await this._rpcRequest("getVersion",[]),r=Se(e,at($_));if("error"in r)throw new Me(r.error,"failed to get version");return r.result}async getGenesisHash(){const e=await this._rpcRequest("getGenesisHash",[]),r=Se(e,at(xe()));if("error"in r)throw new Me(r.error,"failed to get genesis hash");return r.result}async getBlock(e,r){const{commitment:n,config:s}=Lt(r),i=this._buildArgsAtLeastConfirmed([e],n,void 0,s),o=await this._rpcRequest("getBlock",i);try{switch(s?.transactionDetails){case"accounts":{const a=Se(o,P2);if("error"in a)throw a.error;return a.result}case"none":{const a=Se(o,T2);if("error"in a)throw a.error;return a.result}default:{const a=Se(o,B2);if("error"in a)throw a.error;const{result:c}=a;return c?{...c,transactions:c.transactions.map(({transaction:l,meta:g,version:m})=>({meta:g,transaction:{...l,message:Gc(m,l.message)},version:m}))}:null}}}catch(a){throw new Me(a,"failed to get confirmed block")}}async getParsedBlock(e,r){const{commitment:n,config:s}=Lt(r),i=this._buildArgsAtLeastConfirmed([e],n,"jsonParsed",s),o=await this._rpcRequest("getBlock",i);try{switch(s?.transactionDetails){case"accounts":{const a=Se(o,D2);if("error"in a)throw a.error;return a.result}case"none":{const a=Se(o,k2);if("error"in a)throw a.error;return a.result}default:{const a=Se(o,C2);if("error"in a)throw a.error;return a.result}}}catch(a){throw new Me(a,"failed to get block")}}async getBlockProduction(e){let r,n;if(typeof e=="string")n=e;else if(e){const{commitment:a,...c}=e;n=a,r=c}const s=this._buildArgs([],n,"base64",r),i=await this._rpcRequest("getBlockProduction",s),o=Se(i,V_);if("error"in o)throw new Me(o.error,"failed to get block production information");return o.result}async getTransaction(e,r){const{commitment:n,config:s}=Lt(r),i=this._buildArgsAtLeastConfirmed([e],n,void 0,s),o=await this._rpcRequest("getTransaction",i),a=Se(o,Jc);if("error"in a)throw new Me(a.error,"failed to get transaction");const c=a.result;return c&&{...c,transaction:{...c.transaction,message:Gc(c.version,c.transaction.message)}}}async getParsedTransaction(e,r){const{commitment:n,config:s}=Lt(r),i=this._buildArgsAtLeastConfirmed([e],n,"jsonParsed",s),o=await this._rpcRequest("getTransaction",i),a=Se(o,sa);if("error"in a)throw new Me(a.error,"failed to get transaction");return a.result}async getParsedTransactions(e,r){const{commitment:n,config:s}=Lt(r),i=e.map(c=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([c],n,"jsonParsed",s)}));return(await this._rpcBatchRequest(i)).map(c=>{const l=Se(c,sa);if("error"in l)throw new Me(l.error,"failed to get transactions");return l.result})}async getTransactions(e,r){const{commitment:n,config:s}=Lt(r),i=e.map(c=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([c],n,void 0,s)}));return(await this._rpcBatchRequest(i)).map(c=>{const l=Se(c,Jc);if("error"in l)throw new Me(l.error,"failed to get transactions");const g=l.result;return g&&{...g,transaction:{...g.transaction,message:Gc(g.version,g.transaction.message)}}})}async getConfirmedBlock(e,r){const n=this._buildArgsAtLeastConfirmed([e],r),s=await this._rpcRequest("getBlock",n),i=Se(s,N2);if("error"in i)throw new Me(i.error,"failed to get confirmed block");const o=i.result;if(!o)throw new Error("Confirmed block "+e+" not found");const a={...o,transactions:o.transactions.map(({transaction:c,meta:l})=>{const g=new Gn(c.message);return{meta:l,transaction:{...c,message:g}}})};return{...a,transactions:a.transactions.map(({transaction:c,meta:l})=>({meta:l,transaction:zn.populate(c.message,c.signatures)}))}}async getBlocks(e,r,n){const s=this._buildArgsAtLeastConfirmed(r!==void 0?[e,r]:[e],n),i=await this._rpcRequest("getBlocks",s),o=Se(i,at(Re(ie())));if("error"in o)throw new Me(o.error,"failed to get blocks");return o.result}async getBlockSignatures(e,r){const n=this._buildArgsAtLeastConfirmed([e],r,void 0,{transactionDetails:"signatures",rewards:!1}),s=await this._rpcRequest("getBlock",n),i=Se(s,Th);if("error"in i)throw new Me(i.error,"failed to get block");const o=i.result;if(!o)throw new Error("Block "+e+" not found");return o}async getConfirmedBlockSignatures(e,r){const n=this._buildArgsAtLeastConfirmed([e],r,void 0,{transactionDetails:"signatures",rewards:!1}),s=await this._rpcRequest("getBlock",n),i=Se(s,Th);if("error"in i)throw new Me(i.error,"failed to get confirmed block");const o=i.result;if(!o)throw new Error("Confirmed block "+e+" not found");return o}async getConfirmedTransaction(e,r){const n=this._buildArgsAtLeastConfirmed([e],r),s=await this._rpcRequest("getTransaction",n),i=Se(s,Jc);if("error"in i)throw new Me(i.error,"failed to get transaction");const o=i.result;if(!o)return o;const a=new Gn(o.transaction.message),c=o.transaction.signatures;return{...o,transaction:zn.populate(a,c)}}async getParsedConfirmedTransaction(e,r){const n=this._buildArgsAtLeastConfirmed([e],r,"jsonParsed"),s=await this._rpcRequest("getTransaction",n),i=Se(s,sa);if("error"in i)throw new Me(i.error,"failed to get confirmed transaction");return i.result}async getParsedConfirmedTransactions(e,r){const n=e.map(o=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([o],r,"jsonParsed")}));return(await this._rpcBatchRequest(n)).map(o=>{const a=Se(o,sa);if("error"in a)throw new Me(a.error,"failed to get confirmed transactions");return a.result})}async getConfirmedSignaturesForAddress(e,r,n){let s={},i=await this.getFirstAvailableBlock();for(;!("until"in s)&&(r--,!(r<=0||r<i));)try{const c=await this.getConfirmedBlockSignatures(r,"finalized");c.signatures.length>0&&(s.until=c.signatures[c.signatures.length-1].toString())}catch(c){if(c instanceof Error&&c.message.includes("skipped"))continue;throw c}let o=await this.getSlot("finalized");for(;!("before"in s)&&(n++,!(n>o));)try{const c=await this.getConfirmedBlockSignatures(n);c.signatures.length>0&&(s.before=c.signatures[c.signatures.length-1].toString())}catch(c){if(c instanceof Error&&c.message.includes("skipped"))continue;throw c}return(await this.getConfirmedSignaturesForAddress2(e,s)).map(c=>c.signature)}async getConfirmedSignaturesForAddress2(e,r,n){const s=this._buildArgsAtLeastConfirmed([e.toBase58()],n,void 0,r),i=await this._rpcRequest("getConfirmedSignaturesForAddress2",s),o=Se(i,l2);if("error"in o)throw new Me(o.error,"failed to get confirmed signatures for address");return o.result}async getSignaturesForAddress(e,r,n){const s=this._buildArgsAtLeastConfirmed([e.toBase58()],n,void 0,r),i=await this._rpcRequest("getSignaturesForAddress",s),o=Se(i,u2);if("error"in o)throw new Me(o.error,"failed to get signatures for address");return o.result}async getAddressLookupTable(e,r){const{context:n,value:s}=await this.getAccountInfoAndContext(e,r);let i=null;return s!==null&&(i=new Sh({key:e,state:Sh.deserialize(s.data)})),{context:n,value:i}}async getNonceAndContext(e,r){const{context:n,value:s}=await this.getAccountInfoAndContext(e,r);let i=null;return s!==null&&(i=Pu.fromAccountData(s.data)),{context:n,value:i}}async getNonce(e,r){return await this.getNonceAndContext(e,r).then(n=>n.value).catch(n=>{throw new Error("failed to get nonce for account "+e.toBase58()+": "+n)})}async requestAirdrop(e,r){const n=await this._rpcRequest("requestAirdrop",[e.toBase58(),r]),s=Se(n,$2);if("error"in s)throw new Me(s.error,`airdrop to ${e.toBase58()} failed`);return s.result}async _blockhashWithExpiryBlockHeight(e){if(!e){for(;this._pollingBlockhash;)await gi(100);const n=Date.now()-this._blockhashInfo.lastFetch>=B_;if(this._blockhashInfo.latestBlockhash!==null&&!n)return this._blockhashInfo.latestBlockhash}return await this._pollNewBlockhash()}async _pollNewBlockhash(){this._pollingBlockhash=!0;try{const e=Date.now(),r=this._blockhashInfo.latestBlockhash,n=r?r.blockhash:null;for(let s=0;s<50;s++){const i=await this.getLatestBlockhash("finalized");if(n!==i.blockhash)return this._blockhashInfo={latestBlockhash:i,lastFetch:Date.now(),transactionSignatures:[],simulatedSignatures:[]},i;await gi(g_/2)}throw new Error(`Unable to obtain a new blockhash after ${Date.now()-e}ms`)}finally{this._pollingBlockhash=!1}}async getStakeMinimumDelegation(e){const{commitment:r,config:n}=Lt(e),s=this._buildArgs([],r,"base64",n),i=await this._rpcRequest("getStakeMinimumDelegation",s),o=Se(i,ar(ie()));if("error"in o)throw new Me(o.error,"failed to get stake minimum delegation");return o.result}async simulateTransaction(e,r,n){if("message"in e){const v=e.serialize(),S=je.Buffer.from(v).toString("base64");if(Array.isArray(r)||n!==void 0)throw new Error("Invalid arguments");const O=r||{};O.encoding="base64","commitment"in O||(O.commitment=this.commitment),r&&typeof r=="object"&&"innerInstructions"in r&&(O.innerInstructions=r.innerInstructions);const $=[S,O],k=await this._rpcRequest("simulateTransaction",$),Z=Se(k,Rh);if("error"in Z)throw new Error("failed to simulate transaction: "+Z.error.message);return Z.result}let s;if(e instanceof zn){let b=e;s=new zn,s.feePayer=b.feePayer,s.instructions=e.instructions,s.nonceInfo=b.nonceInfo,s.signatures=b.signatures}else s=zn.populate(e),s._message=s._json=void 0;if(r!==void 0&&!Array.isArray(r))throw new Error("Invalid arguments");const i=r;if(s.nonceInfo&&i)s.sign(...i);else{let b=this._disableBlockhashCaching;for(;;){const v=await this._blockhashWithExpiryBlockHeight(b);if(s.lastValidBlockHeight=v.lastValidBlockHeight,s.recentBlockhash=v.blockhash,!i)break;if(s.sign(...i),!s.signature)throw new Error("!signature");const S=s.signature.toString("base64");if(!this._blockhashInfo.simulatedSignatures.includes(S)&&!this._blockhashInfo.transactionSignatures.includes(S)){this._blockhashInfo.simulatedSignatures.push(S);break}else b=!0}}const o=s._compile(),a=o.serialize(),l=s._serialize(a).toString("base64"),g={encoding:"base64",commitment:this.commitment};if(n){const b=(Array.isArray(n)?n:o.nonProgramIds()).map(v=>v.toBase58());g.accounts={encoding:"base64",addresses:b}}i&&(g.sigVerify=!0),r&&typeof r=="object"&&"innerInstructions"in r&&(g.innerInstructions=r.innerInstructions);const m=[l,g],I=await this._rpcRequest("simulateTransaction",m),_=Se(I,Rh);if("error"in _){let b;if("data"in _.error&&(b=_.error.data.logs,b&&Array.isArray(b))){const v=`
    `,S=v+b.join(v);console.error(_.error.message,S)}throw new Eh({action:"simulate",signature:"",transactionMessage:_.error.message,logs:b})}return _.result}async sendTransaction(e,r,n){if("version"in e){if(r&&Array.isArray(r))throw new Error("Invalid arguments");const o=e.serialize();return await this.sendRawTransaction(o,r)}if(r===void 0||!Array.isArray(r))throw new Error("Invalid arguments");const s=r;if(e.nonceInfo)e.sign(...s);else{let o=this._disableBlockhashCaching;for(;;){const a=await this._blockhashWithExpiryBlockHeight(o);if(e.lastValidBlockHeight=a.lastValidBlockHeight,e.recentBlockhash=a.blockhash,e.sign(...s),!e.signature)throw new Error("!signature");const c=e.signature.toString("base64");if(this._blockhashInfo.transactionSignatures.includes(c))o=!0;else{this._blockhashInfo.transactionSignatures.push(c);break}}}const i=e.serialize();return await this.sendRawTransaction(i,n)}async sendRawTransaction(e,r){const n=Fi(e).toString("base64");return await this.sendEncodedTransaction(n,r)}async sendEncodedTransaction(e,r){const n={encoding:"base64"},s=r&&r.skipPreflight,i=s===!0?"processed":r&&r.preflightCommitment||this.commitment;r&&r.maxRetries!=null&&(n.maxRetries=r.maxRetries),r&&r.minContextSlot!=null&&(n.minContextSlot=r.minContextSlot),s&&(n.skipPreflight=s),i&&(n.preflightCommitment=i);const o=[e,n],a=await this._rpcRequest("sendTransaction",o),c=Se(a,K2);if("error"in c){let l;throw"data"in c.error&&(l=c.error.data.logs),new Eh({action:s?"send":"simulate",signature:"",transactionMessage:c.error.message,logs:l})}return c.result}_wsOnOpen(){this._rpcWebSocketConnected=!0,this._rpcWebSocketHeartbeat=setInterval(()=>{(async()=>{try{await this._rpcWebSocket.notify("ping")}catch{}})()},5e3),this._updateSubscriptions()}_wsOnError(e){this._rpcWebSocketConnected=!1,console.error("ws error:",e.message)}_wsOnClose(e){if(this._rpcWebSocketConnected=!1,this._rpcWebSocketGeneration=(this._rpcWebSocketGeneration+1)%Number.MAX_SAFE_INTEGER,this._rpcWebSocketIdleTimeout&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null),this._rpcWebSocketHeartbeat&&(clearInterval(this._rpcWebSocketHeartbeat),this._rpcWebSocketHeartbeat=null),e===1e3){this._updateSubscriptions();return}this._subscriptionCallbacksByServerSubscriptionId={},Object.entries(this._subscriptionsByHash).forEach(([r,n])=>{this._setSubscription(r,{...n,state:"pending"})})}_setSubscription(e,r){const n=this._subscriptionsByHash[e]?.state;if(this._subscriptionsByHash[e]=r,n!==r.state){const s=this._subscriptionStateChangeCallbacksByHash[e];s&&s.forEach(i=>{try{i(r.state)}catch{}})}}_onSubscriptionStateChange(e,r){const n=this._subscriptionHashByClientSubscriptionId[e];if(n==null)return()=>{};const s=this._subscriptionStateChangeCallbacksByHash[n]||=new Set;return s.add(r),()=>{s.delete(r),s.size===0&&delete this._subscriptionStateChangeCallbacksByHash[n]}}async _updateSubscriptions(){if(Object.keys(this._subscriptionsByHash).length===0){this._rpcWebSocketConnected&&(this._rpcWebSocketConnected=!1,this._rpcWebSocketIdleTimeout=setTimeout(()=>{this._rpcWebSocketIdleTimeout=null;try{this._rpcWebSocket.close()}catch(n){n instanceof Error&&console.log(`Error when closing socket connection: ${n.message}`)}},500));return}if(this._rpcWebSocketIdleTimeout!==null&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketConnected=!0),!this._rpcWebSocketConnected){this._rpcWebSocket.connect();return}const e=this._rpcWebSocketGeneration,r=()=>e===this._rpcWebSocketGeneration;await Promise.all(Object.keys(this._subscriptionsByHash).map(async n=>{const s=this._subscriptionsByHash[n];if(s!==void 0)switch(s.state){case"pending":case"unsubscribed":if(s.callbacks.size===0){delete this._subscriptionsByHash[n],s.state==="unsubscribed"&&delete this._subscriptionCallbacksByServerSubscriptionId[s.serverSubscriptionId],await this._updateSubscriptions();return}await(async()=>{const{args:i,method:o}=s;try{this._setSubscription(n,{...s,state:"subscribing"});const a=await this._rpcWebSocket.call(o,i);this._setSubscription(n,{...s,serverSubscriptionId:a,state:"subscribed"}),this._subscriptionCallbacksByServerSubscriptionId[a]=s.callbacks,await this._updateSubscriptions()}catch(a){if(console.error(`Received ${a instanceof Error?"":"JSON-RPC "}error calling \`${o}\``,{args:i,error:a}),!r())return;this._setSubscription(n,{...s,state:"pending"}),await this._updateSubscriptions()}})();break;case"subscribed":s.callbacks.size===0&&await(async()=>{const{serverSubscriptionId:i,unsubscribeMethod:o}=s;if(this._subscriptionsAutoDisposedByRpc.has(i))this._subscriptionsAutoDisposedByRpc.delete(i);else{this._setSubscription(n,{...s,state:"unsubscribing"}),this._setSubscription(n,{...s,state:"unsubscribing"});try{await this._rpcWebSocket.call(o,[i])}catch(a){if(a instanceof Error&&console.error(`${o} error:`,a.message),!r())return;this._setSubscription(n,{...s,state:"subscribed"}),await this._updateSubscriptions();return}}this._setSubscription(n,{...s,state:"unsubscribed"}),await this._updateSubscriptions()})();break}}))}_handleServerNotification(e,r){const n=this._subscriptionCallbacksByServerSubscriptionId[e];n!==void 0&&n.forEach(s=>{try{s(...r)}catch(i){console.error(i)}})}_wsOnAccountNotification(e){const{result:r,subscription:n}=Se(e,f2);this._handleServerNotification(n,[r.value,r.context])}_makeSubscription(e,r){const n=this._nextClientSubscriptionId++,s=_h([e.method,r]),i=this._subscriptionsByHash[s];return i===void 0?this._subscriptionsByHash[s]={...e,args:r,callbacks:new Set([e.callback]),state:"pending"}:i.callbacks.add(e.callback),this._subscriptionHashByClientSubscriptionId[n]=s,this._subscriptionDisposeFunctionsByClientSubscriptionId[n]=async()=>{delete this._subscriptionDisposeFunctionsByClientSubscriptionId[n],delete this._subscriptionHashByClientSubscriptionId[n];const o=this._subscriptionsByHash[s];qt(o!==void 0,`Could not find a \`Subscription\` when tearing down client subscription #${n}`),o.callbacks.delete(e.callback),await this._updateSubscriptions()},this._updateSubscriptions(),n}onAccountChange(e,r,n){const{commitment:s,config:i}=Lt(n),o=this._buildArgs([e.toBase58()],s||this._commitment||"finalized","base64",i);return this._makeSubscription({callback:r,method:"accountSubscribe",unsubscribeMethod:"accountUnsubscribe"},o)}async removeAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"account change")}_wsOnProgramAccountNotification(e){const{result:r,subscription:n}=Se(e,d2);this._handleServerNotification(n,[{accountId:r.value.pubkey,accountInfo:r.value.account},r.context])}onProgramAccountChange(e,r,n,s){const{commitment:i,config:o}=Lt(n),a=this._buildArgs([e.toBase58()],i||this._commitment||"finalized","base64",o||(s?{filters:Ah(s)}:void 0));return this._makeSubscription({callback:r,method:"programSubscribe",unsubscribeMethod:"programUnsubscribe"},a)}async removeProgramAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"program account change")}onLogs(e,r,n){const s=this._buildArgs([typeof e=="object"?{mentions:[e.toString()]}:e],n||this._commitment||"finalized");return this._makeSubscription({callback:r,method:"logsSubscribe",unsubscribeMethod:"logsUnsubscribe"},s)}async removeOnLogsListener(e){await this._unsubscribeClientSubscription(e,"logs")}_wsOnLogsNotification(e){const{result:r,subscription:n}=Se(e,V2);this._handleServerNotification(n,[r.value,r.context])}_wsOnSlotNotification(e){const{result:r,subscription:n}=Se(e,g2);this._handleServerNotification(n,[r])}onSlotChange(e){return this._makeSubscription({callback:e,method:"slotSubscribe",unsubscribeMethod:"slotUnsubscribe"},[])}async removeSlotChangeListener(e){await this._unsubscribeClientSubscription(e,"slot change")}_wsOnSlotUpdatesNotification(e){const{result:r,subscription:n}=Se(e,m2);this._handleServerNotification(n,[r])}onSlotUpdate(e){return this._makeSubscription({callback:e,method:"slotsUpdatesSubscribe",unsubscribeMethod:"slotsUpdatesUnsubscribe"},[])}async removeSlotUpdateListener(e){await this._unsubscribeClientSubscription(e,"slot update")}async _unsubscribeClientSubscription(e,r){const n=this._subscriptionDisposeFunctionsByClientSubscriptionId[e];n?await n():console.warn(`Ignored unsubscribe request because an active subscription with id \`${e}\` for '${r}' events could not be found.`)}_buildArgs(e,r,n,s){const i=r||this._commitment;if(i||n||s){let o={};n&&(o.encoding=n),i&&(o.commitment=i),s&&(o=Object.assign(o,s)),e.push(o)}return e}_buildArgsAtLeastConfirmed(e,r,n,s){const i=r||this._commitment;if(i&&!["confirmed","finalized"].includes(i))throw new Error("Using Connection with default commitment: `"+this._commitment+"`, but method requires at least `confirmed`");return this._buildArgs(e,r,n,s)}_wsOnSignatureNotification(e){const{result:r,subscription:n}=Se(e,y2);r.value!=="receivedSignature"&&this._subscriptionsAutoDisposedByRpc.add(n),this._handleServerNotification(n,r.value==="receivedSignature"?[{type:"received"},r.context]:[{type:"status",result:r.value},r.context])}onSignature(e,r,n){const s=this._buildArgs([e],n||this._commitment||"finalized"),i=this._makeSubscription({callback:(o,a)=>{if(o.type==="status"){r(o.result,a);try{this.removeSignatureListener(i)}catch{}}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},s);return i}onSignatureWithOptions(e,r,n){const{commitment:s,...i}={...n,commitment:n&&n.commitment||this._commitment||"finalized"},o=this._buildArgs([e],s,void 0,i),a=this._makeSubscription({callback:(c,l)=>{r(c,l);try{this.removeSignatureListener(a)}catch{}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},o);return a}async removeSignatureListener(e){await this._unsubscribeClientSubscription(e,"signature result")}_wsOnRootNotification(e){const{result:r,subscription:n}=Se(e,b2);this._handleServerNotification(n,[r])}onRootChange(e){return this._makeSubscription({callback:e,method:"rootSubscribe",unsubscribeMethod:"rootUnsubscribe"},[])}async removeRootChangeListener(e){await this._unsubscribeClientSubscription(e,"root change")}}Object.freeze({CreateLookupTable:{index:0,layout:G.struct([G.u32("instruction"),$i("recentSlot"),G.u8("bumpSeed")])},FreezeLookupTable:{index:1,layout:G.struct([G.u32("instruction")])},ExtendLookupTable:{index:2,layout:G.struct([G.u32("instruction"),$i(),G.seq(ht(),G.offset(G.u32(),-8),"addresses")])},DeactivateLookupTable:{index:3,layout:G.struct([G.u32("instruction")])},CloseLookupTable:{index:4,layout:G.struct([G.u32("instruction")])}});new Ge("AddressLookupTab1e1111111111111111111111111");Object.freeze({RequestUnits:{index:0,layout:G.struct([G.u8("instruction"),G.u32("units"),G.u32("additionalFee")])},RequestHeapFrame:{index:1,layout:G.struct([G.u8("instruction"),G.u32("bytes")])},SetComputeUnitLimit:{index:2,layout:G.struct([G.u8("instruction"),G.u32("units")])},SetComputeUnitPrice:{index:3,layout:G.struct([G.u8("instruction"),$i("microLamports")])}});new Ge("ComputeBudget111111111111111111111111111111");G.struct([G.u8("numSignatures"),G.u8("padding"),G.u16("signatureOffset"),G.u16("signatureInstructionIndex"),G.u16("publicKeyOffset"),G.u16("publicKeyInstructionIndex"),G.u16("messageDataOffset"),G.u16("messageDataSize"),G.u16("messageInstructionIndex")]);new Ge("Ed25519SigVerify111111111111111111111111111");t_.utils.isValidPrivateKey;G.struct([G.u8("numSignatures"),G.u16("signatureOffset"),G.u8("signatureInstructionIndex"),G.u16("ethAddressOffset"),G.u8("ethAddressInstructionIndex"),G.u16("messageDataOffset"),G.u16("messageDataSize"),G.u8("messageInstructionIndex"),G.blob(20,"ethAddress"),G.blob(64,"signature"),G.u8("recoveryId")]);new Ge("KeccakSecp256k11111111111111111111111111111");var Xp;new Ge("StakeConfig11111111111111111111111111111111");class Qp{constructor(e,r,n){this.unixTimestamp=void 0,this.epoch=void 0,this.custodian=void 0,this.unixTimestamp=e,this.epoch=r,this.custodian=n}}Xp=Qp;Qp.default=new Xp(0,0,Ge.default);Object.freeze({Initialize:{index:0,layout:G.struct([G.u32("instruction"),a_(),c_()])},Authorize:{index:1,layout:G.struct([G.u32("instruction"),ht("newAuthorized"),G.u32("stakeAuthorizationType")])},Delegate:{index:2,layout:G.struct([G.u32("instruction")])},Split:{index:3,layout:G.struct([G.u32("instruction"),G.ns64("lamports")])},Withdraw:{index:4,layout:G.struct([G.u32("instruction"),G.ns64("lamports")])},Deactivate:{index:5,layout:G.struct([G.u32("instruction")])},Merge:{index:7,layout:G.struct([G.u32("instruction")])},AuthorizeWithSeed:{index:8,layout:G.struct([G.u32("instruction"),ht("newAuthorized"),G.u32("stakeAuthorizationType"),xi("authoritySeed"),ht("authorityOwner")])}});new Ge("Stake11111111111111111111111111111111111111");Object.freeze({InitializeAccount:{index:0,layout:G.struct([G.u32("instruction"),l_()])},Authorize:{index:1,layout:G.struct([G.u32("instruction"),ht("newAuthorized"),G.u32("voteAuthorizationType")])},Withdraw:{index:3,layout:G.struct([G.u32("instruction"),G.ns64("lamports")])},UpdateValidatorIdentity:{index:4,layout:G.struct([G.u32("instruction")])},AuthorizeWithSeed:{index:10,layout:G.struct([G.u32("instruction"),u_()])}});new Ge("Vote111111111111111111111111111111111111111");new Ge("Va1idator1nfo111111111111111111111111111111");me({name:xe(),website:Le(xe()),details:Le(xe()),iconUrl:Le(xe()),keybaseUsername:Le(xe())});new Ge("Vote111111111111111111111111111111111111111");G.struct([ht("nodePubkey"),ht("authorizedWithdrawer"),G.u8("commission"),G.nu64(),G.seq(G.struct([G.nu64("slot"),G.u32("confirmationCount")]),G.offset(G.u32(),-8),"votes"),G.u8("rootSlotValid"),G.nu64("rootSlot"),G.nu64(),G.seq(G.struct([G.nu64("epoch"),ht("authorizedVoter")]),G.offset(G.u32(),-8),"authorizedVoters"),G.struct([G.seq(G.struct([ht("authorizedPubkey"),G.nu64("epochOfLastAuthorizedSwitch"),G.nu64("targetEpoch")]),32,"buf"),G.nu64("idx"),G.u8("isEmpty")],"priorVoters"),G.nu64(),G.seq(G.struct([G.nu64("epoch"),G.nu64("credits"),G.nu64("prevCredits")]),G.offset(G.u32(),-8),"epochCredits"),G.struct([G.nu64("slot"),G.nu64("timestamp")],"lastTimestamp")]);const j2={http:{devnet:"http://api.devnet.solana.com",testnet:"http://api.testnet.solana.com","mainnet-beta":"http://api.mainnet-beta.solana.com/"},https:{devnet:"https://api.devnet.solana.com",testnet:"https://api.testnet.solana.com","mainnet-beta":"https://api.mainnet-beta.solana.com/"}};function H2(t,e){return j2["https"][t]}const G2=1e9;function J2(t){if(t.length>=255)throw new TypeError("Alphabet too long");const e=new Uint8Array(256);for(let l=0;l<e.length;l++)e[l]=255;for(let l=0;l<t.length;l++){const g=t.charAt(l),m=g.charCodeAt(0);if(e[m]!==255)throw new TypeError(g+" is ambiguous");e[m]=l}const r=t.length,n=t.charAt(0),s=Math.log(r)/Math.log(256),i=Math.log(256)/Math.log(r);function o(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";let g=0,m=0,I=0;const _=l.length;for(;I!==_&&l[I]===0;)I++,g++;const b=(_-I)*i+1>>>0,v=new Uint8Array(b);for(;I!==_;){let $=l[I],k=0;for(let Z=b-1;($!==0||k<m)&&Z!==-1;Z--,k++)$+=256*v[Z]>>>0,v[Z]=$%r>>>0,$=$/r>>>0;if($!==0)throw new Error("Non-zero carry");m=k,I++}let S=b-m;for(;S!==b&&v[S]===0;)S++;let O=n.repeat(g);for(;S<b;++S)O+=t.charAt(v[S]);return O}function a(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;let g=0,m=0,I=0;for(;l[g]===n;)m++,g++;const _=(l.length-g)*s+1>>>0,b=new Uint8Array(_);for(;g<l.length;){const $=l.charCodeAt(g);if($>255)return;let k=e[$];if(k===255)return;let Z=0;for(let q=_-1;(k!==0||Z<I)&&q!==-1;q--,Z++)k+=r*b[q]>>>0,b[q]=k%256>>>0,k=k/256>>>0;if(k!==0)throw new Error("Non-zero carry");I=Z,g++}let v=_-I;for(;v!==_&&b[v]===0;)v++;const S=new Uint8Array(m+(_-v));let O=m;for(;v!==_;)S[O++]=b[v++];return S}function c(l){const g=a(l);if(g)return g;throw new Error("Non-base"+r+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var Z2="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const Y2=J2(Z2);function Zc(t,e){switch(e.split(":")[0].toLowerCase()){case"solana":return X2(t);case"eip155":case"ethereum":return Q2(t);case"sui":return eI(t);case"bip122":case"bitcoin":return tI(t);default:return{signature:t,rawSignature:t}}}function Ph(t,e,r){let n=t;if(Al(e))try{const s=ji(t);n="0x"+je.Buffer.from(s).toString("hex")}catch{n=t.startsWith("0x")?t:"0x"+t}return r?{hash:r,rawTransaction:n,blockExplorer:vy(e,"transaction",r)}:{rawTransaction:n}}function X2(t){try{const e=ji(t);return{signature:Y2.encode(e),rawSignature:t}}catch{return{signature:t,rawSignature:t}}}function Q2(t){const e=ji(t);return{signature:"0x"+je.Buffer.from(e).toString("hex"),rawSignature:t}}function eI(t){try{const e=ji(t);return{signature:je.Buffer.from(e).toString("base64"),rawSignature:t}}catch{return{signature:t,rawSignature:t}}}function tI(t){try{const e=ji(t);return{signature:je.Buffer.from(e).toString("hex"),rawSignature:t}}catch{return{signature:t,rawSignature:t}}}function rI(t){try{const e=ji(t);return eg(e)}catch{return null}}function eg(t){try{return zn.from(t)}catch(e){if(e instanceof Error&&e.message.includes("Versioned messages"))return Tu.deserialize(t);throw e}}async function Ch(t,e){const r=e.split(":")[0].toLowerCase();switch(r){case"solana":return nI(t);case"ethereum":case"eip155":case"polygon":case"optimism":case"arbitrum":case"base":return sI(t);case"sui":return await iI(t);case"bitcoin":return oI(t);default:throw new Error(`Unsupported network: ${r}`)}}function nI(t){if(t?.messageBytes!=null)return{parsed:hr(t.messageBytes),originalFormat:"@solana/kit"};if(typeof t?.serialize=="function"){const e=t.serialize({requireAllSignatures:!1,verifySignatures:!1});return{parsed:hr(e),originalFormat:"@solana/web3.js"}}if(t instanceof Uint8Array)return{parsed:hr(t),originalFormat:"bytes"};if(typeof t=="string")try{const e=je.Buffer.from(t,"base64");return{parsed:hr(new Uint8Array(e)),originalFormat:"base64"}}catch{throw new Error("Unsupported Solana transaction format")}throw new Error("Unsupported Solana transaction format")}function sI(t){if(typeof t=="string"&&t.startsWith("0x"))return{parsed:t,originalFormat:"hex"};if(t?.serialize&&typeof t.serialize=="function"){const e=t.serialize();return{parsed:e.startsWith("0x")?e:"0x"+e,originalFormat:"ethers"}}if(t instanceof Uint8Array)return{parsed:"0x"+je.Buffer.from(t).toString("hex"),originalFormat:"bytes"};if(t&&typeof t=="object"&&(t.to||t.data||t.from))try{const{from:e,gas:r,...n}=t;if(r&&(n.gasLimit=r),n.gasLimit||n.to&&n.value&&!n.data&&(n.gasLimit="0x5208"),n.to&&typeof n.to=="string")try{n.to=Gi(n.to)}catch{n.to=n.to.toLowerCase()}const s=Yv.from(n).unsignedSerialized;return{parsed:s.startsWith("0x")?s:"0x"+s,originalFormat:"json"}}catch(e){const r=e instanceof Error?e.message:"Unknown error",n=t?Object.keys(t).join(", "):"N/A",s=t?JSON.stringify(t,null,2):"N/A";throw new Error(`Failed to RLP encode EVM transaction: ${r}.
Transaction keys: [${n}].
Transaction: ${s}
Please ensure the transaction object includes required fields (to, value, chainId, gasLimit or gasPrice, etc.)`)}throw new Error("Unsupported EVM transaction format. Expected hex string, bytes, or transaction object with 'to', 'data', or 'from' fields.")}async function iI(t){if(t?.serialize&&typeof t.serialize=="function"){const e=t.serialize();return{parsed:hr(e),originalFormat:"sui-sdk"}}if(t instanceof Uint8Array)return{parsed:hr(t),originalFormat:"bytes"};if(t?.build&&typeof t.build=="function"){const e=await t.build();if(e?.serialize&&typeof e.serialize=="function"){const r=e.serialize();return{parsed:hr(r),originalFormat:"transaction-block"}}}throw new Error("Unsupported Sui transaction format")}function oI(t){if(t?.toBuffer&&typeof t.toBuffer=="function"){const e=t.toBuffer();return{parsed:hr(new Uint8Array(e)),originalFormat:"bitcoinjs-lib"}}if(t instanceof Uint8Array)return{parsed:hr(t),originalFormat:"bytes"};if(typeof t=="string"){const e=new Uint8Array(je.Buffer.from(t,"hex"));return{parsed:hr(e),originalFormat:"hex"}}throw new Error("Unsupported Bitcoin transaction format")}function aI(t){if(t.length>=255)throw new TypeError("Alphabet too long");const e=new Uint8Array(256);for(let l=0;l<e.length;l++)e[l]=255;for(let l=0;l<t.length;l++){const g=t.charAt(l),m=g.charCodeAt(0);if(e[m]!==255)throw new TypeError(g+" is ambiguous");e[m]=l}const r=t.length,n=t.charAt(0),s=Math.log(r)/Math.log(256),i=Math.log(256)/Math.log(r);function o(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";let g=0,m=0,I=0;const _=l.length;for(;I!==_&&l[I]===0;)I++,g++;const b=(_-I)*i+1>>>0,v=new Uint8Array(b);for(;I!==_;){let $=l[I],k=0;for(let Z=b-1;($!==0||k<m)&&Z!==-1;Z--,k++)$+=256*v[Z]>>>0,v[Z]=$%r>>>0,$=$/r>>>0;if($!==0)throw new Error("Non-zero carry");m=k,I++}let S=b-m;for(;S!==b&&v[S]===0;)S++;let O=n.repeat(g);for(;S<b;++S)O+=t.charAt(v[S]);return O}function a(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;let g=0,m=0,I=0;for(;l[g]===n;)m++,g++;const _=(l.length-g)*s+1>>>0,b=new Uint8Array(_);for(;g<l.length;){const $=l.charCodeAt(g);if($>255)return;let k=e[$];if(k===255)return;let Z=0;for(let q=_-1;(k!==0||Z<I)&&q!==-1;q--,Z++)k+=r*b[q]>>>0,b[q]=k%256>>>0,k=k/256>>>0;if(k!==0)throw new Error("Non-zero carry");I=Z,g++}let v=_-I;for(;v!==_&&b[v]===0;)v++;const S=new Uint8Array(m+(_-v));let O=m;for(;v!==_;)S[O++]=b[v++];return S}function c(l){const g=a(l);if(g)return g;throw new Error("Non-base"+r+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var cI="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const lI=aI(cI);function uI(t){if(t.length>=255)throw new TypeError("Alphabet too long");const e=new Uint8Array(256);for(let l=0;l<e.length;l++)e[l]=255;for(let l=0;l<t.length;l++){const g=t.charAt(l),m=g.charCodeAt(0);if(e[m]!==255)throw new TypeError(g+" is ambiguous");e[m]=l}const r=t.length,n=t.charAt(0),s=Math.log(r)/Math.log(256),i=Math.log(256)/Math.log(r);function o(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";let g=0,m=0,I=0;const _=l.length;for(;I!==_&&l[I]===0;)I++,g++;const b=(_-I)*i+1>>>0,v=new Uint8Array(b);for(;I!==_;){let $=l[I],k=0;for(let Z=b-1;($!==0||k<m)&&Z!==-1;Z--,k++)$+=256*v[Z]>>>0,v[Z]=$%r>>>0,$=$/r>>>0;if($!==0)throw new Error("Non-zero carry");m=k,I++}let S=b-m;for(;S!==b&&v[S]===0;)S++;let O=n.repeat(g);for(;S<b;++S)O+=t.charAt(v[S]);return O}function a(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;let g=0,m=0,I=0;for(;l[g]===n;)m++,g++;const _=(l.length-g)*s+1>>>0,b=new Uint8Array(_);for(;g<l.length;){const $=l.charCodeAt(g);if($>255)return;let k=e[$];if(k===255)return;let Z=0;for(let q=_-1;(k!==0||Z<I)&&q!==-1;q--,Z++)k+=r*b[q]>>>0,b[q]=k%256>>>0,k=k/256>>>0;if(k!==0)throw new Error("Non-zero carry");I=Z,g++}let v=_-I;for(;v!==_&&b[v]===0;)v++;const S=new Uint8Array(m+(_-v));let O=m;for(;v!==_;)S[O++]=b[v++];return S}function c(l){const g=a(l);if(g)return g;throw new Error("Non-base"+r+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var fI="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const tg=uI(fI);var Dh=10080*60*1e3,ka=["google","apple","phantom"],hI=class{constructor(t){this.provider=t,this.currentNetworkId=rr.SOLANA_MAINNET,this._connected=!1,this._publicKey=null,this.eventEmitter=new Qs,this.setupEventListeners(),this.syncInitialState()}get connected(){return this._connected}get publicKey(){return this._publicKey}ensureConnected(){if(!this.provider.isConnected())throw new Error("Solana chain not available. Ensure SDK is connected.")}async signMessage(t){this.ensureConnected();const e=typeof t=="string"?t:new TextDecoder().decode(t),r=await this.provider.signMessage({message:e,networkId:this.currentNetworkId});return{signature:typeof r.signature=="string"?new Uint8Array(tg.decode(r.signature)):r.signature,publicKey:this._publicKey||""}}async signTransaction(t){this.ensureConnected();const e=await this.provider.signTransaction({transaction:t,networkId:this.currentNetworkId}),r=rI(e.rawTransaction);if(!r)throw new Error("Failed to parse signed transaction");return r}async signAndSendTransaction(t){this.ensureConnected();const e=await this.provider.signAndSendTransaction({transaction:t,networkId:this.currentNetworkId});if(!e.hash)throw new Error("Transaction not submitted");return{signature:e.hash}}async signAllTransactions(t){return this.ensureConnected(),await Promise.all(t.map(r=>this.signTransaction(r)))}async signAndSendAllTransactions(t){return{signatures:(await Promise.all(t.map(r=>this.signAndSendTransaction(r)))).map(r=>r.signature)}}connect(t){if(!this.provider.isConnected())throw new Error("Provider not connected. Call provider connect first.");const r=this.provider.getAddresses().find(n=>n.addressType==="Solana");if(!r)throw new Error("No Solana address found");return this.updateConnectionState(!0,r.address),Promise.resolve({publicKey:r.address})}async disconnect(){return this.provider.disconnect()}switchNetwork(t){return this.currentNetworkId=t==="mainnet"?rr.SOLANA_MAINNET:rr.SOLANA_DEVNET,Promise.resolve()}getPublicKey(){if(!this.provider.isConnected())return Promise.resolve(null);const e=this.provider.getAddresses().find(r=>r.addressType==="Solana");return Promise.resolve(e?.address||null)}isConnected(){return this._connected&&this.provider.isConnected()}setupEventListeners(){this.provider.on("connect",t=>{const e=t.addresses?.find(r=>r.addressType==="Solana");e&&(this.updateConnectionState(!0,e.address),this.eventEmitter.emit("connect",e.address))}),this.provider.on("disconnect",()=>{this.updateConnectionState(!1,null),this.eventEmitter.emit("disconnect")})}syncInitialState(){if(this.provider.isConnected()){const e=this.provider.getAddresses().find(r=>r.addressType==="Solana");e&&this.updateConnectionState(!0,e.address)}}updateConnectionState(t,e){this._connected=t,this._publicKey=e}on(t,e){this.eventEmitter.on(t,e)}off(t,e){this.eventEmitter.off(t,e)}},dI=class{constructor(t){this.provider=t,this.currentNetworkId=rr.ETHEREUM_MAINNET,this._connected=!1,this._accounts=[],this.eventEmitter=new Qs,this.setupEventListeners(),this.syncInitialState()}get connected(){return this._connected}get chainId(){return`0x${(gc(this.currentNetworkId)||1).toString(16)}`}get accounts(){return this._accounts}ensureConnected(){if(!this.provider.isConnected())throw new Error("Ethereum chain not available. Ensure SDK is connected.")}async request(t){return this.ensureConnected(),this.handleEmbeddedRequest(t)}connect(){if(!this.provider.isConnected())throw new Error("Provider not connected. Call provider connect first.");const e=this.provider.getAddresses().filter(r=>r.addressType==="Ethereum").map(r=>r.address);return this.updateConnectionState(!0,e),Promise.resolve(e)}async disconnect(){await this.provider.disconnect()}async signPersonalMessage(t,e){return await this.request({method:"personal_sign",params:[t,e]})}async signTypedData(t,e){return await this.request({method:"eth_signTypedData_v4",params:[e,JSON.stringify(t)]})}async signTransaction(t){let e=this.currentNetworkId;if(t.chainId){const n=typeof t.chainId=="number"?t.chainId:parseInt(t.chainId,16),s=Ho(n);s&&(e=s)}return(await this.provider.signTransaction({transaction:t,networkId:e})).rawTransaction}async sendTransaction(t){if(t.chainId){const r=typeof t.chainId=="number"?t.chainId:parseInt(t.chainId,16);await this.switchChain(r)}const e=await this.provider.signAndSendTransaction({transaction:t,networkId:this.currentNetworkId});if(!e.hash)throw new Error("Transaction not submitted");return e.hash}switchChain(t){const e=typeof t=="string"?t.toLowerCase().startsWith("0x")?parseInt(t,16):parseInt(t,10):t,r=Ho(e);if(!r)throw new Error(`Unsupported chainId: ${t}`);return this.currentNetworkId=r,this.eventEmitter.emit("chainChanged",`0x${e.toString(16)}`),Promise.resolve()}getChainId(){const t=gc(this.currentNetworkId);return Promise.resolve(t||1)}async getAccounts(){return this.request({method:"eth_accounts"})}isConnected(){return this._connected&&this.provider.isConnected()}setupEventListeners(){this.provider.on("connect",t=>{const e=t.addresses?.filter(r=>r.addressType==="Ethereum")?.map(r=>r.address)||[];e.length>0&&(this.updateConnectionState(!0,e),this.eventEmitter.emit("connect",{chainId:this.chainId}),this.eventEmitter.emit("accountsChanged",e))}),this.provider.on("disconnect",()=>{this.updateConnectionState(!1,[]),this.eventEmitter.emit("disconnect",{code:4900,message:"Provider disconnected"}),this.eventEmitter.emit("accountsChanged",[])})}syncInitialState(){if(this.provider.isConnected()){const e=this.provider.getAddresses().filter(r=>r.addressType==="Ethereum").map(r=>r.address);e.length>0&&this.updateConnectionState(!0,e)}}updateConnectionState(t,e){this._connected=t,this._accounts=e}async handleEmbeddedRequest(t){switch(t.method){case"personal_sign":{const[e,r]=t.params;return(await this.provider.signEthereumMessage({message:e,networkId:this.currentNetworkId})).signature}case"eth_signTypedData_v4":{const[e,r]=t.params,n=JSON.parse(r);return(await this.provider.signTypedDataV4({typedData:n,networkId:this.currentNetworkId})).signature}case"eth_signTransaction":{const[e]=t.params,r=e.chainId?Ho(typeof e.chainId=="number"?e.chainId:parseInt(e.chainId,16)):null;return(await this.provider.signTransaction({transaction:e,networkId:r||this.currentNetworkId})).rawTransaction}case"eth_sendTransaction":{const[e]=t.params,r=e.chainId?Ho(typeof e.chainId=="number"?e.chainId:parseInt(e.chainId,16)):null;return(await this.provider.signAndSendTransaction({transaction:e,networkId:r||this.currentNetworkId})).hash}case"eth_accounts":{const r=this.provider.getAddresses().find(n=>n.addressType==="Ethereum");return r?[r.address]:[]}case"eth_chainId":return`0x${(gc(this.currentNetworkId)||1).toString(16)}`;case"wallet_switchEthereumChain":{const[{chainId:e}]=t.params,r=parseInt(e,16);await this.switchChain(r);return}default:throw new Error(`Embedded provider doesn't support method: ${t.method}`)}}on(t,e){this.eventEmitter.on(t,e)}off(t,e){this.eventEmitter.off(t,e)}};async function pI(t,e,r,n=3,s=1e3){let i;for(let o=1;o<=n;o++)try{return r.log("EMBEDDED_PROVIDER",`Attempting ${e}`,{attempt:o,maxRetries:n}),await t()}catch(a){if(i=a,r.warn("EMBEDDED_PROVIDER",`${e} failed`,{attempt:o,maxRetries:n,error:a instanceof Error?a.message:String(a)}),o===n){r.error("EMBEDDED_PROVIDER",`${e} failed after ${n} attempts`,{finalError:a instanceof Error?a.message:String(a)});break}const c=s*Math.pow(2,o-1);r.log("EMBEDDED_PROVIDER",`Retrying ${e} in ${c}ms`,{attempt:o+1,delay:c}),await new Promise(l=>setTimeout(l,c))}throw i}function Yc(){return"session_"+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)+"_"+Date.now()}var gI=class{constructor(e,r,n){if(this.client=null,this.walletId=null,this.addresses=[],this.eventListeners=new Map,this.logger=n,this.logger.log("EMBEDDED_PROVIDER","Initializing EmbeddedProvider",{config:e}),e.embeddedWalletType==="app-wallet")throw new Error("app-wallet type is not currently supported. Please use 'user-wallet' instead.");this.config=e,this.platform=r,this.storage=r.storage,this.authProvider=r.authProvider,this.phantomAppProvider=r.phantomAppProvider,this.urlParamsAccessor=r.urlParamsAccessor,this.stamper=r.stamper,this.solana=new hI(this),this.ethereum=new dI(this),this.logger.info("EMBEDDED_PROVIDER","EmbeddedProvider initialized")}on(e,r){this.eventListeners.has(e)||this.eventListeners.set(e,new Set),this.eventListeners.get(e)?.add(r),this.logger.log("EMBEDDED_PROVIDER","Event listener added",{event:e})}off(e,r){const n=this.eventListeners.get(e);n&&(n.delete(r),this.logger.log("EMBEDDED_PROVIDER","Event listener removed",{event:e}))}emit(e,r){const n=this.eventListeners.get(e);n&&n.size>0&&(this.logger.log("EMBEDDED_PROVIDER","Emitting event",{event:e,listenerCount:n.size,data:r}),n.forEach(s=>{try{s(r)}catch(i){this.logger.error("EMBEDDED_PROVIDER","Event callback error",{event:e,error:i})}}))}getAddressForNetwork(e){const r=e.split(":")[0].toLowerCase();let n;switch(r){case"solana":n=st.solana;break;case"eip155":n=st.ethereum;break;case"bitcoin":case"btc":n=st.bitcoinSegwit;break;case"sui":n=st.sui;break;default:n=st.ethereum;break}return this.addresses.find(i=>i.addressType.toLowerCase()===n.toLowerCase())?.address}async getAndFilterWalletAddresses(e){const n=(await this.storage.getSession())?.accountDerivationIndex??0;return(await pI(()=>this.client.getWalletAddresses(e,void 0,n),"getWalletAddresses",this.logger).catch(async i=>{throw this.logger.error("EMBEDDED_PROVIDER","getWalletAddresses failed after retries, disconnecting",{walletId:e,error:i.message,derivationIndex:n}),await this.storage.clearSession(),this.client=null,this.walletId=null,this.addresses=[],i})).filter(i=>this.config.addressTypes.some(o=>o===i.addressType))}async validateAndCleanSession(e){if(!e)return null;if(this.logger.log("EMBEDDED_PROVIDER","Found existing session, validating",{sessionId:e.sessionId,status:e.status,walletId:e.walletId}),e.status!=="completed"){const r=this.urlParamsAccessor.getParam("session_id");if(e.status==="pending"&&!r)return this.logger.warn("EMBEDDED_PROVIDER","Session mismatch detected - pending session without redirect context",{sessionId:e.sessionId,status:e.status}),await this.storage.clearSession(),null;if(r&&r!==e.sessionId)return this.logger.warn("EMBEDDED_PROVIDER","Session ID mismatch detected",{storedSessionId:e.sessionId,urlSessionId:r}),await this.storage.clearSession(),null}return e.status==="completed"&&!this.isSessionValid(e)?(this.logger.warn("EMBEDDED_PROVIDER","Session invalid due to authenticator expiration, will regenerate keypair",{sessionId:e.sessionId,authenticatorExpiresAt:e.authenticatorExpiresAt,currentTime:Date.now(),expired:e.authenticatorExpiresAt<Date.now()}),await this.storage.clearSession(),null):e}async tryExistingConnection(e){this.logger.log("EMBEDDED_PROVIDER","Getting existing session");let r=await this.storage.getSession();if(r=await this.validateAndCleanSession(r),!r)return this.logger.log("EMBEDDED_PROVIDER","No existing session found"),null;if(r.status==="completed"){this.logger.info("EMBEDDED_PROVIDER","Using existing completed session",{sessionId:r.sessionId,walletId:r.walletId}),await this.initializeClientFromSession(r),r.lastUsed=Date.now(),await this.storage.saveSession(r),this.logger.info("EMBEDDED_PROVIDER","Connection from existing session successful",{walletId:this.walletId,addressCount:this.addresses.length}),await this.ensureValidAuthenticator();const n={walletId:this.walletId,addresses:this.addresses,status:"completed",authUserId:r.authUserId,authProvider:r.authProvider};return this.emit("connect",{...n,source:"existing-session"}),n}if(this.logger.log("EMBEDDED_PROVIDER","No completed session found, checking for redirect resume"),this.authProvider.resumeAuthFromRedirect){const n=this.authProvider.resumeAuthFromRedirect(r.authProvider);if(n){this.logger.info("EMBEDDED_PROVIDER","Resuming from redirect",{walletId:n.walletId,provider:n.provider});try{return await this.completeAuthConnection(n)}catch(s){if(s instanceof Error&&s.message.includes("No session found after redirect")&&!e)return this.logger.warn("EMBEDDED_PROVIDER","Session missing during redirect resume - will start fresh auth flow",{error:s.message,walletId:n.walletId}),await this.storage.clearSession(),null;throw s}}}return null}validateAuthOptions(e){if(!ka.includes(e.provider))throw new Error(`Invalid auth provider: ${e.provider}. Must be ${ka.join(", ")}`)}isSessionValid(e){return e?!e.walletId||!e.organizationId||!e.stamperInfo?(this.logger.log("EMBEDDED_PROVIDER","Session missing required fields",{hasWalletId:!!e.walletId,hasOrganizationId:!!e.organizationId,hasStamperInfo:!!e.stamperInfo}),!1):e.status!=="completed"?(this.logger.log("EMBEDDED_PROVIDER","Session not completed",{status:e.status}),!1):e.authenticatorExpiresAt?Date.now()>=e.authenticatorExpiresAt?(this.logger.log("EMBEDDED_PROVIDER","Authenticator expired, session invalid",{authenticatorExpiresAt:new Date(e.authenticatorExpiresAt).toISOString(),now:new Date().toISOString()}),!1):(this.logger.log("EMBEDDED_PROVIDER","Session is valid",{sessionId:e.sessionId,walletId:e.walletId,authenticatorExpires:new Date(e.authenticatorExpiresAt).toISOString()}),!0):(this.logger.log("EMBEDDED_PROVIDER","Session invalid - missing authenticator timing",{sessionId:e.sessionId}),!1):!1}async autoConnect(){try{this.logger.log("EMBEDDED_PROVIDER","Starting auto-connect attempt"),this.emit("connect_start",{source:"auto-connect"});const e=await this.tryExistingConnection(!0);if(e){this.logger.info("EMBEDDED_PROVIDER","Auto-connect successful",{walletId:e.walletId,addressCount:e.addresses.length}),this.emit("connect",{...e,source:"auto-connect"});return}this.logger.log("EMBEDDED_PROVIDER","Auto-connect failed: no valid session found"),this.emit("connect_error",{error:"No valid session found",source:"auto-connect"})}catch(e){this.logger.error("EMBEDDED_PROVIDER","Auto-connect failed",{error:e instanceof Error?e.message:String(e)}),this.emit("connect_error",{error:e instanceof Error?e.message:"Auto-connect failed",source:"auto-connect"}),await this.storage.setShouldClearPreviousSession(!0)}}async initializeStamper(){this.logger.log("EMBEDDED_PROVIDER","Initializing stamper"),await this.stamper.init(),this.logger.log("EMBEDDED_PROVIDER","Resetting keypair to avoid conflicts with existing keypairs");const e=await this.stamper.resetKeyPair();this.logger.log("EMBEDDED_PROVIDER","Stamper initialized with fresh keypair",{publicKey:e.publicKey,keyId:e.keyId,algorithm:this.stamper.algorithm});const r=Dh;return this.logger.info("EMBEDDED_PROVIDER","Stamper ready for auth flow with fresh keypair",{publicKey:e.publicKey,keyId:e.keyId}),{stamperInfo:e,expiresInMs:r}}async createOrganizationForAppWallet(e,r){const n=new bc({apiBaseUrl:this.config.apiBaseUrl,headers:{...this.platform.analyticsHeaders||{}}}),s=this.platform.name||"unknown",i=e.publicKey.slice(0,8),o=`${this.config.appId.substring(0,8)}-${s}-${i}`;this.logger.log("EMBEDDED_PROVIDER","Creating organization for app-wallet",{organizationName:o,publicKey:e.publicKey,platform:s});const a=hr(tg.decode(e.publicKey)),c=`user-${i0()}`,{organizationId:l}=await n.createOrganization(o,[{username:c,role:"ADMIN",authenticators:[{authenticatorName:`auth-${i}`,authenticatorKind:"keypair",publicKey:a,algorithm:"Ed25519",expiresInMs:r}]}]);return this.logger.info("EMBEDDED_PROVIDER","Organization created for app-wallet",{organizationId:l}),l}async connect(e){try{this.logger.info("EMBEDDED_PROVIDER","Starting embedded provider connect",{authOptions:{provider:e.provider}}),this.emit("connect_start",{source:"manual-connect",authOptions:{provider:e.provider}});const r=await this.tryExistingConnection(!1);if(r)return this.logger.info("EMBEDDED_PROVIDER","Manual connect using existing connection",{walletId:r.walletId,addressCount:r.addresses.length}),this.emit("connect",{...r,source:"manual-existing"}),r;this.validateAuthOptions(e),this.logger.info("EMBEDDED_PROVIDER","No existing connection available, creating new auth flow with fresh keypair");const{stamperInfo:n,expiresInMs:s}=await this.initializeStamper(),i=await this.handleAuthFlow(n.publicKey,n,e,s);if(!i)return{addresses:[],status:"pending",authProvider:e.provider};this.config.embeddedWalletType==="app-wallet"&&(i.lastUsed=Date.now(),await this.storage.saveSession(i)),await this.initializeClientFromSession(i),await this.ensureValidAuthenticator();const o={walletId:this.walletId,addresses:this.addresses,status:"completed",authUserId:i?.authUserId,authProvider:i?.authProvider};return this.emit("connect",{...o,source:"manual"}),o}catch(r){throw this.logger.error("EMBEDDED_PROVIDER","Connect failed with error",{error:r instanceof Error?{name:r.name,message:r.message,stack:r.stack}:r}),this.emit("connect_error",{error:r instanceof Error?r.message:String(r),source:"manual-connect"}),r instanceof Error?r.message.includes("IndexedDB")||r.message.includes("storage")?new Error("Storage error: Unable to access browser storage. Please ensure storage is available and try again."):r.message.includes("network")||r.message.includes("fetch")?new Error("Network error: Unable to connect to authentication server. Please check your internet connection and try again."):r.message.includes("JWT")||r.message.includes("jwt")?new Error(`JWT Authentication error: ${r.message}`):r.message.includes("Authentication")||r.message.includes("auth")?new Error(`Authentication error: ${r.message}`):r.message.includes("organization")||r.message.includes("wallet")?new Error(`Wallet creation error: ${r.message}`):r:new Error(`Embedded wallet connection failed: ${String(r)}`)}}async disconnect(e=!0){const r=this.client!==null;await this.storage.setShouldClearPreviousSession(e),this.logger.log("EMBEDDED_PROVIDER","Set flag to clear previous session on next login"),await this.storage.clearSession(),this.client=null,this.walletId=null,this.addresses=[],this.logger.info("EMBEDDED_PROVIDER","Disconnected from embedded wallet"),r&&this.emit("disconnect",{source:"manual"})}async signMessage(e){if(!this.client||!this.walletId)throw new Error("Not connected");await this.ensureValidAuthenticator(),this.logger.info("EMBEDDED_PROVIDER","Signing message",{walletId:this.walletId,message:e.message});const n=(await this.storage.getSession())?.accountDerivationIndex??0,s=await this.client.signUtf8Message({walletId:this.walletId,message:e.message,networkId:e.networkId,derivationIndex:n});return this.logger.info("EMBEDDED_PROVIDER","Message signed successfully",{walletId:this.walletId,message:e.message}),Zc(s,e.networkId)}async signEthereumMessage(e){if(!this.client||!this.walletId)throw new Error("Not connected");await this.ensureValidAuthenticator(),this.logger.info("EMBEDDED_PROVIDER","Signing message",{walletId:this.walletId,message:e.message});const r=c=>/^0x[0-9a-fA-F]+$/.test(c),n=(()=>{if(r(e.message)){const c=e.message.slice(2),l=c.length%2===0?c:`0${c}`;return je.Buffer.from(l,"hex").toString("utf8")}return e.message})(),s=P1(n),o=(await this.storage.getSession())?.accountDerivationIndex??0,a=await this.client.ethereumSignMessage({walletId:this.walletId,message:s,networkId:e.networkId,derivationIndex:o});return this.logger.info("EMBEDDED_PROVIDER","Message signed successfully",{walletId:this.walletId,message:e.message}),Zc(a,e.networkId)}async signTypedDataV4(e){if(!this.client||!this.walletId)throw new Error("Not connected");await this.ensureValidAuthenticator(),this.logger.info("EMBEDDED_PROVIDER","Signing typed data",{walletId:this.walletId,typedData:e.typedData});const n=(await this.storage.getSession())?.accountDerivationIndex??0,s=await this.client.ethereumSignTypedData({walletId:this.walletId,typedData:e.typedData,networkId:e.networkId,derivationIndex:n});return this.logger.info("EMBEDDED_PROVIDER","Typed data signed successfully",{walletId:this.walletId}),Zc(s,e.networkId)}async signTransaction(e){if(!this.client||!this.walletId)throw new Error("Not connected");await this.ensureValidAuthenticator(),this.logger.info("EMBEDDED_PROVIDER","Signing transaction",{walletId:this.walletId,networkId:e.networkId});const r=await Ch(e.transaction,e.networkId),s=(await this.storage.getSession())?.accountDerivationIndex??0;this.logger.log("EMBEDDED_PROVIDER","Parsed transaction for signing",{walletId:this.walletId,transaction:r,derivationIndex:s});const i=r.parsed;if(!i)throw new Error("Failed to parse transaction: no valid encoding found");const o=this.getAddressForNetwork(e.networkId);if(!o)throw new Error(`No address found for network ${e.networkId}`);const a=await this.client.signTransaction({walletId:this.walletId,transaction:i,networkId:e.networkId,derivationIndex:s,account:o});return this.logger.info("EMBEDDED_PROVIDER","Transaction signed successfully",{walletId:this.walletId,networkId:e.networkId,rawTransaction:a.rawTransaction}),await Ph(a.rawTransaction,e.networkId)}async signAndSendTransaction(e){if(!this.client||!this.walletId)throw new Error("Not connected");await this.ensureValidAuthenticator(),this.logger.info("EMBEDDED_PROVIDER","Signing and sending transaction",{walletId:this.walletId,networkId:e.networkId});const r=await Ch(e.transaction,e.networkId),s=(await this.storage.getSession())?.accountDerivationIndex??0;this.logger.log("EMBEDDED_PROVIDER","Parsed transaction for signing",{walletId:this.walletId,transaction:r,derivationIndex:s});const i=r.parsed;if(!i)throw new Error("Failed to parse transaction: no valid encoding found");const o=this.getAddressForNetwork(e.networkId);if(!o)throw new Error(`No address found for network ${e.networkId}`);let a;try{a=await this.client.signAndSendTransaction({walletId:this.walletId,transaction:i,networkId:e.networkId,derivationIndex:s,account:o})}catch(c){throw c instanceof l0&&this.emit("spending_limit_reached",{error:c}),c}return this.logger.info("EMBEDDED_PROVIDER","Transaction signed and sent successfully",{walletId:this.walletId,networkId:e.networkId,hash:a.hash,rawTransaction:a.rawTransaction}),await Ph(a.rawTransaction,e.networkId,a.hash)}getAddresses(){return this.addresses}isConnected(){return this.client!==null&&this.walletId!==null}async handleAuthFlow(e,r,n,s){if(this.config.embeddedWalletType==="user-wallet")return this.logger.info("EMBEDDED_PROVIDER","Creating user-wallet, routing authentication",{authProvider:n.provider}),n.provider==="phantom"?await this.handlePhantomAuth(e,r,s):(this.logger.info("EMBEDDED_PROVIDER","Starting redirect-based authentication flow",{publicKey:e,provider:n?.provider}),await this.handleRedirectAuth(e,r,n));{this.logger.info("EMBEDDED_PROVIDER","Creating app-wallet",{publicKey:e});const i=await this.createOrganizationForAppWallet(r,s),c=(await new bc({apiBaseUrl:this.config.apiBaseUrl,organizationId:i,headers:{...this.platform.analyticsHeaders||{}}},this.stamper).createWallet(`Wallet ${Date.now()}`)).walletId,l=Date.now(),g={sessionId:Yc(),walletId:c,organizationId:i,appId:this.config.appId,stamperInfo:r,authProvider:"device",accountDerivationIndex:0,status:"completed",createdAt:l,lastUsed:l,authenticatorCreatedAt:l,authenticatorExpiresAt:Date.now()+s,lastRenewalAttempt:void 0};return await this.storage.saveSession(g),this.logger.info("EMBEDDED_PROVIDER","App-wallet created successfully",{walletId:c,organizationId:i}),g}}async handlePhantomAuth(e,r,n){if(this.logger.info("EMBEDDED_PROVIDER","Starting Phantom authentication flow"),!this.phantomAppProvider.isAvailable())throw this.logger.error("EMBEDDED_PROVIDER","Phantom app not available"),new Error("Phantom app is not available. Please install the Phantom browser extension or mobile app to use this authentication method.");this.logger.info("EMBEDDED_PROVIDER","Phantom app detected, proceeding with authentication");const i=Yc(),o=await this.phantomAppProvider.authenticate({publicKey:e,appId:this.config.appId,sessionId:i});this.logger.info("EMBEDDED_PROVIDER","Phantom authentication completed",{walletId:o.walletId,organizationId:o.organizationId});const a=o.expiresInMs>0?o.expiresInMs:n,c=Date.now(),l={sessionId:i,walletId:o.walletId,organizationId:o.organizationId,appId:this.config.appId,stamperInfo:r,authProvider:"phantom",accountDerivationIndex:o.accountDerivationIndex,status:"completed",createdAt:c,lastUsed:c,authenticatorCreatedAt:c,authenticatorExpiresAt:c+a,lastRenewalAttempt:void 0,authUserId:o.authUserId};return this.logger.log("EMBEDDED_PROVIDER","Saving Phantom session"),await this.storage.saveSession(l),l}async handleRedirectAuth(e,r,n){this.logger.info("EMBEDDED_PROVIDER","Using Phantom Connect authentication flow (redirect-based)",{provider:n.provider,hasRedirectUrl:!!this.config.authOptions.redirectUrl,authUrl:this.config.authOptions.authUrl});const s=Date.now(),i=Yc(),o={sessionId:i,walletId:`temp-wallet-${s}`,organizationId:`temp-org-${s}`,appId:this.config.appId,stamperInfo:r,authProvider:n.provider,accountDerivationIndex:void 0,status:"pending",createdAt:s,lastUsed:s,authenticatorCreatedAt:s,authenticatorExpiresAt:s+Dh,lastRenewalAttempt:void 0};this.logger.log("EMBEDDED_PROVIDER","Saving temporary session before redirect",{sessionId:o.sessionId,tempWalletId:o.walletId}),o.lastUsed=Date.now(),await this.storage.saveSession(o);const a=await this.storage.getShouldClearPreviousSession();this.logger.info("EMBEDDED_PROVIDER","Starting Phantom Connect redirect",{publicKey:e,appId:this.config.appId,provider:n?.provider,authUrl:this.config.authOptions.authUrl,clearPreviousSession:a,allowRefresh:!a});const c=await this.authProvider.authenticate({publicKey:e,appId:this.config.appId,provider:n?.provider,redirectUrl:this.config.authOptions.redirectUrl,authUrl:this.config.authOptions.authUrl,sessionId:i,clearPreviousSession:a,allowRefresh:!a});if(c&&"walletId"in c){if(this.logger.info("EMBEDDED_PROVIDER","Authentication completed after redirect",{walletId:c.walletId,organizationId:c.organizationId,provider:c.provider}),o.walletId=c.walletId,o.organizationId=c.organizationId,o.authProvider=c.provider||o.authProvider,o.accountDerivationIndex=c.accountDerivationIndex,o.authUserId=c.authUserId,o.status="completed",o.lastUsed=Date.now(),c.expiresInMs>0){const l=Date.now();o.authenticatorCreatedAt=l,o.authenticatorExpiresAt=l+c.expiresInMs,this.logger.log("EMBEDDED_PROVIDER","Updated authenticator expiration from immediate auth response",{expiresInMs:c.expiresInMs,expiresAt:new Date(o.authenticatorExpiresAt).toISOString()})}return await this.storage.saveSession(o),await this.storage.setShouldClearPreviousSession(!1),this.logger.log("EMBEDDED_PROVIDER","Cleared logout flag after successful authentication"),o}return this.logger.info("EMBEDDED_PROVIDER","Redirect authentication initiated, waiting for redirect completion"),null}async completeAuthConnection(e){const r=await this.storage.getSession();if(!r)throw new Error("No session found after redirect - session may have expired");if(r.walletId=e.walletId,r.authProvider=e.provider||r.authProvider,r.organizationId=e.organizationId,r.accountDerivationIndex=e.accountDerivationIndex,r.authUserId=e.authUserId,r.status="completed",r.lastUsed=Date.now(),e.expiresInMs>0){const n=Date.now();r.authenticatorCreatedAt=n,r.authenticatorExpiresAt=n+e.expiresInMs,this.logger.log("EMBEDDED_PROVIDER","Updated authenticator expiration from auth response",{expiresInMs:e.expiresInMs,expiresAt:new Date(r.authenticatorExpiresAt).toISOString()})}return await this.storage.saveSession(r),await this.storage.setShouldClearPreviousSession(!1),this.logger.log("EMBEDDED_PROVIDER","Cleared logout flag after successful authentication"),await this.initializeClientFromSession(r),await this.ensureValidAuthenticator(),{walletId:this.walletId,addresses:this.addresses,status:"completed",authUserId:r.authUserId,authProvider:r.authProvider}}async ensureValidAuthenticator(){const e=await this.storage.getSession();if(!e)throw new Error("No active session found");const r=Date.now();if(!e.authenticatorExpiresAt)throw this.logger.warn("EMBEDDED_PROVIDER","Session missing authenticator timing - treating as invalid session"),await this.disconnect(!1),new Error("Invalid session - missing authenticator timing");const n=e.authenticatorExpiresAt-r;if(this.logger.log("EMBEDDED_PROVIDER","Checking authenticator expiration",{expiresAt:new Date(e.authenticatorExpiresAt).toISOString(),timeUntilExpiry:n}),n<=0)throw this.logger.error("EMBEDDED_PROVIDER","Authenticator has expired, disconnecting"),await this.disconnect(!1),new Error("Authenticator expired")}async initializeClientFromSession(e){this.logger.log("EMBEDDED_PROVIDER","Initializing PhantomClient from session",{organizationId:e.organizationId,walletId:e.walletId,appId:e.appId}),this.stamper.getKeyInfo()||await this.stamper.init(),this.client=new bc({apiBaseUrl:this.config.apiBaseUrl,organizationId:e.organizationId,headers:{...this.platform.analyticsHeaders||{},...e.authUserId?{"x-auth-user-id":e.authUserId}:{}}},this.stamper),this.walletId=e.walletId,this.addresses=await this.getAndFilterWalletAddresses(e.walletId)}};function wI(t){if(t.length>=255)throw new TypeError("Alphabet too long");const e=new Uint8Array(256);for(let l=0;l<e.length;l++)e[l]=255;for(let l=0;l<t.length;l++){const g=t.charAt(l),m=g.charCodeAt(0);if(e[m]!==255)throw new TypeError(g+" is ambiguous");e[m]=l}const r=t.length,n=t.charAt(0),s=Math.log(r)/Math.log(256),i=Math.log(256)/Math.log(r);function o(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";let g=0,m=0,I=0;const _=l.length;for(;I!==_&&l[I]===0;)I++,g++;const b=(_-I)*i+1>>>0,v=new Uint8Array(b);for(;I!==_;){let $=l[I],k=0;for(let Z=b-1;($!==0||k<m)&&Z!==-1;Z--,k++)$+=256*v[Z]>>>0,v[Z]=$%r>>>0,$=$/r>>>0;if($!==0)throw new Error("Non-zero carry");m=k,I++}let S=b-m;for(;S!==b&&v[S]===0;)S++;let O=n.repeat(g);for(;S<b;++S)O+=t.charAt(v[S]);return O}function a(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;let g=0,m=0,I=0;for(;l[g]===n;)m++,g++;const _=(l.length-g)*s+1>>>0,b=new Uint8Array(_);for(;g<l.length;){const $=l.charCodeAt(g);if($>255)return;let k=e[$];if(k===255)return;let Z=0;for(let q=_-1;(k!==0||Z<I)&&q!==-1;q--,Z++)k+=r*b[q]>>>0,b[q]=k%256>>>0,k=k/256>>>0;if(k!==0)throw new Error("Non-zero carry");I=Z,g++}let v=_-I;for(;v!==_&&b[v]===0;)v++;const S=new Uint8Array(m+(_-v));let O=m;for(;v!==_;)S[O++]=b[v++];return S}function c(l){const g=a(l);if(g)return g;throw new Error("Non-base"+r+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var mI="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const Xc=wI(mI);var yI=class{constructor(t={}){if(this.db=null,this.activeKeyPairRecord=null,this.pendingKeyPairRecord=null,this.algorithm=Ps.ed25519,this.type="PKI",typeof window>"u"||!window.indexedDB)throw new Error("IndexedDbStamper requires a browser environment with IndexedDB support");this.dbName=t.dbName||"phantom-indexed-db-stamper",this.storeName=t.storeName||"crypto-keys",this.keyName=t.keyName||"signing-key",this.type=t.type||"PKI",this.idToken=t.idToken,this.salt=t.salt}async init(){return await this.openDB(),this.activeKeyPairRecord=await this.loadActiveKeyPairRecord(),this.activeKeyPairRecord||(this.activeKeyPairRecord=await this.generateAndStoreNewKeyPair("active")),this.pendingKeyPairRecord=await this.loadPendingKeyPairRecord(),this.activeKeyPairRecord.keyInfo}getKeyInfo(){return this.activeKeyPairRecord?.keyInfo||null}async resetKeyPair(){return await this.clearStoredKeys(),this.activeKeyPairRecord=await this.generateAndStoreNewKeyPair("active"),this.pendingKeyPairRecord=null,this.activeKeyPairRecord.keyInfo}async stamp(t){const{data:e}=t;if(!this.activeKeyPairRecord)throw new Error("Stamper not initialized. Call init() first.");const r=new Uint8Array(e),n=await crypto.subtle.sign({name:this.algorithm,hash:"SHA-256"},this.activeKeyPairRecord.keyPair.privateKey,r),s=hr(new Uint8Array(n)),i=t.type||this.type,o=t.type==="OIDC"?t.idToken:this.idToken,a=t.type==="OIDC"?t.salt:this.salt,c=i==="PKI"?{publicKey:hr(Xc.decode(this.activeKeyPairRecord.keyInfo.publicKey)),signature:s,kind:"PKI",algorithm:this.algorithm}:{kind:"OIDC",idToken:o,publicKey:hr(Xc.decode(this.activeKeyPairRecord.keyInfo.publicKey)),salt:a,algorithm:this.algorithm,signature:s},l=JSON.stringify(c);return hr(l)}async clear(){await this.clearStoredKeys(),this.activeKeyPairRecord=null,this.pendingKeyPairRecord=null}async clearStoredKeys(){return this.db||await this.openDB(),new Promise((t,e)=>{const n=this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName),s=n.delete(`${this.keyName}-active`),i=n.delete(`${this.keyName}-pending`);let o=0;const a=2,c=()=>{o++,o===a&&t()};s.onsuccess=c,i.onsuccess=c,s.onerror=()=>e(s.error),i.onerror=()=>e(i.error)})}async openDB(){return new Promise((t,e)=>{const r=indexedDB.open(this.dbName,1);r.onerror=()=>e(r.error),r.onsuccess=()=>{this.db=r.result,t()},r.onupgradeneeded=n=>{const s=n.target.result;s.objectStoreNames.contains(this.storeName)||s.createObjectStore(this.storeName)}})}async rotateKeyPair(){return this.db||await this.openDB(),this.pendingKeyPairRecord=await this.generateAndStoreNewKeyPair("pending"),this.pendingKeyPairRecord.keyInfo}async commitRotation(t){if(!this.pendingKeyPairRecord)throw new Error("No pending keypair to commit");this.activeKeyPairRecord&&await this.removeKeyPairRecord("active"),this.pendingKeyPairRecord.status="active",this.pendingKeyPairRecord.authenticatorId=t,this.pendingKeyPairRecord.keyInfo.authenticatorId=t,this.activeKeyPairRecord=this.pendingKeyPairRecord,this.pendingKeyPairRecord=null,await this.storeKeyPairRecord(this.activeKeyPairRecord,"active"),await this.removeKeyPairRecord("pending")}async rollbackRotation(){this.pendingKeyPairRecord&&(await this.removeKeyPairRecord("pending"),this.pendingKeyPairRecord=null)}async generateAndStoreNewKeyPair(t){const e=await crypto.subtle.generateKey({name:"Ed25519"},!1,["sign","verify"]),r=await crypto.subtle.exportKey("raw",e.publicKey),n=Xc.encode(new Uint8Array(r)),s=await crypto.subtle.digest("SHA-256",r),i=hr(new Uint8Array(s)).substring(0,16),o=Date.now(),c={keyPair:e,keyInfo:{keyId:i,publicKey:n,createdAt:o},createdAt:o,expiresAt:0,status:t};return await this.storeKeyPairRecord(c,t),c}async storeKeyPairRecord(t,e){if(!this.db)throw new Error("Database not initialized");return new Promise((r,n)=>{const o=this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName).put(t,`${this.keyName}-${e}`);o.onsuccess=()=>r(),o.onerror=()=>n(o.error)})}async loadActiveKeyPairRecord(){return this.db?new Promise((t,e)=>{const s=this.db.transaction([this.storeName],"readonly").objectStore(this.storeName).get(`${this.keyName}-active`);s.onsuccess=()=>t(s.result||null),s.onerror=()=>e(s.error)}):null}async loadPendingKeyPairRecord(){return this.db?new Promise((t,e)=>{const s=this.db.transaction([this.storeName],"readonly").objectStore(this.storeName).get(`${this.keyName}-pending`);s.onsuccess=()=>t(s.result||null),s.onerror=()=>e(s.error)}):null}async removeKeyPairRecord(t){if(this.db)return new Promise((e,r)=>{const i=this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName).delete(`${this.keyName}-${t}`);i.onsuccess=()=>e(),i.onerror=()=>r(i.error)})}},lo=class{constructor(){this.level=0,this.enabled=!1}static getInstance(){return lo.instance||(lo.instance=new lo),lo.instance}setCallback(t){this.callback=t}setLevel(t){this.level=t}enable(){this.enabled=!0}disable(){this.enabled=!1}writeLog(t,e,r,n){if(!this.enabled||t>this.level)return;const s={timestamp:Date.now(),level:t,category:e,message:r,data:n};this.callback&&this.callback(s)}error(t,e,r){this.writeLog(0,t,e,r)}warn(t,e,r){this.writeLog(1,t,e,r)}info(t,e,r){this.writeLog(2,t,e,r)}debug(t,e,r){this.writeLog(3,t,e,r)}log(t,e,r){this.writeLog(3,t,e,r)}},K=lo.getInstance(),z={BROWSER_SDK:"BrowserSDK",PROVIDER_MANAGER:"ProviderManager",EMBEDDED_PROVIDER:"EmbeddedProvider",INJECTED_PROVIDER:"InjectedProvider",PHANTOM_CONNECT_AUTH:"PhantomConnectAuth",JWT_AUTH:"JWTAuth",STORAGE:"Storage",SESSION:"Session"};function bI(t){return t.rdns?t.rdns.split(".").reverse().join("-"):t.name.toLowerCase().replace(/\s+/g,"-")}function vI(t){return t.toLowerCase().replace(/\s+/g,"-")}function EI(t){const e=[];K.log(z.BROWSER_SDK,"Processing EIP-6963 providers",{providerCount:t.size,providerNames:Array.from(t.values()).map(r=>r.info.name)});for(const[,r]of t){const{info:n,provider:s}=r;if(n.name.toLowerCase().includes("phantom")||n.rdns&&(n.rdns.toLowerCase().includes("phantom")||n.rdns.toLowerCase()==="app.phantom")){K.log(z.BROWSER_SDK,"Skipping Phantom from EIP-6963",{name:n.name,rdns:n.rdns});continue}const o=bI(n);K.log(z.BROWSER_SDK,"Discovered EIP-6963 wallet",{walletId:o,walletName:n.name,rdns:n.rdns}),e.push({id:o,name:n.name,icon:n.icon,addressTypes:[st.ethereum],providers:{ethereum:s},rdns:n.rdns,discovery:"eip6963"})}return K.log(z.BROWSER_SDK,"EIP-6963 discovery completed",{discoveredCount:e.length,walletIds:e.map(r=>r.id)}),e}function xI(){return new Promise(t=>{const e=new Map;if(typeof window>"u"){t([]);return}const r=s=>{const i=s.detail;i?.info&&i?.provider&&e.set(i.info.uuid,i)};window.addEventListener("eip6963:announceProvider",r),window.dispatchEvent(new Event("eip6963:requestProvider")),setTimeout(()=>{const s=EI(e);window.removeEventListener("eip6963:announceProvider",r),t(s)},400)})}async function _I(){const t=[];if(typeof window>"u"||typeof navigator>"u")return K.log(z.BROWSER_SDK,"Wallet Standard discovery skipped (not in browser environment)"),t;const e=new Set;let r;function n(v){r=void 0,e.add(v);const S=v.features?Object.keys(v.features):[];K.log(z.BROWSER_SDK,"Wallet registered",{name:v.name,chains:v.chains,featureKeys:S,totalWallets:e.size})}function s(v){r=void 0,e.delete(v)}function i(){return r||(r=[...e]),r}function o(...v){return v=v.filter(S=>!e.has(S)),v.length?(v.forEach(S=>n(S)),function(){v.forEach(O=>s(O))}):()=>{}}const a=Object.freeze({register:o}),c=v=>{const S=v.detail;if(typeof S=="function")try{S(a)}catch(O){K.warn(z.BROWSER_SDK,"Error calling wallet registration callback",{error:O})}};try{window.addEventListener("wallet-standard:register-wallet",c)}catch(v){K.warn(z.BROWSER_SDK,"Could not add register-wallet event listener",{error:v})}class l extends Event{constructor(S){super("wallet-standard:app-ready",{bubbles:!1,cancelable:!1,composed:!1}),this.detail=S}}try{window.dispatchEvent(new l(a)),K.log(z.BROWSER_SDK,"Dispatched wallet-standard:app-ready event")}catch(v){K.warn(z.BROWSER_SDK,"Could not dispatch app-ready event",{error:v})}const g={getWallets:()=>({get:i,on:(v,S)=>()=>{},register:o})};navigator.wallets||(navigator.wallets=g),K.log(z.BROWSER_SDK,"Initialized Wallet Standard registry"),await new Promise(v=>setTimeout(v,100));const m=navigator.wallets||window.wallets;if(!m||typeof m.getWallets!="function"){const v={hasNavigator:!!navigator,hasWindow:typeof window<"u",note:"Wallet Standard API not properly initialized"};return K.log(z.BROWSER_SDK,"Wallet Standard API not available",v),t}const I=m.getWallets(),_=()=>Promise.resolve([...I.get()]);K.log(z.BROWSER_SDK,"Wallet Standard API detected, starting discovery");try{let v=[],S=0;const O=5,$=100,k=400;for(await new Promise(q=>setTimeout(q,$));S<O;){v=await _();const q={attempt:S+1,walletCount:v.length,walletNames:v.map(J=>J.name),chains:v.flatMap(J=>J.chains)};if(K.log(z.BROWSER_SDK,`Wallet Standard getWallets attempt ${S+1}`,q),v.length>0||S===O-1)break;await new Promise(J=>setTimeout(J,$)),S++}const Z=$+S*$;if(Z<k){const q=k-Z;await new Promise(J=>setTimeout(J,q)),v=await _()}K.log(z.BROWSER_SDK,"Wallet Standard getWallets final result",{walletCount:v.length,walletNames:v.map(q=>q.name),attempts:S+1});for(const q of v){if(!(q.chains.some(V=>{const W=V.toLowerCase();return W.startsWith("solana:")||W==="solana"})||q.features&&typeof q.features=="object"&&Object.keys(q.features).some(V=>V.toLowerCase().startsWith("solana:")))){const V=q.features?Object.keys(q.features):[];K.log(z.BROWSER_SDK,"Wallet does not support Solana",{walletName:q.name,chains:q.chains,featureKeys:V});continue}if(q.name.toLowerCase().includes("phantom")){K.log(z.BROWSER_SDK,"Skipping Phantom from Wallet Standard (handled separately)");continue}const se=vI(q.name),oe=q.features?Object.keys(q.features):[];K.log(z.BROWSER_SDK,"Discovered Wallet Standard Solana wallet",{walletId:se,walletName:q.name,chains:q.chains,featureKeys:oe,icon:q.icon,version:q.version,accountCount:q.accounts?.length||0}),t.push({id:se,name:q.name,icon:q.icon,addressTypes:[st.solana],providers:{solana:q},discovery:"standard"})}}catch(v){K.warn(z.BROWSER_SDK,"Wallet Standard API error",{error:v instanceof Error?v.message:String(v),stack:v instanceof Error?v.stack:void 0})}const b={discoveredCount:t.length,walletIds:t.map(v=>v.id),walletNames:t.map(v=>v.name)};return K.log(z.BROWSER_SDK,"Wallet Standard Solana discovery completed",b),t}function II(t){if(typeof window>"u"||!Ga())return null;const e=[o1()];t.includes(st.solana)&&e.push(E1()),t.includes(st.ethereum)&&e.push(s1()),e.push(R1());const r=a1({plugins:e});return{id:"phantom",name:"Phantom",icon:void 0,addressTypes:t,providers:{solana:t.includes(st.solana)?r.solana:void 0,ethereum:t.includes(st.ethereum)?r.ethereum:void 0},isPhantom:!0,phantomInstance:r,discovery:"phantom"}}async function SI(t){const e=t||[];K.log(z.BROWSER_SDK,"Starting all wallet discovery methods",{addressTypes:e});const[r,n]=await Promise.all([_I(),xI()]),s=II(e);K.log(z.BROWSER_SDK,"All wallet discovery methods completed",{phantomFound:!!s,solanaWalletsCount:r.length,ethereumWalletsCount:n.length,solanaWalletIds:r.map(o=>o.id),ethereumWalletIds:n.map(o=>o.id)});const i=new Map;s&&i.set("phantom",s);for(const o of[...r,...n]){const a=i.get(o.id);if(a){const c=Array.from(new Set([...a.addressTypes,...o.addressTypes])),l={...a.providers,...o.providers},g={...a,addressTypes:c,icon:o.icon||a.icon,providers:l};i.set(o.id,g),K.log(z.BROWSER_SDK,"Merged wallet by ID",{walletName:o.name,walletId:o.id,existingAddressTypes:a.addressTypes,newAddressTypes:o.addressTypes,mergedAddressTypes:c,existingProviders:Object.keys(a.providers||{}),newProviders:Object.keys(o.providers||{}),mergedProviders:Object.keys(l)}),K.log(z.BROWSER_SDK,"Merged wallet from multiple discovery methods",{walletId:o.id,walletName:o.name,existingAddressTypes:a.addressTypes,newAddressTypes:o.addressTypes,mergedAddressTypes:c})}else i.set(o.id,o)}return Array.from(i.values())}var kh=class{constructor(t,e,r){this.eventEmitter=new Qs,this._connected=!1,this._publicKey=null,this.provider=t,this.walletId=e,this.walletName=r,this.setupEventListeners()}get connected(){return this._connected}get publicKey(){return this._publicKey}async connect(t){K.log(z.INJECTED_PROVIDER,"External wallet Solana connect",{walletId:this.walletId,walletName:this.walletName,onlyIfTrusted:t?.onlyIfTrusted});try{const e=await this.provider.connect(t);if(typeof e=="string")return this._connected=!0,this._publicKey=e,K.info(z.INJECTED_PROVIDER,"External wallet Solana connected",{walletId:this.walletId,walletName:this.walletName,publicKey:e}),{publicKey:e};if(typeof e=="object"&&e!==null&&"publicKey"in e)return this._connected=!0,this._publicKey=e.publicKey,K.info(z.INJECTED_PROVIDER,"External wallet Solana connected",{walletId:this.walletId,walletName:this.walletName,publicKey:e.publicKey}),e;if(Array.isArray(e)&&e.length>0){const r=e[0];if(typeof r=="object"&&r!==null&&"address"in r)return this._connected=!0,this._publicKey=r.address,K.info(z.INJECTED_PROVIDER,"External wallet Solana connected",{walletId:this.walletId,walletName:this.walletName,publicKey:r.address}),{publicKey:r.address}}throw new Error("Unexpected connect result format")}catch(e){throw K.error(z.INJECTED_PROVIDER,"External wallet Solana connect failed",{walletId:this.walletId,walletName:this.walletName,error:e instanceof Error?e.message:String(e)}),e}}async disconnect(){K.log(z.INJECTED_PROVIDER,"External wallet Solana disconnect",{walletId:this.walletId,walletName:this.walletName});try{await this.provider.disconnect(),this._connected=!1,this._publicKey=null,K.info(z.INJECTED_PROVIDER,"External wallet Solana disconnected",{walletId:this.walletId,walletName:this.walletName})}catch(t){throw K.error(z.INJECTED_PROVIDER,"External wallet Solana disconnect failed",{walletId:this.walletId,walletName:this.walletName,error:t instanceof Error?t.message:String(t)}),t}}async signMessage(t){const e=typeof t=="string"?new TextEncoder().encode(t):t,r=typeof t=="string"?t.substring(0,50):`${e.length} bytes`;K.log(z.INJECTED_PROVIDER,"External wallet Solana signMessage",{walletId:this.walletId,walletName:this.walletName,messagePreview:r,messageLength:e.length});try{const n=await this.provider.signMessage(t);return K.info(z.INJECTED_PROVIDER,"External wallet Solana signMessage success",{walletId:this.walletId,walletName:this.walletName,signatureLength:n.signature.length}),{signature:n.signature instanceof Uint8Array?n.signature:new Uint8Array(je.Buffer.from(n.signature,"base64")),publicKey:n.publicKey||this._publicKey||""}}catch(n){throw K.error(z.INJECTED_PROVIDER,"External wallet Solana signMessage failed",{walletId:this.walletId,walletName:this.walletName,error:n instanceof Error?n.message:String(n)}),n}}async signTransaction(t){K.log(z.INJECTED_PROVIDER,"External wallet Solana signTransaction",{walletId:this.walletId,walletName:this.walletName});try{const e=await this.provider.signTransaction(t);return K.info(z.INJECTED_PROVIDER,"External wallet Solana signTransaction success",{walletId:this.walletId,walletName:this.walletName}),e}catch(e){throw K.error(z.INJECTED_PROVIDER,"External wallet Solana signTransaction failed",{walletId:this.walletId,walletName:this.walletName,error:e instanceof Error?e.message:String(e)}),e}}async signAndSendTransaction(t){K.log(z.INJECTED_PROVIDER,"External wallet Solana signAndSendTransaction",{walletId:this.walletId,walletName:this.walletName});try{const e=await this.provider.signAndSendTransaction(t);return K.info(z.INJECTED_PROVIDER,"External wallet Solana signAndSendTransaction success",{walletId:this.walletId,walletName:this.walletName,signature:e.signature}),e}catch(e){throw K.error(z.INJECTED_PROVIDER,"External wallet Solana signAndSendTransaction failed",{walletId:this.walletId,walletName:this.walletName,error:e instanceof Error?e.message:String(e)}),e}}async signAllTransactions(t){K.log(z.INJECTED_PROVIDER,"External wallet Solana signAllTransactions",{walletId:this.walletId,walletName:this.walletName,transactionCount:t.length});try{const e=await this.provider.signAllTransactions(t);return K.info(z.INJECTED_PROVIDER,"External wallet Solana signAllTransactions success",{walletId:this.walletId,walletName:this.walletName,signedCount:e.length}),e}catch(e){throw K.error(z.INJECTED_PROVIDER,"External wallet Solana signAllTransactions failed",{walletId:this.walletId,walletName:this.walletName,error:e instanceof Error?e.message:String(e)}),e}}async signAndSendAllTransactions(t){K.log(z.INJECTED_PROVIDER,"External wallet Solana signAndSendAllTransactions",{walletId:this.walletId,walletName:this.walletName,transactionCount:t.length});try{const e=await this.provider.signAndSendAllTransactions(t);return K.info(z.INJECTED_PROVIDER,"External wallet Solana signAndSendAllTransactions success",{walletId:this.walletId,walletName:this.walletName,signatureCount:e.signatures.length}),e}catch(e){throw K.error(z.INJECTED_PROVIDER,"External wallet Solana signAndSendAllTransactions failed",{walletId:this.walletId,walletName:this.walletName,error:e instanceof Error?e.message:String(e)}),e}}switchNetwork(t){return Promise.resolve()}getPublicKey(){return Promise.resolve(this._publicKey)}isConnected(){return this._connected}setupEventListeners(){typeof this.provider.on=="function"&&(this.provider.on("connect",t=>{this._connected=!0,this._publicKey=t,this.eventEmitter.emit("connect",t)}),this.provider.on("disconnect",()=>{this._connected=!1,this._publicKey=null,this.eventEmitter.emit("disconnect")}),this.provider.on("accountChanged",t=>{this._publicKey=t,this._connected=t!=null&&t.length>0,this.eventEmitter.emit("accountChanged",t)}))}on(t,e){this.eventEmitter.on(t,e)}off(t,e){this.eventEmitter.off(t,e)}},AI=class{constructor(t,e,r){this.eventEmitter=new Qs,this._publicKey=null,this.wallet=t,this.walletId=e,this.walletName=r,this.setupEventListeners()}get connected(){return this._publicKey!==null}get publicKey(){return this._publicKey}async connect(t){try{const e=this.wallet.features["standard:connect"];if(!e)throw new Error("Wallet Standard connect feature not available");const r=await e.connect();let n;if(Array.isArray(r)&&r.length>0?n=r:this.wallet.accounts&&this.wallet.accounts.length>0&&(n=Array.from(this.wallet.accounts)),!n||n.length===0)throw new Error("No accounts available after connecting to wallet");const s=n[0];if(!s)throw new Error("First account is null or undefined");let i;if(typeof s=="string"?i=s:typeof s=="object"&&s!==null&&(i=s.address||s.publicKey?.toString()||(s.publicKey instanceof Uint8Array?je.Buffer.from(s.publicKey).toString("hex"):void 0)),!i)throw new Error(`Could not extract address from account. Account structure: ${JSON.stringify(s,null,2)}`);return this._publicKey=i,{publicKey:i}}catch(e){throw K.error(z.INJECTED_PROVIDER,"Wallet Standard Solana connect failed",{walletId:this.walletId,walletName:this.walletName,error:e instanceof Error?e.message:String(e)}),e}}async disconnect(){try{const t=this.wallet.features["standard:disconnect"];t&&await t.disconnect(),this._publicKey=null}catch(t){throw K.error(z.INJECTED_PROVIDER,"Wallet Standard Solana disconnect failed",{walletId:this.walletId,walletName:this.walletName,error:t instanceof Error?t.message:String(t)}),t}}async signMessage(t){try{const e=this.wallet.features["solana:signMessage"];if(!e)throw new Error("Wallet Standard signMessage feature not available");const r=typeof t=="string"?new TextEncoder().encode(t):t,n=await e.signMessage({message:r,account:this.wallet.accounts[0]});if(!Array.isArray(n)||n.length===0)throw new Error(`Expected array result from signMessage, got: ${typeof n}`);const s=n[0];if(!s||!s.signature)throw new Error(`Invalid signMessage result structure: ${JSON.stringify(n)}`);const i=this.parseUint8Array(s.signature);if(i.length===0)throw new Error("Signature is empty");const o=s.account?.address||this.wallet.accounts[0]?.address||this._publicKey||"";return{signature:i,publicKey:o}}catch(e){throw K.error(z.INJECTED_PROVIDER,"Wallet Standard Solana signMessage failed",{walletId:this.walletId,walletName:this.walletName,error:e instanceof Error?e.message:String(e)}),e}}async signTransaction(t){try{const e=this.wallet.features["solana:signTransaction"];if(!e)throw new Error("Wallet Standard signTransaction feature not available");if(!this.wallet.accounts||this.wallet.accounts.length===0)throw new Error("No accounts available. Please connect first.");const r=this.wallet.accounts[0],n=this.serializeTransaction(t),s=await e.signTransaction({transaction:n,account:r});let i;if(Array.isArray(s)&&s.length>0){const c=s[0];c&&typeof c=="object"&&(i=c.signedTransaction||c.transaction)}else if(s&&typeof s=="object"&&!Array.isArray(s)){const c=s;i=c.transaction||c.signedTransaction}if(!i)throw new Error("No transaction data found in Wallet Standard result");const o=this.parseUint8Array(i);if(o.length===0)throw new Error("Empty signed transaction returned from Wallet Standard");return eg(o)}catch(e){throw K.error(z.INJECTED_PROVIDER,"Wallet Standard Solana signTransaction failed",{walletId:this.walletId,walletName:this.walletName,error:e instanceof Error?e.message:String(e)}),e}}async signAndSendTransaction(t){try{const e=this.wallet.features["solana:signAndSendTransaction"];if(!e)throw new Error("Wallet Standard signAndSendTransaction feature not available");if(!this.wallet.accounts||this.wallet.accounts.length===0)throw new Error("No accounts available. Please connect first.");const r=this.wallet.accounts[0],n=r.chains?.[0]||"solana:mainnet",s=this.serializeTransaction(t),i=await e.signAndSendTransaction({transaction:s,account:r,chain:n});let o;if(Array.isArray(i)&&i.length>0)o=i[0];else if(i&&typeof i=="object"&&!Array.isArray(i))o=i;else throw new Error("Invalid signAndSendTransaction result format");if(!o.signature)throw new Error("No signature found in signAndSendTransaction result");const a=this.parseUint8Array(o.signature);return{signature:lI.encode(a)}}catch(e){throw K.error(z.INJECTED_PROVIDER,"Wallet Standard Solana signAndSendTransaction failed",{walletId:this.walletId,walletName:this.walletName,error:e instanceof Error?e.message:String(e)}),e}}async signAllTransactions(t){try{const e=[];for(const r of t){const n=await this.signTransaction(r);e.push(n)}return e}catch(e){throw K.error(z.INJECTED_PROVIDER,"Wallet Standard Solana signAllTransactions failed",{walletId:this.walletId,walletName:this.walletName,error:e instanceof Error?e.message:String(e)}),e}}async signAndSendAllTransactions(t){try{const e=[];for(const r of t){const n=await this.signAndSendTransaction(r);e.push(n.signature)}return{signatures:e}}catch(e){throw K.error(z.INJECTED_PROVIDER,"Wallet Standard Solana signAndSendAllTransactions failed",{walletId:this.walletId,walletName:this.walletName,error:e instanceof Error?e.message:String(e)}),e}}async switchNetwork(t){return Promise.resolve()}getPublicKey(){return Promise.resolve(this._publicKey)}isConnected(){return this._publicKey!==null}setupEventListeners(){const t=this.wallet.features["standard:events"];if(!t){K.log(z.INJECTED_PROVIDER,"Wallet Standard events feature not available",{walletId:this.walletId,walletName:this.walletName});return}K.log(z.INJECTED_PROVIDER,"Setting up Wallet Standard event listeners",{walletId:this.walletId,walletName:this.walletName}),t.on("change",e=>{if(K.log(z.INJECTED_PROVIDER,"Wallet Standard change event received",{walletId:this.walletId,walletName:this.walletName,hasAccounts:!!e.accounts,accountCount:e.accounts?.length||0}),e.accounts!==void 0)if(e.accounts.length>0){const r=e.accounts[0],n=this.extractAccountAddress(r);n?(this._publicKey=n,this.eventEmitter.emit("accountChanged",n),this.eventEmitter.emit("connect",n),K.log(z.INJECTED_PROVIDER,"Emitted accountChanged and connect events",{walletId:this.walletId,walletName:this.walletName,address:n})):(this._publicKey=null,this.eventEmitter.emit("accountChanged",null),K.log(z.INJECTED_PROVIDER,"Emitted accountChanged event (null - invalid account)",{walletId:this.walletId,walletName:this.walletName}))}else this._publicKey=null,this.eventEmitter.emit("accountChanged",null),this.eventEmitter.emit("disconnect"),K.log(z.INJECTED_PROVIDER,"Emitted accountChanged and disconnect events",{walletId:this.walletId,walletName:this.walletName})})}extractAccountAddress(t){return t.address}on(t,e){this.eventEmitter.on(t,e),K.log(z.INJECTED_PROVIDER,"Added event listener",{walletId:this.walletId,walletName:this.walletName,event:t})}off(t,e){this.eventEmitter.off(t,e),K.log(z.INJECTED_PROVIDER,"Removed event listener",{walletId:this.walletId,walletName:this.walletName,event:t})}serializeTransaction(t){return typeof t.serialize=="function"?t.serialize({requireAllSignatures:!1,verifySignatures:!1}):t instanceof Uint8Array?t:new Uint8Array(0)}parseUint8Array(t){if(t instanceof Uint8Array)return t;if(Array.isArray(t))return new Uint8Array(t);if(typeof t=="object"&&t!==null){const e=Object.keys(t).map(Number).filter(r=>!isNaN(r)&&r>=0).sort((r,n)=>r-n);if(e.length>0){const r=Math.max(...e),n=new Uint8Array(r+1);for(const s of e)n[s]=Number(t[s])||0;return n}}return new Uint8Array(0)}},Nh=class{constructor(t,e,r){this.eventEmitter=new Qs,this._connected=!1,this._chainId="0x1",this._accounts=[],this.provider=t,this.walletId=e,this.walletName=r,this.setupEventListeners()}get connected(){return this._connected}get chainId(){return this._chainId}get accounts(){return this._accounts}async request(t){K.log(z.INJECTED_PROVIDER,"External wallet Ethereum request",{walletId:this.walletId,walletName:this.walletName,method:t.method});try{["personal_sign","eth_sign","eth_signTypedData","eth_signTypedData_v4","eth_sendTransaction","eth_signTransaction"].includes(t.method)&&(!this._connected||this._accounts.length===0)&&(K.log(z.INJECTED_PROVIDER,"Method requires authorization, ensuring connection",{walletId:this.walletId,walletName:this.walletName,method:t.method}),await this.connect());const r=await this.provider.request(t);return K.info(z.INJECTED_PROVIDER,"External wallet Ethereum request success",{walletId:this.walletId,walletName:this.walletName,method:t.method}),r}catch(e){if(e?.code===4100){K.log(z.INJECTED_PROVIDER,"Got 4100 Unauthorized, attempting to re-authorize",{walletId:this.walletId,walletName:this.walletName,method:t.method});try{await this.provider.request({method:"eth_requestAccounts"});const r=await this.provider.request(t);return K.info(z.INJECTED_PROVIDER,"External wallet Ethereum request success (after re-auth)",{walletId:this.walletId,walletName:this.walletName,method:t.method}),r}catch(r){throw K.error(z.INJECTED_PROVIDER,"Failed after re-authorization",{walletId:this.walletId,walletName:this.walletName,method:t.method,error:r instanceof Error?r.message:String(r)}),r}}throw K.error(z.INJECTED_PROVIDER,"External wallet Ethereum request failed",{walletId:this.walletId,walletName:this.walletName,method:t.method,error:e instanceof Error?e.message:String(e),errorCode:e?.code}),e}}async connect(){K.log(z.INJECTED_PROVIDER,"External wallet Ethereum connect",{walletId:this.walletId,walletName:this.walletName});try{const t=await this.provider.request({method:"eth_requestAccounts"});return this._connected=t.length>0,this._accounts=t,K.info(z.INJECTED_PROVIDER,"External wallet Ethereum connected (via eth_requestAccounts)",{walletId:this.walletId,walletName:this.walletName,accountCount:t.length,accounts:t}),t}catch(t){throw K.error(z.INJECTED_PROVIDER,"External wallet Ethereum connect failed",{walletId:this.walletId,walletName:this.walletName,error:t instanceof Error?t.message:String(t)}),t}}async disconnect(){K.log(z.INJECTED_PROVIDER,"External wallet Ethereum disconnect",{walletId:this.walletId,walletName:this.walletName});try{await this.provider.disconnect(),this._connected=!1,this._accounts=[],K.info(z.INJECTED_PROVIDER,"External wallet Ethereum disconnected",{walletId:this.walletId,walletName:this.walletName})}catch(t){throw K.error(z.INJECTED_PROVIDER,"External wallet Ethereum disconnect failed",{walletId:this.walletId,walletName:this.walletName,error:t instanceof Error?t.message:String(t)}),t}}async signPersonalMessage(t,e){const r=t.length>50?t.substring(0,50)+"...":t;K.log(z.INJECTED_PROVIDER,"External wallet Ethereum signPersonalMessage",{walletId:this.walletId,walletName:this.walletName,messagePreview:r,messageLength:t.length,address:e});try{const n=this.provider.isConnected?.()||this.provider.connected||!1;(!this._connected||this._accounts.length===0||!n)&&(K.log(z.INJECTED_PROVIDER,"Not connected, attempting to connect before signing",{walletId:this.walletId,walletName:this.walletName,internalConnected:this._connected,accountsLength:this._accounts.length,providerConnected:n}),await this.connect());const s=e.toLowerCase();if(!this._accounts.map(a=>a.toLowerCase()).includes(s)){K.warn(z.INJECTED_PROVIDER,"Address not in connected accounts, refreshing connection",{walletId:this.walletId,walletName:this.walletName,requestedAddress:e,connectedAccounts:this._accounts});const a=await this.getAccounts();if(!a.map(l=>l.toLowerCase()).includes(s))throw new Error(`Address ${e} is not connected. Connected accounts: ${a.join(", ")}`);this._accounts=a}if(typeof this.provider.signPersonalMessage=="function"){const a=await this.provider.signPersonalMessage(t,e);return K.info(z.INJECTED_PROVIDER,"External wallet Ethereum signPersonalMessage success",{walletId:this.walletId,walletName:this.walletName,signatureLength:a.length}),a}const o=await this.request({method:"personal_sign",params:[t,e]});return K.info(z.INJECTED_PROVIDER,"External wallet Ethereum signPersonalMessage success",{walletId:this.walletId,walletName:this.walletName,signatureLength:o.length}),o}catch(n){throw K.error(z.INJECTED_PROVIDER,"External wallet Ethereum signPersonalMessage failed",{walletId:this.walletId,walletName:this.walletName,error:n instanceof Error?n.message:String(n),errorCode:n?.code}),n}}async signTypedData(t,e){K.log(z.INJECTED_PROVIDER,"External wallet Ethereum signTypedData",{walletId:this.walletId,walletName:this.walletName,primaryType:t?.primaryType,address:e});try{if(typeof this.provider.signTypedData=="function"){const n=await this.provider.signTypedData(t,e);return K.info(z.INJECTED_PROVIDER,"External wallet Ethereum signTypedData success",{walletId:this.walletId,walletName:this.walletName,signatureLength:n.length}),n}const r=await this.request({method:"eth_signTypedData_v4",params:[e,t]});return K.info(z.INJECTED_PROVIDER,"External wallet Ethereum signTypedData success",{walletId:this.walletId,walletName:this.walletName,signatureLength:r.length}),r}catch(r){throw K.error(z.INJECTED_PROVIDER,"External wallet Ethereum signTypedData failed",{walletId:this.walletId,walletName:this.walletName,error:r instanceof Error?r.message:String(r)}),r}}async signTransaction(t){K.log(z.INJECTED_PROVIDER,"External wallet Ethereum signTransaction",{walletId:this.walletId,walletName:this.walletName,from:t.from,to:t.to});try{if(typeof this.provider.signTransaction=="function"){const r=await this.provider.signTransaction(t);return K.info(z.INJECTED_PROVIDER,"External wallet Ethereum signTransaction success",{walletId:this.walletId,walletName:this.walletName,signatureLength:r.length}),r}const e=await this.request({method:"eth_signTransaction",params:[t]});return K.info(z.INJECTED_PROVIDER,"External wallet Ethereum signTransaction success",{walletId:this.walletId,walletName:this.walletName,signatureLength:e.length}),e}catch(e){throw K.error(z.INJECTED_PROVIDER,"External wallet Ethereum signTransaction failed",{walletId:this.walletId,walletName:this.walletName,error:e instanceof Error?e.message:String(e)}),e}}async sendTransaction(t){K.log(z.INJECTED_PROVIDER,"External wallet Ethereum sendTransaction",{walletId:this.walletId,walletName:this.walletName,from:t.from,to:t.to,value:t.value});try{if(typeof this.provider.sendTransaction=="function"){const r=await this.provider.sendTransaction(t);return K.info(z.INJECTED_PROVIDER,"External wallet Ethereum sendTransaction success",{walletId:this.walletId,walletName:this.walletName,txHash:r}),r}const e=await this.request({method:"eth_sendTransaction",params:[t]});return K.info(z.INJECTED_PROVIDER,"External wallet Ethereum sendTransaction success",{walletId:this.walletId,walletName:this.walletName,txHash:e}),e}catch(e){throw K.error(z.INJECTED_PROVIDER,"External wallet Ethereum sendTransaction failed",{walletId:this.walletId,walletName:this.walletName,error:e instanceof Error?e.message:String(e)}),e}}async switchChain(t){K.log(z.INJECTED_PROVIDER,"External wallet Ethereum switchChain",{walletId:this.walletId,walletName:this.walletName,chainId:t});try{const e=typeof t=="string"?t.toLowerCase().startsWith("0x")?t:`0x${parseInt(t,10).toString(16)}`:`0x${t.toString(16)}`;typeof this.provider.switchChain=="function"?await this.provider.switchChain(e):await this.request({method:"wallet_switchEthereumChain",params:[{chainId:e}]}),this._chainId=e,this.eventEmitter.emit("chainChanged",this._chainId),K.info(z.INJECTED_PROVIDER,"External wallet Ethereum switchChain success",{walletId:this.walletId,walletName:this.walletName,chainId:e})}catch(e){throw K.error(z.INJECTED_PROVIDER,"External wallet Ethereum switchChain failed",{walletId:this.walletId,walletName:this.walletName,error:e instanceof Error?e.message:String(e)}),e}}async getChainId(){if(typeof this.provider.getChainId=="function"){const r=await this.provider.getChainId();return this._chainId=`0x${r.toString(16)}`,r}const t=await this.request({method:"eth_chainId"}),e=parseInt(t,16);return this._chainId=t,e}async getAccounts(){if(typeof this.provider.getAccounts=="function"){const e=await this.provider.getAccounts();return this._accounts=e,e}const t=await this.request({method:"eth_accounts"});return this._accounts=t,t}isConnected(){return this._connected}setupEventListeners(){typeof this.provider.on=="function"&&(this.provider.on("connect",t=>{this._connected=!0,this._chainId=t.chainId,this.eventEmitter.emit("connect",t)}),this.provider.on("disconnect",t=>{this._connected=!1,this._accounts=[],this.eventEmitter.emit("disconnect",t),this.eventEmitter.emit("accountsChanged",[])}),this.provider.on("accountsChanged",t=>{this._accounts=t,this._connected=t.length>0,this.eventEmitter.emit("accountsChanged",t)}),this.provider.on("chainChanged",t=>{this._chainId=t,this.eventEmitter.emit("chainChanged",t)}))}on(t,e){this.eventEmitter.on(t,e)}off(t,e){this.eventEmitter.off(t,e)}};function wi(t){return t!==void 0&&t.id==="phantom"&&"isPhantom"in t&&t.isPhantom===!0}function RI(t){return t!==null&&typeof t=="object"&&"features"in t&&typeof t.features=="object"}var BI=class{constructor(){this.wallets=new Map,this.discoveryPromise=null}register(t){const e={};t.providers?.solana&&(RI(t.providers.solana)?(e.solana=new AI(t.providers.solana,t.id,t.name),K.log(z.BROWSER_SDK,"Wrapped Wallet Standard Solana wallet with adapter",{walletId:t.id,walletName:t.name})):(e.solana=new kh(t.providers.solana,t.id,t.name),K.log(z.BROWSER_SDK,"Wrapped Solana provider with InjectedWalletSolanaChain",{walletId:t.id,walletName:t.name}))),t.providers?.ethereum&&(e.ethereum=new Nh(t.providers.ethereum,t.id,t.name),K.log(z.BROWSER_SDK,"Wrapped Ethereum provider with InjectedWalletEthereumChain",{walletId:t.id,walletName:t.name}));const r={...t,providers:Object.keys(e).length>0?e:t.providers};this.wallets.set(t.id,r)}registerPhantom(t,e){const r={};e.includes(st.solana)&&t.solana&&(r.solana=new kh(t.solana,"phantom","Phantom"),K.log(z.BROWSER_SDK,"Created InjectedWalletSolanaChain wrapper for Phantom",{walletId:"phantom"})),e.includes(st.ethereum)&&t.ethereum&&(r.ethereum=new Nh(t.ethereum,"phantom","Phantom"),K.log(z.BROWSER_SDK,"Created InjectedWalletEthereumChain wrapper for Phantom",{walletId:"phantom"}));const n={id:"phantom",name:"Phantom",icon:"",addressTypes:e,providers:r,isPhantom:!0,phantomInstance:t,discovery:"phantom"};this.wallets.set("phantom",n),K.log(z.BROWSER_SDK,"Registered Phantom wallet with chain wrappers",{addressTypes:e,hasSolana:!!r.solana,hasEthereum:!!r.ethereum})}unregister(t){this.wallets.delete(t)}has(t){return this.wallets.has(t)}getById(t){return this.wallets.get(t)}getAll(){return Array.from(this.wallets.values())}getByAddressTypes(t){if(t.length===0)return this.getAll();const e=new Set(t);return this.getAll().filter(r=>r.addressTypes.some(n=>e.has(n)))}discover(t){return this.discoveryPromise?this.discoveryPromise:(K.log(z.BROWSER_SDK,"Starting wallet discovery",{addressTypes:t}),this.discoveryPromise=SI(t).then(e=>{const r=t?e.filter(n=>n.addressTypes.some(s=>t.includes(s))):e;for(const n of r)n.id==="phantom"&&wi(n)?this.registerPhantom(n.phantomInstance,n.addressTypes):this.register(n),K.log(z.BROWSER_SDK,"Registered discovered wallet",{id:n.id,name:n.name,addressTypes:n.addressTypes});K.info(z.BROWSER_SDK,"Wallet discovery completed",{totalDiscovered:e.length,relevantWallets:r.length})}).catch(e=>{throw K.warn(z.BROWSER_SDK,"Wallet discovery failed",{error:e}),this.discoveryPromise=null,e}),this.discoveryPromise)}},Qc=null;function rg(){return Qc||(Qc=new BI),Qc}var el="phantom-injected-was-connected",Oh="true",Mh="phantom-injected-last-wallet-id",TI=class{constructor(t){this.selectedWalletId=null,this.walletStates=new Map,this.eventListeners=new Map,this.eventsInitialized=!1,this.eventListenersSetup=new Set,this.eventListenerCleanups=new Map,K.log(z.INJECTED_PROVIDER,"Initializing InjectedProvider",{config:t}),this.addressTypes=t.addressTypes,this.walletRegistry=rg(),K.log(z.INJECTED_PROVIDER,"Address types configured",{addressTypes:this.addressTypes}),this.walletRegistry.discover(this.addressTypes).catch(e=>{K.warn(z.INJECTED_PROVIDER,"Wallet discovery failed during initialization",{error:e})}),K.info(z.INJECTED_PROVIDER,"InjectedProvider initialized")}async waitForWalletDiscovery(t){if(!this.walletRegistry.has(t)){K.log(z.INJECTED_PROVIDER,"Wallet not found in registry, waiting for discovery",{walletId:t});try{await this.walletRegistry.discover(this.addressTypes),K.log(z.INJECTED_PROVIDER,"Wallet discovery completed",{walletId:t})}catch(e){K.warn(z.INJECTED_PROVIDER,"Wallet discovery failed",{walletId:t,error:e instanceof Error?e.message:String(e)})}}}getChainProvider(t,e,r){if(!this.addressTypes.includes(t))throw new Error(`${r} not enabled for this provider`);const n=this.selectedWalletId||"phantom",s=this.walletRegistry.getById(n);if(!s)throw this.walletRegistry.discoveryPromise?new Error(`Wallet "${n}" not found. Wallet discovery is still in progress. Please wait for sdk.discoverWallets() to complete before accessing chain properties.`):new Error(`Wallet "${n}" not found. Please ensure wallet discovery has completed. Make sure you call sdk.discoverWallets() and await it before accessing chain properties.`);const i=s.providers?.[e];if(!i)throw new Error(`Selected wallet "${s.name}" does not support ${r}. This wallet only supports: ${s.addressTypes.join(", ")}. Make sure your SDK config includes ${r} in addressTypes.`);return i}get solana(){return this.getChainProvider(st.solana,"solana","Solana")}get ethereum(){return this.getChainProvider(st.ethereum,"ethereum","Ethereum")}validateAndSelectWallet(t){if(!this.walletRegistry.has(t))throw K.error(z.INJECTED_PROVIDER,"Unknown injected wallet id requested",{walletId:t}),new Error(`Unknown injected wallet id: ${t}`);const e=this.walletRegistry.getById(t);if(!e||!e.providers)throw K.warn(z.INJECTED_PROVIDER,"Wallet not available for connection",{walletId:t}),new Error(`Wallet not available for connection: ${t}`);return this.selectedWalletId=t,K.log(z.INJECTED_PROVIDER,"Selected injected wallet for connection",{walletId:t}),e}async connectToWallet(t,e){if(!t.providers){const n=new Error(`Wallet adapter not available for wallet: ${this.selectedWalletId}`);throw K.error(z.INJECTED_PROVIDER,"Wallet adapter not available",{walletId:this.selectedWalletId}),this.emit("connect_error",{error:n.message,source:e?.skipEventListeners?"auto-connect":"manual-connect"}),n}K.log(z.INJECTED_PROVIDER,"Connecting via wallet",{walletId:this.selectedWalletId,walletName:t.name,options:e}),e?.skipEventListeners||this.setupEventListeners(t);const r=[];if(this.addressTypes.includes(st.solana)&&t.providers?.solana){K.log(z.INJECTED_PROVIDER,"Attempting Solana connection",{walletId:this.selectedWalletId,walletName:t.name,onlyIfTrusted:e?.onlyIfTrusted});try{const s=(await t.providers.solana.connect(e?.onlyIfTrusted?{onlyIfTrusted:!0}:void 0)).publicKey;r.push({addressType:st.solana,address:s}),K.info(z.INJECTED_PROVIDER,"Solana connected successfully",{address:s,walletId:this.selectedWalletId,walletName:t.name})}catch(n){throw K.warn(z.INJECTED_PROVIDER,"Failed to connect Solana, stopping",{error:n,walletId:this.selectedWalletId,walletName:t.name}),this.emit("connect_error",{error:n instanceof Error?n.message:"Failed to connect",source:e?.skipEventListeners?"auto-connect":"manual-connect"}),n}}if(this.addressTypes.includes(st.ethereum)&&t.providers?.ethereum){K.log(z.INJECTED_PROVIDER,"Attempting Ethereum connection",{walletId:this.selectedWalletId,walletName:t.name,silent:e?.silent});try{let n;e?.silent?n=await t.providers.ethereum.request({method:"eth_accounts"}):n=await t.providers.ethereum.connect(),n.length>0&&(r.push(...n.map(s=>({addressType:st.ethereum,address:s}))),K.info(z.INJECTED_PROVIDER,"Ethereum connected successfully",{addresses:n,walletId:this.selectedWalletId,walletName:t.name}))}catch(n){throw K.warn(z.INJECTED_PROVIDER,"Failed to connect Ethereum, stopping",{error:n,walletId:this.selectedWalletId,walletName:t.name}),this.emit("connect_error",{error:n instanceof Error?n.message:"Failed to connect",source:e?.skipEventListeners?"auto-connect":"manual-connect"}),n}}return r}async finalizeConnection(t,e,r){if(t.length===0){const a=new Error("Failed to connect to any supported wallet provider");throw this.emit("connect_error",{error:a.message,source:"manual-connect"}),a}this.selectedWalletId&&this.setWalletState(this.selectedWalletId,{connected:!0,addresses:t}),K.log(z.INJECTED_PROVIDER,"Finalized connection with addresses",{addressCount:t.length,addresses:t.map(a=>({type:a.addressType,address:a.address.substring(0,10)+"..."}))});const n=await this.getAuthUserId("manual-connect");try{localStorage.setItem(el,Oh),K.log(z.INJECTED_PROVIDER,"Set was-connected flag - auto-reconnect enabled"),this.selectedWalletId&&(localStorage.setItem(Mh,this.selectedWalletId),K.log(z.INJECTED_PROVIDER,"Stored last injected wallet id",{walletId:this.selectedWalletId}))}catch(a){K.warn(z.INJECTED_PROVIDER,"Failed to persist injected provider state",{error:a})}const s=r?this.walletRegistry.getById(r):void 0,i=s?{id:s.id,name:s.name,icon:s.icon,addressTypes:s.addressTypes,rdns:s.rdns,discovery:s.discovery}:void 0,o={addresses:t,status:"completed",authUserId:n,authProvider:e,walletId:r,wallet:i};return this.emit("connect",{addresses:t,source:"manual-connect",authUserId:n}),o}async connect(t){if(K.info(z.INJECTED_PROVIDER,"Starting injected provider connect",{addressTypes:this.addressTypes,provider:t.provider}),t.provider!=="injected")throw new Error(`Invalid provider for injected connection: ${t.provider}. Must be "injected"`);this.emit("connect_start",{source:"manual-connect",providerType:"injected"});try{const e=t.walletId||"phantom",r=this.validateAndSelectWallet(e),n=await this.connectToWallet(r);return await this.finalizeConnection(n,"injected",this.selectedWalletId||void 0)}catch(e){throw this.emit("connect_error",{error:e instanceof Error?e.message:"Failed to connect",source:"manual-connect"}),e}}async disconnect(){K.info(z.INJECTED_PROVIDER,"Starting injected provider disconnect");const t=this.walletRegistry.getById(this.selectedWalletId||"phantom");if(t?.providers){if(this.addressTypes.includes(st.solana)&&t.providers.solana)try{await t.providers.solana.disconnect(),K.log(z.INJECTED_PROVIDER,"Solana disconnected successfully")}catch(n){K.warn(z.INJECTED_PROVIDER,"Failed to disconnect Solana",{error:n})}if(this.addressTypes.includes(st.ethereum)&&t.providers.ethereum)try{await t.providers.ethereum.disconnect(),K.log(z.INJECTED_PROVIDER,"Ethereum disconnected successfully")}catch(n){K.warn(z.INJECTED_PROVIDER,"Failed to disconnect Ethereum",{error:n})}}const e=this.selectedWalletId||"phantom",r=this.eventListenerCleanups.get(e);r&&(r.forEach(n=>n()),this.eventListenerCleanups.delete(e)),this.eventListenersSetup.delete(e),this.selectedWalletId&&this.setWalletState(this.selectedWalletId,{connected:!1,addresses:[]});try{localStorage.removeItem(el),K.log(z.INJECTED_PROVIDER,"Cleared was connected flag to prevent auto-reconnect")}catch(n){K.warn(z.INJECTED_PROVIDER,"Failed to clear was-connected flag",{error:n})}this.emit("disconnect",{source:"manual-disconnect"}),K.info(z.INJECTED_PROVIDER,"Injected provider disconnected successfully")}async autoConnect(){K.log(z.INJECTED_PROVIDER,"Attempting auto-connect");let t=null;try{if(localStorage.getItem(el)!==Oh){K.log(z.INJECTED_PROVIDER,"Skipping auto-connect: user was not previously connected");return}t=localStorage.getItem(Mh),K.log(z.INJECTED_PROVIDER,"User was previously connected, attempting auto-connect",{lastWalletId:t||"phantom"})}catch(e){K.warn(z.INJECTED_PROVIDER,"Failed to check was-connected flag",{error:e});return}this.emit("connect_start",{source:"auto-connect",providerType:"injected"});try{const e=t||"phantom";await this.waitForWalletDiscovery(e);const r=this.validateAndSelectWallet(e);let n=[];try{n=await this.connectToWallet(r,{onlyIfTrusted:!0,silent:!0,skipEventListeners:!0})}catch(i){K.log(z.INJECTED_PROVIDER,"Auto-connect failed (expected if not trusted)",{error:i,walletId:this.selectedWalletId})}if(n.length===0){K.log(z.INJECTED_PROVIDER,"Auto-connect failed: no trusted connections available"),this.emit("connect_error",{error:"No trusted connections available",source:"auto-connect"});return}this.setupEventListeners(r),this.selectedWalletId&&this.setWalletState(this.selectedWalletId,{connected:!0,addresses:n});const s=await this.getAuthUserId("auto-connect");this.emit("connect",{addresses:n,source:"auto-connect",authUserId:s}),K.info(z.INJECTED_PROVIDER,"Auto-connect successful",{addressCount:n.length,addresses:n.map(i=>({type:i.addressType,address:i.address.substring(0,8)+"..."})),walletId:this.selectedWalletId,authUserId:s})}catch(e){K.log(z.INJECTED_PROVIDER,"Auto-connect failed with error",{error:e instanceof Error?e.message:String(e)}),this.emit("connect_error",{error:e instanceof Error?e.message:"Auto-connect failed",source:"auto-connect"})}}getWalletState(t){return this.walletStates.has(t)||this.walletStates.set(t,{connected:!1,addresses:[]}),this.walletStates.get(t)}setWalletState(t,e){this.walletStates.set(t,e)}updateWalletAddresses(t,e,r){const s=this.getWalletState(t).addresses.filter(a=>a.addressType!==r),i=e.map(a=>({addressType:r,address:a})),o=[...s,...i];return this.setWalletState(t,{connected:o.length>0,addresses:o}),o}getAccountChangeSource(t){return`${t}-account-change`}createSolanaConnectHandler(t,e){return async r=>{K.log(z.INJECTED_PROVIDER,"Solana connect event received",{publicKey:r,walletId:t});const n=this.updateWalletAddresses(t,[r],st.solana),s=await this.getAuthUserId("Solana connect event");this.emit("connect",{addresses:n,source:e,authUserId:s})}}createSolanaDisconnectHandler(t,e){return()=>{K.log(z.INJECTED_PROVIDER,"Solana disconnect event received",{walletId:t});const n=this.getWalletState(t).addresses.filter(s=>s.addressType!==st.solana);this.setWalletState(t,{connected:n.length>0,addresses:n}),this.emit("disconnect",{source:e})}}createSolanaAccountChangeHandler(t,e){return async r=>{if(K.log(z.INJECTED_PROVIDER,"Solana account changed event received",{publicKey:r,walletId:t}),r){const n=this.updateWalletAddresses(t,[r],st.solana),s=await this.getAuthUserId("Solana account changed event");this.emit("connect",{addresses:n,source:this.getAccountChangeSource(e),authUserId:s})}else{const s=this.getWalletState(t).addresses.filter(i=>i.addressType!==st.solana);this.setWalletState(t,{connected:s.length>0,addresses:s}),this.emit("disconnect",{source:this.getAccountChangeSource(e)})}}}createEthereumConnectHandler(t,e){return async r=>{let n=[];if(Array.isArray(r))n=r;else try{const s=this.walletRegistry.getById(t);s?.providers?.ethereum&&(n=await s.providers.ethereum.getAccounts())}catch(s){K.warn(z.INJECTED_PROVIDER,"Failed to get accounts on connect",{error:s})}if(K.log(z.INJECTED_PROVIDER,"Ethereum connect event received",{accounts:n,walletId:t}),n.length>0){const s=this.updateWalletAddresses(t,n,st.ethereum),i=await this.getAuthUserId("Ethereum connect event");this.emit("connect",{addresses:s,source:e,authUserId:i})}}}createEthereumDisconnectHandler(t,e){return()=>{K.log(z.INJECTED_PROVIDER,"Ethereum disconnect event received",{walletId:t});const n=this.getWalletState(t).addresses.filter(s=>s.addressType!==st.ethereum);this.setWalletState(t,{connected:n.length>0,addresses:n}),this.emit("disconnect",{source:e})}}createEthereumAccountChangeHandler(t,e){return async r=>{if(K.log(z.INJECTED_PROVIDER,"Ethereum accounts changed event received",{accounts:r,walletId:t}),r&&r.length>0){const n=this.updateWalletAddresses(t,r,st.ethereum),s=await this.getAuthUserId("Ethereum accounts changed event");this.emit("connect",{addresses:n,source:this.getAccountChangeSource(e),authUserId:s})}else{const s=this.getWalletState(t).addresses.filter(i=>i.addressType!==st.ethereum);this.setWalletState(t,{connected:s.length>0,addresses:s}),this.emit("disconnect",{source:this.getAccountChangeSource(e)})}}}getAddresses(){const t=this.selectedWalletId||"phantom";return this.getWalletState(t).addresses}getEnabledAddressTypes(){if(!this.selectedWalletId||this.selectedWalletId==="phantom")return this.addressTypes;const t=this.walletRegistry.getById(this.selectedWalletId);return t?t.addressTypes:this.addressTypes}isConnected(){const t=this.selectedWalletId||"phantom";return this.getWalletState(t).connected}async enableAutoConfirm(t){const e=this.walletRegistry.getById(this.selectedWalletId||"phantom");if(!wi(e))throw new Error("Auto-confirm is only available for Phantom wallet");return K.log(z.INJECTED_PROVIDER,"Enabling autoConfirm",{params:t}),await e.phantomInstance.autoConfirm.autoConfirmEnable(t)}async disableAutoConfirm(){const t=this.walletRegistry.getById(this.selectedWalletId||"phantom");if(!wi(t))throw new Error("Auto-confirm is only available for Phantom wallet");K.log(z.INJECTED_PROVIDER,"Disabling autoConfirm"),await t.phantomInstance.autoConfirm.autoConfirmDisable()}async getAutoConfirmStatus(){const t=this.walletRegistry.getById(this.selectedWalletId||"phantom");if(!wi(t))throw new Error("Auto-confirm is only available for Phantom wallet");return K.log(z.INJECTED_PROVIDER,"Getting autoConfirm status"),await t.phantomInstance.autoConfirm.autoConfirmStatus()}async getSupportedAutoConfirmChains(){const t=this.walletRegistry.getById(this.selectedWalletId||"phantom");if(!wi(t))throw new Error("Auto-confirm is only available for Phantom wallet");return K.log(z.INJECTED_PROVIDER,"Getting supported autoConfirm chains"),await t.phantomInstance.autoConfirm.autoConfirmSupportedChains()}async getAuthUserId(t){const e=this.walletRegistry.getById(this.selectedWalletId||"phantom");if(wi(e))try{if(window.phantom?.app?.getUser){const n=(await window.phantom.app.getUser())?.authUserId;return n&&K.log(z.INJECTED_PROVIDER,`Retrieved authUserId from window.phantom.app.getUser() during ${t}`,{authUserId:n}),n}}catch(r){K.log(z.INJECTED_PROVIDER,`Failed to get user info during ${t} (method may not be supported)`,{error:r})}}on(t,e){if(K.log(z.INJECTED_PROVIDER,"Adding event listener",{event:t}),!this.eventsInitialized){const r=this.selectedWalletId||"phantom",n=this.walletRegistry.getById(r);n&&this.setupEventListeners(n)}this.eventListeners.has(t)||this.eventListeners.set(t,new Set),this.eventListeners.get(t)?.add(e)}off(t,e){K.log(z.INJECTED_PROVIDER,"Removing event listener",{event:t}),this.eventListeners.has(t)&&(this.eventListeners.get(t)?.delete(e),this.eventListeners.get(t)?.size===0&&this.eventListeners.delete(t))}emit(t,e){K.log(z.INJECTED_PROVIDER,"Emitting event",{event:t,listenerCount:this.eventListeners.get(t)?.size||0,data:e});const r=this.eventListeners.get(t);r&&r.size>0&&r.forEach(n=>{try{n(e)}catch(s){K.error(z.INJECTED_PROVIDER,"Event callback error",{event:t,error:s})}})}setupSolanaEventListeners(t,e,r){if(typeof t.on!="function")return;K.log(z.INJECTED_PROVIDER,"Setting up Solana event listeners",{walletId:e,source:r});const n={connect:this.createSolanaConnectHandler(e,r),disconnect:this.createSolanaDisconnectHandler(e,r),accountChanged:this.createSolanaAccountChangeHandler(e,r)};t.on("connect",n.connect),t.on("disconnect",n.disconnect),t.on("accountChanged",n.accountChanged);const s=[];typeof t.off=="function"&&s.push(()=>t.off("connect",n.connect),()=>t.off("disconnect",n.disconnect),()=>t.off("accountChanged",n.accountChanged));const i=this.eventListenerCleanups.get(e)||[];this.eventListenerCleanups.set(e,[...i,...s])}setupEthereumEventListeners(t,e,r){if(typeof t.on!="function")return;K.log(z.INJECTED_PROVIDER,"Setting up Ethereum event listeners",{walletId:e,source:r});const n={connect:this.createEthereumConnectHandler(e,r),disconnect:this.createEthereumDisconnectHandler(e,r),accountsChanged:this.createEthereumAccountChangeHandler(e,r)};t.on("connect",n.connect),t.on("disconnect",n.disconnect),t.on("accountsChanged",n.accountsChanged);const s=[];typeof t.off=="function"&&s.push(()=>t.off("connect",n.connect),()=>t.off("disconnect",n.disconnect),()=>t.off("accountsChanged",n.accountsChanged));const i=this.eventListenerCleanups.get(e)||[];this.eventListenerCleanups.set(e,[...i,...s])}setupEventListeners(t){const e=this.selectedWalletId||"phantom";if(this.eventListenersSetup.has(e)){K.log(z.INJECTED_PROVIDER,"Event listeners already set up for wallet",{walletId:e});return}K.log(z.INJECTED_PROVIDER,"Setting up event listeners",{walletId:e}),this.addressTypes.includes(st.solana)&&t.providers?.solana&&this.setupSolanaEventListeners(t.providers.solana,e,"wallet"),this.addressTypes.includes(st.ethereum)&&t.providers?.ethereum&&this.setupEthereumEventListeners(t.providers.ethereum,e,"wallet"),this.eventListenersSetup.add(e),this.eventsInitialized=!0}},PI=class{constructor(){this.dbName="phantom-browser-sdk",this.storeName="sessions",this.version=1}async getDB(){return new Promise((t,e)=>{const r=indexedDB.open(this.dbName,this.version);r.onerror=()=>e(r.error),r.onsuccess=()=>t(r.result),r.onupgradeneeded=n=>{const s=n.target.result;s.objectStoreNames.contains(this.storeName)||s.createObjectStore(this.storeName)}})}async getSession(){K.log(z.STORAGE,"Getting session from IndexedDB");const t=await this.getDB();return new Promise((e,r)=>{const i=t.transaction([this.storeName],"readonly").objectStore(this.storeName).get("currentSession");i.onsuccess=()=>{const o=i.result||null;K.log(z.STORAGE,"Retrieved session from IndexedDB",{hasSession:!!o,sessionId:o?.sessionId}),e(o)},i.onerror=()=>{K.error(z.STORAGE,"Failed to get session from IndexedDB",{error:i.error}),r(i.error)}})}async saveSession(t){K.log(z.STORAGE,"Saving session to IndexedDB",{sessionId:t.sessionId,walletId:t.walletId,status:t.status});const e=await this.getDB();return new Promise((r,n)=>{const o=e.transaction([this.storeName],"readwrite").objectStore(this.storeName).put(t,"currentSession");o.onsuccess=()=>{K.log(z.STORAGE,"Successfully saved session to IndexedDB"),r()},o.onerror=()=>{K.error(z.STORAGE,"Failed to save session to IndexedDB",{error:o.error}),n(o.error)}})}async clearSession(){K.log(z.STORAGE,"Clearing session from IndexedDB");const t=await this.getDB();return new Promise((e,r)=>{const i=t.transaction([this.storeName],"readwrite").objectStore(this.storeName).delete("currentSession");i.onsuccess=()=>{K.log(z.STORAGE,"Successfully cleared session from IndexedDB"),e()},i.onerror=()=>{K.error(z.STORAGE,"Failed to clear session from IndexedDB",{error:i.error}),r(i.error)}})}async getShouldClearPreviousSession(){K.log(z.STORAGE,"Getting shouldClearPreviousSession flag from IndexedDB");const t=await this.getDB();return new Promise((e,r)=>{const i=t.transaction([this.storeName],"readonly").objectStore(this.storeName).get("shouldClearPreviousSession");i.onsuccess=()=>{const o=i.result??!1;K.log(z.STORAGE,"Retrieved shouldClearPreviousSession flag from IndexedDB",{shouldClear:o}),e(o)},i.onerror=()=>{K.error(z.STORAGE,"Failed to get shouldClearPreviousSession flag from IndexedDB",{error:i.error}),r(i.error)}})}async setShouldClearPreviousSession(t){K.log(z.STORAGE,"Setting shouldClearPreviousSession flag in IndexedDB",{should:t});const e=await this.getDB();return new Promise((r,n)=>{const o=e.transaction([this.storeName],"readwrite").objectStore(this.storeName).put(t,"shouldClearPreviousSession");o.onsuccess=()=>{K.log(z.STORAGE,"Successfully set shouldClearPreviousSession flag in IndexedDB"),r()},o.onerror=()=>{K.error(z.STORAGE,"Failed to set shouldClearPreviousSession flag in IndexedDB",{error:o.error}),n(o.error)}})}},CI=class{getParam(t){return new URLSearchParams(window.location.search).get(t)}};function DI(t,e){let r="unknown",n="unknown";if(!t||typeof t!="string")return{name:r,version:n,userAgent:"unknown"};try{if(t.includes("Edg/")){r="edge";const s=t.match(/Edg\/([0-9]+(?:\.[0-9]+)*)/);s&&(n=s[1].split(".")[0])}else if(t.includes("OPR/")||t.includes("Opera/")){r="opera";const s=t.match(/(?:OPR|Opera)\/([0-9]+(?:\.[0-9]+)*)/);s&&(n=s[1].split(".")[0])}else if(t.includes("SamsungBrowser/")){r="samsung";const s=t.match(/SamsungBrowser\/([0-9]+(?:\.[0-9]+)*)/);s&&(n=s[1].split(".")[0])}else if(t.includes("DuckDuckGo/")){r="duckduckgo";const s=t.match(/DuckDuckGo\/([0-9]+(?:\.[0-9]+)*)/);s&&(n=s[1].split(".")[0])}else if(t.includes("Chrome/")&&e){r="brave";const s=t.match(/Chrome\/([0-9]+(?:\.[0-9]+)*)/);s&&(n=s[1].split(".")[0])}else if(t.includes("Mobile/")||t.includes("Android"))if(t.includes("Chrome/")){r="chrome-mobile";const s=t.match(/Chrome\/([0-9]+(?:\.[0-9]+)*)/);s&&(n=s[1].split(".")[0])}else if(t.includes("Firefox/")){r="firefox-mobile";const s=t.match(/Firefox\/([0-9]+(?:\.[0-9]+)*)/);s&&(n=s[1].split(".")[0])}else if(t.includes("Safari/")&&t.includes("Mobile/")){r="safari-mobile";const s=t.match(/Version\/([0-9]+(?:\.[0-9]+)*)/);s&&(n=s[1].split(".")[0])}else r="mobile";else if(t.includes("Chrome/")){r="chrome";const s=t.match(/Chrome\/([0-9]+(?:\.[0-9]+)*)/);s&&(n=s[1].split(".")[0])}else if(t.includes("Firefox/")){r="firefox";const s=t.match(/Firefox\/([0-9]+(?:\.[0-9]+)*)/);s&&(n=s[1].split(".")[0])}else if(t.includes("Safari/")&&!t.includes("Chrome/")){r="safari";const s=t.match(/Version\/([0-9]+(?:\.[0-9]+)*)/);s&&(n=s[1].split(".")[0])}if(r==="unknown"){const s=[{regex:/Chrome\/([0-9]+)/,name:"chrome"},{regex:/Firefox\/([0-9]+)/,name:"firefox"},{regex:/Safari\/([0-9]+)/,name:"safari"},{regex:/Edge\/([0-9]+)/,name:"edge"},{regex:/Opera\/([0-9]+)/,name:"opera"}];for(const i of s){const o=t.match(i.regex);if(o){r=i.name,n=o[1];break}}}}catch{}return{name:r,version:n,userAgent:t}}function Nu(){if(typeof window>"u"||!window.navigator?.userAgent)return{name:"unknown",version:"unknown",userAgent:"unknown"};const t=window.navigator.userAgent,e=!!navigator.brave;return DI(t,e)}function kI(){const{name:t,version:e}=Nu();return e!=="unknown"?`${t}-v${e}`:t}var NI=class{constructor(t){this.urlParamsAccessor=t}getValidatedCurrentUrl(){const t=window.location.href;if(!t.startsWith("http:")&&!t.startsWith("https:"))throw new Error("Invalid URL protocol - only HTTP/HTTPS URLs are supported");return t}authenticate(t){return new Promise(e=>{if("jwtToken"in t)throw new Error("JWT authentication should be handled by the core JWTAuth class");const r=t;K.info(z.PHANTOM_CONNECT_AUTH,"Starting Phantom Connect authentication",{publicKey:r.publicKey,appId:r.appId,provider:r.provider,authUrl:r.authUrl});const n=r.authUrl||n0;K.log(z.PHANTOM_CONNECT_AUTH,"Using auth URL",{baseUrl:n});const s=new URLSearchParams({public_key:r.publicKey,app_id:r.appId,redirect_uri:r.redirectUrl||(typeof window<"u"?this.getValidatedCurrentUrl():""),session_id:r.sessionId,clear_previous_session:(r.clearPreviousSession??!1).toString(),allow_refresh:(r.allowRefresh??!0).toString(),sdk_version:"1.0.2",sdk_type:"browser",platform:Nu().name});r.provider?(K.log(z.PHANTOM_CONNECT_AUTH,"Provider specified, will skip selection",{provider:r.provider}),s.append("provider",r.provider)):(K.log(z.PHANTOM_CONNECT_AUTH,"No provider specified, defaulting to Google"),s.append("provider","google"));const i={publicKey:r.publicKey,appId:r.appId,provider:r.provider,sessionId:r.sessionId};sessionStorage.setItem("phantom-auth-context",JSON.stringify(i)),K.log(z.PHANTOM_CONNECT_AUTH,"Stored auth context in session storage",{authContext:i});const o=`${n}?${s.toString()}`;if(K.info(z.PHANTOM_CONNECT_AUTH,"Redirecting to Phantom Connect",{authUrl:o}),!o.startsWith("https:")&&!o.startsWith("http://localhost"))throw new Error("Invalid auth URL - only HTTPS URLs are allowed for authentication");window.location.href=o,e()})}resumeAuthFromRedirect(t){try{const e=this.urlParamsAccessor.getParam("wallet_id"),r=this.urlParamsAccessor.getParam("session_id"),n=this.urlParamsAccessor.getParam("selected_account_index"),s=this.urlParamsAccessor.getParam("error"),i=this.urlParamsAccessor.getParam("error_description");if(s){const m=i||s;switch(s){case"access_denied":throw new Error(`Authentication cancelled: ${m}`);case"invalid_request":throw new Error(`Invalid authentication request: ${m}`);case"server_error":throw new Error(`Authentication server error: ${m}`);case"temporarily_unavailable":throw new Error(`Authentication service temporarily unavailable: ${m}`);default:throw new Error(`Authentication failed: ${m}`)}}if(!e||!r)return K.log(z.PHANTOM_CONNECT_AUTH,"Missing auth parameters in URL",{hasWalletId:!!e,hasSessionId:!!r}),null;const o=sessionStorage.getItem("phantom-auth-context");let a={};if(o)try{a=JSON.parse(o)}catch(m){K.warn(z.PHANTOM_CONNECT_AUTH,"Failed to parse stored auth context",{error:m})}if(a.sessionId&&r!==a.sessionId)throw K.error(z.PHANTOM_CONNECT_AUTH,"Session ID mismatch",{urlSessionId:r,storedSessionId:a.sessionId}),new Error("Session ID mismatch - possible session corruption or replay attack");sessionStorage.removeItem("phantom-auth-context"),K.info(z.PHANTOM_CONNECT_AUTH,"Successfully resumed auth from redirect",{walletId:e,sessionId:r,accountDerivationIndex:n?parseInt(n):void 0});const c=this.urlParamsAccessor.getParam("organization_id"),l=this.urlParamsAccessor.getParam("expires_in_ms"),g=this.urlParamsAccessor.getParam("auth_user_id");if(K.log(z.PHANTOM_CONNECT_AUTH,"Auth redirect parameters",{walletId:e,organizationId:c,sessionId:r,accountDerivationIndex:n,expiresInMs:l,authUserId:g}),!c)throw K.error(z.PHANTOM_CONNECT_AUTH,"Missing organization_id in auth response"),new Error("Missing organization_id in auth response");return c.startsWith("temp-")&&K.warn(z.PHANTOM_CONNECT_AUTH,"Received temporary organization_id, server may not be configured properly",{organizationId:c}),{walletId:e,organizationId:c,accountDerivationIndex:n?parseInt(n):0,expiresInMs:l?parseInt(l):0,authUserId:g||void 0,provider:t}}catch(e){throw sessionStorage.removeItem("phantom-auth-context"),e}}};async function OI(t=3e3){if(!await MI(t))return!1;try{if(!window.phantom?.app?.features||typeof window.phantom.app.features!="function")return!1;const r=await window.phantom.app.features();return Array.isArray(r.features)?r.features.includes("phantom_login"):!1}catch(r){return console.error("Error checking Phantom extension features",r),!1}}async function MI(t){return new Promise(e=>{const r=Date.now(),n=100,s=()=>{try{if(Ga()){e(!0);return}}catch{}if(Date.now()-r>=t){e(!1);return}setTimeout(s,n)};s()})}var UI=class{isAvailable(){return Ga()}async authenticate(t){if(!this.isAvailable())throw new Error("Phantom extension is not installed. Please install the Phantom browser extension to use this authentication method.");if(!await OI())throw new Error("Phantom Login is not available. Please update your Phantom extension to use this authentication method.");try{if(!window.phantom?.app?.login)throw new Error("Phantom extension login method not found");const r=await window.phantom.app.login({publicKey:t.publicKey,appId:t.appId,sessionId:t.sessionId});if(!r||!r.walletId||!r.organizationId)throw new Error("Invalid authentication response from Phantom extension");return{walletId:r.walletId,organizationId:r.organizationId,provider:"phantom",accountDerivationIndex:r.accountDerivationIndex??0,expiresInMs:r.expiresInMs??0,authUserId:r.authUserId}}catch(r){throw r instanceof Error?r:new Error(`Phantom extension authentication failed: ${String(r)}`)}}},LI=class{info(t,e,r){K.info(t,e,r)}warn(t,e,r){K.warn(t,e,r)}error(t,e,r){K.error(t,e,r)}log(t,e,r){K.log(t,e,r)}},FI=class extends gI{constructor(t){K.log(z.EMBEDDED_PROVIDER,"Initializing Browser EmbeddedProvider",{config:t});const e=new CI,r=new yI({dbName:`phantom-embedded-sdk-${t.appId}`,storeName:"crypto-keys",keyName:"signing-key"}),n=kI(),{name:s,version:i}=Nu(),o={storage:new PI,authProvider:new NI(e),phantomAppProvider:new UI,urlParamsAccessor:e,stamper:r,name:n,analyticsHeaders:{[ui.SDK_TYPE]:"browser",[ui.PLATFORM]:s,[ui.PLATFORM_VERSION]:i,[ui.APP_ID]:t.appId,[ui.WALLET_TYPE]:t.embeddedWalletType,[ui.SDK_VERSION]:"1.0.2"}};K.log(z.EMBEDDED_PROVIDER,"Detected platform",{platformName:n});const a=new LI;super(t,o,a),this.addressTypes=t.addressTypes,K.info(z.EMBEDDED_PROVIDER,"Browser EmbeddedProvider initialized")}getEnabledAddressTypes(){return this.addressTypes}};function $I(t){if(typeof window>"u")return!1;const e=new URLSearchParams(window.location.search),r=e.get("response_type"),n=e.get("session_id");return r==="failure"&&!!n}function KI(t){if(typeof window>"u")return!1;const e=new URLSearchParams(window.location.search);return!!(e.get("session_id")&&(e.has("response_type")||e.has("wallet_id")))}function zI(t){if(!window.location.href.startsWith("http:")&&!window.location.href.startsWith("https:"))throw new Error("Invalid URL protocol - only HTTP/HTTPS URLs are supported for deeplinks");return`https://phantom.app/ul/browse/${encodeURIComponent(window.location.href)}`}var VI=class{constructor(t){this.providers=new Map,this.currentProvider=null,this.currentProviderKey=null,this.eventListeners=new Map,this.providerForwardingSetup=new WeakSet,K.log(z.PROVIDER_MANAGER,"Initializing ProviderManager",{config:t}),this.config=t,K.log(z.PROVIDER_MANAGER,"Setting default provider"),this.setDefaultProvider(),K.info(z.PROVIDER_MANAGER,"ProviderManager initialized",{currentProviderKey:this.currentProviderKey})}getValidatedCurrentUrl(){if(typeof window>"u")return"";const t=window.location.href;if(!t.startsWith("http:")&&!t.startsWith("https:"))throw new Error("Invalid URL protocol - only HTTP/HTTPS URLs are supported");return t}switchProvider(t,e){if(e?.embeddedWalletType&&!["app-wallet","user-wallet"].includes(e.embeddedWalletType))throw new Error(`Invalid embeddedWalletType: ${e.embeddedWalletType}. Must be "app-wallet" or "user-wallet".`);const r=this.getProviderKey(t,e?.embeddedWalletType);return this.providers.has(r)||this.createProvider(t,e?.embeddedWalletType),this.currentProvider=this.providers.get(r),this.currentProviderKey=r,this.ensureProviderEventForwarding(),this.currentProvider}getCurrentProvider(){return this.currentProvider}getCurrentProviderInfo(){if(!this.currentProviderKey)return null;const t=this.currentProviderKey.split("-"),[e,r]=t;return{type:e,embeddedWalletType:r}}isProviderAllowed(t){return this.config.providers.includes(t)}async connect(t){if(K.info(z.PROVIDER_MANAGER,"Starting connection",{currentProviderKey:this.currentProviderKey,authOptions:{provider:t.provider}}),!this.isProviderAllowed(t.provider)){const s=`Provider "${t.provider}" is not in the allowed providers list: ${JSON.stringify(this.config.providers)}`;throw K.error(z.PROVIDER_MANAGER,s),new Error(s)}const e=t.provider;let r=null;if(e==="injected")r="injected";else if(e==="deeplink")try{const s=zI();return typeof window<"u"&&(window.location.href=s),{addresses:[],walletId:void 0,authUserId:void 0}}catch(s){const i=s instanceof Error?s.message:"Failed to open deeplink";throw K.error(z.PROVIDER_MANAGER,"Deeplink error",{error:i}),new Error(`Failed to open deeplink: ${i}`)}else ka.includes(e)&&(r="embedded");if(r){const s=this.getCurrentProviderInfo();if(s?.type!==r){K.log(z.PROVIDER_MANAGER,"Auto-switching provider based on auth options",{from:s?.type,to:r,requestedProvider:e});const i={};r==="embedded"&&(i.embeddedWalletType=s?.embeddedWalletType||this.config.embeddedWalletType),this.switchProvider(r,i)}}if(!this.currentProvider)throw K.error(z.PROVIDER_MANAGER,"No provider selected"),new Error("No provider selected");K.log(z.PROVIDER_MANAGER,"Delegating to provider connect method");const n=await this.currentProvider.connect(t);return K.log(z.PROVIDER_MANAGER,"Connection successful, saving preferences",{addressCount:n.addresses?.length||0,provider:t.provider}),this.saveProviderPreference(),K.info(z.PROVIDER_MANAGER,"Connect completed",{addresses:n.addresses,provider:t.provider}),n}async disconnect(){this.currentProvider&&await this.currentProvider.disconnect()}getAddresses(){return this.currentProvider?this.currentProvider.getAddresses():[]}isConnected(){return this.currentProvider?.isConnected()??!1}async autoConnect(){if(K.log(z.PROVIDER_MANAGER,"Starting auto-connect with fallback strategy"),$I())return K.warn(z.PROVIDER_MANAGER,"Auth failure detected in URL, skipping autoConnect fallback"),!1;const t=this.config.embeddedWalletType||"user-wallet",e=this.getProviderKey("embedded",t);if(this.config.providers.some(i=>i!=="injected")&&this.providers.has(e)){K.log(z.PROVIDER_MANAGER,"Trying auto-connect with existing embedded provider");const i=this.providers.get(e);try{const o=this.currentProvider,a=this.currentProviderKey;if(this.currentProvider=i,this.currentProviderKey=e,this.ensureProviderEventForwarding(),await i.autoConnect(),i.isConnected())return K.info(z.PROVIDER_MANAGER,"Embedded auto-connect successful"),this.saveProviderPreference(),!0;K.log(z.PROVIDER_MANAGER,"Embedded provider did not connect, restoring previous provider"),this.currentProvider=o,this.currentProviderKey=a}catch(o){if(K.log(z.PROVIDER_MANAGER,"Embedded auto-connect failed",{error:o.message}),KI())return K.log(z.PROVIDER_MANAGER,"In auth callback URL, not attempting injected fallback"),!1}}const n=this.config.providers.includes("injected"),s=this.getProviderKey("injected");if(n&&this.providers.has(s)){K.log(z.PROVIDER_MANAGER,"Trying auto-connect with existing injected provider");const i=this.providers.get(s);try{if(this.currentProvider=i,this.currentProviderKey=s,this.ensureProviderEventForwarding(),await i.autoConnect(),i.isConnected())return K.info(z.PROVIDER_MANAGER,"Injected auto-connect successful"),this.saveProviderPreference(),!0}catch(o){K.log(z.PROVIDER_MANAGER,"Injected auto-connect failed",{error:o.message})}}return K.log(z.PROVIDER_MANAGER,"Auto-connect failed for all allowed providers"),!1}on(t,e){K.log(z.PROVIDER_MANAGER,"Adding event listener",{event:t}),this.eventListeners.has(t)||this.eventListeners.set(t,new Set),this.eventListeners.get(t)?.add(e),this.ensureProviderEventForwarding()}off(t,e){K.log(z.PROVIDER_MANAGER,"Removing event listener",{event:t}),this.eventListeners.has(t)&&(this.eventListeners.get(t)?.delete(e),this.eventListeners.get(t)?.size===0&&this.eventListeners.delete(t))}emit(t,e){K.log(z.PROVIDER_MANAGER,"Emitting event to stored callbacks",{event:t,listenerCount:this.eventListeners.get(t)?.size||0,data:e});const r=this.eventListeners.get(t);r&&r.size>0?r.forEach(n=>{try{K.log(z.PROVIDER_MANAGER,"Calling stored callback for event",{event:t}),n(e)}catch(s){K.error(z.PROVIDER_MANAGER,"Event callback error",{event:t,error:s})}}):K.warn(z.PROVIDER_MANAGER,"No stored callbacks for event",{event:t})}ensureProviderEventForwarding(){if(!this.currentProvider||!("on"in this.currentProvider)){K.warn(z.PROVIDER_MANAGER,"Current provider does not support events",{providerType:this.getCurrentProviderInfo()?.type});return}if(this.providerForwardingSetup.has(this.currentProvider)){K.log(z.PROVIDER_MANAGER,"Event forwarding already set up for current provider");return}K.log(z.PROVIDER_MANAGER,"Setting up event forwarding from current provider");const t=["connect_start","connect","connect_error","disconnect","error","spending_limit_reached"];for(const e of t){const r=n=>{K.log(z.PROVIDER_MANAGER,"Forwarding event from provider",{event:e,data:n}),this.emit(e,n)};K.log(z.PROVIDER_MANAGER,"Attaching forwarding callback for event",{event:e}),this.currentProvider.on(e,r)}this.providerForwardingSetup.add(this.currentProvider)}setDefaultProvider(){const t=this.config.embeddedWalletType||"user-wallet",e=this.config.providers.includes("injected"),r=this.config.providers.some(i=>i!=="injected"&&i!=="deeplink");e&&(K.log(z.PROVIDER_MANAGER,"Creating injected provider (allowed by providers array)"),this.createProvider("injected")),r&&(K.log(z.PROVIDER_MANAGER,"Creating embedded provider (allowed by providers array)"),this.createProvider("embedded",t));let n;if(r&&this.providers.has(`embedded-${t}`))n="embedded";else if(e&&this.providers.has("injected"))n="injected";else throw new Error("No valid providers could be created from the providers array");const s={};n==="embedded"&&(s.embeddedWalletType=t),this.switchProvider(n,s)}createProvider(t,e){const r=this.getProviderKey(t,e);if(this.providers.has(r))return;let n;if(t==="injected")n=new TI({addressTypes:this.config.addressTypes||[st.solana]});else if(t==="embedded"){if(!this.config.appId)throw new Error("appId is required for embedded provider");const s=this.config.apiBaseUrl||xy,i=this.config.authOptions?.authUrl||n0;n=new FI({apiBaseUrl:s,appId:this.config.appId,authOptions:{...this.config.authOptions||{},authUrl:i,redirectUrl:this.config.authOptions?.redirectUrl||this.getValidatedCurrentUrl()},embeddedWalletType:e||s0,addressTypes:this.config.addressTypes||[st.solana]})}else throw new Error(`Unsupported provider type: ${t}`);this.providers.set(r,n)}getProviderKey(t,e){if(t==="injected")return"injected";if(t==="embedded")return`embedded-${e||"app-wallet"}`;throw new Error(`Unsupported provider type: ${t}`)}saveProviderPreference(){try{const t=this.getCurrentProviderInfo();t&&localStorage.setItem("phantom-provider-preference",JSON.stringify(t))}catch(t){console.error("Failed to save provider preference:",t)}}},tl=[...ka,"injected","deeplink"],qI=class{constructor(t){if(this.walletRegistry=rg(),this.isLoading=!0,K.info(z.BROWSER_SDK,"Initializing BrowserSDK",{providers:t.providers,embeddedWalletType:t.embeddedWalletType,addressTypes:t.addressTypes}),!Array.isArray(t.providers)||t.providers.length===0)throw K.error(z.BROWSER_SDK,"Invalid providers array",{providers:t.providers}),new Error("providers must be a non-empty array of AuthProviderType");const e=t.providers.filter(s=>!tl.includes(s));if(e.length>0)throw K.error(z.BROWSER_SDK,"Invalid provider types",{invalidProviders:e,validProviders:tl}),new Error(`Invalid provider type(s): ${e.join(", ")}. Valid providers are: ${tl.join(", ")}`);if(t.providers.some(s=>s!=="injected")&&!t.appId)throw K.error(z.BROWSER_SDK,"appId required for embedded providers",{providers:t.providers}),new Error("appId is required when using embedded providers (google, apple, phantom, etc.)");const n=t.embeddedWalletType||s0;if(!["app-wallet","user-wallet"].includes(n))throw K.error(z.BROWSER_SDK,"Invalid embeddedWalletType",{embeddedWalletType:t.embeddedWalletType}),new Error(`Invalid embeddedWalletType: ${t.embeddedWalletType}. Must be "app-wallet" or "user-wallet".`);this.config=t,this.providerManager=new VI(t),this.discoverWallets()}discoverWallets(){return this.walletRegistry.discover(this.config.addressTypes).finally(()=>{this.isLoading=!1})}get solana(){const t=this.providerManager.getCurrentProvider();if(!t)throw new Error("No provider available. Call connect() first.");return t.solana}get ethereum(){const t=this.providerManager.getCurrentProvider();if(!t)throw new Error("No provider available. Call connect() first.");return t.ethereum}async connect(t){K.info(z.BROWSER_SDK,"Starting connection",t);try{const e=await this.providerManager.connect(t);return K.info(z.BROWSER_SDK,"Connection successful",{addressCount:e.addresses.length,status:e.status}),e}catch(e){throw K.error(z.BROWSER_SDK,"Connection failed",{error:e.message}),e}}async disconnect(){K.info(z.BROWSER_SDK,"Disconnecting");try{await this.providerManager.disconnect(),K.info(z.BROWSER_SDK,"Disconnection successful")}catch(t){throw K.error(z.BROWSER_SDK,"Disconnection failed",{error:t.message}),t}}isConnected(){return this.providerManager.isConnected()}getAddresses(){return this.providerManager.getAddresses()}getCurrentProviderInfo(){return this.providerManager.getCurrentProviderInfo()}getEnabledAddressTypes(){const t=this.providerManager.getCurrentProvider();return t?t.getEnabledAddressTypes():[]}on(t,e){K.log(z.BROWSER_SDK,"Adding event listener",{event:t}),this.providerManager.on(t,e)}off(t,e){K.log(z.BROWSER_SDK,"Removing event listener",{event:t}),this.providerManager.off(t,e)}async autoConnect(){K.log(z.BROWSER_SDK,"Attempting auto-connect with fallback strategy"),await this.providerManager.autoConnect()?K.info(z.BROWSER_SDK,"Auto-connect successful",{providerType:this.getCurrentProviderInfo()?.type}):K.log(z.BROWSER_SDK,"Auto-connect failed for all providers")}enableDebug(){K.enable(),K.info(z.BROWSER_SDK,"Debug logging enabled")}disableDebug(){K.disable()}setDebugLevel(t){K.setLevel(t),K.info(z.BROWSER_SDK,"Debug level updated",{level:t})}setDebugCallback(t){K.setCallback(t),K.info(z.BROWSER_SDK,"Debug callback updated")}configureDebug(t){t.enabled!==void 0&&(t.enabled?this.enableDebug():this.disableDebug()),t.level!==void 0&&this.setDebugLevel(t.level),t.callback!==void 0&&this.setDebugCallback(t.callback)}async enableAutoConfirm(t){K.info(z.BROWSER_SDK,"Enabling auto-confirm",{params:t});const e=this.providerManager.getCurrentProvider();if(!e)throw new Error("No provider available. Call connect() first.");if(!("enableAutoConfirm"in e))throw new Error("Auto-confirm is only available for injected providers");try{const r=await e.enableAutoConfirm(t);return K.info(z.BROWSER_SDK,"Auto-confirm enabled successfully",{result:r}),r}catch(r){throw K.error(z.BROWSER_SDK,"Failed to enable auto-confirm",{error:r.message}),r}}async disableAutoConfirm(){K.info(z.BROWSER_SDK,"Disabling auto-confirm");const t=this.providerManager.getCurrentProvider();if(!t)throw new Error("No provider available. Call connect() first.");if(!("disableAutoConfirm"in t))throw new Error("Auto-confirm is only available for injected providers");try{await t.disableAutoConfirm(),K.info(z.BROWSER_SDK,"Auto-confirm disabled successfully")}catch(e){throw K.error(z.BROWSER_SDK,"Failed to disable auto-confirm",{error:e.message}),e}}async getAutoConfirmStatus(){K.info(z.BROWSER_SDK,"Getting auto-confirm status");const t=this.providerManager.getCurrentProvider();if(!t)throw new Error("No provider available. Call connect() first.");if(!("getAutoConfirmStatus"in t))throw new Error("Auto-confirm is only available for injected providers");try{const e=await t.getAutoConfirmStatus();return K.info(z.BROWSER_SDK,"Got auto-confirm status",{result:e}),e}catch(e){throw K.error(z.BROWSER_SDK,"Failed to get auto-confirm status",{error:e.message}),e}}async getSupportedAutoConfirmChains(){K.info(z.BROWSER_SDK,"Getting supported auto-confirm chains");const t=this.providerManager.getCurrentProvider();if(!t)throw new Error("No provider available. Call connect() first.");if(!("getSupportedAutoConfirmChains"in t))throw new Error("Auto-confirm is only available for injected providers");try{const e=await t.getSupportedAutoConfirmChains();return K.info(z.BROWSER_SDK,"Got supported auto-confirm chains",{result:e}),e}catch(e){throw K.error(z.BROWSER_SDK,"Failed to get supported auto-confirm chains",{error:e.message}),e}}getDiscoveredWallets(){K.log(z.BROWSER_SDK,"Getting discovered wallets");try{const t=this.walletRegistry.getByAddressTypes(this.config.addressTypes);return K.log(z.BROWSER_SDK,"Retrieved discovered wallets",{count:t.length,walletIds:t.map(e=>e.id)}),t}catch(t){return K.error(z.BROWSER_SDK,"Failed to get discovered wallets",{error:t.message}),[]}}};const go=new qI({providers:["apple","google"],addressTypes:[st.solana,st.ethereum],authOptions:{redirectUrl:"https://tokendove.com/#/home"},appId:"6f372dd1-51cb-4cc0-a989-9d89b83b6114"});var WI=$a('<div class="transaction svelte-bc7d1r"><div> </div> <div> </div> <div> </div> <div>Signature: <div> </div></div> <div> </div></div>'),jI=$a('<div class="actions svelte-bc7d1r"><button class="svelte-bc7d1r">Sign Out</button> <button class="button2 svelte-bc7d1r">Back Home</button></div> <h2 class="svelte-bc7d1r">Transaction History</h2> <p> </p> <!>',1);function HI(t,e){Io(e,!0);let r=En(""),n=En(Rs([])),s="";const i=async()=>{await go.disconnect(),wo("/")},o=async()=>{await wo("/home")},a=new W2(H2("devnet"),"confirmed");async function c(){if(s="",or(n,[],!0),!!ut(r))try{const S=new Ge(ut(r)),O=await a.getSignaturesForAddress(S,{limit:5});if(!O.length){s="No transactions found for this address.";return}for(const $ of O){const k=await a.getTransaction($.signature,{commitment:"confirmed"});if(!k)continue;const Z=k.blockTime?new Date(k.blockTime*1e3).toLocaleString():"Unknown",q=k.transaction.signatures[0],J=k.meta.preBalances,se=k.meta.postBalances,oe=k.transaction.message.accountKeys,V=k.transaction.message.instructions[0],W=V.accounts[0],Y=V.accounts[1]!==void 0?V.accounts[1]:V.accounts[0],te=oe[W],A=oe[Y],u=((J[W]-se[W])/G2).toFixed(6);or(n,[...ut(n),{from:te,to:A,amount:u,signature:q,blockTime:Z}],!0)}}catch(S){s=S.message}}Td(async()=>{await go.connect({provider:"google"});try{or(r,await go.solana.getPublicKey(),!0),ut(r)&&await c()}catch(S){s="Failed to load public key",console.error(S)}});var l=jI(),g=Ii(l),m=Dn(g);m.__click=i;var I=xn(m,2);I.__click=o;var _=xn(g,4),b=Dn(_),v=xn(_,2);pw(v,17,()=>ut(n),S=>S.signature,(S,O)=>{var $=WI(),k=Dn($),Z=Dn(k),q=xn(k,2),J=Dn(q),se=xn(q,2),oe=Dn(se),V=xn(se,2),W=xn(Dn(V)),Y=Dn(W),te=xn(V,2),A=Dn(te);Fu(()=>{ai(Z,`From: ${ut(O).from??""}`),ai(J,`To: ${ut(O).to??""}`),ai(oe,`Amount (SOL): ${ut(O).amount??""}`),ai(Y,ut(O).signature),ai(A,`Time: ${ut(O).blockTime??""}`)}),Fs(S,$)}),Fu(()=>ai(b,`Public Key: ${ut(r)}`)),Fs(t,l),So()}Yl(["click"]);var GI=$a(`<h2>Token Dove</h2> <p class="svelte-6ry042">This is an <a href="https://github.com/mourningdove007/token-dove">open source project</a> with the end goal of providing videogame developers an easy platform for in
    game asset exchange. Currently, the app will allow a user to sign in with their
    Phantom wallet and view transaction history.</p> <button class="svelte-6ry042">Sign In with Phantom</button> <p class="svelte-6ry042">Privacy Disclaimer: No personal information is collected as there is no
    backend. All information is owned by the user.</p> <div class="footer svelte-6ry042"><a href="https://github.com/mourningdove007/token-dove" target="_blank" class="svelte-6ry042">Token Dove</a>  Devnet Edition  Printed from the Solana blockchain</div>`,1);function JI(t,e){Io(e,!1);const r=async()=>{try{const i=await go.connect({provider:"google"});console.log("Connected addresses:",i),wo("/home")}catch{console.log("error signing in")}};Xl();var n=GI(),s=xn(Ii(n),4);s.__click=r,Fs(t,n),So()}Yl(["click"]);var ZI=$a('<button class="signOutButton svelte-et6md">Sign Out</button> <h2 class="svelte-et6md">Welcome</h2> <p>To view transaction history, please select from our avialable options below.</p> <button class="svelte-et6md">View Your Solana Devnet Transaction History</button> <div class="footer svelte-et6md"><a href="https://github.com/mourningdove007/token-dove" target="_blank">Token Dove</a>  Devnet Edition  Printed from the Solana blockchain</div>',1);function YI(t,e){Io(e,!1);const r=async()=>{await go.disconnect(),wo("/")},n=async()=>{await wo("/ledger")};Xl();var s=ZI(),i=Ii(s);i.__click=r;var o=xn(i,6);o.__click=n,Fs(t,s),So()}Yl(["click"]);function XI(t){const e={"/":JI,"/ledger":HI,"/home":YI};Rw(t,{get routes(){return e}})}lw(XI,{target:document.getElementById("app")});
